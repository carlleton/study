var cc=cc||{};cc._tmp=cc._tmp||{};cc._LogInfos={};_p=window;_p=Object.prototype;delete window._p;cc.newElement=function(b){return document.createElement(b)};cc._addEventListener=function(f,e,h,g){f.addEventListener(e,h,g)};cc._isNodeJs="undefined"!==typeof require&&require("fs");cc.each=function(g,f,k){if(g){if(g instanceof Array){for(var j=0,h=g.length;j<h&&!1!==f.call(k,g[j],j);j++){}}else{for(j in g){if(!1===f.call(k,g[j],j)){break}}}}};cc.extend=function(d){var c=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];cc.each(c,function(a){for(var e in a){a.hasOwnProperty(e)&&(d[e]=a[e])}});return d};cc.isFunction=function(b){return"function"===typeof b};cc.isNumber=function(b){return"number"===typeof b||"[object Number]"===Object.prototype.toString.call(b)};cc.isString=function(b){return"string"===typeof b||"[object String]"===Object.prototype.toString.call(b)};cc.isArray=function(b){return Array.isArray(b)||"object"===typeof b&&"[object Array]"===Object.prototype.toString.call(b)};cc.isUndefined=function(b){return"undefined"===typeof b};cc.isObject=function(b){return"object"===typeof b&&"[object Object]"===Object.prototype.toString.call(b)};cc.isCrossOrigin=function(d){if(!d){return cc.log("invalid URL"),!1}var c=d.indexOf("://");if(-1===c){return !1}c=d.indexOf("/",c+3);return(-1===c?d:d.substring(0,c))!==location.origin};cc.AsyncPool=function(h,g,n,m,k){var j=this;j._srcObj=h;j._limit=g;j._pool=[];j._iterator=n;j._iteratorTarget=k;j._onEnd=m;j._onEndTarget=k;j._results=h instanceof Array?[]:{};j._isErr=!1;cc.each(h,function(d,c){j._pool.push({index:c,value:d})});j.size=j._pool.length;j.finishedSize=0;j._workingSize=0;j._limit=j._limit||j.size;j.onIterator=function(d,c){j._iterator=d;j._iteratorTarget=c};j.onEnd=function(d,c){j._onEnd=d;j._onEndTarget=c};j._handleItem=function(){var f=this;if(!(0===f._pool.length||f._workingSize>=f._limit)){var e=f._pool.shift(),p=e.value,o=e.index;f._workingSize++;f._iterator.call(f._iteratorTarget,p,o,function(a){if(!f._isErr){if(f.finishedSize++,f._workingSize--,a){f._isErr=!0,f._onEnd&&f._onEnd.call(f._onEndTarget,a)}else{var d=Array.prototype.slice.call(arguments,1);f._results[this.index]=d[0];f.finishedSize===f.size?f._onEnd&&f._onEnd.call(f._onEndTarget,null,f._results):f._handleItem()}}}.bind(e),f)}};j.flow=function(){if(0===this._pool.length){this._onEnd&&this._onEnd.call(this._onEndTarget,null,[])}else{for(var b=0;b<this._limit;b++){this._handleItem()}}}};cc.async={series:function(e,d,f){e=new cc.AsyncPool(e,1,function(g,c,h){g.call(f,h)},d,f);e.flow();return e},parallel:function(e,d,f){e=new cc.AsyncPool(e,0,function(g,c,h){g.call(f,h)},d,f);e.flow();return e},waterfall:function(h,g,n){var m=[],k=[null],j=new cc.AsyncPool(h,1,function(a,d,c){m.push(function(e){m=Array.prototype.slice.call(arguments,1);h.length-1===d&&(k=k.concat(m));c.apply(null,arguments)});a.apply(n,m)},function(b){if(g){if(b){return g.call(n,b)}g.apply(n,k)}});j.flow();return j},map:function(g,f,k,j){var h=f;"object"===typeof f&&(k=f.cb,j=f.iteratorTarget,h=f.iterator);g=new cc.AsyncPool(g,0,h,k,j);g.flow();return g},mapLimit:function(g,f,k,j,h){g=new cc.AsyncPool(g,f,k,j,h);g.flow();return g}};cc.path={join:function(){for(var e=arguments.length,d="",f=0;f<e;f++){d=(d+(""===d?"":"/")+arguments[f]).replace(/(\/|\\\\)$/,"")}return d},extname:function(b){return(b=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(b))?b[1]:null},mainFileName:function(d){if(d){var c=d.lastIndexOf(".");if(-1!==c){return d.substring(0,c)}}return d},basename:function(e,d){var f=e.indexOf("?");0<f&&(e=e.substring(0,f));f=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(e.replace(/(\/|\\\\)$/,""));if(!f){return null}f=f[2];return d&&e.substring(e.length-d.length).toLowerCase()===d.toLowerCase()?f.substring(0,f.length-d.length):f},dirname:function(b){return b.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(f,e){e=e||"";var h=f.indexOf("?"),g="";0<h&&(g=f.substring(h),f=f.substring(0,h));h=f.lastIndexOf(".");return 0>h?f+e+g:f.substring(0,h)+e+g},changeBasename:function(g,f,k){if(0===f.indexOf(".")){return this.changeExtname(g,f)}var j=g.indexOf("?"),h="";k=k?this.extname(g):"";0<j&&(h=g.substring(j),g=g.substring(0,j));j=g.lastIndexOf("/");return g.substring(0,0>=j?0:j+1)+f+k+h}};cc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(g){var f=g[0],k=g[1],j=g[2],h=["",null,null];if(1===g.length){h[1]=f instanceof Array?f:[f]}else{if(2===g.length){"function"===typeof k?(h[1]=f instanceof Array?f:[f],h[2]=k):(h[0]=f||"",h[1]=k instanceof Array?k:[k])}else{if(3===g.length){h[0]=f||"",h[1]=k instanceof Array?k:[k],h[2]=j}else{throw"arguments error to load js!"}}}return h},loadJs:function(k,j,s){var r=this,p=r._jsCache,o=r._getArgs4Js(arguments),n=o[0],m=o[1],o=o[2];-1<navigator.userAgent.indexOf("Trident/5")?r._loadJs4Dependency(n,m,0,o):cc.async.map(m,function(e,d,f){e=cc.path.join(n,e);if(p[e]){return f(null)}r._createScript(e,!1,f)},o)},loadJsWithImg:function(g,f,k){var j=this._loadJsImg(),h=this._getArgs4Js(arguments);this.loadJs(h[0],h[1],function(b){if(b){throw b}j.parentNode.removeChild(j);if(h[2]){h[2]()}})},_createScript:function(g,f,k){var j=document,h=cc.newElement("script");h.async=f;this._jsCache[g]=!0;cc.game.config.noCache&&"string"===typeof g?this._noCacheRex.test(g)?h.src=g+"\x26_t\x3d"+(new Date-0):h.src=g+"?_t\x3d"+(new Date-0):h.src=g;cc._addEventListener(h,"load",function(){h.parentNode.removeChild(h);this.removeEventListener("load",arguments.callee,!1);k()},!1);cc._addEventListener(h,"error",function(){h.parentNode.removeChild(h);k("Load "+g+" failed!")},!1);j.body.appendChild(h)},_loadJs4Dependency:function(g,f,k,j){if(k>=f.length){j&&j()}else{var h=this;h._createScript(cc.path.join(g,f[k]),!1,function(a){if(a){return j(a)}h._loadJs4Dependency(g,f,k+1,j)})}},_loadJsImg:function(){var e=document,d=e.getElementById("cocos2d_loadJsImg");if(!d){d=cc.newElement("img");cc._loadingImage&&(d.src=cc._loadingImage);e=e.getElementById(cc.game.config.id);e.style.backgroundColor="white";e.parentNode.appendChild(d);var f=getComputedStyle?getComputedStyle(e):e.currentStyle;f||(f={width:e.width,height:e.height});d.style.left=e.offsetLeft+(parseFloat(f.width)-d.width)/2+"px";d.style.top=e.offsetTop+(parseFloat(f.height)-d.height)/2+"px";d.style.position="absolute"}return d},loadTxt:function(f,e){if(cc._isNodeJs){require("fs").readFile(f,function(b,d){b?e(b):e(null,d.toString())})}else{var h=this.getXMLHttpRequest(),g="load "+f+" failed!";h.open("GET",f,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(h.setRequestHeader("Accept-Charset","utf-8"),h.onreadystatechange=function(){4===h.readyState&&(200===h.status?e(null,h.responseText):e(g))}):(h.overrideMimeType&&h.overrideMimeType("text/plain; charset\x3dutf-8"),h.onload=function(){4===h.readyState&&(200===h.status?e(null,h.responseText):e(g))});h.send(null)}},_loadTxtSync:function(d){if(cc._isNodeJs){return require("fs").readFileSync(d).toString()}var c=this.getXMLHttpRequest();c.open("GET",d,!1);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?c.setRequestHeader("Accept-Charset","utf-8"):c.overrideMimeType&&c.overrideMimeType("text/plain; charset\x3dutf-8");c.send(null);return 4===!c.readyState||200!==c.status?null:c.responseText},loadCsb:function(e,d){var f=new XMLHttpRequest;f.open("GET",e,!0);f.responseType="arraybuffer";f.onload=function(){var a=f.response;a&&(window.msg=a);4===f.readyState&&(200===f.status?d(null,f.response):d("load "+e+" failed!"))};f.send(null)},loadJson:function(d,c){this.loadTxt(d,function(h,g){if(h){c(h)}else{try{var b=JSON.parse(g)}catch(a){throw"parse json ["+d+"] failed : "+a}c(null,b)}})},_checkIsImageURL:function(b){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(b)},loadImg:function(k,j,s){var r={isCrossOrigin:!0};void 0!==s?r.isCrossOrigin=null===j.isCrossOrigin?r.isCrossOrigin:j.isCrossOrigin:void 0!==j&&(s=j);var p=this.getRes(k);if(p){return s&&s(null,p),p}p=new Image;r.isCrossOrigin&&"file://"!==location.origin&&(p.crossOrigin="Anonymous");var o=function(){this.removeEventListener("load",o,!1);this.removeEventListener("error",m,!1);cc.loader.cache[k]=p;s&&s(null,p)},n=this,m=function(){this.removeEventListener("error",m,!1);p.crossOrigin&&"anonymous"===p.crossOrigin.toLowerCase()?(r.isCrossOrigin=!1,n.release(k),cc.loader.loadImg(k,r,s)):"function"===typeof s&&s("load image failed")};cc._addEventListener(p,"load",o);cc._addEventListener(p,"error",m);p.src=k;return p},_loadResIterator:function(h,g,n){var m=this,k=null,j=h.type;j?(j="."+j.toLowerCase(),k=h.src?h.src:h.name+j):(k=h,j=cc.path.extname(k));if(g=m.getRes(k)){return n(null,g)}g=null;j&&(g=m._register[j.toLowerCase()]);if(!g){return cc.error("loader for ["+j+"] not exists!"),n()}j=g.getBasePath?g.getBasePath():m.resPath;j=m.getUrl(j,k);cc.game.config.noCache&&"string"===typeof j&&(j=m._noCacheRex.test(j)?j+("\x26_t\x3d"+(new Date-0)):j+("?_t\x3d"+(new Date-0)));g.load(j,k,h,function(d,c){d?(cc.log(d),m.cache[k]=null,delete m.cache[k],n()):(m.cache[k]=c,n(null,c))})},_noCacheRex:/\?/,getUrl:function(g,f){var k=this._langPathCache,j=cc.path;if(void 0!==g&&void 0===f){f=g;var h=j.extname(f),h=h?h.toLowerCase():"";g=(h=this._register[h])?h.getBasePath?h.getBasePath():this.resPath:this.resPath}f=cc.path.join(g||"",f);if(f.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(k[f]){return k[f]}j=j.extname(f)||"";f=k[f]=f.substring(0,f.length-j.length)+"_"+cc.sys.language+j}return f},load:function(g,f,k){var j=this,h=arguments.length;if(0===h){throw"arguments error!"}3===h?"function"===typeof f&&(f="function"===typeof k?{trigger:f,cb:k}:{cb:f,cbTarget:k}):2===h?"function"===typeof f&&(f={cb:f}):1===h&&(f={});g instanceof Array||(g=[g]);h=new cc.AsyncPool(g,0,function(b,n,m,d){j._loadResIterator(b,n,function(e){if(e){return m(e)}var o=Array.prototype.slice.call(arguments,1);f.trigger&&f.trigger.call(f.triggerTarget,o[0],d.size,d.finishedSize);m(null,o[0])})},f.cb,f.cbTarget);h.flow();return h},_handleAliases:function(h,g){var n=this._aliases,m=[],k;for(k in h){var j=h[k];n[k]=j;m.push(j)}this.load(m,g)},loadAliases:function(f,e){var h=this,g=h.getRes(f);g?h._handleAliases(g.filenames,e):h.load(f,function(b,c){h._handleAliases(c[0].filenames,e)})},register:function(f,e){if(f&&e){if("string"===typeof f){return this._register[f.trim().toLowerCase()]=e}for(var h=0,g=f.length;h<g;h++){this._register["."+f[h].trim().toLowerCase()]=e}}},getRes:function(b){return this.cache[b]||this.cache[this._aliases[b]]},release:function(e){var d=this.cache,f=this._aliases;delete d[e];delete d[f[e]];delete f[e]},releaseAll:function(){var e=this.cache,d=this._aliases,f;for(f in e){delete e[f]}for(f in d){delete d[f]}}};cc.formatStr=function(){var j=arguments,h=j.length;if(1>h){return""}var p=j[0],o=!0;"object"===typeof p&&(o=!1);for(var n=1;n<h;++n){var m=j[n];if(o){for(;;){var k=null;if("number"===typeof m&&(k=p.match(/(%d)|(%s)/))){p=p.replace(/(%d)|(%s)/,m);break}p=(k=p.match(/%s/))?p.replace(/%s/,m):p+("    "+m);break}}else{p+="    "+m}}return p};(function(){var g=window,f,k;cc.isUndefined(document.hidden)?cc.isUndefined(document.mozHidden)?cc.isUndefined(document.msHidden)?cc.isUndefined(document.webkitHidden)||(f="webkitHidden",k="webkitvisibilitychange"):(f="msHidden",k="msvisibilitychange"):(f="mozHidden",k="mozvisibilitychange"):(f="hidden",k="visibilitychange");var j=function(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)},h=function(){cc.eventManager&&cc.game._eventShow&&cc.eventManager.dispatchEvent(cc.game._eventShow);cc.game._intervalId&&(window.cancelAnimationFrame(cc.game._intervalId),cc.game._runMainLoop())};f?cc._addEventListener(document,k,function(){document[f]?j():h()},!1):(cc._addEventListener(g,"blur",j,!1),cc._addEventListener(g,"focus",h,!1));-1<navigator.userAgent.indexOf("MicroMessenger")&&(g.onfocus=function(){h()});"onpageshow" in window&&"onpagehide" in window&&(cc._addEventListener(g,"pagehide",j,!1),cc._addEventListener(g,"pageshow",h,!1));k=g=null})();cc.log=cc.warn=cc.error=cc.assert=function(){};cc.create3DContext=function(h,g){for(var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],m=null,k=0;k<n.length;++k){try{m=h.getContext(n[k],g)}catch(j){}if(m){break}}return m};cc._initSys=function(B,A){cc._RENDER_TYPE_CANVAS=0;cc._RENDER_TYPE_WEBGL=1;cc.sys={};var z=cc.sys;z.LANGUAGE_ENGLISH="en";z.LANGUAGE_CHINESE="zh";z.LANGUAGE_FRENCH="fr";z.LANGUAGE_ITALIAN="it";z.LANGUAGE_GERMAN="de";z.LANGUAGE_SPANISH="es";z.LANGUAGE_DUTCH="du";z.LANGUAGE_RUSSIAN="ru";z.LANGUAGE_KOREAN="ko";z.LANGUAGE_JAPANESE="ja";z.LANGUAGE_HUNGARIAN="hu";z.LANGUAGE_PORTUGUESE="pt";z.LANGUAGE_ARABIC="ar";z.LANGUAGE_NORWEGIAN="no";z.LANGUAGE_POLISH="pl";z.OS_IOS="iOS";z.OS_ANDROID="Android";z.OS_WINDOWS="Windows";z.OS_MARMALADE="Marmalade";z.OS_LINUX="Linux";z.OS_BADA="Bada";z.OS_BLACKBERRY="Blackberry";z.OS_OSX="OS X";z.OS_WP8="WP8";z.OS_WINRT="WINRT";z.OS_UNKNOWN="Unknown";z.UNKNOWN=0;z.IOS=1;z.ANDROID=2;z.WIN32=3;z.MARMALADE=4;z.LINUX=5;z.BADA=6;z.BLACKBERRY=7;z.MACOS=8;z.NACL=9;z.EMSCRIPTEN=10;z.TIZEN=11;z.QT5=12;z.WP8=13;z.WINRT=14;z.MOBILE_BROWSER=100;z.DESKTOP_BROWSER=101;z.BROWSER_TYPE_WECHAT="wechat";z.BROWSER_TYPE_ANDROID="androidbrowser";z.BROWSER_TYPE_IE="ie";z.BROWSER_TYPE_QQ="qqbrowser";z.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";z.BROWSER_TYPE_UC="ucbrowser";z.BROWSER_TYPE_360="360browser";z.BROWSER_TYPE_BAIDU_APP="baiduboxapp";z.BROWSER_TYPE_BAIDU="baidubrowser";z.BROWSER_TYPE_MAXTHON="maxthon";z.BROWSER_TYPE_OPERA="opera";z.BROWSER_TYPE_OUPENG="oupeng";z.BROWSER_TYPE_MIUI="miuibrowser";z.BROWSER_TYPE_FIREFOX="firefox";z.BROWSER_TYPE_SAFARI="safari";z.BROWSER_TYPE_CHROME="chrome";z.BROWSER_TYPE_LIEBAO="liebao";z.BROWSER_TYPE_QZONE="qzone";z.BROWSER_TYPE_SOUGOU="sogou";z.BROWSER_TYPE_UNKNOWN="unknown";z.isNative=!1;var y=window,x=y.navigator,w=document,v=w.documentElement,u=x.userAgent.toLowerCase();z.isMobile=-1!==u.indexOf("mobile")||-1!==u.indexOf("android");z.platform=z.isMobile?z.MOBILE_BROWSER:z.DESKTOP_BROWSER;var t=x.language,t=(t=t?t:x.browserLanguage)?t.split("-")[0]:z.LANGUAGE_ENGLISH;z.language=t;var t=z.BROWSER_TYPE_UNKNOWN,r=u.match(/sogou|qzone|liebao|micromessenger|qqbrowser|ucbrowser|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|trident|oupeng|opera|miuibrowser|firefox/i)||u.match(/chrome|safari/i);r&&0<r.length?(t=r[0],"micromessenger"===t?t=z.BROWSER_TYPE_WECHAT:"safari"===t&&u.match(/android.*applewebkit/)?t=z.BROWSER_TYPE_ANDROID:"trident"===t?t=z.BROWSER_TYPE_IE:"360 aphone"===t&&(t=z.BROWSER_TYPE_360)):u.indexOf("iphone")&&u.indexOf("mobile")&&(t="safari");z.browserType=t;t=u.match(/(iPad|iPhone|iPod)/i)?!0:!1;u=u.match(/android/i)||x.platform.match(/android/i)?!0:!1;r=z.OS_UNKNOWN;-1!==x.appVersion.indexOf("Win")?r=z.OS_WINDOWS:t?r=z.OS_IOS:-1!==x.appVersion.indexOf("Mac")?r=z.OS_OSX:-1!==x.appVersion.indexOf("X11")&&-1===x.appVersion.indexOf("Linux")?r=z.OS_UNIX:u?r=z.OS_ANDROID:-1!==x.appVersion.indexOf("Linux")&&(r=z.OS_LINUX);z.os=r;z._supportMultipleAudio=-1<[z.BROWSER_TYPE_BAIDU,z.BROWSER_TYPE_OPERA,z.BROWSER_TYPE_FIREFOX,z.BROWSER_TYPE_CHROME,z.BROWSER_TYPE_BAIDU_APP,z.BROWSER_TYPE_SAFARI,z.BROWSER_TYPE_UC,z.BROWSER_TYPE_QQ,z.BROWSER_TYPE_MOBILE_QQ,z.BROWSER_TYPE_IE].indexOf(z.browserType);(function(H,G){var F=G[A.renderMode]-0;if(isNaN(F)||2<F||0>F){F=0}var E=[H.OS_ANDROID],D=[],s=cc.newElement("canvas");cc._renderType=cc._RENDER_TYPE_CANVAS;cc._supportRender=!1;var p=y.WebGLRenderingContext;if(2===F||0===F&&p&&-1===E.indexOf(H.os)&&-1===D.indexOf(H.browserType)){try{cc.create3DContext(s,{stencil:!0,preserveDrawingBuffer:!0})&&(cc._renderType=cc._RENDER_TYPE_WEBGL,cc._supportRender=!0)}catch(d){}}if(1===F||0===F&&!1===cc._supportRender){try{s.getContext("2d"),cc._renderType=cc._RENDER_TYPE_CANVAS,cc._supportRender=!0}catch(b){}}})(z,B);z._canUseCanvasNewBlendModes=function(){var e=document.createElement("canvas");e.width=1;e.height=1;e=e.getContext("2d");e.fillStyle="#000";e.fillRect(0,0,1,1);e.globalCompositeOperation="multiply";var d=document.createElement("canvas");d.width=1;d.height=1;var f=d.getContext("2d");f.fillStyle="#fff";f.fillRect(0,0,1,1);e.drawImage(d,0,0,1,1);return 0===e.getImageData(0,0,1,1).data[0]};z._supportCanvasNewBlendModes=z._canUseCanvasNewBlendModes();try{z._supportWebAudio=!!(y.AudioContext||y.webkitAudioContext||y.mozAudioContext)}catch(o){z._supportWebAudio=!1}try{var j=z.localStorage=y.localStorage;j.setItem("storage","");j.removeItem("storage");j=null}catch(C){"SECURITY_ERR"!==C.name&&"QuotaExceededError"!==C.name||cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"),z.localStorage=function(){}}j=z.capabilities={canvas:!0};cc._renderType===cc._RENDER_TYPE_WEBGL&&(j.opengl=!0);if(void 0!==v.ontouchstart||void 0!==w.ontouchstart||x.msPointerEnabled){j.touches=!0}void 0!==v.onmouseup&&(j.mouse=!0);void 0!==v.onkeyup&&(j.keyboard=!0);if(y.DeviceMotionEvent||y.DeviceOrientationEvent){j.accelerometer=!0}z.garbageCollect=function(){};z.dumpRoot=function(){};z.restartVM=function(){};z.cleanScript=function(b){};z.isObjectValid=function(b){return b?!0:!1};z.dump=function(){var b;b=""+("isMobile : "+this.isMobile+"\r\n");b+="language : "+this.language+"\r\n";b+="browserType : "+this.browserType+"\r\n";b+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n";b+="os : "+this.os+"\r\n";b+="platform : "+this.platform+"\r\n";cc.log(b)};z.openURL=function(b){window.open(b)}};cc.ORIENTATION_PORTRAIT=0;cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1;cc.ORIENTATION_LANDSCAPE_LEFT=2;cc.ORIENTATION_LANDSCAPE_RIGHT=3;cc._drawingUtil=null;cc._renderContext=null;cc._canvas=null;cc._gameDiv=null;cc._rendererInitialized=!1;cc._setupCalled=!1;cc._setup=function(h,g,n){if(!cc._setupCalled){cc._setupCalled=!0;var m=window,k=cc.$(h)||cc.$("#"+h),j;cc.game._setAnimFrame();"CANVAS"===k.tagName?(g=g||k.width,n=n||k.height,j=cc.container=cc.newElement("DIV"),h=cc._canvas=k,h.parentNode.insertBefore(j,h),h.appendTo(j),j.setAttribute("id","Cocos2dGameContainer")):("DIV"!==k.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),g=g||k.clientWidth,n=n||k.clientHeight,j=cc.container=k,h=cc._canvas=cc.$(cc.newElement("CANVAS")),k.appendChild(h));h.addClass("gameCanvas");h.setAttribute("width",g||480);h.setAttribute("height",n||320);h.setAttribute("tabindex",99);h.style.outline="none";k=j.style;k.width=(g||480)+"px";k.height=(n||320)+"px";k.margin="0 auto";k.position="relative";k.overflow="hidden";j.top="100%";cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc._renderContext=cc.webglContext=cc.create3DContext(h,{stencil:!0,preserveDrawingBuffer:!0,antialias:!cc.sys.isMobile,alpha:!1}));cc._renderContext?(m.gl=cc._renderContext,cc._drawingUtil=new cc.DrawingPrimitiveWebGL(cc._renderContext),cc._rendererInitialized=!0,cc.textureCache._initializingRenderer(),cc.shaderCache._init()):(cc._renderContext=new cc.CanvasContextWrapper(h.getContext("2d")),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(cc._renderContext):null);cc._gameDiv=j;cc.log(cc.ENGINE_VERSION);cc._setContextMenuEnable(!1);cc.sys.isMobile&&(g=cc.newElement("style"),g.type="text/css",document.body.appendChild(g),g.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}");cc.view=cc.EGLView._getInstance();cc.inputManager.registerSystemEvent(cc._canvas);cc.director=cc.Director._getInstance();cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view);cc.winSize=cc.director.getWinSize();cc.saxParser=new cc.SAXParser;cc.plistParser=new cc.PlistParser}};cc._checkWebGLRenderMode=function(){if(cc._renderType!==cc._RENDER_TYPE_WEBGL){throw"This feature supports WebGL render mode only."}};cc._isContextMenuEnable=!1;cc._setContextMenuEnable=function(b){cc._isContextMenuEnable=b;cc._canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable){return !1}}};cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:!1,_prepared:!1,_paused:!0,_intervalId:null,_lastTime:null,_frameTime:null,config:null,onStart:null,onStop:null,setFrameRate:function(b){this.config[this.CONFIG_KEY.frameRate]=b;this._intervalId&&window.cancelAnimationFrame(this._intervalId);this._paused=!0;this._setAnimFrame();this._runMainLoop()},_setAnimFrame:function(){this._lastTime=new Date;this._frameTime=1000/cc.game.config[cc.game.CONFIG_KEY.frameRate];cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT||60!==cc.game.config[cc.game.CONFIG_KEY.frameRate]?(window.requestAnimFrame=this._stTime,window.cancelAnimationFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(f){var e=(new Date).getTime(),h=Math.max(0,cc.game._frameTime-(e-cc.game._lastTime)),g=window.setTimeout(function(){f()},h);cc.game._lastTime=e+h;return g},_ctTime:function(b){window.clearTimeout(b)},_runMainLoop:function(){var e=this,d,f=cc.director;f.setDisplayStats(e.config[e.CONFIG_KEY.showFPS]);d=function(){e._paused||(f.mainLoop(),e._intervalId&&window.cancelAnimationFrame(e._intervalId),e._intervalId=window.requestAnimFrame(d))};window.requestAnimFrame(d);e._paused=!1},restart:function(){cc.director.popToSceneStackLevel(0);cc.audioEngine&&cc.audioEngine.end();cc.game.onStart()},run:function(e){var d=this,f=function(){e&&(d.config[d.CONFIG_KEY.id]=e);d._prepareCalled||d.prepare(function(){d._prepared=!0});cc._supportRender&&(d._checkPrepare=setInterval(function(){d._prepared&&(cc._setup(d.config[d.CONFIG_KEY.id]),d._runMainLoop(),d._eventHide=d._eventHide||new cc.EventCustom(d.EVENT_HIDE),d._eventHide.setUserData(d),d._eventShow=d._eventShow||new cc.EventCustom(d.EVENT_SHOW),d._eventShow.setUserData(d),d.onStart(),clearInterval(d._checkPrepare))},10))};document.body?f():cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);f()},!1)},_initConfig:function(){var w=this.CONFIG_KEY,v=function(a){a[w.engineDir]=a[w.engineDir]||"frameworks/cocos2d-html5";null==a[w.debugMode]&&(a[w.debugMode]=0);a[w.frameRate]=a[w.frameRate]||60;null==a[w.renderMode]&&(a[w.renderMode]=1);return a};if(document.ccConfig){this.config=v(document.ccConfig)}else{try{for(var u=document.getElementsByTagName("script"),t=0;t<u.length;t++){var s=u[t].getAttribute("cocos");if(""===s||s){break}}var r,p,o;if(t<u.length){if(r=u[t].src){o=/(.*)\//.exec(r)[0],cc.loader.resPath=o,r=cc.path.join(o,"project.json")}p=cc.loader._loadTxtSync(r)}p||(p=cc.loader._loadTxtSync("project.json"));var n=JSON.parse(p);this.config=v(n||{})}catch(j){cc.log("Failed to read or parse project.json"),this.config=v({})}}cc._initSys(this.config,w)},_jsAddedCache:{},_getJsListOfModule:function(w,v,u){var t=this._jsAddedCache;if(t[v]){return null}u=u||"";var s=[],r=w[v];if(!r){throw"can not find module ["+v+"]"}v=cc.path;for(var p=0,o=r.length;p<o;p++){var n=r[p];if(!t[n]){var j=v.extname(n);j?".js"===j.toLowerCase()&&s.push(v.join(u,n)):(j=this._getJsListOfModule(w,n,u))&&(s=s.concat(j));t[n]=1}}return s},prepare:function(j){var h=this,p=h.config,o=h.CONFIG_KEY,n=p[o.engineDir],m=cc.loader;if(!cc._supportRender){throw"The renderer doesn't support the renderMode "+p[o.renderMode]}h._prepareCalled=!0;var k=p[o.jsList]||[];cc.Class?m.loadJsWithImg("",k,function(a){if(a){throw a}h._prepared=!0;j&&j()}):(o=cc.path.join(n,"moduleConfig.json"),m.loadJson(o,function(v,g){if(v){throw v}var a=p.modules||[],w=g.module,t=[];cc._renderType===cc._RENDER_TYPE_WEBGL?a.splice(0,0,"shaders"):0>a.indexOf("core")&&a.splice(0,0,"core");for(var c=0,e=a.length;c<e;c++){var b=h._getJsListOfModule(w,a[c],n);b&&(t=t.concat(b))}t=t.concat(k);cc.loader.loadJsWithImg(t,function(d){if(d){throw d}h._prepared=!0;j&&j()})}))}};cc.game._initConfig();Function.prototype.bind=Function.prototype.bind||function(g){if(!cc.isFunction(this)){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var f=Array.prototype.slice.call(arguments,1),k=this,j=function(){},h=function(){return k.apply(this instanceof j&&g?this:g,f.concat(Array.prototype.slice.call(arguments)))};j.prototype=this.prototype;h.prototype=new j;return h};cc._LogInfos={ActionManager_addAction:"cc.ActionManager.addAction(): action must be non-null",ActionManager_removeAction:"cocos2d: removeAction: Target not found",ActionManager_removeActionByTag:"cc.ActionManager.removeActionByTag(): an invalid tag",ActionManager_removeActionByTag_2:"cc.ActionManager.removeActionByTag(): target must be non-null",ActionManager_getActionByTag:"cc.ActionManager.getActionByTag(): an invalid tag",ActionManager_getActionByTag_2:"cocos2d : getActionByTag(tag \x3d %s): Action not found",configuration_dumpInfo:"cocos2d: **** WARNING **** CC_ENABLE_PROFILERS is defined. Disable it when you finish profiling (from ccConfig.js)",configuration_loadConfigFile:"Expected 'data' dict, but not found. Config file: %s",configuration_loadConfigFile_2:"Please load the resource first : %s",Director_resume:"cocos2d: Director: Error in gettimeofday",Director_setProjection:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel:"cocos2d: Director: unrecognized projection",Director_popToSceneStackLevel_2:"cocos2d: Director: Error in gettimeofday",Director_popScene:"running scene should not null",Director_pushScene:"the scene should not null",arrayVerifyType:"element type is wrong!",Scheduler_scheduleCallbackForTarget:"CCSheduler#scheduleCallback. Callback already scheduled. Updating interval from:%s to %s",Scheduler_scheduleCallbackForTarget_2:"cc.scheduler.scheduleCallbackForTarget(): callback_fn should be non-null.",Scheduler_scheduleCallbackForTarget_3:"cc.scheduler.scheduleCallbackForTarget(): target should be non-null.",Scheduler_pauseTarget:"cc.Scheduler.pauseTarget():target should be non-null",Scheduler_resumeTarget:"cc.Scheduler.resumeTarget():target should be non-null",Scheduler_isTargetPaused:"cc.Scheduler.isTargetPaused():target should be non-null",Node_getZOrder:"getZOrder is deprecated. Please use getLocalZOrder instead.",Node_setZOrder:"setZOrder is deprecated. Please use setLocalZOrder instead.",Node_getRotation:"RotationX !\x3d RotationY. Don't know which one to return",Node_getScale:"ScaleX !\x3d ScaleY. Don't know which one to return",Node_addChild:"An Node can't be added as a child of itself.",Node_addChild_2:"child already added. It can't be added again",Node_addChild_3:"child must be non-null",Node_removeFromParentAndCleanup:"removeFromParentAndCleanup is deprecated. Use removeFromParent instead",Node_boundingBox:"boundingBox is deprecated. Use getBoundingBox instead",Node_removeChildByTag:"argument tag is an invalid tag",Node_removeChildByTag_2:"cocos2d: removeChildByTag(tag \x3d %s): child not found!",Node_removeAllChildrenWithCleanup:"removeAllChildrenWithCleanup is deprecated. Use removeAllChildren instead",Node_stopActionByTag:"cc.Node.stopActionBy(): argument tag an invalid tag",Node_getActionByTag:"cc.Node.getActionByTag(): argument tag is an invalid tag",Node_resumeSchedulerAndActions:"resumeSchedulerAndActions is deprecated, please use resume instead.",Node_pauseSchedulerAndActions:"pauseSchedulerAndActions is deprecated, please use pause instead.",Node__arrayMakeObjectsPerformSelector:"Unknown callback function",Node_reorderChild:"child must be non-null",Node_runAction:"cc.Node.runAction(): action must be non-null",Node_schedule:"callback function must be non-null",Node_schedule_2:"interval must be positive",Node_initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",AtlasNode_updateAtlasValues:"cc.AtlasNode.updateAtlasValues(): Shall be overridden in subclasses",AtlasNode_initWithTileFile:"",AtlasNode__initWithTexture:"cocos2d: Could not initialize cc.AtlasNode. Invalid Texture.",_EventListenerKeyboard_checkAvailable:"cc._EventListenerKeyboard.checkAvailable(): Invalid EventListenerKeyboard!",_EventListenerTouchOneByOne_checkAvailable:"cc._EventListenerTouchOneByOne.checkAvailable(): Invalid EventListenerTouchOneByOne!",_EventListenerTouchAllAtOnce_checkAvailable:"cc._EventListenerTouchAllAtOnce.checkAvailable(): Invalid EventListenerTouchAllAtOnce!",_EventListenerAcceleration_checkAvailable:"cc._EventListenerAcceleration.checkAvailable(): _onAccelerationEvent must be non-nil",EventListener_create:"Invalid parameter.",__getListenerID:"Don't call this method if the event is for touch.",eventManager__forceAddEventListener:"Invalid scene graph priority!",eventManager_addListener:"0 priority is forbidden for fixed priority since it's used for scene graph based priority.",eventManager_removeListeners:"Invalid listener type!",eventManager_setPriority:"Can't set fixed priority with scene graph based listener.",eventManager_addListener_2:"Invalid parameters.",eventManager_addListener_3:"listener must be a cc.EventListener object when adding a fixed priority listener",eventManager_addListener_4:"The listener has been registered, please don't register it again.",LayerMultiplex_initWithLayers:"parameters should not be ending with null in Javascript",LayerMultiplex_switchTo:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_switchToAndReleaseMe:"Invalid index in MultiplexLayer switchTo message",LayerMultiplex_addLayer:"cc.Layer.addLayer(): layer should be non-null",EGLView_setDesignResolutionSize:"Resolution not valid",EGLView_setDesignResolutionSize_2:"should set resolutionPolicy",inputManager_handleTouchesBegin:"The touches is more than MAX_TOUCHES, nUnusedIndex \x3d %s",swap:"cc.swap is being modified from original macro, please check usage",checkGLErrorDebug:"WebGL error %s",animationCache__addAnimationsWithDictionary:"cocos2d: cc.AnimationCache: No animations were found in provided dictionary.",animationCache__addAnimationsWithDictionary_2:"cc.AnimationCache. Invalid animation format",animationCache_addAnimations:"cc.AnimationCache.addAnimations(): File could not be found",animationCache__parseVersion1:"cocos2d: cc.AnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion1_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache__parseVersion1_3:"cocos2d: cc.AnimationCache: None of the frames for animation '%s' were found in the cc.SpriteFrameCache. Animation is not being added to the Animation Cache.",animationCache__parseVersion1_4:"cocos2d: cc.AnimationCache: An animation in your dictionary refers to a frame which is not in the cc.SpriteFrameCache. Some or all of the frames for the animation '%s' may be missing.",animationCache__parseVersion2:"cocos2d: CCAnimationCache: Animation '%s' found in dictionary without any frames - cannot add to animation cache.",animationCache__parseVersion2_2:"cocos2d: cc.AnimationCache: Animation '%s' refers to frame '%s' which is not currently in the cc.SpriteFrameCache. This frame will not be added to the animation.",animationCache_addAnimations_2:"cc.AnimationCache.addAnimations(): Invalid texture file name",Sprite_reorderChild:"cc.Sprite.reorderChild(): this child is not in children list",Sprite_ignoreAnchorPointForPosition:"cc.Sprite.ignoreAnchorPointForPosition(): it is invalid in cc.Sprite when using SpriteBatchNode",Sprite_setDisplayFrameWithAnimationName:"cc.Sprite.setDisplayFrameWithAnimationName(): Frame not found",Sprite_setDisplayFrameWithAnimationName_2:"cc.Sprite.setDisplayFrameWithAnimationName(): Invalid frame index",Sprite_setDisplayFrame:"setDisplayFrame is deprecated, please use setSpriteFrame instead.",Sprite__updateBlendFunc:"cc.Sprite._updateBlendFunc(): _updateBlendFunc doesn't work when the sprite is rendered using a cc.CCSpriteBatchNode",Sprite_initWithSpriteFrame:"cc.Sprite.initWithSpriteFrame(): spriteFrame should be non-null",Sprite_initWithSpriteFrameName:"cc.Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null",Sprite_initWithSpriteFrameName1:" is null, please check.",Sprite_initWithFile:"cc.Sprite.initWithFile(): filename should be non-null",Sprite_setDisplayFrameWithAnimationName_3:"cc.Sprite.setDisplayFrameWithAnimationName(): animationName must be non-null",Sprite_reorderChild_2:"cc.Sprite.reorderChild(): child should be non-null",Sprite_addChild:"cc.Sprite.addChild(): cc.Sprite only supports cc.Sprites as children when using cc.SpriteBatchNode",Sprite_addChild_2:"cc.Sprite.addChild(): cc.Sprite only supports a sprite using same texture as children when using cc.SpriteBatchNode",Sprite_addChild_3:"cc.Sprite.addChild(): child should be non-null",Sprite_setTexture:"cc.Sprite.texture setter: Batched sprites should use the same texture as the batchnode",Sprite_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_4:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",Sprite_addChild_5:"cc.SpriteBatchNode.addChild(): cc.Sprite is not using the same texture",Sprite_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",Sprite_setSpriteFrame:"Invalid spriteFrameName",Sprite_setTexture_2:"Invalid argument: cc.Sprite.texture setter expects a CCTexture2D.",Sprite_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",Sprite_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",SpriteBatchNode_addSpriteWithoutQuad:"cc.SpriteBatchNode.addQuadFromSprite(): SpriteBatchNode only supports cc.Sprites as children",SpriteBatchNode_increaseAtlasCapacity:"cocos2d: CCSpriteBatchNode: resizing TextureAtlas capacity from %s to %s.",SpriteBatchNode_increaseAtlasCapacity_2:"cocos2d: WARNING: Not enough memory to resize the atlas",SpriteBatchNode_reorderChild:"cc.SpriteBatchNode.addChild(): Child doesn't belong to Sprite",SpriteBatchNode_removeChild:"cc.SpriteBatchNode.addChild(): sprite batch node should contain the child",SpriteBatchNode_addSpriteWithoutQuad_2:"cc.SpriteBatchNode.addQuadFromSprite(): child should be non-null",SpriteBatchNode_reorderChild_2:"cc.SpriteBatchNode.addChild(): child should be non-null",spriteFrameCache__getFrameConfig:"cocos2d: WARNING: originalWidth/Height not found on the cc.SpriteFrame. AnchorPoint won't work as expected. Regenrate the .plist",spriteFrameCache_addSpriteFrames:"cocos2d: WARNING: an alias with name %s already exists",spriteFrameCache__checkConflict:"cocos2d: WARNING: Sprite frame: %s has already been added by another source, please fix name conflit",spriteFrameCache_getSpriteFrame:"cocos2d: cc.SpriteFrameCahce: Frame %s not found",spriteFrameCache__getFrameConfig_2:"Please load the resource first : %s",spriteFrameCache_addSpriteFrames_2:"cc.SpriteFrameCache.addSpriteFrames(): plist should be non-null",spriteFrameCache_addSpriteFrames_3:"Argument must be non-nil",CCSpriteBatchNode_updateQuadFromSprite:"cc.SpriteBatchNode.updateQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_insertQuadFromSprite:"cc.SpriteBatchNode.insertQuadFromSprite(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_addChild:"cc.SpriteBatchNode.addChild(): cc.SpriteBatchNode only supports cc.Sprites as children",CCSpriteBatchNode_initWithTexture:"Sprite.initWithTexture(): Argument must be non-nil ",CCSpriteBatchNode_addChild_2:"cc.Sprite.addChild(): child should be non-null",CCSpriteBatchNode_setSpriteFrame:"Invalid spriteFrameName",CCSpriteBatchNode_setTexture:"Invalid argument: cc.Sprite texture setter expects a CCTexture2D.",CCSpriteBatchNode_updateQuadFromSprite_2:"cc.SpriteBatchNode.updateQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_insertQuadFromSprite_2:"cc.SpriteBatchNode.insertQuadFromSprite(): sprite should be non-null",CCSpriteBatchNode_addChild_3:"cc.SpriteBatchNode.addChild(): child should be non-null",TextureAtlas_initWithFile:"cocos2d: Could not open file: %s",TextureAtlas_insertQuad:"cc.TextureAtlas.insertQuad(): invalid totalQuads",TextureAtlas_initWithTexture:"cc.TextureAtlas.initWithTexture():texture should be non-null",TextureAtlas_updateQuad:"cc.TextureAtlas.updateQuad(): quad should be non-null",TextureAtlas_updateQuad_2:"cc.TextureAtlas.updateQuad(): Invalid index",TextureAtlas_insertQuad_2:"cc.TextureAtlas.insertQuad(): Invalid index",TextureAtlas_insertQuads:"cc.TextureAtlas.insertQuad(): Invalid index + amount",TextureAtlas_insertQuadFromIndex:"cc.TextureAtlas.insertQuadFromIndex(): Invalid newIndex",TextureAtlas_insertQuadFromIndex_2:"cc.TextureAtlas.insertQuadFromIndex(): Invalid fromIndex",TextureAtlas_removeQuadAtIndex:"cc.TextureAtlas.removeQuadAtIndex(): Invalid index",TextureAtlas_removeQuadsAtIndex:"cc.TextureAtlas.removeQuadsAtIndex(): index + amount out of bounds",TextureAtlas_moveQuadsFromIndex:"cc.TextureAtlas.moveQuadsFromIndex(): move is out of bounds",TextureAtlas_moveQuadsFromIndex_2:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid newIndex",TextureAtlas_moveQuadsFromIndex_3:"cc.TextureAtlas.moveQuadsFromIndex(): Invalid oldIndex",textureCache_addPVRTCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_addETCImage:"TextureCache:addPVRTCImage does not support on HTML5",textureCache_textureForKey:"textureForKey is deprecated. Please use getTextureForKey instead.",textureCache_addPVRImage:"addPVRImage does not support on HTML5",textureCache_addUIImage:"cocos2d: Couldn't add UIImage in TextureCache",textureCache_dumpCachedTextureInfo:"cocos2d: '%s' id\x3d%s %s x %s",textureCache_dumpCachedTextureInfo_2:"cocos2d: '%s' id\x3d HTMLCanvasElement %s x %s",textureCache_dumpCachedTextureInfo_3:"cocos2d: TextureCache dumpDebugInfo: %s textures, HTMLCanvasElement for %s KB (%s MB)",textureCache_addUIImage_2:"cc.Texture.addUIImage(): image should be non-null",Texture2D_initWithETCFile:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData:"initWithPVRTCData does not support on HTML5",Texture2D_addImage:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithImage:"cocos2d: cc.Texture2D. Can't create Texture. UIImage is nil",Texture2D_initWithImage_2:"cocos2d: WARNING: Image (%s x %s) is bigger than the supported %s x %s",Texture2D_initWithString:"initWithString isn't supported on cocos2d-html5",Texture2D_initWithETCFile_2:"initWithETCFile does not support on HTML5",Texture2D_initWithPVRFile_2:"initWithPVRFile does not support on HTML5",Texture2D_initWithPVRTCData_2:"initWithPVRTCData does not support on HTML5",Texture2D_bitsPerPixelForFormat:"bitsPerPixelForFormat: %s, cannot give useful result, it's a illegal pixel format",Texture2D__initPremultipliedATextureWithImage:"cocos2d: cc.Texture2D: Using RGB565 texture since image has no alpha",Texture2D_addImage_2:"cc.Texture.addImage(): path should be non-null",Texture2D_initWithData:"NSInternalInconsistencyException",MissingFile:"Missing file: %s",radiansToDegress:"cc.radiansToDegress() should be called cc.radiansToDegrees()",RectWidth:"Rect width exceeds maximum margin: %s",RectHeight:"Rect height exceeds maximum margin: %s",EventManager__updateListeners:"If program goes here, there should be event in dispatch.",EventManager__updateListeners_2:"_inDispatch should be 1 here."};cc._logToWebPage=function(f){if(cc._canvas){var e=cc._logList,h=document;if(!e){var g=h.createElement("Div"),e=g.style;g.setAttribute("id","logInfoDiv");cc._canvas.parentNode.appendChild(g);g.setAttribute("width","200");g.setAttribute("height",cc._canvas.height);e.zIndex="99999";e.position="absolute";e.top="0";e.left="0";e=cc._logList=h.createElement("textarea");h=e.style;e.setAttribute("rows","20");e.setAttribute("cols","30");e.setAttribute("disabled",!0);g.appendChild(e);h.backgroundColor="transparent";h.borderBottom="1px solid #cccccc";h.borderRightWidth="0px";h.borderLeftWidth="0px";h.borderTopWidth="0px";h.borderTopStyle="none";h.borderRightStyle="none";h.borderLeftStyle="none";h.padding="0px";h.margin=0}e.value=e.value+f+"\r\n";e.scrollTop=e.scrollHeight}};cc._formatString=function(d){if(cc.isObject(d)){try{return JSON.stringify(d)}catch(c){return""}}else{return d}};cc._initDebugSetting=function(e){var d=cc.game;if(e!==d.DEBUG_MODE_NONE){var f;e>d.DEBUG_MODE_ERROR?(f=cc._logToWebPage.bind(cc),cc.error=function(){f("ERROR :  "+cc.formatStr.apply(cc,arguments))},cc.assert=function(g,c){if(!g&&c){for(var h=2;h<arguments.length;h++){c=c.replace(/(%s)|(%d)/,cc._formatString(arguments[h]))}f("Assert: "+c)}},e!==d.DEBUG_MODE_ERROR_FOR_WEB_PAGE&&(cc.warn=function(){f("WARN :  "+cc.formatStr.apply(cc,arguments))}),e===d.DEBUG_MODE_INFO_FOR_WEB_PAGE&&(cc.log=function(){f(cc.formatStr.apply(cc,arguments))})):console&&console.log.apply&&(cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(h,g){if(!h&&g){for(var j=2;j<arguments.length;j++){g=g.replace(/(%s)|(%d)/,cc._formatString(arguments[j]))}throw g}},e!==d.DEBUG_MODE_ERROR&&(cc.warn=function(){return console.warn.apply(console,arguments)}),e===d.DEBUG_MODE_INFO&&(cc.log=function(){return console.log.apply(console,arguments)}))}};cc._initDebugSetting(cc.game.config[cc.game.CONFIG_KEY.debugMode]);cc.loader.loadBinary=function(g,f){var k=this,j=this.getXMLHttpRequest(),h="load "+g+" failed!";j.open("GET",g,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(j.setRequestHeader("Accept-Charset","x-user-defined"),j.onreadystatechange=function(){if(4===j.readyState&&200===j.status){var b=cc._convertResponseBodyToText(j.responseBody);f(null,k._str2Uint8Array(b))}else{f(h)}}):(j.overrideMimeType&&j.overrideMimeType("text/plain; charset\x3dx-user-defined"),j.onload=function(){4===j.readyState&&200===j.status?f(null,k._str2Uint8Array(j.responseText)):f(h)});j.send(null)};cc.loader._str2Uint8Array=function(e){if(!e){return null}for(var d=new Uint8Array(e.length),f=0;f<e.length;f++){d[f]=e.charCodeAt(f)&255}return d};cc.loader.loadBinarySync=function(e){var d=this.getXMLHttpRequest(),f="load "+e+" failed!";d.open("GET",e,!1);e=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){d.setRequestHeader("Accept-Charset","x-user-defined");d.send(null);if(200!==d.status){return cc.log(f),null}(d=cc._convertResponseBodyToText(d.responseBody))&&(e=this._str2Uint8Array(d))}else{d.overrideMimeType&&d.overrideMimeType("text/plain; charset\x3dx-user-defined");d.send(null);if(200!==d.status){return cc.log(f),null}e=this._str2Uint8Array(d.responseText)}return e};var Uint8Array=Uint8Array||Array;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr \x3d CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex \x3d LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last \x3d Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last \x3d ""\r\n   End If\r\nEnd Function\r\n',myVBScript=cc.newElement("script");myVBScript.type="text/vbscript";myVBScript.textContent=IEBinaryToArray_ByteStr_Script;document.body.appendChild(myVBScript);cc._convertResponseBodyToText=function(f){for(var e={},h=0;256>h;h++){for(var g=0;256>g;g++){e[String.fromCharCode(h+256*g)]=String.fromCharCode(h)+String.fromCharCode(g)}}h=IEBinaryToArray_ByteStr(f);f=IEBinaryToArray_ByteStr_Last(f);return h.replace(/[\s\S]/g,function(b){return e[b]})+f}}cc=cc||{};cc._loadingImage="data:image/gif;base64,R0lGODlhEAAQALMNAD8/P7+/vyoqKlVVVX9/fxUVFUBAQGBgYMDAwC8vL5CQkP///wAAAP///wAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAANACwAAAAAEAAQAAAEO5DJSau9OOvNex0IMnDIsiCkiW6g6BmKYlBFkhSUEgQKlQCARG6nEBwOgl+QApMdCIRD7YZ5RjlGpCUCACH5BAUAAA0ALAAAAgAOAA4AAAQ6kLGB0JA4M7QW0hrngRllkYyhKAYqKUGguAws0ypLS8JxCLQDgXAIDg+FRKIA6v0SAECCBpXSkstMBAAh+QQFAAANACwAAAAACgAQAAAEOJDJORAac6K1kDSKYmydpASBUl0mqmRfaGTCcQgwcxDEke+9XO2WkxQSiUIuAQAkls0n7JgsWq8RACH5BAUAAA0ALAAAAAAOAA4AAAQ6kMlplDIzTxWC0oxwHALnDQgySAdBHNWFLAvCukc215JIZihVIZEogDIJACBxnCSXTcmwGK1ar1hrBAAh+QQFAAANACwAAAAAEAAKAAAEN5DJKc4RM+tDyNFTkSQF5xmKYmQJACTVpQSBwrpJNteZSGYoFWjIGCAQA2IGsVgglBOmEyoxIiMAIfkEBQAADQAsAgAAAA4ADgAABDmQSVZSKjPPBEDSGucJxyGA1XUQxAFma/tOpDlnhqIYN6MEAUXvF+zldrMBAjHoIRYLhBMqvSmZkggAIfkEBQAADQAsBgAAAAoAEAAABDeQyUmrnSWlYhMASfeFVbZdjHAcgnUQxOHCcqWylKEohqUEAYVkgEAMfkEJYrFA6HhKJsJCNFoiACH5BAUAAA0ALAIAAgAOAA4AAAQ3kMlJq704611SKloCAEk4lln3DQgyUMJxCBKyLAh1EMRR3wiDQmHY9SQslyIQUMRmlmVTIyRaIgA7";cc._fpsImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAAgCAYAAAD9qabkAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfcAgcQLxxUBNp/AAAQZ0lEQVR42u2be3QVVZbGv1N17829eRLyIKAEOiISEtPhJTJAYuyBDmhWjAEx4iAGBhxA4wABbVAMWUAeykMCM+HRTcBRWkNH2l5moS0LCCrQTkYeQWBQSCAIgYRXEpKbW/XNH5zS4noR7faPEeu31l0h4dSpvc+t/Z199jkFWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY/H9D/MR9qfKnLj/00U71aqfJn9+HCkCR/Wk36ddsgyJ/1wF4fkDfqqm9/gPsUeTnVr6a2xlQfnxdI7zs0W7irzD17Ytb2WT7EeNv/r4ox1O3Quf2QP2pgt9utwfout4FQE8AVBSlnaRmfvAURQkg2RlAbwB9AThlW5L0GaiKojhJhgOIBqDa7XaPrusdPtr5kQwF0BVAAoBIABRCKDd5aFUhRDAAw57eAOwAhKIoupft3zoqhB1AqLwuHIBut9uFt02qqvqRDJR2dAEQJj/BAOjn56dqmma+xiaECAEQAWAggLsB6A6HQ2iaZggBhBAqgEAAnQB0kzaEmT4hAITT6VQ8Ho/HJAKKECJQtr8LwD1y/A1/vcdfEUIEyfZ9AcQbYvZ942Px88L2UwlJR0dH0EMPPbRj5syZPUeNGrXR7Xb/641xIwJ1XY9NSUlZm52dfW+XLl1w8uRJzJ8//+OGhoYJqqqe1TSt1Wsm9NN1PSIqKmr12rVrR5WUlHy1bdu2AQCumWc3IYRD1/UwVVXnFRQUTIuNjUVzczN2797dWFJSkq8oymZd15sAGAEnFEUJ1nX9nzIzM1dnZmZGh4SE4OTJk5g5c+Zf29vbp9pstrMej6fVOyhIhgAYU1hY+B+hoaGoqKg4XVlZea+XTULTNFdCQsLGiRMnPuR2u3UhBOV9eeDAAWXTpk095DUe6WsoyRE5OTlr0tLSAux2O/bs2cO5c+e+pijKUpIXSHaQVAGkvPLKK++6XK4OksJLCFlXV2cvKSlJBFAjhU+x2WwhHo9nUHp6+urMzMy7wsLCUF9fjxdffPHjxsbGiTab7WuPx9NiEutOuq4PyMjI+M+srKyYqKgoHD58GDNmzNjq8XhyVFU9b/q+LH7hBAEYu3PnTlZVVRFAGgCX6f/tAHoOHDjwa0p27txp/JO9e/f+QM7cipw9nfL3kQBKt2zZQpJ87rnn6mQmoHilw2EACs+cOUOSrK+vZ1NTE0nyo48+IoBpxswoBcMJ4Ndjx471kOTFixe5d+9ekqTH42H//v13A4jyzpAURfEH0H/OnDnthu1z5sw558MmFUCPWbNmnaMP3nrrLZoyDmP8Hl68eDFJ8siRI9/Yc+zYMQKYKdtAztrTrl27xptRXV1NAKMAOAyBBBA/Y8aMdpLs6Ojgxx9//E37+++//29yvFXppwvAwMcee8xjtDHsuXLlCqOjo//ia3wsfpkoALqFhoZuIckJEyackimm3dQmEMDUmpoakmRISMhhAHOHDx/eQJIbN24kgKEyMAHAFRMTs2XXrl1saWkhSZ0kp0+ffhrAr3wEW/S8efOukORLL72kA1gKYMPWrVtJkk899dRJAHeYrgsEsIQkjx8/TgDvAPjd448/3kaSb7zxBmUa7vC6z53BwcFbSHL9+vU6Sc6aNes8gF5ewWAH0PfVV18lSQL4DMBGIcQ6AKtcLleBFC2jXtFt8ODBe0iyoqKCAJYByC8qKmJDQwOzsrK+MAmqo1OnTveHhoa+GRkZ+XZkZOSWiIiIvzgcjk9mzpypkWRmZuZpmbYbGV4AgPnNzc1sa2sjgN0A5iQmJtaSZHl5OQHcb/K3s81mW0uSTU1NBFAFYFbfvn1Pk+Tbb79NAA8IIVzW42/hByA+Pz/fLR/2ZXIda05NI/z9/TeR5J49ewhgqlxTrtI0jY2NjQQw3zTLuWJiYjaUlJToS5Ys6fjkk080kwDEeAmADcA9GzZsIElGRUW9CyAWwLApU6Y0kOSKFSsog9QICGdERMTGsrIyZmVlEcC9AB4IDw/fTpLbtm0jgN94CUAnAJmVlZVcs2aNZ/LkyRdJcvbs2b4EwAkgZfPmzTxw4AABFAN4BkC6vFeUSewcAO5duXIlSTIhIaEawGMAxgKYAmAGgCS73e5vrKVk/yGythANYEhCQsIhkly+fDkBpKqqGmL6DgIALDKN/3yZpVWQZGVlJQE8aPI3KiMjo5okV61aRQAjAPQBMPfIkSN0u90EUCBtsPiFEwpgbn19PdetW2fM5N4zQ9ekpKQqkty0aRMBpMjiWM6JEydIkoqirJUFJ6iq6pAPVy8A6cZMehMBUACEuVyuFwG8HBwcPEIWx367ZMkSjSQXLVrUJouTRorrkAHdA8BdQogsAOsKCwtJkmPGjDkvMw2bDDo/ADEjRoz4XylyFbm5uY0mAbjLyyZ/AOOrq6tZVlbWsWDBgo69e/eyoqKCgwcPPg4gSQaoIRbp27dvN7KF+tLSUr28vJwFBQXtMpvpYRIM7+wrAkDeqVOnePbsWQIoNKfzpiXPg8uXLydJJicnNwF4f+nSpW6STEtLq5fjYwhk1wkTJtSQ5Ouvv04AqTKj+N2xY8dIkgEBAW/Ie1v8wncRegwZMmQvSfbr12+3Ua33WqPfOWbMmP0kWVpaSgCDZAqcfejQIWNZsEGKgvnh9gfQb9myZd8nAEJVVZtMkUNk8CcNHTq0liR1XWdYWNhmH1mJIme80OnTp18x1rp5eXkEsNJms92Fb7e/IgEsvHz5Mp999tkmAI/l5uZeMC0B7vEqqAYAyL106RJJsra2lpWVld+sucePH38ZQG+5NncBeOrgwYMkqbe3t/Po0aOsra011wAWyl0H7x0JJ4DE+fPnu0kyPT29DsDdUrBuyNKEEAkAdpw/f/6GeoEM8GUmfwEgPCIiopwkGxsbabPZPgOw6L777vvm4p49e26VGYjFLxUhhD+ApLKyMp44ccIoVnXybgbgzkcfffRzklyzZg0BDJYCMMmoCwQFBXkLgLGWvvcWAgBToSsKwNPTp09vMR7UuLi4rwH0lgU8c/Db5ezbeeTIkRWzZ8++aMxu+fn5BPCADBwHgP4LFy701NXVEUAJgAnPP/98kyxMNgHo53A4zH77BQQETMvPz7+Um5vbBuAlAFMSExPPmdbVL0qh8Acw8fDhw5SCchVAEYAVb775JknyhRdeaJYztHfxMwLAaqNwCGC2FArv8x0hAHKNLGPKlCme5OTk/Zs3bzb7O0wKiiG8KXl5ed8IxenTp0mSR48e1UmyW7duWywBuD2xyQcgFECgoih+8H1gyJgZV5Lkyy+/3CbTRIePtl2HDBmyw1QBHyGDdXZdXR1JUghRKkXBjOMHCoBdpr0L3nvvPZLkF198wejo6O0A4lVVDTb74HQ6AwD8Wq7Jh8rgGgDgQ13XjVR8qaxJuADMbmlpYXl5uV5UVNRWUFDgfv/993Vj/ZydnU1c37eHXML4S3viAcQqitJD2l104cIFY8lTKsXSBWBMVVWVcd9yed2A1NTUQ6Zl00CvLMMOoHdubm6zFIlWOf5+PsY/Kj09vdrU11QAwwGsv3jxIk21m2DZr10I0RXAuAcffPBgaWkpV69eTYfDcdiwUxY0w6xw+flX8L1xApjevXv3lREREaW6rofB93aPDUDQpEmTMgHgtddeqwBwEd/utZvpqK6uPgEAcXFxkA94NwB9unfvjrNnz4LklwDcf08iIqv66Zs2bXrl4YcfxooVKxAbG7uqrq5uAYA2TdOEqqpGYIi2tjbl6aeffu/YsWPv5uTk7JaC1wHg4Pnz542MwoVvTx+21dbWYvjw4WLixIl+2dnZ9lGjRgmSTE1NRUpKCkwFTGiaxtTU1OXTpk3707Bhw/6g67pDipnT4biuj7qut+Lbk3Vf1tTUXI9qu91Pjq1QFEUBgJaWFgBo8yGOQ8eNGxcAAOvXr/8QwBUfYygAKL169eoCABcuXACAWtn2hOGv0+kMNO1KiPDw8F4A4rZv3/7R1KlTR0+bNu1ht9u9r1+/fqitrQXJgwDarRC6/QjPzs4+QJIffPCB9/aQmSAA43ft2mW0e1QGoi8CAPyLsZccExNTC2BlRkbGRdOyYJCP2csBIN6UAZzCd7cBbQCijYp/dXU1ExMTz6SmptaMHj36f9LS0vYlJCRsl6mxIWSdu3fv/g5J7t+/nwC2AShMTk6+SJKff/45AWRLYbD7+fndAeDf5BJnLoCCyZMnt5JkdnZ2C4B/F0KEm1Pu+Pj4rST55ZdfEsBWAK+mpaVdMo3raDn7KwDuSEpK+m+S3LBhAwG8DuCtHTt2UBbpjgC408vvcFVV15HkuXPnjMp+p5uMf0RcXNyHJNnQ0EBVVfcCWBQXF3fG+Jv0yxABPwB5LS0tRmFxN4BlTzzxxGWSXLx4sS5F3GGFy+1Hp5SUlJq6ujoWFxdTpsZ2H+0iIyMj/0iSWVlZX5mr5jfJFroPGzasxlhTnjp1iiTZ3NxMl8tlrCd9pfa9SkpKSJI5OTmnZOageLUZZqxvfVFWVkZcPwdgNwnSCKPqb17jkmR8fPzfZMDZ5CRsFBmNI7h95s2b1yhT7/MAYmStwCx4vy0uLqa3v5qmEcCfvSr1QQAeXb16NY3Cm3HQ55133iGAp+SxZTNhKSkpfzUddkrFjYevzAQCeGjp0qXfsYckY2NjTwD4leGDLCL2HTdunNtoY+zWSHFcIHdsFCtcfuZ1vO9Eqs3m7/F47sb1k2qX/f3997W2tl7BjWfpBYDOzzzzzIVJkyZh0KBBCwEsB3AJvl9AETabLcDj8dwRFRW1ctasWb8JCgpSzp07d62wsPC/Wltb8xRFadR1/ZqPXYbgAQMGbI2Pjw/+6quv9ldVVT0r01ezuPRJSUn5Y9euXXVd11WzDaqq6kePHm3+7LPPRgO4KlNuxWazhXo8nuTk5OSXMjIyEl0uFxoaGtqKior+dPXq1VdUVT0jj7r68ieoT58+vx8yZMjdx48fP1JVVTVF9m20VW02WyfZf97YsWPjXS4X6urqWvPy8jYCWCyEuEDS8FdVFKWzruv//OSTTy5OTk7uqWkaPv3007qysrJ8RVH+LI8ym8/rB3Tu3HnRI488knLo0KG2ffv2ZQI4C98vP6mqqoZqmpaclpa2cOTIkX39/f3R0NDQUVxc/G5TU9PLqqrWa5rWLH1QVFUN0TStX1JSUvH48eP7BwYG4uDBg1cKCgpeBbBe2u+2Qug2EwD5N5sMPuNtMe8XP4TT6Qxoa2sbIGeXvUKIK7d4IISiKC5d1wPljOfA9bPwzYqiXNV13dd6Uqiq6qdpml2mpe02m63d4/G4vcTF5fF47LJf71nJA6BZVVW3pmntuPHlmAD5wk6Q9NnbHp9vHaqq6tA0zU/64PZhk1FfCZB9G/23ALiqKEqzD39tpvbGUqoFwFUhRLP3yzpCCDtJpxyXDulfG27+pqRR3DXsUWVd4Yq0x/taVQjhIhksC8L+ABpM9ljBf5sKwI8pIBr75L5E4vvu+UNeG/a+hv+AL7yFH8qPtOfHjtOP6V/Bja8D6z/B2Nys/1u9Xv33tLf4GfF/LC4GCJwByWIAAAAASUVORK5CYII\x3d";cc._loaderImage="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAlAAD/4QMpaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjM4MDBEMDY2QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjM4MDBEMDY1QTU1MjExRTFBQTAzQjEzMUNFNzMxRkQwIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU2RTk0OEM4OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU2RTk0OEM5OERCNDExRTE5NEUyRkE3M0M3QkE1NTlEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQADQkJCQoJDQoKDRMMCwwTFhENDREWGhUVFhUVGhkUFhUVFhQZGR0fIB8dGScnKionJzk4ODg5QEBAQEBAQEBAQAEODAwOEA4RDw8RFA4RDhQVERISERUfFRUXFRUfKB0ZGRkZHSgjJiAgICYjLCwoKCwsNzc1NzdAQEBAQEBAQEBA/8AAEQgAyACgAwEiAAIRAQMRAf/EALAAAAEFAQEAAAAAAAAAAAAAAAQAAgMFBgcBAQEAAwEBAAAAAAAAAAAAAAAAAQMEAgUQAAIBAgIEBwoLBgQGAwAAAAECAwAEEQUhMRIGQVFxsTITFGGBwdEiQlKSMzWRoeFicqKyI1NzFYJjJDQWB9KjVCbxwkNkJWXik3QRAAIBAgMFBQcDBQEAAAAAAAABAhEDIRIEMUFRcTJhwVIUBZGhsSJyEzOB0ULhYpIjUxX/2gAMAwEAAhEDEQA/AMJSpUqAVKlXuFAeUq9wpUB5XuFe4V6ooDzZHDox0CnGMinzwl7Z8NajaHeoO3vmTBZBtp9YUIqTEV5ROxHKnWRnaU8VRMhFBUjpV7hSoSeUq9pUB5Sr2lhQHlKvcK8oBV7hSFSRrtaKAZs07YNPM1pG2xJIAw1jSeandry/8X4m8VCKkWwaWwam7Xl/4v1W8VLtmX/i/VbxUoKkWwakSM407tmX/i/VbxUmzGwjQsjdY41IARie/U0IbZO0kNtCXnOCkEBeFu4KI3Bs7DNb27ya+jDx3kJeEnpJJEcQVbWDsk17u5urd591ucZkWhym2Vnd9RkCDEpFxDRpbw0bunu5mlp2De2FMLYXOD2wB2xbOeraUcYGJ72mlSUiqzzdzMd3Z3mixltA2yzcK/NlHM1DQyRXce1HocdNOEfJXZ88y9ZojOqhiBszIRiHQ8Y4cK5TvHuzLljHNMqxNoDjLFraHHnjPxcNCGVbxEUzYNTx5jZSxhpW6qTzlwJ+DCvO2Zf+L9VvFSgqyHYNLYNTdssPxfibxUu15f8Ai/VPiqCakOwa82DU/a8v/F+JvFTDdWPBL8R8VKCvYRYV5UzoMAy6QdIIqI0B4KJtxiRQwou16QoGUkntH5Tz0RbZbmF2hktraSVBo2lUkY8tDye0flPPXTslVUyiyVRsjqUOA4yMT8dW2ram2m6UVTNq9S7EIyUVJydMTn/6DnP+im9Wl+g5z/opvVrpteEhQWY4AaSTwAVf5WPiZh/9S5/zj7zltzlmYWkfWXNvJDGTgGcYDHirR7i7mSbwXParsFMrgb7w6jKw/wCmnc9I14kF3vpvCljbMyWMOJL4aEiB8qU/ObUK7HYWVrl1pFZWiCOCBQqKOLjPGTrNZZqKbUXVHq2nNwTuJRk1VpbgXN8s7Rk5ym0UQQzhIG2NAjhxHWbI+gCBVjBBFbwxwQqEiiUJGg1BVGAFe7dV28WYLYZFmF2Th1UD7JGjymGyn1iK5OyzIBGB1HgrLZhamzumQAGJwSqnSCh1q3GOCodxt4cxurdcpzuN4cyhiWaF5Bg09udUmnWw1H/jV9nFuJ7Quo+8h8peThFA+047vduyMtk7fYqTl07YFdfUufMPzT5p71UdtlmYXaGS2t3mQHAsgxANdadYJopLe4QS2867EsZ4QfCNYrCFbjdDPmgkYyWFxgVf04ifJf6ScNdRUW1XBb6FU5TjF5EpSSrGu/s5lN+g5z/opvVpfoOc/wCim9WtdHnatvObJXDW7xLGhB8nrPaY9/HCr+tEdPCVaSeDoYLnqF63lzW4/PFSW3ecxbI84VSzWUwUaSdg0DXXK5nvAipnd6qgKvWnQO7pri9ZUEmm3Vl2j1kr8pRlFRyquBNZjGxQ/S56Y1S2fu9OVueon11Szahoou06QoQUXadIVCD2FJJ7R+U89dMydv8Axdn+TH9muZye0flPPXQstlK5Tbka1gUjlC1q0vVLkeb6r+O3Tx9xcY1nt8c0NrZCyiOE1108NYjGv1joo7Js1jzKyScYLIvkzL6LDwHXVJksH9Sb49dKNq0tj1jA6uriOCL+02FWX7iVtZX1/AzaHTyeoauKn2MX9W79zebiZCuR5MjSrhfXuEtwTrUeZH+yNfdrRNcxI6IzhXlJEak6WIGJ2Rw4ChWnChndtlVBLMdQA0k1gbXNMzzDfDLs6mjaPKppJbWwJ1bOwwxw43OnHh71YT3DpfWUJmFlb5jHHDdeXBHIsrRea5TSqvxqG04cNN62vetoCS4tre5mgnkGE9q+3DKOkuI2WX6LDQRRHWDh1UCtwj7QRg2wdl8Djgw1qe7XvW0BQ3kfZ7mSLgU+T9E6RVbnuVrnWVSWqj+Lt8ZbRuHEdKPkYVcZ2MJY5fSGyeVar45+rkWQHAqccalPE5km1htWK5nK4Wnt5FuUBUwOMG4nGkA/BXUrW4S6torlOjMgcd/xVn7rLo7zKs0uEjCNeSvdwoBhgsZxX1l2j36k3Lu+uyprdj5Vs5A+i/lD48a0aaVJOPi7jB6lbzWozpjB48pf1NDXNN4vfl7+Z4BXS65pvF78vfzPAK71XTHmZ/S/yT+jvJ7L3fHytz1E+upbL+Qj5W56jfXWRnsIYKLtekKEFGWvSFQgyjk9o/Keet3YthlMP/5x9msJJ7R+U89biyb/AMXEv7gD6tadL1T+kwepRrC39ZkLDMbiwMvUHRPG0bjlGg8ore/23sxBldxfMPLupNhT8yL/AORNZbdzJ484scytxgLqJY5LZj6Q2sV5G1Vud1mjjyG0ij0NEGSZToKyhjtqw4waztuiXA3qKTbSxltfGhbZlE95ZtZqxVbgiOZhrER9ph3Svk9+pJILZ4Y4DGBFCUMKjRsGPobPFhUfW0NJmljE2xJcIrcI2vFUEln1lRXd6lrazXT9GCNpD+yNqoI7mOVduNw6nzlOIoPOUa6yye1XXcbMR5GdQ3xY0BSbj31/FcTQZirJ+q431q7anbHCTZ72Bw7lbPrKBMcBWNNgbMBBh+bsjBdni0VJ1lARZs6yWiupxCuMDy6KpS2IwOo6DTr3Mre3e5tZZVUM4ZBjqOOJoWO4jkXajcOOMHGgDISvWIrdAkKR80+TzVl908bPPL3LzxOuHdifxVfiTAg92qI/w+/8gGgSyN/mR7XPVlp0lF/3L3mbVKtu5Hjbk/8AHE2Fc03i9+Xv5ngFdKNc13i9+Xv5ngFaNV0x5nn+l/kn9HeEWXu+PlbnqJ9dS2Xu9OVueon11kZ7CGCjLXpCgxRlr0hUIPYUcntH5Tz1s8vb+Bt1/dqPirGSe0flPPWusG/g4Py15q06XqlyMWvVYQ+ruI9xJOqzO9hOto/sP8tbGOFIrmWeM7IuMDMnAXXQJOUjQeOsJk0nY96ip0CYunrjaHx1t+srPJUbXBm2LrFPikwTOb+T+VhbZxGMrDXp83x1QSy2tucJpUjPETp+Cn5/ftaRvKvtp3Kx48HG3erHMzOxZiWZtLMdJNQSbbL71Vk6yynViOkqnEEfOWtPbXi3EQkGg6mXiNckjeSJxJGxR10qw0GtxuxmvbImD4CZMFlA4fRfv0BqesqqzTMZNMEDbIHtHH2QeCiZJSqMQdOGiue53mz3czQwsRbIcNHnkec3c4qAMuriz68gTIToxwOOnlp0MjxMJYW741Gs3RVldtbygE/dMcHX/moDaxTiWNZB53B3arb8/wC+4SOF4sf/AKxU9kcBsfOGHfoUHtG/RbzY5Die5HHhXdvavqiZ9Q8Jdlq4/gbKua7xe/L38zwCuhpf2Uk/Zo50kmwJKIdogDjw1VzzeL35e/meAVp1LTgqY4nn+mRauzqmqwrjzCLL3fHytz1E+upLL+Qj5W56jfXWRnroYKLtekKEFF2vSFQg9hSSe0flPPWosm/hIfoLzVl5PaPynnrRWb/w0X0F5q06XqlyM2sVYx5gmbFre/t71NY2T+0h8VbSO5SWNJUOKSAMp7jDGspmMPaLRlXS6eWve1/FRO7WYdbZm1Y/eW/R7qHxHRXGojlm3ulid6aVbaW+OALvgCLq2Hm9WxHKWqjhj6xsK1e8dm15l4niG1LZkswGsxtrPeOmsvayBJA1VItlWjptLuTdPMo7LtjRDq9naK4+WF9IrUW7BaHOljGqVHB7w2hzVoZt87d8vaNYSLl02CcRsDEbJbj71Uu7UBkvJ7/D7q2QoDxySaAO8MTXdxRVMpRp5XZOWdF/ms7R5XdyKfKWJsO/5PhrG5XlNxmEywW6bTnTxAAcJNbGSMXkM1pjgbiNo1PziPJ+Os7u7m/6ReM00ZOgxSpqYYHT3wRXMKN4ll9zUG4bQfNshu8sZVuEA2hirA4qe/VOwwrVbzbww5mI44UKRRYkbWG0S3JWctbd7u5WFfOOLHiUdJqmaipfLsIsObhWe001lMkMVvJNjhghIALMcBxCs7fxXQmkupx1bXDswGPlaTidVaEyKNXkoo4eBV+Sq7L7Vs9zcBgeyQ4GQ/MB1crmoim2orezqcowTuSeEY48jQ7oZX2PLzdyLhNd6RjrEY6I7+uspvH78vfzPAK6UAAAFGAGgAcArmu8Xvy9/M8ArTfio24RW5nnaG67uou3H/KPuqT2X8hHytz1G+upLL3enK3PUb66ys9RDBRdr0hQgou06QqEGUkntH5Tz1e238vF9BeaqKT2j8p56vbb+Xi+gvNWjTdUuRn1XTHmTh8KrJTJlt8t1CPIY44cGnpJVjTJYkmjaN9Ib4u7V923njTethRauZJV3PaW1rfLIiXEDYg6R4VYc9CXW7thfOZbKdbGZtLW8uPVY/u3GrkNUkM9zlcxUjbhfWOA90cRq4gv4LhdqN+VToNYWmnRm9NNVWNTyHc6VWBv8wt4YeHqm6xyPmroq1Z7WGFLSxTq7WLSuPSdjrkfumq5yHXDUeA92oO2SKpVumNAaoJLMXH3myp0rpJ4uKhc3tbDM5BMri1zAj79j7KTiY8TcdBpcsith0286o+sPCagEX9Pzg4zXUCp6QYse8oouCG3tk6m1BYv05W6T+IdyolxbHDAAa2OgDlNCz3ryN2WxBd5PJMg1t81eId2ukqnLlTBbfcuY+9uJLiRcvtPvHdsHK+cfRHcHDWsyawjyy0WBcDI3lTP6TeIcFV+S5OmXx9bJg1048o8Cj0V8Jq2DVu09nL80up7OxHi+oal3P8AXB/IsZS8T/YOV65zvCcc7vfzPAK3ivWCz445zeH954BXOr6I8yfSfyz+jvCLP3fHytz1G+upLP3fHytz1E+usbPaQ0UXadIUIKLtekKhB7Ckk9o/Keer22/l4/oLzVRSe0flPPV7b/y8X0F5q0abqlyM+q6Y8yQsBTDMor1o8aiaE1pbluMqS3sbLLHIhSRQyngqukhaJ9uBjo+H5aOa3ao2t34qouRlLajTalGP8v0IY8ylXQ+PKPFU/bYXOLPge6CKia0LaxTOxHu1Q7cuBd9yPEJ7TbjXKO8CajbMIF6CNIeNvJHjqIWJ7tSpYkalqVblwIdyG+RGXur0hXYJFxal+Dhq5y3slkv3Y2pD0pTr+QUClpJRUdo9XW4OLrTHtM16cZLLWkeC7y4jvlNEpcRtw1Ux27Ci448NZrTFy3nn3IQWxlgGrDZ3pza7/M8ArZo+ArF5171uvp+CqdV0R5l/psUrs2vB3hdl7vTlbnqJ9dS2Xu+PlbnqJ9dY2eshooq16QoQUXa9IVCD2FLJ7RuU89WNtmUSQqkgYMgw0accKrpPaPynnrZWG4Vi+VWmY5tnMWXG+XrIYnA0rhj0mdcTgdNdwnKDqjmduM1SRR/qlr8/4KX6pa8T/BVzDuLZXudRZblmbxXcPUNPc3KqCIwrbOzgrHEnHjoyD+3eSXkht7DeKG4umDGOJVUklfouThXfmbnZ7Cvy1vt9pmv1W1+d8FL9VteJvgq5yrcOGfLmzHN80iyyETPbptAEFo2ZG8pmUa1OFNn3Ky6W/sbDKM5hv5bx2WTZA+7RF2y52WOPJTzE+z2Dy1vt9pT/AKpacTerS/U7Tib1a04/t7kDXPY03jhN0W6sQ7K7W3q2dnrMccaDy/8At80kuZfqWYxWNtlcvUPPhiGYhWDeUy7IwYU8xPs9g8tb7faUn6pacTerTxm9oOBvVq3v9z927aynuId44LiWKNnjhAXF2UYhRg516qpsryjLr21665zFLSTaK9U2GOA87SwqY37knRU+BzOzags0s1Oyr+BKM6sxwP6tSDPLMen6vy0rvdm3Sxlu7K/S7WDDrFUDUTxgnTU826eXW7KlxmqQuwDBXUKcD+1Xee/wXuKX5XDGWLapSVcOyhEM/seJ/V+WnjeGx4pPV+Wkm6kKZlFay3Jlt7iFpYZY8ASVK6DjtDDA0f8A0Tl340/1f8Ndx8xJVWXB0KbktFFpNzdVXAC/qOwA0CQni2flrO3Vwbm5lnI2TKxbDirX/wBE5d+NcfV/wVR7xZPa5U9utvI8nWhmbbw0YEAYYAVxfhfy5rlKR4Fulu6X7mW1mzT8S4Yis/5CPlbnqJ9dSWfu9OVueon11mZvQ2i7XpChKKtekKhBlNJ7R+U89bDfGTb3a3ZX0Lcj6kdY+T2j8p560288m1kWQr6MJ+ylSAr+2cnV5renjs3H1loX+3j9XvbbtxLN9lqW4UnV5jdnjtXHxihtyZNjeSBu5J9k1BJe7xy7W5CJ/wCzuD/mTVTf2+fq97LJuLrPsNRueS7W6aJ/38x+vLVXuY+xvHaNxbf2GoCezf8A36j/APsSf8w1sLnqczTefJluYoLm5uo5F61sBshItP1cNFYe1f8A3ir/APfE/wCZUe9bB94r5jwuPsrQFhmG4l/Z2M17HdW90tuu3IkTHaCjWdIw0VVZdks9/C06yJFEp2dp+E1bbqybGTZ8vpQD7L1XRv8A7blT96Oda7tpNuuNE37Cq9KSisjyuUoxrStKllHbLlWTXsMs8chuSuwEPDqwoLe5y+YRE/gLzmqRekvKKtd4327yM/ulHxmrHJStySWVRyrjxKI2XC/CTlnlPPKTpTdFbP0L1bgrf5Lp0G3dPhQHwV0S1lzBsns3sESR8Crh9WAJGjSOKuU3E+zdZQ3oJh8IArdZXFDmOTpHa3i2+YrI2KtKy4ricBsBuHHgFXSo440+Wa2qqxjvM9uMoy+WvzWpLCWWWE28HxL6e43ojgkeSCBY1Ri5BGIUDT51cl3vm276BBqSEH4WbxV0tlkyXJcxTMb+OW6uY9mGHrCzDQwwAbTp2uKuTZ9N1uYsfRRR8WPhrm419mSSjRyiqxVK7y23B/ftuTm2oSdJyzNVw3BFn7vTlbnqF9dS2fu9OVueon11lZuQ2iLdsGFD05H2dNQGV0ntG5Tz1dWm9N1b2kVq8EVwsI2UaQaQOKhmitZGLOmk68DhSFvY+gfWNSAg7z3Qvo7yKCKIohiaNR5LKxx8qpxvjcqS0VpbxvwOAcRQPZ7D0G9Y0uz2HoH1jUCpLY7zXlpbm3eKO5QuzjrBqZji3x17PvNcyT288VvDBJbMWUovS2hslW7mFQ9nsPQPrGl2ew9A+saCod/WNxtbYsrfb17WBxx5ddD2281xC88klvDcSXEnWuzrqOGGC9zRUPZ7D0G9Y0uzWHoH1jQVCLreq6ntZbaO3it1mGy7RjTs1X2mYy20ZiCq8ZOODcdEdmsPQb1jS7PYegfWNdJuLqnQiSUlRqpFLmryxtH1Ma7Qw2gNNPOdSt0oI27p007s9h6B9Y0uz2HoH1jXX3Z+I4+1b8IJdX89xLHKQFMXQUahpxoiPN5P+onfU+A0/s9h6DesaXZ7D0D6xpG7OLbUtu0StW5JJx2bBsmbtiSiEk+cxoCWWSaVpZOk2vDVo0VYdnsPQb1jSNvZcCH1jSd2c+p1XAmFqEOmOPEfaH+BQd1ueo211IzrgFUYKNAAqI1WztCpUqVCRUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoBUqVKgFSpUqAVKlSoD/9k\x3d";var cc=cc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),compileSuper:function(j,h,p){j=j.toString();var o=j.indexOf("("),n=j.indexOf(")"),o=j.substring(o+1,n),o=o.trim(),n=j.indexOf("{"),m=j.lastIndexOf("}");for(j=j.substring(n+1,m);-1!==j.indexOf("this._super");){var n=j.indexOf("this._super"),m=j.indexOf("(",n),k=j.indexOf(")",m),k=j.substring(m+1,k),k=(k=k.trim())?",":"";j=j.substring(0,n)+"ClassManager["+p+"]."+h+".call(this"+k+j.substring(m+1)}return Function(o,j)},getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};ClassManager.compileSuper.ClassManager=ClassManager;(function(){var d=/\b_super\b/,c=cc.game.config[cc.game.CONFIG_KEY.classReleaseMode];c&&console.log("release Mode");cc.Class=function(){};cc.Class.extend=function(D){function C(){this.__instanceId=ClassManager.getNewInstanceId();this.ctor&&this.ctor.apply(this,arguments)}var B=this.prototype,A=Object.create(B),z=ClassManager.getNewID();ClassManager[z]=B;var y={writable:!0,enumerable:!1,configurable:!0};A.__instanceId=null;C.id=z;y.value=z;Object.defineProperty(A,"__pid",y);C.prototype=A;y.value=C;Object.defineProperty(C.prototype,"constructor",y);this.__getters__&&(C.__getters__=cc.clone(this.__getters__));this.__setters__&&(C.__setters__=cc.clone(this.__setters__));for(var x=0,o=arguments.length;x<o;++x){var j=arguments[x],b;for(b in j){var I="function"===typeof j[b],a="function"===typeof B[b],G=d.test(j[b]);c&&I&&a&&G?(y.value=ClassManager.compileSuper(j[b],b,z),Object.defineProperty(A,b,y)):I&&a&&G?(y.value=function(f,e){return function(){var h=this._super;this._super=B[f];var g=e.apply(this,arguments);this._super=h;return g}}(b,j[b]),Object.defineProperty(A,b,y)):I?(y.value=j[b],Object.defineProperty(A,b,y)):A[b]=j[b];if(I){var H,F;if(this.__getters__&&this.__getters__[b]){var I=this.__getters__[b],E;for(E in this.__setters__){if(this.__setters__[E]===I){F=E;break}}cc.defineGetterSetter(A,I,j[b],j[F]?j[F]:A[F],b,F)}if(this.__setters__&&this.__setters__[b]){I=this.__setters__[b];for(E in this.__getters__){if(this.__getters__[E]===I){H=E;break}}cc.defineGetterSetter(A,I,j[H]?j[H]:A[H],j[b],H,b)}}}}C.extend=cc.Class.extend;C.implement=function(f){for(var e in f){A[e]=f[e]}};return C}})();cc.defineGetterSetter=function(A,z,y,x,w,v){if(A.__defineGetter__){y&&A.__defineGetter__(z,y),x&&A.__defineSetter__(z,x)}else{if(Object.defineProperty){var u={enumerable:!1,configurable:!0};y&&(u.get=y);x&&(u.set=x);Object.defineProperty(A,z,u)}else{throw Error("browser does not support getters")}}if(!w&&!v){for(var u=null!=y,t=void 0!=x,s=Object.getOwnPropertyNames(A),r=0;r<s.length;r++){var o=s[r];if((A.__lookupGetter__?!A.__lookupGetter__(o):!Object.getOwnPropertyDescriptor(A,o))&&"function"===typeof A[o]){var j=A[o];if(u&&j===y&&(w=o,!t||v)){break}if(t&&j===x&&(v=o,!u||w)){break}}}}A=A.constructor;w&&(A.__getters__||(A.__getters__={}),A.__getters__[w]=z);v&&(A.__setters__||(A.__setters__={}),A.__setters__[v]=z)};cc.clone=function(f){var e=f.constructor?new f.constructor:{},h;for(h in f){var g=f[h];e[h]="object"!==typeof g||!g||g instanceof cc.Node||g instanceof HTMLElement?g:cc.clone(g)}return e};cc.inject=function(e,d){for(var f in e){d[f]=e[f]}};cc=cc||{};cc._tmp=cc._tmp||{};cc.associateWithNative=function(d,c){};cc.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"\x3d":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1000,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005};cc.FMT_JPG=0;cc.FMT_PNG=1;cc.FMT_TIFF=2;cc.FMT_RAWDATA=3;cc.FMT_WEBP=4;cc.FMT_UNKNOWN=5;cc.getImageFormatByData=function(b){return 8<b.length&&137===b[0]&&80===b[1]&&78===b[2]&&71===b[3]&&13===b[4]&&10===b[5]&&26===b[6]&&10===b[7]?cc.FMT_PNG:2<b.length&&(73===b[0]&&73===b[1]||77===b[0]&&77===b[1]||255===b[0]&&216===b[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN};cc.inherits=function(e,d){function f(){}f.prototype=d.prototype;e.superClass_=d.prototype;e.prototype=new f;e.prototype.constructor=e};cc.base=function(j,h,p){var o=arguments.callee.caller;if(o.superClass_){return ret=o.superClass_.constructor.apply(j,Array.prototype.slice.call(arguments,1))}for(var n=Array.prototype.slice.call(arguments,2),m=!1,k=j.constructor;k;k=k.superClass_&&k.superClass_.constructor){if(k.prototype[h]===o){m=!0}else{if(m){return k.prototype[h].apply(j,n)}}}if(j[h]===o){return j.constructor.prototype[h].apply(j,n)}throw Error("cc.base called from a method of one name to a method of a different name")};cc.Point=function(d,c){this.x=d||0;this.y=c||0};cc.p=function(d,c){return void 0===d?{x:0,y:0}:void 0===c?{x:d.x,y:d.y}:{x:d,y:c}};cc.pointEqualToPoint=function(d,c){return d&&c&&d.x===c.x&&d.y===c.y};cc.Size=function(d,c){this.width=d||0;this.height=c||0};cc.size=function(d,c){return void 0===d?{width:0,height:0}:void 0===c?{width:d.width,height:d.height}:{width:d,height:c}};cc.sizeEqualToSize=function(d,c){return d&&c&&d.width===c.width&&d.height===c.height};cc.Rect=function(f,e,h,g){this.x=f||0;this.y=e||0;this.width=h||0;this.height=g||0};cc.rect=function(f,e,h,g){return void 0===f?{x:0,y:0,width:0,height:0}:void 0===e?{x:f.x,y:f.y,width:f.width,height:f.height}:{x:f,y:e,width:h,height:g}};cc.rectEqualToRect=function(d,c){return d&&c&&d.x===c.x&&d.y===c.y&&d.width===c.width&&d.height===c.height};cc._rectEqualToZero=function(b){return b&&0===b.x&&0===b.y&&0===b.width&&0===b.height};cc.rectContainsRect=function(d,c){return d&&c?!(d.x>=c.x||d.y>=c.y||d.x+d.width<=c.x+c.width||d.y+d.height<=c.y+c.height):!1};cc.rectGetMaxX=function(b){return b.x+b.width};cc.rectGetMidX=function(b){return b.x+b.width/2};cc.rectGetMinX=function(b){return b.x};cc.rectGetMaxY=function(b){return b.y+b.height};cc.rectGetMidY=function(b){return b.y+b.height/2};cc.rectGetMinY=function(b){return b.y};cc.rectContainsPoint=function(d,c){return c.x>=cc.rectGetMinX(d)&&c.x<=cc.rectGetMaxX(d)&&c.y>=cc.rectGetMinY(d)&&c.y<=cc.rectGetMaxY(d)};cc.rectIntersectsRect=function(g,f){var k=g.y+g.height,j=f.x+f.width,h=f.y+f.height;return !(g.x+g.width<f.x||j<g.x||k<f.y||h<g.y)};cc.rectOverlapsRect=function(d,c){return !(d.x+d.width<c.x||c.x+c.width<d.x||d.y+d.height<c.y||c.y+c.height<d.y)};cc.rectUnion=function(e,d){var f=cc.rect(0,0,0,0);f.x=Math.min(e.x,d.x);f.y=Math.min(e.y,d.y);f.width=Math.max(e.x+e.width,d.x+d.width)-f.x;f.height=Math.max(e.y+e.height,d.y+d.height)-f.y;return f};cc.rectIntersection=function(e,d){var f=cc.rect(Math.max(cc.rectGetMinX(e),cc.rectGetMinX(d)),Math.max(cc.rectGetMinY(e),cc.rectGetMinY(d)),0,0);f.width=Math.min(cc.rectGetMaxX(e),cc.rectGetMaxX(d))-cc.rectGetMinX(f);f.height=Math.min(cc.rectGetMaxY(e),cc.rectGetMaxY(d))-cc.rectGetMinY(f);return f};cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(b){return this._parseXML(b)},_parseXML:function(d){var c;this._isSupportDOMParser?c=this._parser.parseFromString(d,"text/xml"):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(d));return c}});cc.PlistParser=cc.SAXParser.extend({parse:function(f){f=this._parseXML(f).documentElement;if("plist"!==f.tagName){throw"Not a plist file!"}for(var e=null,h=0,g=f.childNodes.length;h<g&&(e=f.childNodes[h],1!==e.nodeType);h++){}return this._parseNode(e)},_parseNode:function(e){var d=null,f=e.tagName;if("dict"===f){d=this._parseDict(e)}else{if("array"===f){d=this._parseArray(e)}else{if("string"===f){if(1===e.childNodes.length){d=e.firstChild.nodeValue}else{for(d="",f=0;f<e.childNodes.length;f++){d+=e.childNodes[f].nodeValue}}}else{"false"===f?d=!1:"true"===f?d=!0:"real"===f?d=parseFloat(e.firstChild.nodeValue):"integer"===f&&(d=parseInt(e.firstChild.nodeValue,10))}}}return d},_parseArray:function(g){for(var f=[],k=0,j=g.childNodes.length;k<j;k++){var h=g.childNodes[k];1===h.nodeType&&f.push(this._parseNode(h))}return f},_parseDict:function(h){for(var g={},n=null,m=0,k=h.childNodes.length;m<k;m++){var j=h.childNodes[m];1===j.nodeType&&("key"===j.tagName?n=j.firstChild.nodeValue:g[n]=this._parseNode(j))}return g}});cc._txtLoader={load:function(f,e,h,g){cc.loader.loadTxt(f,g)}};cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader);cc._jsonLoader={load:function(f,e,h,g){cc.loader.loadJson(f,g)}};cc.loader.register(["json","ExportJson"],cc._jsonLoader);cc._jsLoader={load:function(f,e,h,g){cc.loader.loadJs(f,g)}};cc.loader.register(["js"],cc._jsLoader);cc._imgLoader={load:function(f,e,h,g){cc.loader.cache[e]=cc.loader.loadImg(f,function(b,d){if(b){return g(b)}cc.textureCache.handleLoadedTexture(e);g(null,d)})}};cc.loader.register("png jpg bmp jpeg gif ico".split(" "),cc._imgLoader);cc._serverImgLoader={load:function(f,e,h,g){cc.loader.cache[e]=cc.loader.loadImg(h.src,function(b,d){if(b){return g(b)}cc.textureCache.handleLoadedTexture(e);g(null,d)})}};cc.loader.register(["serverImg"],cc._serverImgLoader);cc._plistLoader={load:function(f,e,h,g){cc.loader.loadTxt(f,function(d,c){if(d){return g(d)}g(null,cc.plistParser.parse(c))})}};cc.loader.register(["plist"],cc._plistLoader);cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(w,v,u){var t=document,s=cc.path,r=this.TYPE,p=cc.newElement("style");p.type="text/css";t.body.appendChild(p);var o="@font-face { font-family:"+w+"; src:";if(v instanceof Array){for(var n=0,j=v.length;n<j;n++){u=s.extname(v[n]).toLowerCase(),o+="url('"+v[n]+"') format('"+r[u]+"')",o+=n===j-1?";":","}}else{o+="url('"+v+"') format('"+r[u]+"');"}p.textContent+=o+"};";v=cc.newElement("div");u=v.style;u.fontFamily=w;v.innerHTML=".";u.position="absolute";u.left="-100px";u.top="-100px";t.body.appendChild(v)},load:function(f,e,h,g){e=h.type;f=h.name;e=h.srcs;cc.isString(h)?(e=cc.path.extname(h),f=cc.path.basename(h,e),this._loadFont(f,h,e)):this._loadFont(f,e);g(null,!0)}};cc.loader.register(["font","eot","ttf","woff","svg"],cc._fontLoader);cc._binaryLoader={load:function(f,e,h,g){cc.loader.loadBinary(f,g)}};cc._csbLoader={load:function(f,e,h,g){cc.loader.loadCsb(f,g)}};cc.loader.register(["csb"],cc._csbLoader);window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.6";cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0;cc.DIRECTOR_STATS_POSITION=cc.p(0,0);cc.DIRECTOR_FPS_INTERVAL=0.5;cc.COCOSNODE_RENDER_SUBPIXEL=1;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=1;cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=0;cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0;cc.TEXTURE_ATLAS_USE_VAO=0;cc.TEXTURE_NPOT_SUPPORT=0;cc.RETINA_DISPLAY_SUPPORT=1;cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd";cc.USE_LA88_LABELS=1;cc.SPRITE_DEBUG_DRAW=0;cc.SPRITEBATCHNODE_DEBUG_DRAW=0;cc.LABELBMFONT_DEBUG_DRAW=0;cc.LABELATLAS_DEBUG_DRAW=0;cc.IS_RETINA_DISPLAY_SUPPORTED=1;cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas";cc.ENABLE_STACKABLE_ACTIONS=1;cc.ENABLE_GL_STATE_CACHE=1;cc.$=function(d){var c=this===cc?document:this;if(d=d instanceof HTMLElement?d:c.querySelector(d)){d.find=d.find||cc.$,d.hasClass=d.hasClass||function(b){return this.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))},d.addClass=d.addClass||function(b){this.hasClass(b)||(this.className&&(this.className+=" "),this.className+=b);return this},d.removeClass=d.removeClass||function(b){this.hasClass(b)&&(this.className=this.className.replace(b,""));return this},d.remove=d.remove||function(){this.parentNode&&this.parentNode.removeChild(this);return this},d.appendTo=d.appendTo||function(b){b.appendChild(this);return this},d.prependTo=d.prependTo||function(b){b.childNodes[0]?b.insertBefore(this,b.childNodes[0]):b.appendChild(this);return this},d.transforms=d.transforms||function(){this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew);return this},d.position=d.position||{x:0,y:0},d.rotation=d.rotation||0,d.scale=d.scale||{x:1,y:1},d.skew=d.skew||{x:0,y:0},d.translates=function(f,e){this.position.x=f;this.position.y=e;this.transforms();return this},d.rotate=function(b){this.rotation=b;this.transforms();return this},d.resize=function(f,e){this.scale.x=f;this.scale.y=e;this.transforms();return this},d.setSkew=function(f,e){this.skew.x=f;this.skew.y=e;this.transforms();return this}}return d};switch(cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx="O";cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms";cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}cc.$.trans=cc.$.pfx+"Transform";cc.$.translate=cc.$.hd?function(b){return"translate3d("+b.x+"px, "+b.y+"px, 0) "}:function(b){return"translate("+b.x+"px, "+b.y+"px) "};cc.$.rotate=cc.$.hd?function(b){return"rotateZ("+b+"deg) "}:function(b){return"rotate("+b+"deg) "};cc.$.scale=function(b){return"scale("+b.x+", "+b.y+") "};cc.$.skew=function(b){return"skewX("+-b.x+"deg) skewY("+b.y+"deg)"};cc.$new=function(b){return cc.$(document.createElement(b))};cc.$.findpos=function(e){var d=0,f=0;do{d+=e.offsetLeft,f+=e.offsetTop}while(e=e.offsetParent);return{x:d,y:f}};cc.INVALID_INDEX=-1;cc.PI=Math.PI;cc.FLT_MAX=parseFloat("3.402823466e+38F");cc.FLT_MIN=parseFloat("1.175494351e-38F");cc.RAD=cc.PI/180;cc.DEG=180/cc.PI;cc.UINT_MAX=4294967295;cc.swap=function(f,e,h){if(!cc.isObject(h)||cc.isUndefined(h.x)||cc.isUndefined(h.y)){cc.log(cc._LogInfos.swap)}else{var g=h[f];h[f]=h[e];h[e]=g}};cc.lerp=function(e,d,f){return e+(d-e)*f};cc.rand=function(){return 16777215*Math.random()};cc.randomMinus1To1=function(){return 2*(Math.random()-0.5)};cc.random0To1=Math.random;cc.degreesToRadians=function(b){return b*cc.RAD};cc.radiansToDegrees=function(b){return b*cc.DEG};cc.radiansToDegress=function(b){cc.log(cc._LogInfos.radiansToDegress);return b*cc.DEG};cc.REPEAT_FOREVER=Number.MAX_VALUE-1;cc.BLEND_SRC=cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?1:770;cc.BLEND_DST=771;cc.nodeDrawSetup=function(b){b._shaderProgram&&(b._shaderProgram.use(),b._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())};cc.enableDefaultGLStates=function(){};cc.disableDefaultGLStates=function(){};cc.incrementGLDraws=function(b){cc.g_NumberOfDraws+=b};cc.FLT_EPSILON=1.192092896e-7;cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor()}:function(){return 1};cc.pointPointsToPixels=function(d){var c=cc.contentScaleFactor();return cc.p(d.x*c,d.y*c)};cc.pointPixelsToPoints=function(d){var c=cc.contentScaleFactor();return cc.p(d.x/c,d.y/c)};cc._pointPixelsToPointsOut=function(e,d){var f=cc.contentScaleFactor();d.x=e.x/f;d.y=e.y/f};cc.sizePointsToPixels=function(d){var c=cc.contentScaleFactor();return cc.size(d.width*c,d.height*c)};cc.sizePixelsToPoints=function(d){var c=cc.contentScaleFactor();return cc.size(d.width/c,d.height/c)};cc._sizePixelsToPointsOut=function(e,d){var f=cc.contentScaleFactor();d.width=e.width/f;d.height=e.height/f};cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(d){var c=cc.contentScaleFactor();return cc.rect(d.x/c,d.y/c,d.width/c,d.height/c)}:function(b){return b};cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(d){var c=cc.contentScaleFactor();return cc.rect(d.x*c,d.y*c,d.width*c,d.height*c)}:function(b){return b};cc.ONE=1;cc.ZERO=0;cc.SRC_ALPHA=770;cc.SRC_ALPHA_SATURATE=776;cc.SRC_COLOR=768;cc.DST_ALPHA=772;cc.DST_COLOR=774;cc.ONE_MINUS_SRC_ALPHA=771;cc.ONE_MINUS_SRC_COLOR=769;cc.ONE_MINUS_DST_ALPHA=773;cc.ONE_MINUS_DST_COLOR=775;cc.ONE_MINUS_CONSTANT_ALPHA=32772;cc.ONE_MINUS_CONSTANT_COLOR=32770;cc.LINEAR=9729;cc.REPEAT=10497;cc.CLAMP_TO_EDGE=33071;cc.MIRRORED_REPEAT=33648;cc.checkGLErrorDebug=function(){if(cc.renderMode===cc._RENDER_TYPE_WEBGL){var b=cc._renderContext.getError();b&&cc.log(cc._LogInfos.checkGLErrorDebug,b)}};cc.DEVICE_ORIENTATION_PORTRAIT=0;cc.DEVICE_ORIENTATION_LANDSCAPE_LEFT=1;cc.DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2;cc.DEVICE_ORIENTATION_LANDSCAPE_RIGHT=3;cc.DEVICE_MAX_ORIENTATIONS=2;cc.VERTEX_ATTRIB_FLAG_NONE=0;cc.VERTEX_ATTRIB_FLAG_POSITION=1;cc.VERTEX_ATTRIB_FLAG_COLOR=2;cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4;cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS;cc.GL_ALL=0;cc.VERTEX_ATTRIB_POSITION=0;cc.VERTEX_ATTRIB_COLOR=1;cc.VERTEX_ATTRIB_TEX_COORDS=2;cc.VERTEX_ATTRIB_MAX=3;cc.UNIFORM_PMATRIX=0;cc.UNIFORM_MVMATRIX=1;cc.UNIFORM_MVPMATRIX=2;cc.UNIFORM_TIME=3;cc.UNIFORM_SINTIME=4;cc.UNIFORM_COSTIME=5;cc.UNIFORM_RANDOM01=6;cc.UNIFORM_SAMPLER=7;cc.UNIFORM_MAX=8;cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor";cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest";cc.SHADER_POSITION_COLOR="ShaderPositionColor";cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture";cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor";cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color";cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor";cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor";cc.UNIFORM_PMATRIX_S="CC_PMatrix";cc.UNIFORM_MVMATRIX_S="CC_MVMatrix";cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix";cc.UNIFORM_TIME_S="CC_Time";cc.UNIFORM_SINTIME_S="CC_SinTime";cc.UNIFORM_COSTIME_S="CC_CosTime";cc.UNIFORM_RANDOM01_S="CC_Random01";cc.UNIFORM_SAMPLER_S="CC_Texture0";cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value";cc.ATTRIBUTE_NAME_COLOR="a_color";cc.ATTRIBUTE_NAME_POSITION="a_position";cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord";cc.ITEM_SIZE=32;cc.CURRENT_ITEM=3233828865;cc.ZOOM_ACTION_TAG=3233828866;cc.NORMAL_TAG=8801;cc.SELECTED_TAG=8802;cc.DISABLE_TAG=8803;cc.arrayVerifyType=function(e,d){if(e&&0<e.length){for(var f=0;f<e.length;f++){if(!(e[f] instanceof d)){return cc.log("element type is wrong!"),!1}}}return !0};cc.arrayRemoveObject=function(f,e){for(var h=0,g=f.length;h<g;h++){if(f[h]===e){f.splice(h,1);break}}};cc.arrayRemoveArray=function(f,e){for(var h=0,g=e.length;h<g;h++){cc.arrayRemoveObject(f,e[h])}};cc.arrayAppendObjectsToIndex=function(e,d,f){e.splice.apply(e,[f,0].concat(d));return e};cc.copyArray=function(f){var e,h=f.length,g=Array(h);for(e=0;e<h;e+=1){g[e]=f[e]}return g};cc=cc||{};cc._tmp=cc._tmp||{};cc._tmp.WebGLColor=function(){cc.color=function(h,o,n,m,k,j){return void 0===h?new cc.Color(0,0,0,255,k,j):cc.isString(h)?(h=cc.hexToColor(h),new cc.Color(h.r,h.g,h.b,h.a)):cc.isObject(h)?new cc.Color(h.r,h.g,h.b,h.a,h.arrayBuffer,h.offset):new cc.Color(h,o,n,m,k,j)};cc.Color=function(j,r,p,o,n,m){this._arrayBuffer=n||new ArrayBuffer(cc.Color.BYTES_PER_ELEMENT);this._offset=m||0;n=this._arrayBuffer;m=this._offset;var k=Uint8Array.BYTES_PER_ELEMENT;this._rU8=new Uint8Array(n,m,1);this._gU8=new Uint8Array(n,m+k,1);this._bU8=new Uint8Array(n,m+2*k,1);this._aU8=new Uint8Array(n,m+3*k,1);this._rU8[0]=j||0;this._gU8[0]=r||0;this._bU8[0]=p||0;this._aU8[0]=null==o?255:o;void 0===o&&(this.a_undefined=!0)};cc.Color.BYTES_PER_ELEMENT=4;var b=cc.Color.prototype;b._getR=function(){return this._rU8[0]};b._setR=function(c){this._rU8[0]=0>c?0:c};b._getG=function(){return this._gU8[0]};b._setG=function(c){this._gU8[0]=0>c?0:c};b._getB=function(){return this._bU8[0]};b._setB=function(c){this._bU8[0]=0>c?0:c};b._getA=function(){return this._aU8[0]};b._setA=function(c){this._aU8[0]=0>c?0:c};cc.defineGetterSetter(b,"r",b._getR,b._setR);cc.defineGetterSetter(b,"g",b._getG,b._setG);cc.defineGetterSetter(b,"b",b._getB,b._setB);cc.defineGetterSetter(b,"a",b._getA,b._setA);cc.Vertex2F=function(f,j,h,g){this._arrayBuffer=h||new ArrayBuffer(cc.Vertex2F.BYTES_PER_ELEMENT);this._offset=g||0;this._xF32=new Float32Array(this._arrayBuffer,this._offset,1);this._yF32=new Float32Array(this._arrayBuffer,this._offset+4,1);this._xF32[0]=f||0;this._yF32[0]=j||0};cc.Vertex2F.BYTES_PER_ELEMENT=8;b=cc.Vertex2F.prototype;b._getX=function(){return this._xF32[0]};b._setX=function(c){this._xF32[0]=c};b._getY=function(){return this._yF32[0]};b._setY=function(c){this._yF32[0]=c};cc.defineGetterSetter(b,"x",b._getX,b._setX);cc.defineGetterSetter(b,"y",b._getY,b._setY);cc.Vertex3F=function(g,m,k,j,h){this._arrayBuffer=j||new ArrayBuffer(cc.Vertex3F.BYTES_PER_ELEMENT);this._offset=h||0;j=this._arrayBuffer;h=this._offset;this._xF32=new Float32Array(j,h,1);this._xF32[0]=g||0;this._yF32=new Float32Array(j,h+Float32Array.BYTES_PER_ELEMENT,1);this._yF32[0]=m||0;this._zF32=new Float32Array(j,h+2*Float32Array.BYTES_PER_ELEMENT,1);this._zF32[0]=k||0};cc.Vertex3F.BYTES_PER_ELEMENT=12;b=cc.Vertex3F.prototype;b._getX=function(){return this._xF32[0]};b._setX=function(c){this._xF32[0]=c};b._getY=function(){return this._yF32[0]};b._setY=function(c){this._yF32[0]=c};b._getZ=function(){return this._zF32[0]};b._setZ=function(c){this._zF32[0]=c};cc.defineGetterSetter(b,"x",b._getX,b._setX);cc.defineGetterSetter(b,"y",b._getY,b._setY);cc.defineGetterSetter(b,"z",b._getZ,b._setZ);cc.Tex2F=function(f,j,h,g){this._arrayBuffer=h||new ArrayBuffer(cc.Tex2F.BYTES_PER_ELEMENT);this._offset=g||0;this._uF32=new Float32Array(this._arrayBuffer,this._offset,1);this._vF32=new Float32Array(this._arrayBuffer,this._offset+4,1);this._uF32[0]=f||0;this._vF32[0]=j||0};cc.Tex2F.BYTES_PER_ELEMENT=8;b=cc.Tex2F.prototype;b._getU=function(){return this._uF32[0]};b._setU=function(c){this._uF32[0]=c};b._getV=function(){return this._vF32[0]};b._setV=function(c){this._vF32[0]=c};cc.defineGetterSetter(b,"u",b._getU,b._setU);cc.defineGetterSetter(b,"v",b._getV,b._setV);cc.Quad2=function(h,o,n,m,k,j){this._arrayBuffer=k||new ArrayBuffer(cc.Quad2.BYTES_PER_ELEMENT);this._offset=j||0;k=this._arrayBuffer;j=cc.Vertex2F.BYTES_PER_ELEMENT;this._tl=h?new cc.Vertex2F(h.x,h.y,k,0):new cc.Vertex2F(0,0,k,0);this._tr=o?new cc.Vertex2F(o.x,o.y,k,j):new cc.Vertex2F(0,0,k,j);this._bl=n?new cc.Vertex2F(n.x,n.y,k,2*j):new cc.Vertex2F(0,0,k,2*j);this._br=m?new cc.Vertex2F(m.x,m.y,k,3*j):new cc.Vertex2F(0,0,k,3*j)};cc.Quad2.BYTES_PER_ELEMENT=32;b=cc.Quad2.prototype;b._getTL=function(){return this._tl};b._setTL=function(c){this._tl.x=c.x;this._tl.y=c.y};b._getTR=function(){return this._tr};b._setTR=function(c){this._tr.x=c.x;this._tr.y=c.y};b._getBL=function(){return this._bl};b._setBL=function(c){this._bl.x=c.x;this._bl.y=c.y};b._getBR=function(){return this._br};b._setBR=function(c){this._br.x=c.x;this._br.y=c.y};cc.defineGetterSetter(b,"tl",b._getTL,b._setTL);cc.defineGetterSetter(b,"tr",b._getTR,b._setTR);cc.defineGetterSetter(b,"bl",b._getBL,b._setBL);cc.defineGetterSetter(b,"br",b._getBR,b._setBR);cc.Quad3=function(f,j,h,g){this.bl=f||new cc.Vertex3F(0,0,0);this.br=j||new cc.Vertex3F(0,0,0);this.tl=h||new cc.Vertex3F(0,0,0);this.tr=g||new cc.Vertex3F(0,0,0)};cc.V3F_C4B_T2F=function(h,o,n,m,k){this._arrayBuffer=m||new ArrayBuffer(cc.V3F_C4B_T2F.BYTES_PER_ELEMENT);this._offset=k||0;m=this._arrayBuffer;k=this._offset;var j=cc.Vertex3F.BYTES_PER_ELEMENT;this._vertices=h?new cc.Vertex3F(h.x,h.y,h.z,m,k):new cc.Vertex3F(0,0,0,m,k);this._colors=o?cc.color(o.r,o.g,o.b,o.a,m,k+j):cc.color(0,0,0,0,m,k+j);this._texCoords=n?new cc.Tex2F(n.u,n.v,m,k+j+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,m,k+j+cc.Color.BYTES_PER_ELEMENT)};cc.V3F_C4B_T2F.BYTES_PER_ELEMENT=24;b=cc.V3F_C4B_T2F.prototype;b._getVertices=function(){return this._vertices};b._setVertices=function(d){var e=this._vertices;e.x=d.x;e.y=d.y;e.z=d.z};b._getColor=function(){return this._colors};b._setColor=function(d){var e=this._colors;e.r=d.r;e.g=d.g;e.b=d.b;e.a=d.a};b._getTexCoords=function(){return this._texCoords};b._setTexCoords=function(c){this._texCoords.u=c.u;this._texCoords.v=c.v};cc.defineGetterSetter(b,"vertices",b._getVertices,b._setVertices);cc.defineGetterSetter(b,"colors",b._getColor,b._setColor);cc.defineGetterSetter(b,"texCoords",b._getTexCoords,b._setTexCoords);cc.V3F_C4B_T2F_Quad=function(j,r,p,o,n,m){this._arrayBuffer=n||new ArrayBuffer(cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT);this._offset=m||0;n=this._arrayBuffer;m=this._offset;var k=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._tl=j?new cc.V3F_C4B_T2F(j.vertices,j.colors,j.texCoords,n,m):new cc.V3F_C4B_T2F(null,null,null,n,m);this._bl=r?new cc.V3F_C4B_T2F(r.vertices,r.colors,r.texCoords,n,m+k):new cc.V3F_C4B_T2F(null,null,null,n,m+k);this._tr=p?new cc.V3F_C4B_T2F(p.vertices,p.colors,p.texCoords,n,m+2*k):new cc.V3F_C4B_T2F(null,null,null,n,m+2*k);this._br=o?new cc.V3F_C4B_T2F(o.vertices,o.colors,o.texCoords,n,m+3*k):new cc.V3F_C4B_T2F(null,null,null,n,m+3*k)};cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT=96;b=cc.V3F_C4B_T2F_Quad.prototype;b._getTL=function(){return this._tl};b._setTL=function(d){var e=this._tl;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getBL=function(){return this._bl};b._setBL=function(d){var e=this._bl;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getTR=function(){return this._tr};b._setTR=function(d){var e=this._tr;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getBR=function(){return this._br};b._setBR=function(d){var e=this._br;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getArrayBuffer=function(){return this._arrayBuffer};cc.defineGetterSetter(b,"tl",b._getTL,b._setTL);cc.defineGetterSetter(b,"tr",b._getTR,b._setTR);cc.defineGetterSetter(b,"bl",b._getBL,b._setBL);cc.defineGetterSetter(b,"br",b._getBR,b._setBR);cc.defineGetterSetter(b,"arrayBuffer",b._getArrayBuffer,null);cc.V3F_C4B_T2F_QuadZero=function(){return new cc.V3F_C4B_T2F_Quad};cc.V3F_C4B_T2F_QuadCopy=function(f){if(!f){return cc.V3F_C4B_T2F_QuadZero()}var j=f.tl,h=f.bl,g=f.tr;f=f.br;return{tl:{vertices:{x:j.vertices.x,y:j.vertices.y,z:j.vertices.z},colors:{r:j.colors.r,g:j.colors.g,b:j.colors.b,a:j.colors.a},texCoords:{u:j.texCoords.u,v:j.texCoords.v}},bl:{vertices:{x:h.vertices.x,y:h.vertices.y,z:h.vertices.z},colors:{r:h.colors.r,g:h.colors.g,b:h.colors.b,a:h.colors.a},texCoords:{u:h.texCoords.u,v:h.texCoords.v}},tr:{vertices:{x:g.vertices.x,y:g.vertices.y,z:g.vertices.z},colors:{r:g.colors.r,g:g.colors.g,b:g.colors.b,a:g.colors.a},texCoords:{u:g.texCoords.u,v:g.texCoords.v}},br:{vertices:{x:f.vertices.x,y:f.vertices.y,z:f.vertices.z},colors:{r:f.colors.r,g:f.colors.g,b:f.colors.b,a:f.colors.a},texCoords:{u:f.texCoords.u,v:f.texCoords.v}}}};cc.V3F_C4B_T2F_QuadsCopy=function(e){if(!e){return[]}for(var g=[],f=0;f<e.length;f++){g.push(cc.V3F_C4B_T2F_QuadCopy(e[f]))}return g};cc.V2F_C4B_T2F=function(h,o,n,m,k){this._arrayBuffer=m||new ArrayBuffer(cc.V2F_C4B_T2F.BYTES_PER_ELEMENT);this._offset=k||0;m=this._arrayBuffer;k=this._offset;var j=cc.Vertex2F.BYTES_PER_ELEMENT;this._vertices=h?new cc.Vertex2F(h.x,h.y,m,k):new cc.Vertex2F(0,0,m,k);this._colors=o?cc.color(o.r,o.g,o.b,o.a,m,k+j):cc.color(0,0,0,0,m,k+j);this._texCoords=n?new cc.Tex2F(n.u,n.v,m,k+j+cc.Color.BYTES_PER_ELEMENT):new cc.Tex2F(0,0,m,k+j+cc.Color.BYTES_PER_ELEMENT)};cc.V2F_C4B_T2F.BYTES_PER_ELEMENT=20;b=cc.V2F_C4B_T2F.prototype;b._getVertices=function(){return this._vertices};b._setVertices=function(c){this._vertices.x=c.x;this._vertices.y=c.y};b._getColor=function(){return this._colors};b._setColor=function(d){var e=this._colors;e.r=d.r;e.g=d.g;e.b=d.b;e.a=d.a};b._getTexCoords=function(){return this._texCoords};b._setTexCoords=function(c){this._texCoords.u=c.u;this._texCoords.v=c.v};cc.defineGetterSetter(b,"vertices",b._getVertices,b._setVertices);cc.defineGetterSetter(b,"colors",b._getColor,b._setColor);cc.defineGetterSetter(b,"texCoords",b._getTexCoords,b._setTexCoords);cc.V2F_C4B_T2F_Triangle=function(h,o,n,m,k){this._arrayBuffer=m||new ArrayBuffer(cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT);this._offset=k||0;m=this._arrayBuffer;k=this._offset;var j=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._a=h?new cc.V2F_C4B_T2F(h.vertices,h.colors,h.texCoords,m,k):new cc.V2F_C4B_T2F(null,null,null,m,k);this._b=o?new cc.V2F_C4B_T2F(o.vertices,o.colors,o.texCoords,m,k+j):new cc.V2F_C4B_T2F(null,null,null,m,k+j);this._c=n?new cc.V2F_C4B_T2F(n.vertices,n.colors,n.texCoords,m,k+2*j):new cc.V2F_C4B_T2F(null,null,null,m,k+2*j)};cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT=60;b=cc.V2F_C4B_T2F_Triangle.prototype;b._getA=function(){return this._a};b._setA=function(d){var e=this._a;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getB=function(){return this._b};b._setB=function(d){var e=this._b;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};b._getC=function(){return this._c};b._setC=function(d){var e=this._c;e.vertices=d.vertices;e.colors=d.colors;e.texCoords=d.texCoords};cc.defineGetterSetter(b,"a",b._getA,b._setA);cc.defineGetterSetter(b,"b",b._getB,b._setB);cc.defineGetterSetter(b,"c",b._getC,b._setC)};cc._tmp.PrototypeColor=function(){var b=cc.color;b._getWhite=function(){return b(255,255,255)};b._getYellow=function(){return b(255,255,0)};b._getBlue=function(){return b(0,0,255)};b._getGreen=function(){return b(0,255,0)};b._getRed=function(){return b(255,0,0)};b._getMagenta=function(){return b(255,0,255)};b._getBlack=function(){return b(0,0,0)};b._getOrange=function(){return b(255,127,0)};b._getGray=function(){return b(166,166,166)};cc.defineGetterSetter(b,"WHITE",b._getWhite);cc.defineGetterSetter(b,"YELLOW",b._getYellow);cc.defineGetterSetter(b,"BLUE",b._getBlue);cc.defineGetterSetter(b,"GREEN",b._getGreen);cc.defineGetterSetter(b,"RED",b._getRed);cc.defineGetterSetter(b,"MAGENTA",b._getMagenta);cc.defineGetterSetter(b,"BLACK",b._getBlack);cc.defineGetterSetter(b,"ORANGE",b._getOrange);cc.defineGetterSetter(b,"GRAY",b._getGray);cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)};cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)};cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable);cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied);cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied);cc.defineGetterSetter(cc.BlendFunc,"ADDITIVE",cc.BlendFunc._additive)};cc.Color=function(f,e,h,g){this.r=f||0;this.g=e||0;this.b=h||0;this.a=null==g?255:g};cc.color=function(f,e,h,g){return void 0===f?{r:0,g:0,b:0,a:255}:cc.isString(f)?cc.hexToColor(f):cc.isObject(f)?{r:f.r,g:f.g,b:f.b,a:null==f.a?255:f.a}:{r:f,g:e,b:h,a:null==g?255:g}};cc.colorEqual=function(d,c){return d.r===c.r&&d.g===c.g&&d.b===c.b};cc.Acceleration=function(f,e,h,g){this.x=f||0;this.y=e||0;this.z=h||0;this.timestamp=g||0};cc.Vertex2F=function(d,c){this.x=d||0;this.y=c||0};cc.vertex2=function(d,c){return new cc.Vertex2F(d,c)};cc.Vertex3F=function(e,d,f){this.x=e||0;this.y=d||0;this.z=f||0};cc.vertex3=function(e,d,f){return new cc.Vertex3F(e,d,f)};cc.Tex2F=function(d,c){this.u=d||0;this.v=c||0};cc.tex2=function(d,c){return new cc.Tex2F(d,c)};cc.BlendFunc=function(d,c){this.src=d;this.dst=c};cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)};cc.hexToColor=function(b){b=b.replace(/^#?/,"0x");b=parseInt(b);return cc.color(b>>16,(b>>8)%256,b%256)};cc.colorToHex=function(f){var e=f.r.toString(16),h=f.g.toString(16),g=f.b.toString(16);return"#"+(16>f.r?"0"+e:e)+(16>f.g?"0"+h:h)+(16>f.b?"0"+g:g)};cc.TEXT_ALIGNMENT_LEFT=0;cc.TEXT_ALIGNMENT_CENTER=1;cc.TEXT_ALIGNMENT_RIGHT=2;cc.VERTICAL_TEXT_ALIGNMENT_TOP=0;cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1;cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2;cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={};this._valueMapTb={};this.__currId=2<<(0|10*Math.random())},__getKey:function(){this.__currId++;return"key_"+this.__currId},setObject:function(e,d){if(null!=d){var f=this.__getKey();this._keyMapTb[f]=d;this._valueMapTb[f]=e}},objectForKey:function(e){if(null==e){return null}var d=this._keyMapTb,f;for(f in d){if(d[f]===e){return this._valueMapTb[f]}}return null},valueForKey:function(b){return this.objectForKey(b)},removeObjectForKey:function(e){if(null!=e){var d=this._keyMapTb,f;for(f in d){if(d[f]===e){delete this._valueMapTb[f];delete d[f];break}}}},removeObjectsForKeys:function(d){if(null!=d){for(var c=0;c<d.length;c++){this.removeObjectForKey(d[c])}}},allKeys:function(){var e=[],d=this._keyMapTb,f;for(f in d){e.push(d[f])}return e},removeAllObjects:function(){this._keyMapTb={};this._valueMapTb={}},count:function(){return this.allKeys().length}});cc.FontDefinition=function(d){this.fontName="Arial";this.fontSize=12;this.textAlign=cc.TEXT_ALIGNMENT_CENTER;this.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this.fillStyle=cc.color(255,255,255,255);this.boundingHeight=this.boundingWidth=0;this.strokeEnabled=!1;this.strokeStyle=cc.color(255,255,255,255);this.lineWidth=1;this.fontWeight=this.fontStyle=this.lineHeight="normal";this.shadowEnabled=!1;this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0;this.shadowOpacity=1;if(d&&d instanceof Object){for(var c in d){this[c]=d[c]}}};cc.FontDefinition.prototype._getCanvasFontStr=function(){return this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px/"+(this.lineHeight.charAt?this.lineHeight:this.lineHeight+"px")+" '"+this.fontName+"'"};cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLColor),cc._LogInfos.MissingFile,"CCTypesWebGL.js"),cc._tmp.WebGLColor(),delete cc._tmp.WebGLColor);cc.assert(cc.isFunction(cc._tmp.PrototypeColor),cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js");cc._tmp.PrototypeColor();delete cc._tmp.PrototypeColor;cc.Touches=[];cc.TouchesIntergerDict={};cc.DENSITYDPI_DEVICE="device-dpi";cc.DENSITYDPI_HIGH="high-dpi";cc.DENSITYDPI_MEDIUM="medium-dpi";cc.DENSITYDPI_LOW="low-dpi";cc.__BrowserGetter={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(b){return b&&b!==this.html?b.clientWidth:window.innerWidth},availHeight:function(b){return b&&b!==this.html?b.clientHeight:window.innerHeight},meta:{width:"device-width","user-scalable":"no"},adaptationType:cc.sys.browserType};-1<window.navigator.userAgent.indexOf("OS 8_1_")&&(cc.__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_MIUI);cc.sys.os===cc.sys.OS_IOS&&(cc.__BrowserGetter.adaptationType=cc.sys.BROWSER_TYPE_SAFARI);switch(cc.__BrowserGetter.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:cc.__BrowserGetter.meta["minimal-ui"]="true";cc.__BrowserGetter.availWidth=function(b){return b.clientWidth};cc.__BrowserGetter.availHeight=function(b){return b.clientHeight};break;case cc.sys.BROWSER_TYPE_CHROME:cc.__BrowserGetter.__defineGetter__("target-densitydpi",function(){return cc.view._targetDensityDPI});case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:cc.__BrowserGetter.availWidth=function(b){return b.clientWidth};cc.__BrowserGetter.availHeight=function(b){return b.clientHeight};break;case cc.sys.BROWSER_TYPE_MIUI:cc.__BrowserGetter.init=function(d){if(!d.__resizeWithBrowserSize){var c=function(){d.setDesignResolutionSize(d._designResolutionSize.width,d._designResolutionSize.height,d._resolutionPolicy);window.removeEventListener("resize",c,!1)};window.addEventListener("resize",c,!1)}}}cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!0,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_indexBitsUsed:0,_maxTouches:5,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,_captured:!1,_wnd:null,_hDC:null,_hRC:null,_supportTouch:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,_targetDensityDPI:null,ctor:function(){var f=document,e=cc.ContainerStrategy,h=cc.ContentStrategy;cc.__BrowserGetter.init(this);this._frame=cc.container.parentNode===f.body?f.documentElement:cc.container.parentNode;this._frameSize=cc.size(0,0);this._initFrameSize();var f=cc._canvas.width,g=cc._canvas.height;this._designResolutionSize=cc.size(f,g);this._originalDesignResolutionSize=cc.size(f,g);this._viewPortRect=cc.rect(0,0,f,g);this._visibleRect=cc.rect(0,0,f,g);this._contentTranslateLeftTop={left:0,top:0};this._viewName="Cocos2dHTML5";f=cc.sys;this.enableRetina(f.os===f.OS_IOS||f.os===f.OS_OSX);cc.visibleRect&&cc.visibleRect.init(this._visibleRect);this._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,h.EXACT_FIT);this._rpShowAll=new cc.ResolutionPolicy(e.PROPORTION_TO_FRAME,h.SHOW_ALL);this._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,h.NO_BORDER);this._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,h.FIXED_HEIGHT);this._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,h.FIXED_WIDTH);this._hDC=cc._canvas;this._hRC=cc._renderContext;this._targetDensityDPI=cc.DENSITYDPI_HIGH},_resizeEvent:function(){var e;e=this.setDesignResolutionSize?this:cc.view;var d=e._frameSize.width,f=e._frameSize.height;e._initFrameSize();if(e._frameSize.width!==d||e._frameSize.height!==f){e._resizeCallback&&e._resizeCallback.call(),d=e._originalDesignResolutionSize.width,f=e._originalDesignResolutionSize.height,0<d&&e.setDesignResolutionSize(d,f,e._resolutionPolicy)}},setTargetDensityDPI:function(b){this._targetDensityDPI=b;this._setViewPortMeta()},getTargetDensityDPI:function(){return this._targetDensityDPI},resizeWithBrowserSize:function(b){b?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,cc._addEventListener(window,"resize",this._resizeEvent),cc._addEventListener(window,"orientationchange",this._resizeEvent)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resizeEvent),window.removeEventListener("orientationchange",this._resizeEvent))},setResizeCallback:function(b){if(cc.isFunction(b)||null==b){this._resizeCallback=b}},_initFrameSize:function(){var b=this._frameSize;b.width=cc.__BrowserGetter.availWidth(this._frame);b.height=cc.__BrowserGetter.availHeight(this._frame)},_adjustSizeKeepCanvasSize:function(){var d=this._originalDesignResolutionSize.width,c=this._originalDesignResolutionSize.height;0<d&&this.setDesignResolutionSize(d,c,this._resolutionPolicy)},_setViewPortMeta:function(){if(this._isAdjustViewPort){var g=document.getElementById("cocosMetaElement");g&&document.head.removeChild(g);var f,k=(g=document.getElementsByName("viewport"))?g[0]:null,j,g=cc.newElement("meta");g.id="cocosMetaElement";g.name="viewport";g.content="";f=cc.__BrowserGetter.meta;j=k?k.content:"";for(var h in f){RegExp(h).test(j)||(j+=","+h+"\x3d"+f[h])}/^,/.test(j)&&(j=j.substr(1));g.content=j;k&&(k.content=j);document.head.appendChild(g)}},_setScaleXYForRenderTexture:function(){var b=cc.contentScaleFactor();this._scaleY=this._scaleX=b},_resetScale:function(){this._scaleX=this._originalScaleX;this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(b){this._isAdjustViewPort=b},enableRetina:function(b){this._retinaEnabled=b?!0:!1},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(b){this._autoFullScreen=b?!0:!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},end:function(){},isOpenGLReady:function(){return null!==this._hDC&&null!==this._hRC},setFrameZoomFactor:function(b){this._frameZoomFactor=b;this.centerWindow();cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(b){},setContentTranslateLeftTop:function(d,c){this._contentTranslateLeftTop={left:d,top:c}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(d,c){this._frameSize.width=d;this._frameSize.height=c;this._frame.style.width=d+"px";this._frame.style.height=c+"px";this._resizeEvent();cc.director.setProjection(cc.director.getProjection())},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},canSetContentScaleFactor:function(){return !0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(d){if(d instanceof cc.ResolutionPolicy){this._resolutionPolicy=d}else{var c=cc.ResolutionPolicy;d===c.EXACT_FIT&&(this._resolutionPolicy=this._rpExactFit);d===c.SHOW_ALL&&(this._resolutionPolicy=this._rpShowAll);d===c.NO_BORDER&&(this._resolutionPolicy=this._rpNoBorder);d===c.FIXED_HEIGHT&&(this._resolutionPolicy=this._rpFixedHeight);d===c.FIXED_WIDTH&&(this._resolutionPolicy=this._rpFixedWidth)}},setDesignResolutionSize:function(f,e,h){if(0<f||0<e){if(this.setResolutionPolicy(h),h=this._resolutionPolicy){h.preApply(this);cc.sys.isMobile&&this._setViewPortMeta();this._initFrameSize();this._originalDesignResolutionSize.width=this._designResolutionSize.width=f;this._originalDesignResolutionSize.height=this._designResolutionSize.height=e;var g=h.apply(this,this._designResolutionSize);g.scale&&2===g.scale.length&&(this._scaleX=g.scale[0],this._scaleY=g.scale[1]);g.viewport&&(f=this._viewPortRect,e=this._visibleRect,g=g.viewport,f.x=g.x,f.y=g.y,f.width=g.width,f.height=g.height,e.x=-f.x/this._scaleX,e.y=-f.y/this._scaleY,e.width=cc._canvas.width/this._scaleX,e.height=cc._canvas.height/this._scaleY,cc._renderContext.setOffset&&cc._renderContext.setOffset(f.x,-f.y));f=cc.director;f._winSizeInPoints.width=this._designResolutionSize.width;f._winSizeInPoints.height=this._designResolutionSize.height;h.postApply(this);cc.winSize.width=f._winSizeInPoints.width;cc.winSize.height=f._winSizeInPoints.height;cc._renderType===cc._RENDER_TYPE_WEBGL&&(f._createStatsLabel(),f.setGLDefaultValues());this._originalScaleX=this._scaleX;this._originalScaleY=this._scaleY;cc.DOM&&cc.DOM._resetEGLViewDiv();cc.visibleRect&&cc.visibleRect.init(this._visibleRect)}else{cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2)}}else{cc.log(cc._LogInfos.EGLView_setDesignResolutionSize)}},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setViewPortInPoints:function(j,h,p,o){var n=this._frameZoomFactor,m=this._scaleX,k=this._scaleY;cc._renderContext.viewport(j*m*n+this._viewPortRect.x*n,h*k*n+this._viewPortRect.y*n,p*m*n,o*k*n)},setScissorInPoints:function(j,h,p,o){var n=this._frameZoomFactor,m=this._scaleX,k=this._scaleY;cc._renderContext.scissor(j*m*n+this._viewPortRect.x*n,h*k*n+this._viewPortRect.y*n,p*m*n,o*k*n)},isScissorEnabled:function(){var b=cc._renderContext;return b.isEnabled(b.SCISSOR_TEST)},getScissorRect:function(){var e=cc._renderContext,d=this._scaleX,f=this._scaleY,e=e.getParameter(e.SCISSOR_BOX);return cc.rect((e[0]-this._viewPortRect.x)/d,(e[1]-this._viewPortRect.y)/f,e[2]/d,e[3]/f)},setViewName:function(b){null!=b&&0<b.length&&(this._viewName=b)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(e,d,f){return{x:this._devicePixelRatio*(e-f.left),y:this._devicePixelRatio*(f.top+f.height-d)}},_convertMouseToLocationInView:function(e,d){var f=this._viewPortRect;e.x=(this._devicePixelRatio*(e.x-d.left)-f.x)/this._scaleX;e.y=(this._devicePixelRatio*(d.top+d.height-e.y)-f.y)/this._scaleY},_convertTouchesWithScale:function(k){for(var j=this._viewPortRect,s=this._scaleX,r=this._scaleY,p,o,n,m=0;m<k.length;m++){p=k[m],o=p._point,n=p._prevPoint,p._setPoint((o.x-j.x)/s,(o.y-j.y)/r),p._setPrevPoint((n.x-j.x)/s,(n.y-j.y)/r)}}});cc.EGLView._getInstance=function(){this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize());return this._instance};cc.ContainerStrategy=cc.Class.extend({preApply:function(b){},apply:function(d,c){},postApply:function(b){},_setupContainer:function(h,g,n){var m=h._frame;cc.view._autoFullScreen&&cc.sys.isMobile&&m===document.documentElement&&cc.screen.autoFullScreen(m);var m=cc._canvas,k=cc.container;k.style.width=m.style.width=g+"px";k.style.height=m.style.height=n+"px";k=h._devicePixelRatio=1;h.isRetinaEnabled()&&(k=h._devicePixelRatio=window.devicePixelRatio||1);m.width=g*k;m.height=n*k;cc._renderContext.resetCache&&cc._renderContext.resetCache();h=document.body;var j;h&&(j=h.style)&&(j.paddingTop=j.paddingTop||"0px",j.paddingRight=j.paddingRight||"0px",j.paddingBottom=j.paddingBottom||"0px",j.paddingLeft=j.paddingLeft||"0px",j.borderTop=j.borderTop||"0px",j.borderRight=j.borderRight||"0px",j.borderBottom=j.borderBottom||"0px",j.borderLeft=j.borderLeft||"0px",j.marginTop=j.marginTop||"0px",j.marginRight=j.marginRight||"0px",j.marginBottom=j.marginBottom||"0px",j.marginLeft=j.marginLeft||"0px")},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var b=document.body.style;b.width=window.innerWidth+"px";b.height=window.innerHeight+"px";b.overflow="hidden";b=cc.container.style;b.position="fixed";b.left=b.top="0px";document.body.scrollTop=0}});cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(h,g,n,m,k,j){2>Math.abs(h-n)&&(n=h);2>Math.abs(g-m)&&(m=g);h=cc.rect(Math.round((h-n)/2),Math.round((g-m)/2),n,m);this._result.scale=[k,j];this._result.viewport=h;return this._result},preApply:function(b){},apply:function(d,c){return{scale:[1,1]}},postApply:function(b){}});(function(){var g=cc.ContainerStrategy.extend({apply:function(b){this._setupContainer(b,b._frameSize.width,b._frameSize.height)}}),f=cc.ContainerStrategy.extend({apply:function(A,z){var y=A._frameSize.width,x=A._frameSize.height,w=cc.container.style,v=z.width,o=z.height,D=y/v,m=x/o,B,C;D<m?(B=y,C=o*D):(B=v*m,C=x);v=Math.round((y-B)/2);C=Math.round((x-C)/2);this._setupContainer(A,y-2*v,x-2*C);w.marginLeft=v+"px";w.marginRight=v+"px";w.marginTop=C+"px";w.marginBottom=C+"px"}});g.extend({preApply:function(b){this._super(b);b._frame=document.documentElement},apply:function(b){this._super(b);this._fixContainer()}});f.extend({preApply:function(b){this._super(b);b._frame=document.documentElement},apply:function(d,c){this._super(d,c);this._fixContainer()}});var k=cc.ContainerStrategy.extend({apply:function(b){this._setupContainer(b,cc._canvas.width,cc._canvas.height)}});cc.ContainerStrategy.EQUAL_TO_FRAME=new g;cc.ContainerStrategy.PROPORTION_TO_FRAME=new f;cc.ContainerStrategy.ORIGINAL_CONTAINER=new k;var g=cc.ContentStrategy.extend({apply:function(m,e){var o=cc._canvas.width,n=cc._canvas.height;return this._buildResult(o,n,o,n,o/e.width,n/e.height)}}),f=cc.ContentStrategy.extend({apply:function(A,z){var y=cc._canvas.width,x=cc._canvas.height,w=z.width,v=z.height,o=y/w,D=x/v,m=0,B,C;o<D?(m=o,B=y,C=v*m):(m=D,B=w*m,C=x);return this._buildResult(y,x,B,C,m,m)}}),k=cc.ContentStrategy.extend({apply:function(A,z){var y=cc._canvas.width,x=cc._canvas.height,w=z.width,v=z.height,o=y/w,D=x/v,m,B,C;o<D?(m=D,B=w*m,C=x):(m=o,B=y,C=v*m);return this._buildResult(y,x,B,C,m,m)}}),j=cc.ContentStrategy.extend({apply:function(n,m){var r=cc._canvas.width,p=cc._canvas.height,o=p/m.height;return this._buildResult(r,p,r,p,o,o)},postApply:function(b){cc.director._winSizeInPoints=b.getVisibleSize()}}),h=cc.ContentStrategy.extend({apply:function(n,m){var r=cc._canvas.width,p=cc._canvas.height,o=r/m.width;return this._buildResult(r,p,r,p,o,o)},postApply:function(b){cc.director._winSizeInPoints=b.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new g;cc.ContentStrategy.SHOW_ALL=new f;cc.ContentStrategy.NO_BORDER=new k;cc.ContentStrategy.FIXED_HEIGHT=new j;cc.ContentStrategy.FIXED_WIDTH=new h})();cc.ResolutionPolicy=cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(d,c){this.setContainerStrategy(d);this.setContentStrategy(c)},preApply:function(b){this._containerStrategy.preApply(b);this._contentStrategy.preApply(b)},apply:function(d,c){this._containerStrategy.apply(d,c);return this._contentStrategy.apply(d,c)},postApply:function(b){this._containerStrategy.postApply(b);this._contentStrategy.postApply(b)},setContainerStrategy:function(b){b instanceof cc.ContainerStrategy&&(this._containerStrategy=b)},setContentStrategy:function(b){b instanceof cc.ContentStrategy&&(this._contentStrategy=b)}});cc.ResolutionPolicy.EXACT_FIT=0;cc.ResolutionPolicy.NO_BORDER=1;cc.ResolutionPolicy.SHOW_ALL=2;cc.ResolutionPolicy.FIXED_HEIGHT=3;cc.ResolutionPolicy.FIXED_WIDTH=4;cc.ResolutionPolicy.UNKNOWN=5;cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var f,e,h=this._fnMap,g;f=0;for(l=h.length;f<l;f++){if((e=h[f])&&e[1] in document){f=0;for(g=e.length;f<g;f++){this._fn[h[0][f]]=e[f]}break}}this._supportsFullScreen="undefined"!==typeof this._fn.requestFullscreen;this._touchEvent="ontouchstart" in window?"touchstart":"mousedown"},fullScreen:function(){return this._supportsFullScreen&&document[this._fn.fullscreenElement]},requestFullScreen:function(e,d){if(this._supportsFullScreen){e=e||document.documentElement;if(d){var f=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(f,this._preOnFullScreenChange);this._preOnFullScreenChange=d;cc._addEventListener(document,f,d,!1)}return e[this._fn.requestFullscreen]()}},exitFullScreen:function(){return this._supportsFullScreen?document[this._fn.exitFullscreen]():!0},autoFullScreen:function(g,f){function k(){h.requestFullScreen(g,f);j.removeEventListener(h._touchEvent,k)}g=g||document.body;var j=cc._canvas||g,h=this;this.requestFullScreen(g,f);cc._addEventListener(j,this._touchEvent,k)}};cc.screen.init();cc.visibleRect={topLeft:cc.p(0,0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(h){var g=this.width=h.width,n=this.height=h.height,m=h.x;h=h.y;var k=h+n,j=m+g;this.topLeft.x=m;this.topLeft.y=k;this.topRight.x=j;this.topRight.y=k;this.top.x=m+g/2;this.top.y=k;this.bottomLeft.x=m;this.bottomLeft.y=h;this.bottomRight.x=j;this.bottomRight.y=h;this.bottom.x=m+g/2;this.bottom.y=h;this.center.x=m+g/2;this.center.y=h+n/2;this.left.x=m;this.left.y=h+n/2;this.right.x=j;this.right.y=h+n/2}};cc.UIInterfaceOrientationLandscapeLeft=-90;cc.UIInterfaceOrientationLandscapeRight=90;cc.UIInterfaceOrientationPortraitUpsideDown=180;cc.UIInterfaceOrientationPortrait=0;cc.inputManager={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var d=this._indexBitsUsed,c=0;c<this._maxTouches;c++){if(!(d&1)){return this._indexBitsUsed|=1<<c,c}d>>=1}return -1},_removeUsedIndexBit:function(b){0>b||b>=this._maxTouches||(b=~(1<<b),this._indexBitsUsed&=b)},_glView:null,handleTouchesBegin:function(u){for(var t,s,r,p=[],o=this._touchesIntegerDict,n=0,m=u.length;n<m;n++){if(t=u[n],r=t.getID(),s=o[r],null==s){var j=this._getUnUsedIndex();-1===j?cc.log(cc._LogInfos.inputManager_handleTouchesBegin,j):(s=this._touches[j]=new cc.Touch(t._point.x,t._point.y,t.getID()),s._setPrevPoint(t._prevPoint),o[r]=j,p.push(s))}}0<p.length&&(this._glView._convertTouchesWithScale(p),u=new cc.EventTouch(p),u._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(u))},handleTouchesMove:function(j){for(var h,p,o=[],n=this._touches,m=0,k=j.length;m<k;m++){h=j[m],p=h.getID(),p=this._touchesIntegerDict[p],null!=p&&n[p]&&(n[p]._setPoint(h._point),n[p]._setPrevPoint(h._prevPoint),o.push(n[p]))}0<o.length&&(this._glView._convertTouchesWithScale(o),j=new cc.EventTouch(o),j._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(j))},handleTouchesEnd:function(b){b=this.getSetOfTouchesEndOrCancel(b);0<b.length&&(this._glView._convertTouchesWithScale(b),b=new cc.EventTouch(b),b._eventCode=cc.EventTouch.EventCode.ENDED,cc.eventManager.dispatchEvent(b))},handleTouchesCancel:function(b){b=this.getSetOfTouchesEndOrCancel(b);0<b.length&&(this._glView._convertTouchesWithScale(b),b=new cc.EventTouch(b),b._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(b))},getSetOfTouchesEndOrCancel:function(u){for(var t,s,r,p=[],o=this._touches,n=this._touchesIntegerDict,m=0,j=u.length;m<j;m++){t=u[m],r=t.getID(),s=n[r],null!=s&&o[s]&&(o[s]._setPoint(t._point),o[s]._setPrevPoint(t._prevPoint),p.push(o[s]),this._removeUsedIndexBit(s),delete n[r])}return p},getHTMLElementPosition:function(f){var e=document.documentElement,h=window,g=null,g=cc.isFunction(f.getBoundingClientRect)?f.getBoundingClientRect():f instanceof HTMLCanvasElement?{left:0,top:0,width:f.width,height:f.height}:{left:0,top:0,width:parseInt(f.style.width),height:parseInt(f.style.height)};return{left:g.left+h.pageXOffset-e.clientLeft,top:g.top+h.pageYOffset-e.clientTop,width:g.width,height:g.height}},getPreTouch:function(g){for(var f=null,k=this._preTouchPool,j=g.getID(),h=k.length-1;0<=h;h--){if(k[h].getID()===j){f=k[h];break}}f||(f=g);return f},setPreTouch:function(g){for(var f=!1,k=this._preTouchPool,j=g.getID(),h=k.length-1;0<=h;h--){if(k[h].getID()===j){k[h]=g;f=!0;break}}f||(50>=k.length?k.push(g):(k[this._preTouchPoolPointer]=g,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(f,e,h){var g=this._preTouchPoint;f=this._glView.convertToLocationInView(f,e,h);e=new cc.Touch(f.x,f.y);e._setPrevPoint(g.x,g.y);g.x=f.x;g.y=f.y;return e},getMouseEvent:function(f,e,h){var g=this._prevMousePoint;this._glView._convertMouseToLocationInView(f,e);e=new cc.EventMouse(h);e.setLocation(f.x,f.y);e._setPrevCursor(g.x,g.y);g.x=f.x;g.y=f.y;return e},getPointByEvent:function(d,c){if(null!=d.pageX){return{x:d.pageX,y:d.pageY}}c.left-=document.body.scrollLeft;c.top-=document.body.scrollTop;return{x:d.clientX,y:d.clientY}},getTouchesByEvent:function(w,v){for(var u=[],t=this._glView,s,r,p=this._preTouchPoint,o=w.changedTouches.length,n=0;n<o;n++){if(s=w.changedTouches[n]){var j;j=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?t.convertToLocationInView(s.pageX,s.pageY,v):t.convertToLocationInView(s.clientX,s.clientY,v);null!=s.identifier?(s=new cc.Touch(j.x,j.y,s.identifier),r=this.getPreTouch(s).getLocation(),s._setPrevPoint(r.x,r.y),this.setPreTouch(s)):(s=new cc.Touch(j.x,j.y),s._setPrevPoint(p.x,p.y));p.x=j.x;p.y=j.y;u.push(s)}}return u},registerSystemEvent:function(h){if(!this._isRegisterEvent){this._glView=cc.view;var g=this,n="mouse" in cc.sys.capabilities,m="touches" in cc.sys.capabilities,k=!1;cc.sys.isMobile&&(k=!0);n&&(cc._addEventListener(window,"mousedown",function(){g._mousePressed=!0},!1),cc._addEventListener(window,"mouseup",function(e){if(!k){var b=g._mousePressed;g._mousePressed=!1;if(b){var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(e,b);cc.rectContainsPoint(new cc.Rect(b.left,b.top,b.width,b.height),a)||(g.handleTouchesEnd([g.getTouchByXY(a.x,a.y,b)]),b=g.getMouseEvent(a,b,cc.EventMouse.UP),b.setButton(e.button),cc.eventManager.dispatchEvent(b))}}},!1),cc._addEventListener(h,"mousedown",function(e){if(!k){g._mousePressed=!0;var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(e,b);g.handleTouchesBegin([g.getTouchByXY(a.x,a.y,b)]);b=g.getMouseEvent(a,b,cc.EventMouse.DOWN);b.setButton(e.button);cc.eventManager.dispatchEvent(b);e.stopPropagation();e.preventDefault();h.focus()}},!1),cc._addEventListener(h,"mouseup",function(e){if(!k){g._mousePressed=!1;var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(e,b);g.handleTouchesEnd([g.getTouchByXY(a.x,a.y,b)]);b=g.getMouseEvent(a,b,cc.EventMouse.UP);b.setButton(e.button);cc.eventManager.dispatchEvent(b);e.stopPropagation();e.preventDefault()}},!1),cc._addEventListener(h,"mousemove",function(e){if(!k){var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(e,b);g.handleTouchesMove([g.getTouchByXY(a.x,a.y,b)]);b=g.getMouseEvent(a,b,cc.EventMouse.MOVE);g._mousePressed?b.setButton(e.button):b.setButton(null);cc.eventManager.dispatchEvent(b);e.stopPropagation();e.preventDefault()}},!1),cc._addEventListener(h,"mousewheel",function(f){var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(f,b),b=g.getMouseEvent(a,b,cc.EventMouse.SCROLL);b.setButton(f.button);b.setScrollData(0,f.wheelDelta);cc.eventManager.dispatchEvent(b);f.stopPropagation();f.preventDefault()},!1),cc._addEventListener(h,"DOMMouseScroll",function(f){var b=g.getHTMLElementPosition(h),a=g.getPointByEvent(f,b),b=g.getMouseEvent(a,b,cc.EventMouse.SCROLL);b.setButton(f.button);b.setScrollData(0,-120*f.detail);cc.eventManager.dispatchEvent(b);f.stopPropagation();f.preventDefault()},!1));if(window.navigator.msPointerEnabled){var n={MSPointerDown:g.handleTouchesBegin,MSPointerMove:g.handleTouchesMove,MSPointerUp:g.handleTouchesEnd,MSPointerCancel:g.handleTouchesCancel},j;for(j in n){(function(b,a){cc._addEventListener(h,b,function(f){var d=g.getHTMLElementPosition(h);d.left-=document.documentElement.scrollLeft;d.top-=document.documentElement.scrollTop;a.call(g,[g.getTouchByXY(f.clientX,f.clientY,d)]);f.stopPropagation()},!1)})(j,n[j])}}m&&(cc._addEventListener(h,"touchstart",function(b){if(b.changedTouches){var a=g.getHTMLElementPosition(h);a.left-=document.body.scrollLeft;a.top-=document.body.scrollTop;g.handleTouchesBegin(g.getTouchesByEvent(b,a));b.stopPropagation();b.preventDefault();h.focus()}},!1),cc._addEventListener(h,"touchmove",function(b){if(b.changedTouches){var a=g.getHTMLElementPosition(h);a.left-=document.body.scrollLeft;a.top-=document.body.scrollTop;g.handleTouchesMove(g.getTouchesByEvent(b,a));b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(h,"touchend",function(b){if(b.changedTouches){var a=g.getHTMLElementPosition(h);a.left-=document.body.scrollLeft;a.top-=document.body.scrollTop;g.handleTouchesEnd(g.getTouchesByEvent(b,a));b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(h,"touchcancel",function(b){if(b.changedTouches){var a=g.getHTMLElementPosition(h);a.left-=document.body.scrollLeft;a.top-=document.body.scrollTop;g.handleTouchesCancel(g.getTouchesByEvent(b,a));b.stopPropagation();b.preventDefault()}},!1));this._registerKeyboardEvent();this._registerAccelerometerEvent();this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(b){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration)));this._accelCurTime+=b}};var _p=cc.inputManager;_p.setAccelerometerEnabled=function(b){this._accelEnabled!==b&&(this._accelEnabled=b,b=cc.director.getScheduler(),this._accelCurTime=0,b.scheduleUpdate(this))};_p.setAccelerometerInterval=function(b){this._accelInterval!==b&&(this._accelInterval=b)};_p._registerKeyboardEvent=function(){cc._addEventListener(cc._canvas,"keydown",function(b){cc.eventManager.dispatchEvent(new cc.EventKeyboard(b.keyCode,!0));b.stopPropagation();b.preventDefault()},!1);cc._addEventListener(cc._canvas,"keyup",function(b){cc.eventManager.dispatchEvent(new cc.EventKeyboard(b.keyCode,!1));b.stopPropagation();b.preventDefault()},!1)};_p._registerAccelerometerEvent=function(){var e=window;this._acceleration=new cc.Acceleration;this._accelDeviceEvent=e.DeviceMotionEvent||e.DeviceOrientationEvent;cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(this._accelDeviceEvent=window.DeviceOrientationEvent);var d=this._accelDeviceEvent===e.DeviceMotionEvent?"devicemotion":"deviceorientation",f=navigator.userAgent;if(/Android/.test(f)||/Adr/.test(f)&&cc.sys.browserType===cc.BROWSER_TYPE_UC){this._minus=-1}cc._addEventListener(e,d,this.didAccelerate.bind(this),!1)};_p.didAccelerate=function(h){var g=window;if(this._accelEnabled){var n=this._acceleration,m,k,j;this._accelDeviceEvent===window.DeviceMotionEvent?(j=h.accelerationIncludingGravity,m=this._accelMinus*j.x*0.1,k=this._accelMinus*j.y*0.1,j=0.1*j.z):(m=h.gamma/90*0.981,k=0.981*-(h.beta/90),j=h.alpha/90*0.981);cc.sys.os===cc.sys.OS_ANDROID?(n.x=-m,n.y=-k):(n.x=m,n.y=k);n.z=j;n.timestamp=h.timeStamp||Date.now();h=n.x;g.orientation===cc.UIInterfaceOrientationLandscapeRight?(n.x=-n.y,n.y=h):g.orientation===cc.UIInterfaceOrientationLandscapeLeft?(n.x=n.y,n.y=-h):g.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(n.x=-n.x,n.y=-n.y)}};delete _p;cc.AffineTransform=function(h,g,n,m,k,j){this.a=h;this.b=g;this.c=n;this.d=m;this.tx=k;this.ty=j};cc.affineTransformMake=function(h,g,n,m,k,j){return{a:h,b:g,c:n,d:m,tx:k,ty:j}};cc.pointApplyAffineTransform=function(f,e,h){var g;void 0===h?(h=e,g=f.x,f=f.y):(g=f,f=e);return{x:h.a*g+h.c*f+h.tx,y:h.b*g+h.d*f+h.ty}};cc._pointApplyAffineTransform=function(e,d,f){return cc.pointApplyAffineTransform(e,d,f)};cc.sizeApplyAffineTransform=function(d,c){return{width:c.a*d.width+c.c*d.height,height:c.b*d.width+c.d*d.height}};cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}};cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}};cc.rectApplyAffineTransform=function(u,t){var s=cc.rectGetMinY(u),r=cc.rectGetMinX(u),p=cc.rectGetMaxX(u),o=cc.rectGetMaxY(u),n=cc.pointApplyAffineTransform(r,s,t),s=cc.pointApplyAffineTransform(p,s,t),r=cc.pointApplyAffineTransform(r,o,t),m=cc.pointApplyAffineTransform(p,o,t),p=Math.min(n.x,s.x,r.x,m.x),o=Math.max(n.x,s.x,r.x,m.x),j=Math.min(n.y,s.y,r.y,m.y),n=Math.max(n.y,s.y,r.y,m.y);return cc.rect(p,j,o-p,n-j)};cc._rectApplyAffineTransformIn=function(u,t){var s=cc.rectGetMinY(u),r=cc.rectGetMinX(u),p=cc.rectGetMaxX(u),o=cc.rectGetMaxY(u),n=cc.pointApplyAffineTransform(r,s,t),s=cc.pointApplyAffineTransform(p,s,t),r=cc.pointApplyAffineTransform(r,o,t),m=cc.pointApplyAffineTransform(p,o,t),p=Math.min(n.x,s.x,r.x,m.x),o=Math.max(n.x,s.x,r.x,m.x),j=Math.min(n.y,s.y,r.y,m.y),n=Math.max(n.y,s.y,r.y,m.y);u.x=p;u.y=j;u.width=o-p;u.height=n-j;return u};cc.affineTransformTranslate=function(e,d,f){return{a:e.a,b:e.b,c:e.c,d:e.d,tx:e.tx+e.a*d+e.c*f,ty:e.ty+e.b*d+e.d*f}};cc.affineTransformScale=function(e,d,f){return{a:e.a*d,b:e.b*d,c:e.c*f,d:e.d*f,tx:e.tx,ty:e.ty}};cc.affineTransformRotate=function(f,e){var h=Math.sin(e),g=Math.cos(e);return{a:f.a*g+f.c*h,b:f.b*g+f.d*h,c:f.c*g-f.a*h,d:f.d*g-f.b*h,tx:f.tx,ty:f.ty}};cc.affineTransformConcat=function(d,c){return{a:d.a*c.a+d.b*c.c,b:d.a*c.b+d.b*c.d,c:d.c*c.a+d.d*c.c,d:d.c*c.b+d.d*c.d,tx:d.tx*c.a+d.ty*c.c+c.tx,ty:d.tx*c.b+d.ty*c.d+c.ty}};cc.affineTransformEqualToTransform=function(d,c){return d.a===c.a&&d.b===c.b&&d.c===c.c&&d.d===c.d&&d.tx===c.tx&&d.ty===c.ty};cc.affineTransformInvert=function(d){var c=1/(d.a*d.d-d.b*d.c);return{a:c*d.d,b:-c*d.b,c:-c*d.c,d:c*d.a,tx:c*(d.c*d.ty-d.d*d.tx),ty:c*(d.b*d.tx-d.a*d.ty)}};cc.POINT_EPSILON=parseFloat("1.192092896e-07F");cc.pNeg=function(b){return cc.p(-b.x,-b.y)};cc.pAdd=function(d,c){return cc.p(d.x+c.x,d.y+c.y)};cc.pSub=function(d,c){return cc.p(d.x-c.x,d.y-c.y)};cc.pMult=function(d,c){return cc.p(d.x*c,d.y*c)};cc.pMidpoint=function(d,c){return cc.pMult(cc.pAdd(d,c),0.5)};cc.pDot=function(d,c){return d.x*c.x+d.y*c.y};cc.pCross=function(d,c){return d.x*c.y-d.y*c.x};cc.pPerp=function(b){return cc.p(-b.y,b.x)};cc.pRPerp=function(b){return cc.p(b.y,-b.x)};cc.pProject=function(d,c){return cc.pMult(c,cc.pDot(d,c)/cc.pDot(c,c))};cc.pRotate=function(d,c){return cc.p(d.x*c.x-d.y*c.y,d.x*c.y+d.y*c.x)};cc.pUnrotate=function(d,c){return cc.p(d.x*c.x+d.y*c.y,d.y*c.x-d.x*c.y)};cc.pLengthSQ=function(b){return cc.pDot(b,b)};cc.pDistanceSQ=function(d,c){return cc.pLengthSQ(cc.pSub(d,c))};cc.pLength=function(b){return Math.sqrt(cc.pLengthSQ(b))};cc.pDistance=function(d,c){return cc.pLength(cc.pSub(d,c))};cc.pNormalize=function(d){var c=cc.pLength(d);return 0===c?cc.p(d):cc.pMult(d,1/c)};cc.pForAngle=function(b){return cc.p(Math.cos(b),Math.sin(b))};cc.pToAngle=function(b){return Math.atan2(b.y,b.x)};cc.clampf=function(f,e,h){if(e>h){var g=e;e=h;h=g}return f<e?e:f<h?f:h};cc.pClamp=function(e,d,f){return cc.p(cc.clampf(e.x,d.x,f.x),cc.clampf(e.y,d.y,f.y))};cc.pFromSize=function(b){return cc.p(b.width,b.height)};cc.pCompOp=function(d,c){return cc.p(c(d.x),c(d.y))};cc.pLerp=function(e,d,f){return cc.pAdd(cc.pMult(e,1-f),cc.pMult(d,f))};cc.pFuzzyEqual=function(e,d,f){return e.x-f<=d.x&&d.x<=e.x+f&&e.y-f<=d.y&&d.y<=e.y+f?!0:!1};cc.pCompMult=function(d,c){return cc.p(d.x*c.x,d.y*c.y)};cc.pAngleSigned=function(f,e){var h=cc.pNormalize(f),g=cc.pNormalize(e),h=Math.atan2(h.x*g.y-h.y*g.x,cc.pDot(h,g));return Math.abs(h)<cc.POINT_EPSILON?0:h};cc.pAngle=function(e,d){var f=Math.acos(cc.pDot(cc.pNormalize(e),cc.pNormalize(d)));return Math.abs(f)<cc.POINT_EPSILON?0:f};cc.pRotateByAngle=function(g,f,k){g=cc.pSub(g,f);var j=Math.cos(k);k=Math.sin(k);var h=g.x;g.x=h*j-g.y*k+f.x;g.y=h*k+g.y*j+f.y;return g};cc.pLineIntersect=function(k,j,s,r,p){if(k.x===j.x&&k.y===j.y||s.x===r.x&&s.y===r.y){return !1}var o=j.x-k.x;j=j.y-k.y;var n=r.x-s.x;r=r.y-s.y;var m=k.x-s.x;k=k.y-s.y;s=r*o-n*j;p.x=n*k-r*m;p.y=o*k-j*m;if(0===s){return 0===p.x||0===p.y?!0:!1}p.x/=s;p.y/=s;return !0};cc.pSegmentIntersect=function(g,f,k,j){var h=cc.p(0,0);return cc.pLineIntersect(g,f,k,j,h)&&0<=h.x&&1>=h.x&&0<=h.y&&1>=h.y?!0:!1};cc.pIntersectPoint=function(g,f,k,j){var h=cc.p(0,0);return cc.pLineIntersect(g,f,k,j,h)?(k=cc.p(0,0),k.x=g.x+h.x*(f.x-g.x),k.y=g.y+h.x*(f.y-g.y),k):cc.p(0,0)};cc.pSameAs=function(d,c){return null!=d&&null!=c?d.x===c.x&&d.y===c.y:!1};cc.pZeroIn=function(b){b.x=0;b.y=0};cc.pIn=function(d,c){d.x=c.x;d.y=c.y};cc.pMultIn=function(d,c){d.x*=c;d.y*=c};cc.pSubIn=function(d,c){d.x-=c.x;d.y-=c.y};cc.pAddIn=function(d,c){d.x+=c.x;d.y+=c.y};cc.pNormalizeIn=function(b){cc.pMultIn(b,1/Math.sqrt(b.x*b.x+b.y*b.y))};cc.vertexLineToPolygon=function(D,C,B,A,z){z+=A;if(!(1>=z)){C*=0.5;for(var y,x=z-1,w=A;w<z;w++){y=2*w;var v=cc.p(D[2*w],D[2*w+1]),u;if(0===w){u=cc.pPerp(cc.pNormalize(cc.pSub(v,cc.p(D[2*(w+1)],D[2*(w+1)+1]))))}else{if(w===x){u=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(D[2*(w-1)],D[2*(w-1)+1]),v)))}else{u=cc.p(D[2*(w-1)],D[2*(w-1)+1]);var t=cc.p(D[2*(w+1)],D[2*(w+1)+1]),o=cc.pNormalize(cc.pSub(t,v)),E=cc.pNormalize(cc.pSub(u,v)),j=Math.acos(cc.pDot(o,E));u=j<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(o,E))):j<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(o,E)):cc.pPerp(cc.pNormalize(cc.pSub(t,u)))}}u=cc.pMult(u,C);B[2*y]=v.x+u.x;B[2*y+1]=v.y+u.y;B[2*(y+1)]=v.x-u.x;B[2*(y+1)+1]=v.y-u.y}for(w=0===A?0:A-1;w<x;w++){y=2*w,D=y+2,C=cc.vertex2(B[2*y],B[2*y+1]),z=cc.vertex2(B[2*(y+1)],B[2*(y+1)+1]),y=cc.vertex2(B[2*D],B[2*D]),A=cc.vertex2(B[2*(D+1)],B[2*(D+1)+1]),C=!cc.vertexLineIntersect(C.x,C.y,A.x,A.y,z.x,z.y,y.x,y.y),!C.isSuccess&&(0>C.value||1<C.value)&&(C.isSuccess=!0),C.isSuccess&&(B[2*D]=A.x,B[2*D+1]=A.y,B[2*(D+1)]=y.x,B[2*(D+1)+1]=y.y)}}};cc.vertexLineIntersect=function(k,j,s,r,p,o,n,m){if(k===s&&j===r||p===n&&o===m){return{isSuccess:!1,value:0}}s-=k;r-=j;p-=k;o-=j;n-=k;m-=j;k=Math.sqrt(s*s+r*r);s/=k;r/=k;j=p*s+o*r;o=o*s-p*r;p=j;j=n*s+m*r;m=m*s-n*r;n=j;return o===m?{isSuccess:!1,value:0}:{isSuccess:!0,value:(n+(p-n)*m/(m-o))/k}};cc.vertexListIsClockwise=function(g){for(var f=0,k=g.length;f<k;f++){var j=g[(f+1)%k],h=g[(f+2)%k];if(0<cc.pCross(cc.pSub(j,g[f]),cc.pSub(h,j))){return !1}}return !0};cc.CGAffineToGL=function(d,c){c[2]=c[3]=c[6]=c[7]=c[8]=c[9]=c[11]=c[14]=0;c[10]=c[15]=1;c[0]=d.a;c[4]=d.c;c[12]=d.tx;c[1]=d.b;c[5]=d.d;c[13]=d.ty};cc.GLToCGAffine=function(d,c){c.a=d[0];c.c=d[4];c.tx=d[12];c.b=d[1];c.d=d[5];c.ty=d[13]};cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(e,d,f){this._point=cc.p(e||0,d||0);this._id=f||0},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){cc.log("getId is deprecated. Please use getID instead.");return this._id},setTouchInfo:function(e,d,f){this._prevPoint=this._point;this._point=cc.p(d||0,f||0);this._id=e;this._startPointCaptured||(this._startPoint=cc.p(this._point),this._startPointCaptured=!0)},_setPoint:function(d,c){void 0===c?(this._point.x=d.x,this._point.y=d.y):(this._point.x=d,this._point.y=c)},_setPrevPoint:function(d,c){this._prevPoint=void 0===c?cc.p(d.x,d.y):cc.p(d||0,c||0)}});cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(b){this._currentTarget=b},ctor:function(b){this._type=b},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}});cc.Event.TOUCH=0;cc.Event.KEYBOARD=1;cc.Event.ACCELERATION=2;cc.Event.MOUSE=3;cc.Event.FOCUS=4;cc.Event.CUSTOM=6;cc.EventCustom=cc.Event.extend({_eventName:null,_userData:null,ctor:function(b){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM);this._eventName=b},setUserData:function(b){this._userData=b},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}});cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(b){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE);this._eventType=b},setScrollData:function(d,c){this._scrollX=d;this._scrollY=c},getScrollX:function(){return this._scrollX},getScrollY:function(){return this._scrollY},setLocation:function(d,c){this._x=d;this._y=c},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},_setPrevCursor:function(d,c){this._prevX=d;this._prevY=c},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(b){this._button=b},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}});cc.EventMouse.NONE=0;cc.EventMouse.DOWN=1;cc.EventMouse.UP=2;cc.EventMouse.MOVE=3;cc.EventMouse.SCROLL=4;cc.EventMouse.BUTTON_LEFT=0;cc.EventMouse.BUTTON_RIGHT=2;cc.EventMouse.BUTTON_MIDDLE=1;cc.EventMouse.BUTTON_4=3;cc.EventMouse.BUTTON_5=4;cc.EventMouse.BUTTON_6=5;cc.EventMouse.BUTTON_7=6;cc.EventMouse.BUTTON_8=7;cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,ctor:function(b){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH);this._touches=b||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(b){this._eventCode=b},_setTouches:function(b){this._touches=b}});cc.EventTouch.MAX_TOUCHES=5;cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3};cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(d,c){cc.Event.prototype.ctor.call(this,cc.Event.FOCUS);this._widgetGetFocus=c;this._widgetLoseFocus=d}});cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!0,_isEnabled:!0,ctor:function(e,d,f){this._onEvent=f;this._type=e||0;this._listenerID=d||""},_setPaused:function(b){this._paused=b},_isPaused:function(){return this._paused},_setRegistered:function(b){this._registered=b},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(b){this._fixedPriority=b},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(b){this._node=b},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(b){this._isEnabled=b},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}});cc.EventListener.UNKNOWN=0;cc.EventListener.TOUCH_ONE_BY_ONE=1;cc.EventListener.TOUCH_ALL_AT_ONCE=2;cc.EventListener.KEYBOARD=3;cc.EventListener.MOUSE=4;cc.EventListener.ACCELERATION=5;cc.EventListener.ACCELERATION=6;cc.EventListener.CUSTOM=8;cc.EventListener.FOCUS=7;cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(e,d){this._onCustomEvent=d;var f=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,e,function(b){null!==f._onCustomEvent&&f._onCustomEvent(b)})},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}});cc._EventListenerCustom.create=function(d,c){return new cc._EventListenerCustom(d,c)};cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var b=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,function(a){var d=cc.EventMouse;switch(a._eventType){case d.DOWN:if(b.onMouseDown){b.onMouseDown(a)}break;case d.UP:if(b.onMouseUp){b.onMouseUp(a)}break;case d.MOVE:if(b.onMouseMove){b.onMouseMove(a)}break;case d.SCROLL:if(b.onMouseScroll){b.onMouseScroll(a)}}})},clone:function(){var b=new cc._EventListenerMouse;b.onMouseDown=this.onMouseDown;b.onMouseUp=this.onMouseUp;b.onMouseMove=this.onMouseMove;b.onMouseScroll=this.onMouseScroll;return b},checkAvailable:function(){return !0}});cc._EventListenerMouse.LISTENER_ID="__cc_mouse";cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse};cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,cc._EventListenerTouchOneByOne.LISTENER_ID,null);this._claimedTouches=[]},setSwallowTouches:function(b){this.swallowTouches=b},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var b=new cc._EventListenerTouchOneByOne;b.onTouchBegan=this.onTouchBegan;b.onTouchMoved=this.onTouchMoved;b.onTouchEnded=this.onTouchEnded;b.onTouchCancelled=this.onTouchCancelled;b.swallowTouches=this.swallowTouches;return b},checkAvailable:function(){return this.onTouchBegan?!0:(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}});cc._EventListenerTouchOneByOne.LISTENER_ID="__cc_touch_one_by_one";cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne};cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var b=new cc._EventListenerTouchAllAtOnce;b.onTouchesBegan=this.onTouchesBegan;b.onTouchesMoved=this.onTouchesMoved;b.onTouchesEnded=this.onTouchesEnded;b.onTouchesCancelled=this.onTouchesCancelled;return b},checkAvailable:function(){return null===this.onTouchesBegan&&null===this.onTouchesMoved&&null===this.onTouchesEnded&&null===this.onTouchesCancelled?(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1):!0}});cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once";cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce};cc.EventListener.create=function(f){cc.assert(f&&f.event,cc._LogInfos.EventListener_create);var e=f.event;delete f.event;var h=null;e===cc.EventListener.TOUCH_ONE_BY_ONE?h=new cc._EventListenerTouchOneByOne:e===cc.EventListener.TOUCH_ALL_AT_ONCE?h=new cc._EventListenerTouchAllAtOnce:e===cc.EventListener.MOUSE?h=new cc._EventListenerMouse:e===cc.EventListener.CUSTOM?(h=new cc._EventListenerCustom(f.eventName,f.callback),delete f.eventName,delete f.callback):e===cc.EventListener.KEYBOARD?h=new cc._EventListenerKeyboard:e===cc.EventListener.ACCELERATION?(h=new cc._EventListenerAcceleration(f.callback),delete f.callback):e===cc.EventListener.FOCUS&&(h=new cc._EventListenerFocus);for(var g in f){h[g]=f[g]}return h};cc._EventListenerFocus=cc.EventListener.extend({clone:function(){var b=new cc._EventListenerFocus;b.onFocusChanged=this.onFocusChanged;return b},checkAvailable:function(){return this.onFocusChanged?!0:(cc.log("Invalid EventListenerFocus!"),!1)},onFocusChanged:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.FOCUS,cc._EventListenerFocus.LISTENER_ID,function(b){if(this.onFocusChanged){this.onFocusChanged(b._widgetLoseFocus,b._widgetGetFocus)}})}});cc._EventListenerFocus.LISTENER_ID="__cc_focus_event";cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[];this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(b){0===b._getFixedPriority()?this._sceneGraphListeners.push(b):this._fixedListeners.push(b)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0;this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}});cc.__getListenerID=function(e){var d=cc.Event,f=e.getType();if(f===d.ACCELERATION){return cc._EventListenerAcceleration.LISTENER_ID}if(f===d.CUSTOM){return e.getEventName()}if(f===d.KEYBOARD){return cc._EventListenerKeyboard.LISTENER_ID}if(f===d.MOUSE){return cc._EventListenerMouse.LISTENER_ID}if(f===d.FOCUS){return cc._EventListenerFocus.LISTENER_ID}f===d.TOUCH&&cc.log(cc._LogInfos.__getListenerID);return""};cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_dirtyNodes:[],_inDispatch:0,_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(e){null!=this._nodeListenersMap[e.__instanceId]&&this._dirtyNodes.push(e);e=e.getChildren();for(var d=0,f=e.length;d<f;d++){this._setDirtyForNode(e[d])}},pauseTarget:function(g,f){var k=this._nodeListenersMap[g.__instanceId],j,h;if(k){for(j=0,h=k.length;j<h;j++){k[j]._setPaused(!0)}}if(!0===f){for(k=g.getChildren(),j=0,h=k.length;j<h;j++){this.pauseTarget(k[j],!0)}}},resumeTarget:function(g,f){var k=this._nodeListenersMap[g.__instanceId],j,h;if(k){for(j=0,h=k.length;j<h;j++){k[j]._setPaused(!1)}}this._setDirtyForNode(g);if(!0===f){for(k=g.getChildren(),j=0,h=k.length;j<h;j++){this.resumeTarget(k[j],!0)}}},_addListener:function(b){0===this._inDispatch?this._forceAddEventListener(b):this._toAddedListeners.push(b)},_forceAddEventListener:function(e){var d=e._getListenerID(),f=this._listenersMap[d];f||(f=new cc._EventListenerVector,this._listenersMap[d]=f);f.push(e);0===e._getFixedPriority()?(this._setDirty(d,this.DIRTY_SCENE_GRAPH_PRIORITY),d=e._getSceneGraphPriority(),null===d&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(d,e),d.isRunning()&&this.resumeTarget(d)):this._setDirty(d,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(b){return this._listenersMap[b]},_updateDirtyFlagForSceneGraph:function(){if(0!==this._dirtyNodes.length){for(var k=this._dirtyNodes,j,s,r=this._nodeListenersMap,p=0,o=k.length;p<o;p++){if(j=r[k[p].__instanceId]){for(var n=0,m=j.length;n<m;n++){(s=j[n])&&this._setDirty(s._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY)}}}this._dirtyNodes.length=0}},_removeAllListenersInVector:function(e){if(e){for(var d,f=0;f<e.length;){d=e[f],d._setRegistered(!1),null!=d._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(d._getSceneGraphPriority(),d),d._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(e,d):++f}}},_removeListenersForListenerID:function(f){var e=this._listenersMap[f];if(e){var h=e.getFixedPriorityListeners(),g=e.getSceneGraphPriorityListeners();this._removeAllListenersInVector(g);this._removeAllListenersInVector(h);delete this._priorityDirtyFlagMap[f];this._inDispatch||(e.clear(),delete this._listenersMap[f])}h=this._toAddedListeners;for(e=0;e<h.length;){(g=h[e])&&g._getListenerID()===f?cc.arrayRemoveObject(h,g):++e}},_sortEventListeners:function(e){var d=this.DIRTY_NONE,f=this._priorityDirtyFlagMap;f[e]&&(d=f[e]);d!==this.DIRTY_NONE&&(f[e]=this.DIRTY_NONE,d&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(e),d&this.DIRTY_SCENE_GRAPH_PRIORITY&&((d=cc.director.getRunningScene())?this._sortListenersOfSceneGraphPriority(e,d):f[e]=this.DIRTY_SCENE_GRAPH_PRIORITY))},_sortListenersOfSceneGraphPriority:function(f,e){var h=this._getListeners(f);if(h){var g=h.getSceneGraphPriorityListeners();g&&0!==g.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(e,!0),h.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(g,f){var k=cc.eventManager._nodePriorityMap,j=g._getSceneGraphPriority(),h=f._getSceneGraphPriority();return g&&f&&j&&h&&k[j.__instanceId]&&k[h.__instanceId]?k[f._getSceneGraphPriority().__instanceId]-k[g._getSceneGraphPriority().__instanceId]:-1},_sortListenersOfFixedPriority:function(f){if(f=this._listenersMap[f]){var e=f.getFixedPriorityListeners();if(e&&0!==e.length){e.sort(this._sortListenersOfFixedPriorityAsc);for(var h=0,g=e.length;h<g&&!(0<=e[h]._getFixedPriority());){++h}f.gt0Index=h}}},_sortListenersOfFixedPriorityAsc:function(d,c){return d._getFixedPriority()-c._getFixedPriority()},_onUpdateListeners:function(g){if(g=this._listenersMap[g]){var f=g.getFixedPriorityListeners(),k=g.getSceneGraphPriorityListeners(),j,h;if(k){for(j=0;j<k.length;){h=k[j],h._isRegistered()?++j:cc.arrayRemoveObject(k,h)}}if(f){for(j=0;j<f.length;){h=f[j],h._isRegistered()?++j:cc.arrayRemoveObject(f,h)}}k&&0===k.length&&g.clearSceneGraphListeners();f&&0===f.length&&g.clearFixedListeners()}},_updateListeners:function(e){var d=this._inDispatch;cc.assert(0<d,cc._LogInfos.EventManager__updateListeners);if(!(1<d)){e.getType()===cc.Event.TOUCH?(this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID)):this._onUpdateListeners(cc.__getListenerID(e));cc.assert(1===d,cc._LogInfos.EventManager__updateListeners_2);e=this._listenersMap;var d=this._priorityDirtyFlagMap,f;for(f in e){e[f].empty()&&(delete d[f],delete e[f])}f=this._toAddedListeners;if(0!==f.length){e=0;for(d=f.length;e<d;e++){this._forceAddEventListener(f[e])}this._toAddedListeners.length=0}}},_onTouchEventCallback:function(k,j){if(!k._isRegistered){return !1}var s=j.event,r=j.selTouch;s._setCurrentTarget(k._node);var p=!1,o,n=s.getEventCode(),m=cc.EventTouch.EventCode;if(n===m.BEGAN){k.onTouchBegan&&(p=k.onTouchBegan(r,s))&&k._registered&&k._claimedTouches.push(r)}else{if(0<k._claimedTouches.length&&-1!==(o=k._claimedTouches.indexOf(r))){if(p=!0,n===m.MOVED&&k.onTouchMoved){k.onTouchMoved(r,s)}else{if(n===m.ENDED){if(k.onTouchEnded){k.onTouchEnded(r,s)}k._registered&&k._claimedTouches.splice(o,1)}else{if(n===m.CANCELLED){if(k.onTouchCancelled){k.onTouchCancelled(r,s)}k._registered&&k._claimedTouches.splice(o,1)}}}}}return s.isStopped()?(cc.eventManager._updateListeners(s),!0):p&&k._registered&&k.swallowTouches?(j.needsMutableSet&&j.touches.splice(r,1),!0):!1},_dispatchTouchEvent:function(j){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var h=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),p=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);if(null!==h||null!==p){var o=j.getTouches(),n=cc.copyArray(o),m={event:j,needsMutableSet:h&&p,touches:n,selTouch:null};if(h){for(var k=0;k<o.length;k++){if(m.selTouch=o[k],this._dispatchEventToListeners(h,this._onTouchEventCallback,m),j.isStopped()){return}}}if(p&&0<n.length&&(this._dispatchEventToListeners(p,this._onTouchesEventCallback,{event:j,touches:n}),j.isStopped())){return}this._updateListeners(j)}},_onTouchesEventCallback:function(h,g){if(!h._registered){return !1}var n=cc.EventTouch.EventCode,m=g.event,k=g.touches,j=m.getEventCode();m._setCurrentTarget(h._node);if(j===n.BEGAN&&h.onTouchesBegan){h.onTouchesBegan(k,m)}else{if(j===n.MOVED&&h.onTouchesMoved){h.onTouchesMoved(k,m)}else{if(j===n.ENDED&&h.onTouchesEnded){h.onTouchesEnded(k,m)}else{if(j===n.CANCELLED&&h.onTouchesCancelled){h.onTouchesCancelled(k,m)}}}}return m.isStopped()?(cc.eventManager._updateListeners(m),!0):!1},_associateNodeAndEventListener:function(e,d){var f=this._nodeListenersMap[e.__instanceId];f||(f=[],this._nodeListenersMap[e.__instanceId]=f);f.push(d)},_dissociateNodeAndEventListener:function(e,d){var f=this._nodeListenersMap[e.__instanceId];f&&(cc.arrayRemoveObject(f,d),0===f.length&&delete this._nodeListenersMap[e.__instanceId])},_dispatchEventToListeners:function(k,j,s){var r=!1,p=k.getFixedPriorityListeners(),o=k.getSceneGraphPriorityListeners(),n=0,m;if(p&&0!==p.length){for(;n<k.gt0Index;++n){if(m=p[n],m.isEnabled()&&!m._isPaused()&&m._isRegistered()&&j(m,s)){r=!0;break}}}if(o&&!r){for(k=0;k<o.length;k++){if(m=o[k],m.isEnabled()&&!m._isPaused()&&m._isRegistered()&&j(m,s)){r=!0;break}}}if(p&&!r){for(;n<p.length&&(m=p[n],!m.isEnabled()||m._isPaused()||!m._isRegistered()||!j(m,s));++n){}}},_setDirty:function(e,d){var f=this._priorityDirtyFlagMap;f[e]=null==f[e]?d:d|f[e]},_visitTarget:function(u,t){var s=u.getChildren(),r=0,p=s.length,o=this._globalZOrderNodeMap,n=this._nodeListenersMap;if(0<p){for(var m;r<p;r++){if((m=s[r])&&0>m.getLocalZOrder()){this._visitTarget(m,!1)}else{break}}null!=n[u.__instanceId]&&(o[u.getGlobalZOrder()]||(o[u.getGlobalZOrder()]=[]),o[u.getGlobalZOrder()].push(u.__instanceId));for(;r<p;r++){(m=s[r])&&this._visitTarget(m,!1)}}else{null!=n[u.__instanceId]&&(o[u.getGlobalZOrder()]||(o[u.getGlobalZOrder()]=[]),o[u.getGlobalZOrder()].push(u.__instanceId))}if(t){var s=[],j;for(j in o){s.push(j)}s.sort(this._sortNumberAsc);j=s.length;m=this._nodePriorityMap;for(r=0;r<j;r++){for(p=o[s[r]],n=0;n<p.length;n++){m[p[n]]=++this._nodePriorityIndex}}this._globalZOrderNodeMap={}}},_sortNumberAsc:function(d,c){return d-c},addListener:function(d,c){cc.assert(d&&c,cc._LogInfos.eventManager_addListener_2);if(!(d instanceof cc.EventListener)){cc.assert(!cc.isNumber(c),cc._LogInfos.eventManager_addListener_3),d=cc.EventListener.create(d)}else{if(d._isRegistered()){cc.log(cc._LogInfos.eventManager_addListener_4);return}}if(d.checkAvailable()){if(cc.isNumber(c)){if(0===c){cc.log(cc._LogInfos.eventManager_addListener);return}d._setSceneGraphPriority(null);d._setFixedPriority(c);d._setRegistered(!0);d._setPaused(!1)}else{d._setSceneGraphPriority(c),d._setFixedPriority(0),d._setRegistered(!0)}this._addListener(d);return d}},addCustomListener:function(e,d){var f=new cc._EventListenerCustom(e,d);this.addListener(f,1);return f},removeListener:function(h){if(null!=h){var g,n=this._listenersMap,m;for(m in n){var k=n[m],j=k.getFixedPriorityListeners();g=k.getSceneGraphPriorityListeners();(g=this._removeListenerInVector(g,h))?this._setDirty(h._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(g=this._removeListenerInVector(j,h))&&this._setDirty(h._getListenerID(),this.DIRTY_FIXED_PRIORITY);k.empty()&&(delete this._priorityDirtyFlagMap[h._getListenerID()],delete n[m]);if(g){break}}if(!g){for(n=this._toAddedListeners,m=0,k=n.length;m<k;m++){if(j=n[m],j===h){cc.arrayRemoveObject(n,j);j._setRegistered(!1);break}}}}},_removeListenerInVector:function(g,f){if(null==g){return !1}for(var k=0,j=g.length;k<j;k++){var h=g[k];if(h===f){return h._setRegistered(!1),null!=h._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(h._getSceneGraphPriority(),h),h._setSceneGraphPriority(null)),0===this._inDispatch&&cc.arrayRemoveObject(g,h),!0}}return !1},removeListeners:function(g,f){if(g instanceof cc.Node){delete this._nodePriorityMap[g.__instanceId];cc.arrayRemoveObject(this._dirtyNodes,g);var k=this._nodeListenersMap[g.__instanceId];if(k){for(var j=cc.copyArray(k),k=0;k<j.length;k++){this.removeListener(j[k])}j.length=0}j=this._toAddedListeners;for(k=0;k<j.length;){var h=j[k];h._getSceneGraphPriority()===g?(h._setSceneGraphPriority(null),h._setRegistered(!1),j.splice(k,1)):++k}if(!0===f){for(j=g.getChildren(),k=0,h=j.length;k<h;k++){this.removeListeners(j[k],!0)}}}else{g===cc.EventListener.TOUCH_ONE_BY_ONE?this._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):g===cc.EventListener.TOUCH_ALL_AT_ONCE?this._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):g===cc.EventListener.MOUSE?this._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):g===cc.EventListener.ACCELERATION?this._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):g===cc.EventListener.KEYBOARD?this._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):cc.log(cc._LogInfos.eventManager_removeListeners)}},removeCustomListeners:function(b){this._removeListenersForListenerID(b)},removeAllListeners:function(){var e=this._listenersMap,d=this._internalCustomListenerIDs,f;for(f in e){-1===d.indexOf(f)&&this._removeListenersForListenerID(f)}},setPriority:function(g,f){if(null!=g){var k=this._listenersMap,j;for(j in k){var h=k[j].getFixedPriorityListeners();if(h&&-1!==h.indexOf(g)){null!=g._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority);g._getFixedPriority()!==f&&(g._setFixedPriority(f),this._setDirty(g._getListenerID(),this.DIRTY_FIXED_PRIORITY));break}}}},setEnabled:function(b){this._isEnabled=b},isEnabled:function(){return this._isEnabled},dispatchEvent:function(d){if(this._isEnabled){this._updateDirtyFlagForSceneGraph();this._inDispatch++;if(!d||!d.getType){throw"event is undefined"}if(d.getType()===cc.Event.TOUCH){this._dispatchTouchEvent(d)}else{var c=cc.__getListenerID(d);this._sortEventListeners(c);c=this._listenersMap[c];null!=c&&this._dispatchEventToListeners(c,this._onListenerCallback,d);this._updateListeners(d)}this._inDispatch--}},_onListenerCallback:function(d,c){c._setCurrentTarget(d._getSceneGraphPriority());d._onEvent(c);return c.isStopped()},dispatchCustomEvent:function(e,d){var f=new cc.EventCustom(e);f.setUserData(d);this.dispatchEvent(f)}};cc.EventHelper=function(){};cc.EventHelper.prototype={constructor:cc.EventHelper,apply:function(b){b.addEventListener=cc.EventHelper.prototype.addEventListener;b.hasEventListener=cc.EventHelper.prototype.hasEventListener;b.removeEventListener=cc.EventHelper.prototype.removeEventListener;b.dispatchEvent=cc.EventHelper.prototype.dispatchEvent},addEventListener:function(f,e,h){if("load"===f&&this._textureLoaded){setTimeout(function(){e.call(h)},0)}else{void 0===this._listeners&&(this._listeners={});var g=this._listeners;void 0===g[f]&&(g[f]=[]);this.hasEventListener(f,e,h)||g[f].push({callback:e,eventTarget:h})}},hasEventListener:function(h,g,n){if(void 0===this._listeners){return !1}var m=this._listeners;if(void 0!==m[h]){h=0;for(var k=m.length;h<k;h++){var j=m[h];if(j.callback===g&&j.eventTarget===n){return !0}}}return !1},removeEventListener:function(f,e){if(void 0!==this._listeners){var h=this._listeners[f];if(void 0!==h){for(var g=0;g<h.length;){h[g].eventTarget===e?h.splice(g,1):g++}}}},dispatchEvent:function(h,g){if(void 0!==this._listeners){null==g&&(g=!0);var n=this._listeners[h];if(void 0!==n){for(var m=[],k=n.length,j=0;j<k;j++){m[j]=n[j]}for(j=0;j<k;j++){m[j].callback.call(m[j].eventTarget,this)}g&&(n.length=0)}}}};cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(b){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION);this._acc=b}});cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(d,c){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD);this._keyCode=d;this._isPressed=c}});cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(d){this._onAccelerationEvent=d;var c=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,function(b){c._onAccelerationEvent(b._acc,b)})},checkAvailable:function(){cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable);return !0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}});cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration";cc._EventListenerAcceleration.create=function(b){return new cc._EventListenerAcceleration(b)};cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var b=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,function(a){if(a._isPressed){if(b.onKeyPressed){b.onKeyPressed(a._keyCode,a)}}else{if(b.onKeyReleased){b.onKeyReleased(a._keyCode,a)}}})},clone:function(){var b=new cc._EventListenerKeyboard;b.onKeyPressed=this.onKeyPressed;b.onKeyReleased=this.onKeyReleased;return b},checkAvailable:function(){return null===this.onKeyPressed&&null===this.onKeyReleased?(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1):!0}});cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard";cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard};cc.rendererCanvas={childrenOrderDirty:!0,_transformNodePool:[],_renderCmds:[],_isCacheToCanvasOn:!1,_cacheToCanvasCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(b){return b._createRenderCmd()},rendering:function(h){var g=this._renderCmds,n,m=cc.view.getScaleX(),k=cc.view.getScaleY(),j=h||cc._renderContext;j.computeRealOffsetY();h=0;for(n=g.length;h<n;h++){g[h].rendering(j,m,k)}},_renderingToCacheCanvas:function(j,h,p,o){j||cc.log("The context of RenderTexture is invalid.");p=cc.isUndefined(p)?1:p;o=cc.isUndefined(o)?1:o;h=h||this._currentID;var n=this._cacheToCanvasCmds[h],m,k;j.computeRealOffsetY();m=0;for(k=n.length;m<k;m++){n[m].rendering(j,p,o)}n.length=0;j=this._cacheInstanceIds;delete this._cacheToCanvasCmds[h];cc.arrayRemoveObject(j,h);0===j.length?this._isCacheToCanvasOn=!1:this._currentID=j[j.length-1]},_turnToCacheMode:function(b){this._isCacheToCanvasOn=!0;b=b||0;this._cacheToCanvasCmds[b]=[];-1===this._cacheInstanceIds.indexOf(b)&&this._cacheInstanceIds.push(b);this._currentID=b},_turnToNormalMode:function(){this._isCacheToCanvasOn=!1},resetFlag:function(){this.childrenOrderDirty=!1;this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);for(var d=0,f=e.length;d<f;d++){0!==e[d]._dirtyFlag&&e[d].updateStatus()}e.length=0},transformDirty:function(){return 0<this._transformNodePool.length},_sortNodeByLevelAsc:function(d,c){return d._curLevel-c._curLevel},pushDirtyNode:function(b){this._transformNodePool.push(b)},clearRenderCommands:function(){this._renderCmds.length=0},pushRenderCommand:function(d){if(d._needDraw){if(this._isCacheToCanvasOn){var c=this._cacheToCanvasCmds[this._currentID];-1===c.indexOf(d)&&c.push(d)}else{-1===this._renderCmds.indexOf(d)&&this._renderCmds.push(d)}}}};cc._renderType===cc._RENDER_TYPE_CANVAS&&(cc.renderer=cc.rendererCanvas);(function(){cc.CanvasContextWrapper=function(c){this._context=c;this._saveCount=0;this._currentAlpha=c.globalAlpha;this._currentCompositeOperation=c.globalCompositeOperation;this._currentFillStyle=c.fillStyle;this._currentStrokeStyle=c.strokeStyle;this._offsetY=this._offsetX=0;this._realOffsetY=this.height;this._armatureMode=0};var b=cc.CanvasContextWrapper.prototype;b.resetCache=function(){var c=this._context;this._currentAlpha=c.globalAlpha;this._currentCompositeOperation=c.globalCompositeOperation;this._currentFillStyle=c.fillStyle;this._currentStrokeStyle=c.strokeStyle;this._realOffsetY=this._context.canvas.height+this._offsetY};b.setOffset=function(d,e){this._offsetX=d;this._offsetY=e;this._realOffsetY=this._context.canvas.height+this._offsetY};b.computeRealOffsetY=function(){this._realOffsetY=this._context.canvas.height+this._offsetY};b.setViewScale=function(d,e){this._scaleX=d;this._scaleY=e};b.getContext=function(){return this._context};b.save=function(){this._context.save();this._saveCount++};b.restore=function(){this._context.restore();this._saveCount--};b.setGlobalAlpha=function(c){0<this._saveCount?this._context.globalAlpha=c:this._currentAlpha!==c&&(this._currentAlpha=c,this._context.globalAlpha=c)};b.setCompositeOperation=function(c){0<this._saveCount?this._context.globalCompositeOperation=c:this._currentCompositeOperation!==c&&(this._currentCompositeOperation=c,this._context.globalCompositeOperation=c)};b.setFillStyle=function(c){0<this._saveCount?this._context.fillStyle=c:this._currentFillStyle!==c&&(this._currentFillStyle=c,this._context.fillStyle=c)};b.setStrokeStyle=function(c){0<this._saveCount?this._context.strokeStyle=c:this._currentStrokeStyle!==c&&(this._currentStrokeStyle=c,this._context.strokeStyle=c)};b.setTransform=function(e,g,f){0<this._armatureMode?(this.restore(),this.save(),this._context.transform(e.a,-e.b,-e.c,e.d,e.tx*g,-(e.ty*f))):this._context.setTransform(e.a,-e.b,-e.c,e.d,this._offsetX+e.tx*g,this._realOffsetY-e.ty*f)};b._switchToArmatureMode=function(f,j,h,g){f?(this._armatureMode++,this._context.setTransform(j.a,j.c,j.b,j.d,this._offsetX+j.tx*h,this._realOffsetY-j.ty*g),this.save()):(this._armatureMode--,this.restore())}})();cc.rendererWebGL={childrenOrderDirty:!0,_transformNodePool:[],_renderCmds:[],_isCacheToBufferOn:!1,_cacheToBufferCmds:{},_cacheInstanceIds:[],_currentID:0,getRenderCmd:function(b){return b._createRenderCmd()},rendering:function(f){var e=this._renderCmds,h,g=f||cc._renderContext;f=0;for(h=e.length;f<h;f++){e[f].rendering(g)}},_turnToCacheMode:function(b){this._isCacheToBufferOn=!0;b=b||0;this._cacheToBufferCmds[b]=[];this._cacheInstanceIds.push(b);this._currentID=b},_turnToNormalMode:function(){this._isCacheToBufferOn=!1},_renderingToBuffer:function(h){h=h||this._currentID;var g=this._cacheToBufferCmds[h],n,m,k=cc._renderContext,j=this._cacheInstanceIds;n=0;for(m=g.length;n<m;n++){g[n].rendering(k)}g.length=0;delete this._cacheToBufferCmds[h];cc.arrayRemoveObject(j,h);0===j.length?this._isCacheToBufferOn=!1:this._currentID=j[j.length-1]},resetFlag:function(){this.childrenOrderDirty=!1;this._transformNodePool.length=0},transform:function(){var e=this._transformNodePool;e.sort(this._sortNodeByLevelAsc);for(var d=0,f=e.length;d<f;d++){e[d].updateStatus()}e.length=0},transformDirty:function(){return 0<this._transformNodePool.length},_sortNodeByLevelAsc:function(d,c){return d._curLevel-c._curLevel},pushDirtyNode:function(b){this._transformNodePool.push(b)},clearRenderCommands:function(){this._renderCmds.length=0},pushRenderCommand:function(d){if(d._needDraw){if(this._isCacheToBufferOn){var c=this._cacheToBufferCmds[this._currentID];-1===c.indexOf(d)&&c.push(d)}else{-1===this._renderCmds.indexOf(d)&&this._renderCmds.push(d)}}}};cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.renderer=cc.rendererWebGL);cc._tmp.PrototypeCCNode=function(){var b=cc.Node.prototype;cc.defineGetterSetter(b,"x",b.getPositionX,b.setPositionX);cc.defineGetterSetter(b,"y",b.getPositionY,b.setPositionY);cc.defineGetterSetter(b,"width",b._getWidth,b._setWidth);cc.defineGetterSetter(b,"height",b._getHeight,b._setHeight);cc.defineGetterSetter(b,"anchorX",b._getAnchorX,b._setAnchorX);cc.defineGetterSetter(b,"anchorY",b._getAnchorY,b._setAnchorY);cc.defineGetterSetter(b,"skewX",b.getSkewX,b.setSkewX);cc.defineGetterSetter(b,"skewY",b.getSkewY,b.setSkewY);cc.defineGetterSetter(b,"zIndex",b.getLocalZOrder,b.setLocalZOrder);cc.defineGetterSetter(b,"vertexZ",b.getVertexZ,b.setVertexZ);cc.defineGetterSetter(b,"rotation",b.getRotation,b.setRotation);cc.defineGetterSetter(b,"rotationX",b.getRotationX,b.setRotationX);cc.defineGetterSetter(b,"rotationY",b.getRotationY,b.setRotationY);cc.defineGetterSetter(b,"scale",b.getScale,b.setScale);cc.defineGetterSetter(b,"scaleX",b.getScaleX,b.setScaleX);cc.defineGetterSetter(b,"scaleY",b.getScaleY,b.setScaleY);cc.defineGetterSetter(b,"children",b.getChildren);cc.defineGetterSetter(b,"childrenCount",b.getChildrenCount);cc.defineGetterSetter(b,"parent",b.getParent,b.setParent);cc.defineGetterSetter(b,"visible",b.isVisible,b.setVisible);cc.defineGetterSetter(b,"running",b.isRunning);cc.defineGetterSetter(b,"ignoreAnchor",b.isIgnoreAnchorPointForPosition,b.ignoreAnchorPointForPosition);cc.defineGetterSetter(b,"actionManager",b.getActionManager,b.setActionManager);cc.defineGetterSetter(b,"scheduler",b.getScheduler,b.setScheduler);cc.defineGetterSetter(b,"shaderProgram",b.getShaderProgram,b.setShaderProgram);cc.defineGetterSetter(b,"opacity",b.getOpacity,b.setOpacity);cc.defineGetterSetter(b,"opacityModifyRGB",b.isOpacityModifyRGB);cc.defineGetterSetter(b,"cascadeOpacity",b.isCascadeOpacityEnabled,b.setCascadeOpacityEnabled);cc.defineGetterSetter(b,"color",b.getColor,b.setColor);cc.defineGetterSetter(b,"cascadeColor",b.isCascadeColorEnabled,b.setCascadeColorEnabled)};cc.NODE_TAG_INVALID=-1;cc.s_globalOrderOfArrival=1;cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_normalizedPosition:null,_usingNormalizedPosition:!1,_normalizedPositionDirty:!1,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_reorderChildDirty:!1,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_className:"Node",_showNode:!1,_name:"",_realOpacity:255,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_renderCmd:null,_camera:null,ctor:function(){this._initNode();this._initRendererCmd()},_initNode:function(){this._anchorPoint=cc.p(0,0);this._contentSize=cc.size(0,0);this._position=cc.p(0,0);this._normalizedPosition=cc.p(0,0);this._children=[];var b=cc.director;this._actionManager=b.getActionManager();this._scheduler=b.getScheduler();this._additionalTransform=cc.affineTransformMakeIdentity();cc.ComponentContainer&&(this._componentContainer=new cc.ComponentContainer(this));this._realOpacity=255;this._realColor=cc.color(255,255,255,255);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!1},init:function(){return !0},_arrayMakeObjectsPerformSelector:function(g,f){if(g&&0!==g.length){var k,j=g.length,h;k=cc.Node._stateCallbackType;switch(f){case k.onEnter:for(k=0;k<j;k++){if(h=g[k]){h.onEnter()}}break;case k.onExit:for(k=0;k<j;k++){if(h=g[k]){h.onExit()}}break;case k.onEnterTransitionDidFinish:for(k=0;k<j;k++){if(h=g[k]){h.onEnterTransitionDidFinish()}}break;case k.cleanup:for(k=0;k<j;k++){(h=g[k])&&h.cleanup()}break;case k.updateTransform:for(k=0;k<j;k++){(h=g[k])&&h.updateTransform()}break;case k.onExitTransitionDidStart:for(k=0;k<j;k++){if(h=g[k]){h.onExitTransitionDidStart()}}break;case k.sortAllChildren:for(k=0;k<j;k++){(h=g[k])&&h.sortAllChildren()}break;default:cc.assert(0,cc._LogInfos.Node__arrayMakeObjectsPerformSelector)}}},attr:function(d){for(var c in d){this[c]=d[c]}},getSkewX:function(){return this._skewX},setSkewX:function(b){this._skewX=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getSkewY:function(){return this._skewY},setSkewY:function(b){this._skewY=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setLocalZOrder:function(b){this._localZOrder=b;this._parent&&this._parent.reorderChild(this,b);cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(b){this._localZOrder=b},getLocalZOrder:function(){return this._localZOrder},getZOrder:function(){cc.log(cc._LogInfos.Node_getZOrder);return this.getLocalZOrder()},setZOrder:function(b){cc.log(cc._LogInfos.Node_setZOrder);this.setLocalZOrder(b)},setGlobalZOrder:function(b){this._globalZOrder!==b&&(this._globalZOrder=b,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(b){this._vertexZ=b},getRotation:function(){this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation);return this._rotationX},setRotation:function(b){this._rotationX=this._rotationY=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationX:function(){return this._rotationX},setRotationX:function(b){this._rotationX=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getRotationY:function(){return this._rotationY},setRotationY:function(b){this._rotationY=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScale:function(){this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale);return this._scaleX},setScale:function(d,c){this._scaleX=d;this._scaleY=c||0===c?c:d;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleX:function(){return this._scaleX},setScaleX:function(b){this._scaleX=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getScaleY:function(){return this._scaleY},setScaleY:function(b){this._scaleY=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setPosition:function(e,d){var f=this._position;if(void 0===d){if(f.x===e.x&&f.y===e.y){return}f.x=e.x;f.y=e.y}else{if(f.x===e&&f.y===d){return}f.x=e;f.y=d}this._usingNormalizedPosition=!1;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setNormalizedPosition:function(e,d){var f=this._normalizedPosition;void 0===d?(f.x=e.x,f.y=e.y):(f.x=e,f.y=d);this._normalizedPositionDirty=this._usingNormalizedPosition=!0;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPosition:function(){return cc.p(this._position)},getNormalizedPosition:function(){return cc.p(this._normalizedPosition)},getPositionX:function(){return this._position.x},setPositionX:function(b){this._position.x=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getPositionY:function(){return this._position.y},setPositionY:function(b){this._position.y=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(b){this._visible!==b&&(this._visible=b,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0)},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(e,d){var f=this._anchorPoint;if(void 0===d){if(e.x===f.x&&e.y===f.y){return}f.x=e.x;f.y=e.y}else{if(e===f.x&&d===f.y){return}f.x=e;f.y=d}this._renderCmd._updateAnchorPointInPoint()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(b){this._anchorPoint.x!==b&&(this._anchorPoint.x=b,this._renderCmd._updateAnchorPointInPoint())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(b){this._anchorPoint.y!==b&&(this._anchorPoint.y=b,this._renderCmd._updateAnchorPointInPoint())},getAnchorPointInPoints:function(){return this._renderCmd.getAnchorPointInPoints()},_getWidth:function(){return this._contentSize.width},_setWidth:function(b){this._contentSize.width=b;this._renderCmd._updateAnchorPointInPoint()},_getHeight:function(){return this._contentSize.height},_setHeight:function(b){this._contentSize.height=b;this._renderCmd._updateAnchorPointInPoint()},getContentSize:function(){return cc.size(this._contentSize)},setContentSize:function(e,d){var f=this._contentSize;if(void 0===d){if(e.width===f.width&&e.height===f.height){return}f.width=e.width;f.height=e.height}else{if(e===f.width&&d===f.height){return}f.width=e;f.height=d}this._renderCmd._updateAnchorPointInPoint()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(b){this._parent=b},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(b){b!==this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=b,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},getTag:function(){return this.tag},setTag:function(b){this.tag=b},setName:function(b){this._name=b},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(b){this.userData=b},getUserObject:function(){return this.userObject},setUserObject:function(b){this.userObject!==b&&(this.userObject=b)},getOrderOfArrival:function(){return this.arrivalOrder},setOrderOfArrival:function(b){this.arrivalOrder=b},getActionManager:function(){this._actionManager||(this._actionManager=cc.director.getActionManager());return this._actionManager},setActionManager:function(b){this._actionManager!==b&&(this.stopAllActions(),this._actionManager=b)},getScheduler:function(){this._scheduler||(this._scheduler=cc.director.getScheduler());return this._scheduler},setScheduler:function(b){this._scheduler!==b&&(this.unscheduleAllCallbacks(),this._scheduler=b)},boundingBox:function(){cc.log(cc._LogInfos.Node_boundingBox);return this.getBoundingBox()},getBoundingBox:function(){var b=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(b,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions();this.unscheduleAllCallbacks();cc.eventManager.removeListeners(this);this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.cleanup)},getChildByTag:function(f){var e=this._children;if(null!==e){for(var h=0;h<e.length;h++){var g=e[h];if(g&&g.tag===f){return g}}}return null},getChildByName:function(f){if(!f){return cc.log("Invalid name"),null}for(var e=this._children,h=0,g=e.length;h<g;h++){if(e[h]._name===f){return e[h]}}return null},addChild:function(g,f,k){f=void 0===f?g._localZOrder:f;var j,h=!1;cc.isUndefined(k)?(k=void 0,j=g._name):cc.isString(k)?(j=k,k=void 0):cc.isNumber(k)&&(h=!0,j="");cc.assert(g,cc._LogInfos.Node_addChild_3);cc.assert(null===g._parent,"child already added. It can't be added again");this._addChildHelper(g,f,k,j,h)},_addChildHelper:function(g,f,k,j,h){this._children||(this._children=[]);this._insertChild(g,f);h?g.setTag(k):g.setName(j);g.setParent(this);g.setOrderOfArrival(cc.s_globalOrderOfArrival++);if(this._running&&(g.onEnter(),this._isTransitionFinished)){g.onEnterTransitionDidFinish()}this._cascadeColorEnabled&&g._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);this._cascadeOpacityEnabled&&g._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},removeFromParent:function(b){this._parent&&(void 0===b&&(b=!0),this._parent.removeChild(this,b))},removeFromParentAndCleanup:function(b){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup);this.removeFromParent(b)},removeChild:function(d,c){0!==this._children.length&&(void 0===c&&(c=!0),-1<this._children.indexOf(d)&&this._detachChild(d,c),cc.renderer.childrenOrderDirty=!0)},removeChildByTag:function(e,d){e===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);var f=this.getChildByTag(e);f?this.removeChild(f,d):cc.log(cc._LogInfos.Node_removeChildByTag_2,e)},removeAllChildrenWithCleanup:function(b){this.removeAllChildren(b)},removeAllChildren:function(f){var e=this._children;if(null!==e){void 0===f&&(f=!0);for(var h=0;h<e.length;h++){var g=e[h];g&&(this._running&&(g.onExitTransitionDidStart(),g.onExit()),f&&g.cleanup(),g.parent=null,g._renderCmd.detachFromParent())}this._children.length=0;cc.renderer.childrenOrderDirty=!0}},_detachChild:function(d,c){this._running&&(d.onExitTransitionDidStart(),d.onExit());c&&d.cleanup();d.parent=null;d._renderCmd.detachFromParent();cc.arrayRemoveObject(this._children,d)},_insertChild:function(d,c){cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0;this._children.push(d);d._setLocalZOrder(c)},setNodeDirty:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},reorderChild:function(d,c){cc.assert(d,cc._LogInfos.Node_reorderChild);cc.renderer.childrenOrderDirty=this._reorderChildDirty=!0;d.arrivalOrder=cc.s_globalOrderOfArrival;cc.s_globalOrderOfArrival++;d._setLocalZOrder(c)},sortAllChildren:function(){if(this._reorderChildDirty){var g=this._children,f=g.length,k,j,h;for(k=1;k<f;k++){h=g[k];for(j=k-1;0<=j;){if(h._localZOrder<g[j]._localZOrder){g[j+1]=g[j]}else{if(h._localZOrder===g[j]._localZOrder&&h.arrivalOrder<g[j].arrivalOrder){g[j+1]=g[j]}else{break}}j--}g[j+1]=h}this._reorderChildDirty=!1}},draw:function(b){},transformAncestors:function(){null!==this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1;this._running=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnter);this.resume()},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExitTransitionDidStart)},onExit:function(){this._running=!1;this.pause();this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.onExit);this.removeAllComponents()},runAction:function(b){cc.assert(b,cc._LogInfos.Node_runAction);this.actionManager.addAction(b,this,!this._running);return b},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(b){this.actionManager.removeAction(b)},stopActionByTag:function(b){b===cc.ACTION_TAG_INVALID?cc.log(cc._LogInfos.Node_stopActionByTag):this.actionManager.removeActionByTag(b,this)},getActionByTag:function(b){return b===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(b,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(b){this.scheduler.scheduleUpdate(this,b,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdate(this)},schedule:function(h,g,n,m,k){var j=arguments.length;"function"===typeof h?1===j?(g=0,n=cc.REPEAT_FOREVER,m=0,k=this.__instanceId):2===j?"number"===typeof g?(n=cc.REPEAT_FOREVER,m=0,k=this.__instanceId):(k=g,g=0,n=cc.REPEAT_FOREVER,m=0):3===j?("string"===typeof n?(k=n,n=cc.REPEAT_FOREVER):k=this.__instanceId,m=0):4===j&&(k=this.__instanceId):1===j?(g=0,n=cc.REPEAT_FOREVER,m=0):2===j&&(n=cc.REPEAT_FOREVER,m=0);cc.assert(h,cc._LogInfos.Node_schedule);cc.assert(0<=g,cc._LogInfos.Node_schedule_2);n=null==n?cc.REPEAT_FOREVER:n;this.scheduler.schedule(h,this,g||0,n,m||0,!this._running,k)},scheduleOnce:function(e,d,f){void 0===f&&(f=this.__instanceId);this.schedule(e,0,0,d,f)},unschedule:function(b){b&&this.scheduler.unschedule(b,this)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllForTarget(this)},resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions);this.resume()},resume:function(){this.scheduler.resumeTarget(this);this.actionManager&&this.actionManager.resumeTarget(this);cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions);this.pause()},pause:function(){this.scheduler.pauseTarget(this);this.actionManager&&this.actionManager.pauseTarget(this);cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(b){if(void 0===b){return this._additionalTransformDirty=!1}this._additionalTransform=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty);this._additionalTransformDirty=!0},getParentToNodeTransform:function(){this._renderCmd.getParentToNodeTransform()},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var d=this.getNodeToParentTransform(),c=this._parent;null!==c;c=c.parent){d=cc.affineTransformConcat(d,c.getNodeToParentTransform())}return d},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(b){return cc.pointApplyAffineTransform(b,this.getWorldToNodeTransform())},convertToWorldSpace:function(b){b=b||cc.p(0,0);return cc.pointApplyAffineTransform(b,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(b){return cc.pSub(this.convertToNodeSpace(b),this._renderCmd.getAnchorPointInPoints())},convertToWorldSpaceAR:function(b){b=b||cc.p(0,0);b=cc.pAdd(b,this._renderCmd.getAnchorPointInPoints());return this.convertToWorldSpace(b)},_convertToWindowSpace:function(b){b=this.convertToWorldSpace(b);return cc.director.convertToUI(b)},convertTouchToNodeSpace:function(b){b=b.getLocation();return this.convertToNodeSpace(b)},convertTouchToNodeSpaceAR:function(b){b=cc.director.convertToGL(b.getLocation());return this.convertToNodeSpaceAR(b)},update:function(b){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(b)},updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._stateCallbackType.updateTransform)},retain:function(){},release:function(){},getComponent:function(b){return this._componentContainer?this._componentContainer.getComponent(b):null},addComponent:function(b){this._componentContainer&&this._componentContainer.add(b)},removeComponent:function(b){return this._componentContainer?this._componentContainer.remove(b):!1},removeAllComponents:function(){this._componentContainer&&this._componentContainer.removeAll()},grid:null,visit:function(b){this._renderCmd.visit(b)},transform:function(d,c){this._renderCmd.transform(d,c)},nodeToParentTransform:function(){return this.getNodeToParentTransform()},getNodeToParentTransform:function(){return this._renderCmd.getNodeToParentTransform()},getCamera:function(){this._camera||(this._camera=new cc.Camera);return this._camera},getGrid:function(){return this.grid},setGrid:function(b){this.grid=b},getShaderProgram:function(){return this._renderCmd.getShaderProgram()},setShaderProgram:function(b){this._renderCmd.setShaderProgram(b)},getGLServerState:function(){return 0},setGLServerState:function(b){},getBoundingBoxToWorld:function(){var g=cc.rect(0,0,this._contentSize.width,this._contentSize.height),f=this.getNodeToWorldTransform(),g=cc.rectApplyAffineTransform(g,f);if(!this._children){return g}for(var k=this._children,j=0;j<k.length;j++){var h=k[j];h&&h._visible&&(h=h._getBoundingBoxToCurrentNode(f))&&(g=cc.rectUnion(g,h))}return g},_getBoundingBoxToCurrentNode:function(g){var f=cc.rect(0,0,this._contentSize.width,this._contentSize.height);g=void 0===g?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),g);f=cc.rectApplyAffineTransform(f,g);if(!this._children){return f}for(var k=this._children,j=0;j<k.length;j++){var h=k[j];h&&h._visible&&(h=h._getBoundingBoxToCurrentNode(g))&&(f=cc.rectUnion(f,h))}return f},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._renderCmd.getDisplayedOpacity()},setOpacity:function(b){this._realOpacity=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},updateDisplayedOpacity:function(b){this._renderCmd._updateDisplayOpacity(b)},isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(b){this._cascadeOpacityEnabled!==b&&(this._cascadeOpacityEnabled=b,this._renderCmd.setCascadeOpacityEnabledDirty())},getColor:function(){var b=this._realColor;return cc.color(b.r,b.g,b.b,b.a)},getDisplayedColor:function(){return this._renderCmd.getDisplayedColor()},setColor:function(d){var c=this._realColor;c.r=d.r;c.g=d.g;c.b=d.b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},updateDisplayedColor:function(b){this._renderCmd._updateDisplayColor(b)},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(b){this._cascadeColorEnabled!==b&&(this._cascadeColorEnabled=b,this._renderCmd.setCascadeColorEnabledDirty())},setOpacityModifyRGB:function(b){},isOpacityModifyRGB:function(){return !1},_initRendererCmd:function(){this._renderCmd=cc.renderer.getRenderCmd(this)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Node.CanvasRenderCmd(this):new cc.Node.WebGLRenderCmd(this)},enumerateChildren:function(j,h){cc.assert(j&&0!=j.length,"Invalid name");cc.assert(null!=h,"Invalid callback function");var p=j.length,o=0,n=p,m=!1;2<p&&"/"===j[0]&&"/"===j[1]&&(m=!0,o=2,n-=2);var k=!1;3<p&&"/"===j[p-3]&&"."===j[p-2]&&"."===j[p-1]&&(k=!0,n-=3);p=j.substr(o,n);k&&(p="[[:alnum:]]+/"+p);m?this.doEnumerateRecursive(this,p,h):this.doEnumerate(p,h)},doEnumerateRecursive:function(h,g,n){if(!h.doEnumerate(g,n)){for(var m=h.getChildren(),k=m.length,j=0;j<k&&(h=m[j],!this.doEnumerateRecursive(h,g,n));j++){}}},doEnumerate:function(u,t){var s=u.indexOf("/"),r=u,p=!1;-1!==s&&(r=u.substr(0,s),p=!0);for(var s=!1,o,n=this._children,m=n.length,j=0;j<m;j++){if(o=n[j],-1!==o._name.indexOf(r)){if(p){if(s=o.doEnumerate(u,t)){break}}else{if(t(o)){s=!0;break}}}}return s}});cc.Node.create=function(){return new cc.Node};cc.Node._stateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7};cc.assert(cc.isFunction(cc._tmp.PrototypeCCNode),cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js");cc._tmp.PrototypeCCNode();delete cc._tmp.PrototypeCCNode;cc.CustomRenderCmd=function(d,c){this._needDraw=!0;this._target=d;this._callback=c;this.rendering=function(g,f,h){this._callback&&this._callback.call(this._target,g,f,h)}};cc.Node._dirtyFlags={transformDirty:1,visibleDirty:2,colorDirty:4,opacityDirty:8,cacheDirty:16,orderDirty:32,textDirty:64,gradientDirty:128,all:255};cc.Node.RenderCmd=function(b){this._dirtyFlag=1;this._node=b;this._needDraw=!1;this._anchorPointInPoints=new cc.Point(0,0);this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._inverse={a:1,b:0,c:0,d:1,tx:0,ty:0};this._displayedOpacity=255;this._displayedColor=cc.color(255,255,255,255);this._cascadeOpacityEnabledDirty=this._cascadeColorEnabledDirty=!1;this._curLevel=-1};cc.Node.RenderCmd.prototype={constructor:cc.Node.RenderCmd,getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},getDisplayedColor:function(){var b=this._displayedColor;return cc.color(b.r,b.g,b.b,b.a)},getDisplayedOpacity:function(){return this._displayedOpacity},setCascadeColorEnabledDirty:function(){this._cascadeColorEnabledDirty=!0;this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setCascadeOpacityEnabledDirty:function(){this._cascadeOpacityEnabledDirty=!0;this.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getParentToNodeTransform:function(){this._dirtyFlag&cc.Node._dirtyFlags.transformDirty&&(this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform()));return this._inverse},detachFromParent:function(){},_updateAnchorPointInPoint:function(){var e=this._anchorPointInPoints,d=this._node._contentSize,f=this._node._anchorPoint;e.x=d.width*f.x;e.y=d.height*f.y;this.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},setDirtyFlag:function(b){0===this._dirtyFlag&&0!==b&&cc.renderer.pushDirtyNode(this);this._dirtyFlag|=b},getParentRenderCmd:function(){return this._node&&this._node._parent&&this._node._parent._renderCmd?this._node._parent._renderCmd:null},_updateDisplayColor:function(g){var f=this._node,k=this._displayedColor,j=f._realColor,h;if(this._cascadeColorEnabledDirty&&!f._cascadeColorEnabled){k.r=j.r;k.g=j.g;k.b=j.b;k=new cc.Color(255,255,255,255);g=f._children;f=0;for(j=g.length;f<j;f++){(h=g[f])&&h._renderCmd&&h._renderCmd._updateDisplayColor(k)}this._cascadeColorEnabledDirty=!1}else{if(void 0===g&&(g=(g=f._parent)&&g._cascadeColorEnabled?g.getDisplayedColor():cc.color.WHITE),k.r=0|j.r*g.r/255,k.g=0|j.g*g.g/255,k.b=0|j.b*g.b/255,f._cascadeColorEnabled){for(g=f._children,f=0,j=g.length;f<j;f++){(h=g[f])&&h._renderCmd&&(h._renderCmd._updateDisplayColor(k),h._renderCmd._updateColor())}}}this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.colorDirty},_updateDisplayOpacity:function(f){var e=this._node,h,g;if(this._cascadeOpacityEnabledDirty&&!e._cascadeOpacityEnabled){this._displayedOpacity=e._realOpacity;h=e._children;f=0;for(e=h.length;f<e;f++){(g=h[f])&&g._renderCmd&&g._renderCmd._updateDisplayOpacity(255)}this._cascadeOpacityEnabledDirty=!1}else{if(void 0===f&&(h=e._parent,f=255,h&&h._cascadeOpacityEnabled&&(f=h.getDisplayedOpacity())),this._displayedOpacity=e._realOpacity*f/255,e._cascadeOpacityEnabled){for(h=e._children,f=0,e=h.length;f<e;f++){(g=h[f])&&g._renderCmd&&(g._renderCmd._updateDisplayOpacity(this._displayedOpacity),g._renderCmd._updateColor())}}}this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.opacityDirty},_syncDisplayColor:function(f){var e=this._node,h=this._displayedColor,g=e._realColor;void 0===f&&(f=(f=e._parent)&&f._cascadeColorEnabled?f.getDisplayedColor():cc.color.WHITE);h.r=0|g.r*f.r/255;h.g=0|g.g*f.g/255;h.b=0|g.b*f.b/255},_syncDisplayOpacity:function(e){var d=this._node;if(void 0===e){var f=d._parent;e=255;f&&f._cascadeOpacityEnabled&&(e=f.getDisplayedOpacity())}this._displayedOpacity=d._realOpacity*e/255},_updateColor:function(){},updateStatus:function(){var f=cc.Node._dirtyFlags,e=this._dirtyFlag,h=e&f.colorDirty,g=e&f.opacityDirty;h&&this._updateDisplayColor();g&&this._updateDisplayOpacity();(h||g)&&this._updateColor();e&f.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)}};(function(){cc.Node.CanvasRenderCmd=function(c){cc.Node.RenderCmd.call(this,c);this._cachedParent=null;this._cacheDirty=!1};var b=cc.Node.CanvasRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);b.constructor=cc.Node.CanvasRenderCmd;b.transform=function(g,m){var k=this.getNodeToParentTransform(),j=this._worldTransform;this._cacheDirty=!0;if(g){var h=g._worldTransform;j.a=k.a*h.a+k.b*h.c;j.b=k.a*h.b+k.b*h.d;j.c=k.c*h.a+k.d*h.c;j.d=k.c*h.b+k.d*h.d;j.tx=h.a*k.tx+h.c*k.ty+h.tx;j.ty=h.d*k.ty+h.ty+h.b*k.tx}else{j.a=k.a,j.b=k.b,j.c=k.c,j.d=k.d,j.tx=k.tx,j.ty=k.ty}if(m&&(k=this._node._children)&&0!==k.length){for(j=0,h=k.length;j<h;j++){k[j]._renderCmd.transform(this,m)}}};b.getNodeToParentTransform=function(){var A=this._node,z=!1;A._usingNormalizedPosition&&A._parent&&(z=A._parent._contentSize,A._position.x=A._normalizedPosition.x*z.width,A._position.y=A._normalizedPosition.y*z.height,A._normalizedPositionDirty=!1,z=!0);if(z||this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){z=this._transform;z.tx=A._position.x;z.ty=A._position.y;var y=1,x=0,w=0,v=1;A._rotationX&&(v=0.017453292519943295*A._rotationX,w=Math.sin(v),v=Math.cos(v));A._rotationY&&(x=0.017453292519943295*A._rotationY,y=Math.cos(x),x=-Math.sin(x));z.a=y;z.b=x;z.c=w;z.d=v;var u=A._scaleX,t=A._scaleY,r=this._anchorPointInPoints.x,o=this._anchorPointInPoints.y,j=0.000001>u&&-0.000001<u?0.000001:u,B=0.000001>t&&-0.000001<t?0.000001:t;if(1!==u||1!==t){y=z.a*=j,x=z.b*=j,w=z.c*=B,v=z.d*=B}if(A._skewX||A._skewY){u=Math.tan(-A._skewX*Math.PI/180),t=Math.tan(-A._skewY*Math.PI/180),Infinity===u&&(u=99999999),Infinity===t&&(t=99999999),j=o*u,B=r*t,z.a=y-w*t,z.b=x-v*t,z.c=w-y*u,z.d=v-x*u,z.tx+=y*j+w*B,z.ty+=x*j+v*B}z.tx-=y*r+w*o;z.ty-=x*r+v*o;A._ignoreAnchorPointForPosition&&(z.tx+=r,z.ty+=o);A._additionalTransformDirty&&(this._transform=cc.affineTransformConcat(z,A._additionalTransform))}return this._transform};b.visit=function(f){var j=this._node;if(j._visible){if(f=f||this.getParentRenderCmd()){this._curLevel=f._curLevel+1}var h=j._children,g;this._syncStatus(f);f=h.length;if(0<f){j.sortAllChildren();for(j=0;j<f;j++){if(g=h[j],0>g._localZOrder){g._renderCmd.visit(this)}else{break}}for(cc.renderer.pushRenderCommand(this);j<f;j++){h[j]._renderCmd.visit(this)}}else{cc.renderer.pushRenderCommand(this)}this._dirtyFlag=0}};b._syncStatus=function(g){var m=cc.Node._dirtyFlags,k=this._dirtyFlag,j=g?g._node:null;j&&j._cascadeColorEnabled&&g._dirtyFlag&m.colorDirty&&(k|=m.colorDirty);j&&j._cascadeOpacityEnabled&&g._dirtyFlag&m.opacityDirty&&(k|=m.opacityDirty);g&&g._dirtyFlag&m.transformDirty&&(k|=m.transformDirty);var j=k&m.colorDirty,h=k&m.opacityDirty,m=k&m.transformDirty;this._dirtyFlag=k;j&&this._syncDisplayColor();h&&this._syncDisplayOpacity();j&&this._updateColor();m&&this.transform(g)};b.setDirtyFlag=function(c){cc.Node.RenderCmd.prototype.setDirtyFlag.call(this,c);this._setCacheDirty();this._cachedParent&&this._cachedParent.setDirtyFlag(c)};b._setCacheDirty=function(){if(!1===this._cacheDirty){this._cacheDirty=!0;var c=this._cachedParent;c&&c!==this&&c._setNodeDirtyForCache&&c._setNodeDirtyForCache()}};b._setCachedParent=function(f){if(this._cachedParent!==f){this._cachedParent=f;for(var j=this._node._children,h=0,g=j.length;h<g;h++){j[h]._renderCmd._setCachedParent(f)}}};b.detachFromParent=function(){this._cachedParent=null;for(var f=this._node._children,j,h=0,g=f.length;h<g;h++){(j=f[h])&&j._renderCmd&&j._renderCmd.detachFromParent()}};b.setShaderProgram=function(c){};b.getShaderProgram=function(){return null};cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc=function(c){return c?c.src===cc.SRC_ALPHA&&c.dst===cc.ONE||c.src===cc.ONE&&c.dst===cc.ONE?"lighter":c.src===cc.ZERO&&c.dst===cc.SRC_ALPHA?"destination-in":c.src===cc.ZERO&&c.dst===cc.ONE_MINUS_SRC_ALPHA?"destination-out":"source-over":"source-over"}})();(function(){cc.Node.WebGLRenderCmd=function(d){cc.Node.RenderCmd.call(this,d);d=new cc.math.Matrix4;var e=d.mat;e[2]=e[3]=e[6]=e[7]=e[8]=e[9]=e[11]=e[14]=0;e[10]=e[15]=1;this._transform4x4=d;this._stackMatrix=new cc.math.Matrix4;this._camera=this._shaderProgram=null};var b=cc.Node.WebGLRenderCmd.prototype=Object.create(cc.Node.RenderCmd.prototype);b.constructor=cc.Node.WebGLRenderCmd;b.getNodeToParentTransform=function(){var E=this._node;if(E._usingNormalizedPosition&&E._parent){var D=E._parent._contentSize;E._position.x=E._normalizedPosition.x*D.width;E._position.y=E._normalizedPosition.y*D.height;E._normalizedPositionDirty=!1}if(this._dirtyFlag&cc.Node._dirtyFlags.transformDirty){var D=E._position.x,C=E._position.y,B=this._anchorPointInPoints.x,A=-B,z=this._anchorPointInPoints.y,y=-z,x=E._scaleX,w=E._scaleY,v=0.017453292519943295*E._rotationX,o=0.017453292519943295*E._rotationY;E._ignoreAnchorPointForPosition&&(D+=B,C+=z);var H=1,j=0,F=1,G=0;if(0!==E._rotationX||0!==E._rotationY){H=Math.cos(-v),j=Math.sin(-v),F=Math.cos(-o),G=Math.sin(-o)}v=E._skewX||E._skewY;v||0===B&&0===z||(D+=F*A*x+-j*y*w,C+=G*A*x+H*y*w);o=this._transform;o.a=F*x;o.b=G*x;o.c=-j*w;o.d=H*w;o.tx=D;o.ty=C;v&&(o=cc.affineTransformConcat({a:1,b:Math.tan(cc.degreesToRadians(E._skewY)),c:Math.tan(cc.degreesToRadians(E._skewX)),d:1,tx:0,ty:0},o),0!==B||0!==z)&&(o=cc.affineTransformTranslate(o,A,y));E._additionalTransformDirty&&(o=cc.affineTransformConcat(o,E._additionalTransform),E._additionalTransformDirty=!1);this._transform=o}return this._transform};b._syncStatus=function(f){var j=cc.Node._dirtyFlags,h=this._dirtyFlag,g=f?f._node:null;g&&g._cascadeColorEnabled&&f._dirtyFlag&j.colorDirty&&(h|=j.colorDirty);g&&g._cascadeOpacityEnabled&&f._dirtyFlag&j.opacityDirty&&(h|=j.opacityDirty);f&&f._dirtyFlag&j.transformDirty&&(h|=j.transformDirty);g=h&j.colorDirty;j=h&j.opacityDirty;this._dirtyFlag=h;g&&this._syncDisplayColor();j&&this._syncDisplayOpacity();(g||j)&&this._updateColor();this.transform(f)};b._updateColor=function(){};b.visit=function(f){var j=this._node;if(j._visible){f=f||this.getParentRenderCmd();j._parent&&j._parent._renderCmd&&(this._curLevel=j._parent._renderCmd._curLevel+1);var h=cc.current_stack;h.stack.push(h.top);this._syncStatus(f);h.top=this._stackMatrix;if((f=j._children)&&0<f.length){var g=f.length;j.sortAllChildren();for(j=0;j<g;j++){if(f[j]&&0>f[j]._localZOrder){f[j]._renderCmd.visit(this)}else{break}}for(cc.renderer.pushRenderCommand(this);j<g;j++){f[j]&&f[j]._renderCmd.visit(this)}}else{cc.renderer.pushRenderCommand(this)}this._dirtyFlag=0;h.top=h.stack.pop()}};b.transform=function(j,t){var s=this._transform4x4,r=this._stackMatrix,p=this._node,o=(j=j||this.getParentRenderCmd())?j._stackMatrix:cc.current_stack.top,n=this.getNodeToParentTransform();this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty;var m=s.mat;m[0]=n.a;m[4]=n.c;m[12]=n.tx;m[1]=n.b;m[5]=n.d;m[13]=n.ty;m[14]=p._vertexZ;cc.kmMat4Multiply(r,o,s);null===p._camera||null!==p.grid&&p.grid.isActive()||(o=this._anchorPointInPoints.x,n=this._anchorPointInPoints.y,0!==o||0!==n?(cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(o|=0,n|=0),m=cc.math.Matrix4.createByTranslation(o,n,0,s),r.multiply(m),p._camera._locateForRenderer(r),m=cc.math.Matrix4.createByTranslation(-o,-n,0,m),r.multiply(m),s.identity()):p._camera._locateForRenderer(r));if(t&&p._children&&0!==p._children.length){for(p=p._children,s=0,r=p.length;s<r;s++){p[s]._renderCmd.transform(this,t)}}};b.setShaderProgram=function(c){this._shaderProgram=c};b.getShaderProgram=function(){return this._shaderProgram}})();cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",_textureForCanvas:null,ctor:function(f,e,h,g){cc.Node.prototype.ctor.call(this);this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._ignoreContentScaleFactor=!1;void 0!==g&&this.initWithTileFile(f,e,h,g)},_createRenderCmd:function(){this._renderCmd=cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.AtlasNode.CanvasRenderCmd(this):new cc.AtlasNode.WebGLRenderCmd(this)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},getColor:function(){return this._opacityModifyRGB?this._renderCmd._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(d){var c=this.color;this._opacityModifyRGB=d;this.setColor(c)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(d,c){this._blendFunc=void 0===c?d:{src:d,dst:c}},setTextureAtlas:function(b){this.textureAtlas=b},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},setQuadsToDraw:function(b){this.quadsToDraw=b},initWithTileFile:function(f,e,h,g){if(!f){throw"cc.AtlasNode.initWithTileFile(): title should not be null"}f=cc.textureCache.addImage(f);return this.initWithTexture(f,e,h,g)},initWithTexture:function(f,e,h,g){return this._renderCmd.initWithTexture(f,e,h,g)},setColor:function(b){this._renderCmd.setColor(b)},setOpacity:function(b){this._renderCmd.setOpacity(b)},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(b){this._renderCmd.setTexture(b)},_setIgnoreContentScaleFactor:function(b){this._ignoreContentScaleFactor=b}});_p=cc.AtlasNode.prototype;cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor);cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);cc.EventHelper.prototype.apply(_p);cc.AtlasNode.create=function(f,e,h,g){return new cc.AtlasNode(f,e,h,g)};(function(){cc.AtlasNode.CanvasRenderCmd=function(c){cc.Node.CanvasRenderCmd.call(this,c);this._needDraw=!1;this._colorUnmodified=cc.color.WHITE;this._texture=this._originalTexture=null};var b=cc.AtlasNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);b.constructor=cc.AtlasNode.CanvasRenderCmd;b.initWithTexture=function(g,m,k,j){var h=this._node;h._itemWidth=m;h._itemHeight=k;h._opacityModifyRGB=!0;this._originalTexture=g;if(!this._originalTexture){return cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1}this._texture=this._originalTexture;this._calculateMaxItems();h.quadsToDraw=j;return !0};b.setColor=function(d){var e=this._node._realColor;if(e.r!==d.r||e.g!==d.g||e.b!==d.b){this._colorUnmodified=d,this._changeTextureColor()}};b._changeTextureColor=cc.sys._supportCanvasNewBlendModes?function(){var f=this._node,j=f.getTexture();if(j&&this._originalTexture){var h=this._originalTexture.getHtmlElementObj();if(h){var g=j.getHtmlElementObj(),j=cc.rect(0,0,h.width,h.height);g instanceof HTMLCanvasElement?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(h,this._colorUnmodified,j,g):(g=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(h,this._colorUnmodified,j),j=new cc.Texture2D,j.initWithElement(g),j.handleLoadedTexture(),f.setTexture(j))}}}:function(){var f=this._node,j,h=f.getTexture();if(h&&this._originalTexture&&(j=h.getHtmlElementObj())){var g=this._originalTexture.getHtmlElementObj();if(h=cc.textureCache.getTextureColors(g)){g=cc.rect(0,0,g.width,g.height),j instanceof HTMLCanvasElement?cc.Sprite.CanvasRenderCmd._generateTintImage(j,h,this._displayedColor,g,j):(j=cc.Sprite.CanvasRenderCmd._generateTintImage(j,h,this._displayedColor,g),h=new cc.Texture2D,h.initWithElement(j),h.handleLoadedTexture(),f.setTexture(h))}}};b.setOpacity=function(c){cc.Node.prototype.setOpacity.call(this._node,c)};b.getTexture=function(){return this._texture};b.setTexture=function(c){this._texture=c};b._calculateMaxItems=function(){var d=this._node,e=this._texture.getContentSize();d._itemsPerColumn=0|e.height/d._itemHeight;d._itemsPerRow=0|e.width/d._itemWidth}})();(function(){cc.AtlasNode.WebGLRenderCmd=function(c){cc.Node.WebGLRenderCmd.call(this,c);this._needDraw=!0;this._textureAtlas=null;this._colorUnmodified=cc.color.WHITE;this._uniformColor=this._colorF32Array=null;this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR);this._uniformColor=cc._renderContext.getUniformLocation(this._shaderProgram.getProgram(),"u_color")};var b=cc.AtlasNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);b.constructor=cc.AtlasNode.WebGLRenderCmd;b._updateBlendFunc=function(){var c=this._node;this._textureAtlas.texture.hasPremultipliedAlpha()||(c._blendFunc.src=cc.SRC_ALPHA,c._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)};b._updateOpacityModifyRGB=function(){this._node._opacityModifyRGB=this._textureAtlas.texture.hasPremultipliedAlpha()};b.rendering=function(d){d=d||cc._renderContext;var e=this._node;this._shaderProgram.use();this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst);this._uniformColor&&this._colorF32Array&&(d.uniform4fv(this._uniformColor,this._colorF32Array),this._textureAtlas.drawNumberOfQuads(e.quadsToDraw,0))};b.initWithTexture=function(g,m,k,j){var h=this._node;h._itemWidth=m;h._itemHeight=k;this._colorUnmodified=cc.color.WHITE;h._opacityModifyRGB=!0;h._blendFunc.src=cc.BLEND_SRC;h._blendFunc.dst=cc.BLEND_DST;m=h._realColor;this._colorF32Array=new Float32Array([m.r/255,m.g/255,m.b/255,h._realOpacity/255]);this._textureAtlas=new cc.TextureAtlas;this._textureAtlas.initWithTexture(g,j);if(!this._textureAtlas){return cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1}this._updateBlendFunc();this._updateOpacityModifyRGB();this._calculateMaxItems();h.quadsToDraw=j;return !0};b.setColor=function(e){var g=cc.color(e.r,e.g,e.b),f=this._node;this._colorUnmodified=e;e=this._displayedOpacity;f._opacityModifyRGB&&(g.r=g.r*e/255,g.g=g.g*e/255,g.b=g.b*e/255);cc.Node.prototype.setColor.call(f,g)};b.setOpacity=function(d){var e=this._node;cc.Node.prototype.setOpacity.call(e,d);e._opacityModifyRGB&&(e.color=this._colorUnmodified)};b._updateColor=function(){var c=this._displayedColor;this._colorF32Array=new Float32Array([c.r/255,c.g/255,c.b/255,this._displayedOpacity/255])};b.getTexture=function(){return this._textureAtlas.texture};b.setTexture=function(c){this._textureAtlas.texture=c;this._updateBlendFunc();this._updateOpacityModifyRGB()};b._calculateMaxItems=function(){var e=this._node,g=this._textureAtlas.texture,f=g.getContentSize();e._ignoreContentScaleFactor&&(f=g.getContentSizeInPixels());e._itemsPerColumn=0|f.height/e._itemHeight;e._itemsPerRow=0|f.width/e._itemWidth}})();cc._tmp.WebGLTexture2D=function(){cc.Texture2D=cc.Class.extend({_pVRHaveAlphaPremultiplied:!0,_pixelFormat:null,_pixelsWide:0,_pixelsHigh:0,_name:"",_contentSize:null,maxS:0,maxT:0,_hasPremultipliedAlpha:!1,_hasMipmaps:!1,shaderProgram:null,_textureLoaded:!1,_htmlElementObj:null,_webTextureObj:null,url:null,ctor:function(){this._contentSize=cc.size(0,0);this._pixelFormat=cc.Texture2D.defaultPixelFormat},releaseTexture:function(){this._webTextureObj&&cc._renderContext.deleteTexture(this._webTextureObj);cc.loader.release(this.url)},getPixelFormat:function(){return this._pixelFormat},getPixelsWide:function(){return this._pixelsWide},getPixelsHigh:function(){return this._pixelsHigh},getName:function(){return this._webTextureObj},getContentSize:function(){return cc.size(this._contentSize.width/cc.contentScaleFactor(),this._contentSize.height/cc.contentScaleFactor())},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},getMaxS:function(){return this.maxS},setMaxS:function(b){this.maxS=b},getMaxT:function(){return this.maxT},setMaxT:function(b){this.maxT=b},getShaderProgram:function(){return this.shaderProgram},setShaderProgram:function(b){this.shaderProgram=b},hasPremultipliedAlpha:function(){return this._hasPremultipliedAlpha},hasMipmaps:function(){return this._hasMipmaps},description:function(){return"\x3ccc.Texture2D | Name \x3d "+this._name+" | Dimensions \x3d "+this._pixelsWide+" x "+this._pixelsHigh+" | Coordinates \x3d ("+this.maxS+", "+this.maxT+")\x3e"},releaseData:function(b){},keepData:function(d,c){return d},initWithData:function(w,v,u,t,s){var r=cc.Texture2D,p=cc._renderContext,o=p.RGBA,n=p.UNSIGNED_BYTE,j=u*cc.Texture2D._B[v]/8;0===j%8?p.pixelStorei(p.UNPACK_ALIGNMENT,8):0===j%4?p.pixelStorei(p.UNPACK_ALIGNMENT,4):0===j%2?p.pixelStorei(p.UNPACK_ALIGNMENT,2):p.pixelStorei(p.UNPACK_ALIGNMENT,1);this._webTextureObj=p.createTexture();cc.glBindTexture2D(this);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE);switch(v){case r.PIXEL_FORMAT_RGBA8888:o=p.RGBA;break;case r.PIXEL_FORMAT_RGB888:o=p.RGB;break;case r.PIXEL_FORMAT_RGBA4444:n=p.UNSIGNED_SHORT_4_4_4_4;break;case r.PIXEL_FORMAT_RGB5A1:n=p.UNSIGNED_SHORT_5_5_5_1;break;case r.PIXEL_FORMAT_RGB565:n=p.UNSIGNED_SHORT_5_6_5;break;case r.PIXEL_FORMAT_AI88:o=p.LUMINANCE_ALPHA;break;case r.PIXEL_FORMAT_A8:o=p.ALPHA;break;case r.PIXEL_FORMAT_I8:o=p.LUMINANCE;break;default:cc.assert(0,cc._LogInfos.Texture2D_initWithData)}p.texImage2D(p.TEXTURE_2D,0,o,u,t,0,o,n,w);this._contentSize.width=s.width;this._contentSize.height=s.height;this._pixelsWide=u;this._pixelsHigh=t;this._pixelFormat=v;this.maxS=s.width/u;this.maxT=s.height/t;this._hasMipmaps=this._hasPremultipliedAlpha=!1;this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE);return this._textureLoaded=!0},drawAtPoint:function(f){var e=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0],h=this._pixelsWide*this.maxS,g=this._pixelsHigh*this.maxT;f=[f.x,f.y,0,h+f.x,f.y,0,f.x,g+f.y,0,h+f.x,g+f.y,0];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);this._shaderProgram.use();this._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(this);h=cc._renderContext;h.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,f);h.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,h.FLOAT,!1,0,e);h.drawArrays(h.TRIANGLE_STRIP,0,4)},drawInRect:function(e){var d=[0,this.maxT,this.maxS,this.maxT,0,0,this.maxS,0];e=[e.x,e.y,e.x+e.width,e.y,e.x,e.y+e.height,e.x+e.width,e.y+e.height];cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_TEX_COORDS);this._shaderProgram.use();this._shaderProgram.setUniformsForBuiltins();cc.glBindTexture2D(this);var f=cc._renderContext;f.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,f.FLOAT,!1,0,e);f.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,f.FLOAT,!1,0,d);f.drawArrays(f.TRIANGLE_STRIP,0,4)},initWithImage:function(f){if(null==f){return cc.log(cc._LogInfos.Texture2D_initWithImage),!1}var e=f.getWidth(),h=f.getHeight(),g=cc.configuration.getMaxTextureSize();if(e>g||h>g){return cc.log(cc._LogInfos.Texture2D_initWithImage_2,e,h,g,g),!1}this._textureLoaded=!0;return this._initPremultipliedATextureWithImage(f,e,h)},initWithElement:function(b){b&&(this._webTextureObj=cc._renderContext.createTexture(),this._htmlElementObj=b,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(d){d=void 0===d?!1:d;if(cc._rendererInitialized){if(!this._htmlElementObj){var c=cc.loader.getRes(this.url);if(!c){return}this.initWithElement(c)}this._htmlElementObj.width&&this._htmlElementObj.height&&(c=cc._renderContext,cc.glBindTexture2D(this),c.pixelStorei(c.UNPACK_ALIGNMENT,4),d&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this._htmlElementObj),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),cc.glBindTexture2D(null),d&&c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),c=this._htmlElementObj.height,this._pixelsWide=this._contentSize.width=this._htmlElementObj.width,this._pixelsHigh=this._contentSize.height=c,this._pixelFormat=cc.Texture2D.PIXEL_FORMAT_RGBA8888,this.maxT=this.maxS=1,this._hasPremultipliedAlpha=d,this._hasMipmaps=!1,this.dispatchEvent("load"))}},initWithString:function(h,g,n,m,k,j){cc.log(cc._LogInfos.Texture2D_initWithString);return null},initWithETCFile:function(b){cc.log(cc._LogInfos.Texture2D_initWithETCFile_2);return !1},initWithPVRFile:function(b){cc.log(cc._LogInfos.Texture2D_initWithPVRFile_2);return !1},initWithPVRTCData:function(h,g,n,m,k,j){cc.log(cc._LogInfos.Texture2D_initWithPVRTCData_2);return !1},setTexParameters:function(g,f,k,j){var h=cc._renderContext;void 0!==f&&(g={minFilter:g,magFilter:f,wrapS:k,wrapT:j});cc.assert(this._pixelsWide===cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh)||g.wrapS===h.CLAMP_TO_EDGE&&g.wrapT===h.CLAMP_TO_EDGE,"WebGLRenderingContext.CLAMP_TO_EDGE should be used in NPOT textures");cc.glBindTexture2D(this);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,g.minFilter);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,g.magFilter);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,g.wrapS);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,g.wrapT)},setAntiAliasTexParameters:function(){var b=cc._renderContext;cc.glBindTexture2D(this);this._hasMipmaps?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR_MIPMAP_NEAREST):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR)},setAliasTexParameters:function(){var b=cc._renderContext;cc.glBindTexture2D(this);this._hasMipmaps?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST_MIPMAP_NEAREST):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST)},generateMipmap:function(){cc.assert(this._pixelsWide===cc.NextPOT(this._pixelsWide)&&this._pixelsHigh===cc.NextPOT(this._pixelsHigh),"Mimpap texture only works in POT textures");cc.glBindTexture2D(this);cc._renderContext.generateMipmap(cc._renderContext.TEXTURE_2D);this._hasMipmaps=!0},stringForFormat:function(){return cc.Texture2D._M[this._pixelFormat]},bitsPerPixelForFormat:function(d){d=d||this._pixelFormat;var c=cc.Texture2D._B[d];if(null!=c){return c}cc.log(cc._LogInfos.Texture2D_bitsPerPixelForFormat,d);return -1},_initPremultipliedATextureWithImage:function(y,x,w){var v=cc.Texture2D,u=y.getData(),t=null,t=null,s=y.hasAlpha(),r=cc.size(y.getWidth(),y.getHeight()),p=v.defaultPixelFormat,o=y.getBitsPerComponent();s||(8<=o?p=v.PIXEL_FORMAT_RGB888:(cc.log(cc._LogInfos.Texture2D__initPremultipliedATextureWithImage),p=v.PIXEL_FORMAT_RGB565));var j=x*w;if(p===v.PIXEL_FORMAT_RGB565){if(s){for(u=new Uint16Array(x*w),t=y.getData(),o=0;o<j;++o){u[o]=(t[o]>>0&255)>>3<<11|(t[o]>>8&255)>>2<<5|(t[o]>>16&255)>>3<<0}}else{for(u=new Uint16Array(x*w),t=y.getData(),o=0;o<j;++o){u[o]=(t[o]&255)>>3<<11|(t[o]&255)>>2<<5|(t[o]&255)>>3<<0}}}else{if(p===v.PIXEL_FORMAT_RGBA4444){for(u=new Uint16Array(x*w),t=y.getData(),o=0;o<j;++o){u[o]=(t[o]>>0&255)>>4<<12|(t[o]>>8&255)>>4<<8|(t[o]>>16&255)>>4<<4|(t[o]>>24&255)>>4<<0}}else{if(p===v.PIXEL_FORMAT_RGB5A1){for(u=new Uint16Array(x*w),t=y.getData(),o=0;o<j;++o){u[o]=(t[o]>>0&255)>>3<<11|(t[o]>>8&255)>>3<<6|(t[o]>>16&255)>>3<<1|(t[o]>>24&255)>>7<<0}}else{if(p===v.PIXEL_FORMAT_A8){for(u=new Uint8Array(x*w),t=y.getData(),o=0;o<j;++o){u[o]=t>>24&255}}}}}if(s&&p===v.PIXEL_FORMAT_RGB888){for(t=y.getData(),u=new Uint8Array(x*w*3),o=0;o<j;++o){u[3*o]=t>>0&255,u[3*o+1]=t>>8&255,u[3*o+2]=t>>16&255}}this.initWithData(u,p,x,w,r);y.getData();this._hasPremultipliedAlpha=y.isPremultipliedAlpha();return !0},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},removeLoadedEventListener:function(b){this.removeEventListener("load",b)}})};cc._tmp.WebGLTextureAtlas=function(){var b=cc.TextureAtlas.prototype;b._setupVBO=function(){var c=cc._renderContext;this._buffersVBO[0]=c.createBuffer();this._buffersVBO[1]=c.createBuffer();this._quadsWebBuffer=c.createBuffer();this._mapBuffers()};b._mapBuffers=function(){var c=cc._renderContext;c.bindBuffer(c.ARRAY_BUFFER,this._quadsWebBuffer);c.bufferData(c.ARRAY_BUFFER,this._quadsArrayBuffer,c.DYNAMIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);c.bufferData(c.ELEMENT_ARRAY_BUFFER,this._indices,c.STATIC_DRAW)};b.drawNumberOfQuads=function(e,g){g=g||0;if(0!==e&&this.texture&&this.texture.isLoaded()){var f=cc._renderContext;cc.glBindTexture2D(this.texture);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);f.bindBuffer(f.ARRAY_BUFFER,this._quadsWebBuffer);this.dirty&&(f.bufferData(f.ARRAY_BUFFER,this._quadsArrayBuffer,f.DYNAMIC_DRAW),this.dirty=!1);f.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,f.FLOAT,!1,24,0);f.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,f.UNSIGNED_BYTE,!0,24,12);f.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,f.FLOAT,!1,24,16);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?f.drawElements(f.TRIANGLE_STRIP,6*e,f.UNSIGNED_SHORT,6*g*this._indices.BYTES_PER_ELEMENT):f.drawElements(f.TRIANGLES,6*e,f.UNSIGNED_SHORT,6*g*this._indices.BYTES_PER_ELEMENT);cc.g_NumberOfDraws++}}};cc._tmp.WebGLTextureCache=function(){var b=cc.textureCache;b.handleLoadedTexture=function(e){var g=this._textures;cc._rendererInitialized||(g=this._loadedTexturesBefore);var f=g[e];f||(f=g[e]=new cc.Texture2D,f.url=e);f.handleLoadedTexture()};b.addImage=function(g,m,k){cc.assert(g,cc._LogInfos.Texture2D_addImage_2);var j=this._textures;cc._rendererInitialized||(j=this._loadedTexturesBefore);var h=j[g]||j[cc.loader._aliases[g]];if(h){return m&&m.call(k,h),h}h=j[g]=new cc.Texture2D;h.url=g;(cc.loader._checkIsImageURL(g)?cc.loader.load:cc.loader.loadImg).call(cc.loader,g,function(d,c){if(d){return m&&m.call(k,d)}cc.textureCache.handleLoadedTexture(g);var a=j[g];m&&m.call(k,a)});return h};b.addImageAsync=b.addImage;b=null};cc._tmp.PrototypeTexture2D=function(){var d=cc.Texture2D;d.PVRImagesHavePremultipliedAlpha=function(b){cc.PVRHaveAlphaPremultiplied_=b};d.PIXEL_FORMAT_RGBA8888=2;d.PIXEL_FORMAT_RGB888=3;d.PIXEL_FORMAT_RGB565=4;d.PIXEL_FORMAT_A8=5;d.PIXEL_FORMAT_I8=6;d.PIXEL_FORMAT_AI88=7;d.PIXEL_FORMAT_RGBA4444=8;d.PIXEL_FORMAT_RGB5A1=7;d.PIXEL_FORMAT_PVRTC4=9;d.PIXEL_FORMAT_PVRTC2=10;d.PIXEL_FORMAT_DEFAULT=d.PIXEL_FORMAT_RGBA8888;var c=cc.Texture2D._M={};c[d.PIXEL_FORMAT_RGBA8888]="RGBA8888";c[d.PIXEL_FORMAT_RGB888]="RGB888";c[d.PIXEL_FORMAT_RGB565]="RGB565";c[d.PIXEL_FORMAT_A8]="A8";c[d.PIXEL_FORMAT_I8]="I8";c[d.PIXEL_FORMAT_AI88]="AI88";c[d.PIXEL_FORMAT_RGBA4444]="RGBA4444";c[d.PIXEL_FORMAT_RGB5A1]="RGB5A1";c[d.PIXEL_FORMAT_PVRTC4]="PVRTC4";c[d.PIXEL_FORMAT_PVRTC2]="PVRTC2";c=cc.Texture2D._B={};c[d.PIXEL_FORMAT_RGBA8888]=32;c[d.PIXEL_FORMAT_RGB888]=24;c[d.PIXEL_FORMAT_RGB565]=16;c[d.PIXEL_FORMAT_A8]=8;c[d.PIXEL_FORMAT_I8]=8;c[d.PIXEL_FORMAT_AI88]=16;c[d.PIXEL_FORMAT_RGBA4444]=16;c[d.PIXEL_FORMAT_RGB5A1]=16;c[d.PIXEL_FORMAT_PVRTC4]=4;c[d.PIXEL_FORMAT_PVRTC2]=3;c=cc.Texture2D.prototype;cc.defineGetterSetter(c,"name",c.getName);cc.defineGetterSetter(c,"pixelFormat",c.getPixelFormat);cc.defineGetterSetter(c,"pixelsWidth",c.getPixelsWide);cc.defineGetterSetter(c,"pixelsHeight",c.getPixelsHigh);cc.defineGetterSetter(c,"width",c._getWidth);cc.defineGetterSetter(c,"height",c._getHeight);d.defaultPixelFormat=d.PIXEL_FORMAT_DEFAULT};cc._tmp.PrototypeTextureAtlas=function(){var b=cc.TextureAtlas.prototype;cc.defineGetterSetter(b,"totalQuads",b.getTotalQuads);cc.defineGetterSetter(b,"capacity",b.getCapacity);cc.defineGetterSetter(b,"quads",b.getQuads,b.setQuads)};cc.ALIGN_CENTER=51;cc.ALIGN_TOP=19;cc.ALIGN_TOP_RIGHT=18;cc.ALIGN_RIGHT=50;cc.ALIGN_BOTTOM_RIGHT=34;cc.ALIGN_BOTTOM=35;cc.ALIGN_BOTTOM_LEFT=33;cc.ALIGN_LEFT=49;cc.ALIGN_TOP_LEFT=17;cc.PVRHaveAlphaPremultiplied_=!1;cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Texture2D=cc.Class.extend({_contentSize:null,_textureLoaded:!1,_htmlElementObj:null,url:null,_pattern:null,ctor:function(){this._contentSize=cc.size(0,0);this._textureLoaded=!1;this._htmlElementObj=null;this._pattern=""},getPixelsWide:function(){return this._contentSize.width},getPixelsHigh:function(){return this._contentSize.height},getContentSize:function(){var b=cc.contentScaleFactor();return cc.size(this._contentSize.width/b,this._contentSize.height/b)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(b){b&&(this._htmlElementObj=b,this._contentSize.width=b.width,this._contentSize.height=b.height,this._textureLoaded=!0)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._textureLoaded},handleLoadedTexture:function(){if(!this._textureLoaded){if(!this._htmlElementObj){var b=cc.loader.getRes(this.url);if(!b){return}this.initWithElement(b)}b=this._htmlElementObj;this._contentSize.width=b.width;this._contentSize.height=b.height;this.dispatchEvent("load")}},description:function(){return"\x3ccc.Texture2D | width \x3d "+this._contentSize.width+" height "+this._contentSize.height+"\x3e"},initWithData:function(g,f,k,j,h){return !1},initWithImage:function(b){return !1},initWithString:function(h,g,n,m,k,j){return !1},releaseTexture:function(){cc.loader.release(this.url)},getName:function(){return null},getMaxS:function(){return 1},setMaxS:function(b){},getMaxT:function(){return 1},setMaxT:function(b){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(b){},hasPremultipliedAlpha:function(){return !1},hasMipmaps:function(){return !1},releaseData:function(b){},keepData:function(d,c){return d},drawAtPoint:function(b){},drawInRect:function(b){},initWithETCFile:function(b){cc.log(cc._LogInfos.Texture2D_initWithETCFile);return !1},initWithPVRFile:function(b){cc.log(cc._LogInfos.Texture2D_initWithPVRFile);return !1},initWithPVRTCData:function(h,g,n,m,k,j){cc.log(cc._LogInfos.Texture2D_initWithPVRTCData);return !1},setTexParameters:function(f,e,h,g){void 0!==e&&(f={minFilter:f,magFilter:e,wrapS:h,wrapT:g});this._pattern=f.wrapS===cc.REPEAT&&f.wrapT===cc.REPEAT?"repeat":f.wrapS===cc.REPEAT?"repeat-x":f.wrapT===cc.REPEAT?"repeat-y":""},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(b){return -1},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},removeLoadedEventListener:function(b){this.removeEventListener("load",b)},_grayElementObj:null,_backupElement:null,_isGray:!1,_switchToGray:function(b){this._textureLoaded&&this._isGray!==b&&((this._isGray=b)?(this._backupElement=this._htmlElementObj,this._grayElementObj||(this._grayElementObj=cc.Texture2D._generateGrayTexture(this._htmlElementObj)),this._htmlElementObj=this._grayElementObj):null!==this._backupElement&&(this._htmlElementObj=this._backupElement))}}),cc.Texture2D._generateGrayTexture=function(h,g,n){if(null===h){return null}n=n||cc.newElement("canvas");g=g||cc.rect(0,0,h.width,h.height);n.width=g.width;n.height=g.height;var m=n.getContext("2d");m.drawImage(h,g.x,g.y,g.width,g.height,0,0,g.width,g.height);h=m.getImageData(0,0,g.width,g.height);g=h.data;for(var k=0,j=g.length;k<j;k+=4){g[k]=g[k+1]=g[k+2]=0.34*g[k]+0.5*g[k+1]+0.16*g[k+2]}m.putImageData(h,0,0);return n}):(cc.assert(cc.isFunction(cc._tmp.WebGLTexture2D),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D);cc.EventHelper.prototype.apply(cc.Texture2D.prototype);cc.assert(cc.isFunction(cc._tmp.PrototypeTexture2D),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js");cc._tmp.PrototypeTexture2D();delete cc._tmp.PrototypeTexture2D;cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1000*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var f,e=this._loadedTexturesBefore,h=this._textures;for(f in e){var g=e[f];g.handleLoadedTexture();h[f]=g}this._loadedTexturesBefore={}},addPVRTCImage:function(b){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(b){cc.log(cc._LogInfos.textureCache_addETCImage)},description:function(){return"\x3cTextureCache | Number of textures \x3d "+this._textures.length+"\x3e"},textureForKey:function(b){cc.log(cc._LogInfos.textureCache_textureForKey);return this.getTextureForKey(b)},getTextureForKey:function(b){return this._textures[b]||this._textures[cc.loader._aliases[b]]},getKeyByTexture:function(d){for(var c in this._textures){if(this._textures[c]===d){return c}}return null},_generalTextureKey:function(){this._textureKeySeq++;return"_textureKey_"+this._textureKeySeq},getTextureColors:function(d){var c=this.getKeyByTexture(d);c||(c=d instanceof HTMLImageElement?d.src:this._generalTextureKey());this._textureColorsCache[c]||(this._textureColorsCache[c]=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor(d));return this._textureColorsCache[c]},addPVRImage:function(b){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var d=this._textures,c;for(c in d){d[c]&&d[c].releaseTexture()}this._textures={}},removeTexture:function(e){if(e){var d=this._textures,f;for(f in d){d[f]===e&&(d[f].releaseTexture(),delete d[f])}}},removeTextureForKey:function(b){null!=b&&this._textures[b]&&delete this._textures[b]},cacheImage:function(e,d){if(d instanceof cc.Texture2D){this._textures[e]=d}else{var f=new cc.Texture2D;f.initWithElement(d);f.handleLoadedTexture();this._textures[e]=f}},addUIImage:function(e,d){cc.assert(e,cc._LogInfos.textureCache_addUIImage_2);if(d&&this._textures[d]){return this._textures[d]}var f=new cc.Texture2D;f.initWithImage(e);null!=d?this._textures[d]=f:cc.log(cc._LogInfos.textureCache_addUIImage);return f},dumpCachedTextureInfo:function(){var j=0,h=0,p=this._textures,o;for(o in p){var n=p[o];j++;n.getHtmlElementObj() instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,o,n.getHtmlElementObj().src,n.pixelsWidth,n.pixelsHeight):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,o,n.pixelsWidth,n.pixelsHeight);h+=n.pixelsWidth*n.pixelsHeight*4}p=this._textureColorsCache;for(o in p){var n=p[o],m;for(m in n){var k=n[m];j++;cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,o,k.width,k.height);h+=k.width*k.height*4}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,j,h/1024,(h/1048576).toFixed(2))},_clear:function(){this._textures={};this._textureColorsCache={};this._textureKeySeq=0|1000*Math.random();this._loadedTexturesBefore={}}};cc._renderType===cc._RENDER_TYPE_CANVAS?(_p=cc.textureCache,_p.handleLoadedTexture=function(e){var d=this._textures,f=d[e];f||(f=d[e]=new cc.Texture2D,f.url=e);f.handleLoadedTexture()},_p.addImage=function(g,f,k){cc.assert(g,cc._LogInfos.Texture2D_addImage);var j=this._textures,h=j[g]||j[cc.loader._aliases[g]];if(h){return f&&f.call(k,h),h}h=j[g]=new cc.Texture2D;h.url=g;(cc.loader._checkIsImageURL(g)?cc.loader.load:cc.loader.loadImg).call(cc.loader,g,function(c,b){if(c){return f&&f.call(k,c)}cc.textureCache.handleLoadedTexture(g);var a=j[g];f&&f.call(k,a)});return h},_p.addImageAsync=_p.addImage,_p=null):(cc.assert(cc.isFunction(cc._tmp.WebGLTextureCache),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),delete cc._tmp.WebGLTextureCache);cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(d,c){this._buffersVBO=[];cc.isString(d)?this.initWithFile(d,c):d instanceof cc.Texture2D&&this.initWithTexture(d,c)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(b){this.texture=b},setDirty:function(b){this.dirty=b},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(b){this._quads=b},_copyQuadsToTextureAtlas:function(e,d){if(e){for(var f=0;f<e.length;f++){this._setQuadToArray(e[f],d+f)}}},_setQuadToArray:function(e,d){var f=this._quads;f[d]?(f[d].bl=e.bl,f[d].br=e.br,f[d].tl=e.tl,f[d].tr=e.tr):f[d]=new cc.V3F_C4B_T2F_Quad(e.tl,e.bl,e.tr,e.br,this._quadsArrayBuffer,d*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT)},description:function(){return"\x3ccc.TextureAtlas | totalQuads \x3d"+this._totalQuads+"\x3e"},_setupIndices:function(){if(0!==this._capacity){for(var e=this._indices,d=this._capacity,f=0;f<d;f++){cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(e[6*f+0]=4*f+0,e[6*f+1]=4*f+0,e[6*f+2]=4*f+2,e[6*f+3]=4*f+1,e[6*f+4]=4*f+3,e[6*f+5]=4*f+3):(e[6*f+0]=4*f+0,e[6*f+1]=4*f+1,e[6*f+2]=4*f+2,e[6*f+3]=4*f+3,e[6*f+4]=4*f+2,e[6*f+5]=4*f+1)}}},_setupVBO:function(){var b=cc._renderContext;this._buffersVBO[0]=b.createBuffer();this._buffersVBO[1]=b.createBuffer();this._quadsWebBuffer=b.createBuffer();this._mapBuffers()},_mapBuffers:function(){var b=cc._renderContext;b.bindBuffer(b.ARRAY_BUFFER,this._quadsWebBuffer);b.bufferData(b.ARRAY_BUFFER,this._quadsArrayBuffer,b.DYNAMIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this._indices,b.STATIC_DRAW)},initWithFile:function(e,d){var f=cc.textureCache.addImage(e);if(f){return this.initWithTexture(f,d)}cc.log(cc._LogInfos.TextureAtlas_initWithFile,e);return !1},initWithTexture:function(g,f){cc.assert(g,cc._LogInfos.TextureAtlas_initWithTexture);this._capacity=f|=0;this._totalQuads=0;this.texture=g;this._quads=[];this._indices=new Uint16Array(6*f);var k=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._quadsArrayBuffer=new ArrayBuffer(k*f);this._quadsReader=new Uint8Array(this._quadsArrayBuffer);if((!this._quads||!this._indices)&&0<f){return !1}for(var j=this._quads,h=0;h<f;h++){j[h]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,h*k)}this._setupIndices();this._setupVBO();return this.dirty=!0},updateQuad:function(d,c){cc.assert(d,cc._LogInfos.TextureAtlas_updateQuad);cc.assert(0<=c&&c<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2);this._totalQuads=Math.max(c+1,this._totalQuads);this._setQuadToArray(d,c);this.dirty=!0},insertQuad:function(g,f){cc.assert(f<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2);this._totalQuads++;if(this._totalQuads>this._capacity){cc.log(cc._LogInfos.TextureAtlas_insertQuad)}else{var k=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,j=f*k,h=(this._totalQuads-1-f)*k;this._quads[this._totalQuads-1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*k);this._quadsReader.set(this._quadsReader.subarray(j,j+h),j+k);this._setQuadToArray(g,f);this.dirty=!0}},insertQuads:function(k,j,s){s=s||k.length;cc.assert(j+s<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var r=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._totalQuads+=s;if(this._totalQuads>this._capacity){cc.log(cc._LogInfos.TextureAtlas_insertQuad)}else{var p=j*r,o=(this._totalQuads-1-j-s)*r,n=this._totalQuads-1-s,m;for(m=0;m<s;m++){this._quads[n+m]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*r)}this._quadsReader.set(this._quadsReader.subarray(p,p+o),p+r*s);for(m=0;m<s;m++){this._setQuadToArray(k[m],j+m)}this.dirty=!0}},insertQuadFromIndex:function(h,g){if(h!==g){cc.assert(0<=g||g<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex);cc.assert(0<=h||h<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);var n=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,m=this._quadsReader,k=m.subarray(h*n,n),j;h>g?(j=g*n,m.set(m.subarray(j,j+(h-g)*n),j+n),m.set(k,j)):(j=(h+1)*n,m.set(m.subarray(j,j+(g-h)*n),j-n),m.set(k,g*n));this.dirty=!0}},removeQuadAtIndex:function(e){cc.assert(e<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var d=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;this._totalQuads--;this._quads.length=this._totalQuads;if(e!==this._totalQuads){var f=(e+1)*d;this._quadsReader.set(this._quadsReader.subarray(f,f+(this._totalQuads-e)*d),f-d)}this.dirty=!0},removeQuadsAtIndex:function(g,f){cc.assert(g+f<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex);this._totalQuads-=f;if(g!==this._totalQuads){var k=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,j=(g+f)*k,h=g*k;this._quadsReader.set(this._quadsReader.subarray(j,j+(this._totalQuads-g)*k),h)}this.dirty=!0},removeAllQuads:function(){this._totalQuads=this._quads.length=0},_setDirty:function(b){this.dirty=b},resizeCapacity:function(k){if(k===this._capacity){return !0}var j=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,s=this._capacity;this._totalQuads=Math.min(this._totalQuads,k);var r=this._capacity=0|k,p=this._totalQuads;if(null===this._quads){for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(j*r),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),k=0;k<r;k++){this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,k*j)}}else{var o,n,m=this._quads;if(r>s){o=[];n=new ArrayBuffer(j*r);for(k=0;k<p;k++){o[k]=new cc.V3F_C4B_T2F_Quad(m[k].tl,m[k].bl,m[k].tr,m[k].br,n,k*j)}for(;k<r;k++){o[k]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,n,k*j)}}else{for(p=Math.max(p,r),o=[],n=new ArrayBuffer(j*r),k=0;k<p;k++){o[k]=new cc.V3F_C4B_T2F_Quad(m[k].tl,m[k].bl,m[k].tr,m[k].br,n,k*j)}}this._quadsReader=new Uint8Array(n);this._quads=o;this._quadsArrayBuffer=n}null===this._indices?this._indices=new Uint16Array(6*r):r>s?(j=new Uint16Array(6*r),j.set(this._indices,0),this._indices=j):this._indices=this._indices.subarray(0,6*r);this._setupIndices();this._mapBuffers();return this.dirty=!0},increaseTotalQuadsWith:function(b){this._totalQuads+=b},moveQuadsFromIndex:function(u,t,s){if(void 0===s){if(s=t,t=this._totalQuads-u,cc.assert(s+(this._totalQuads-u)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===t){return}}else{if(cc.assert(s+t<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(u<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),u===s){return}}var r=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,p=u*r,o=t*r,n=this._quadsReader,m=n.subarray(p,p+o),j=s*r;s<u?(t=s*r,n.set(n.subarray(t,t+(u-s)*r),t+o)):(t=(u+t)*r,n.set(n.subarray(t,t+(s-u)*r),p));n.set(m,j);this.dirty=!0},fillWithEmptyQuadsFromIndex:function(g,f){for(var k=f*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,j=new Uint8Array(this._quadsArrayBuffer,g*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,k),h=0;h<k;h++){j[h]=0}},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var b=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&b.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&b.deleteBuffer(this._buffersVBO[1]));this._quadsWebBuffer&&b.deleteBuffer(this._quadsWebBuffer)}});_p=cc.TextureAtlas.prototype;cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads);cc.defineGetterSetter(_p,"capacity",_p.getCapacity);cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads);cc.TextureAtlas.create=function(d,c){return new cc.TextureAtlas(d,c)};cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create;cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert(cc.isFunction(cc._tmp.WebGLTextureAtlas),cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas);cc.assert(cc.isFunction(cc._tmp.PrototypeTextureAtlas),cc._LogInfos.MissingFile,"TexturesPropertyDefine.js");cc._tmp.PrototypeTextureAtlas();delete cc._tmp.PrototypeTextureAtlas;cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this);this._ignoreAnchorPointForPosition=!0;this.setAnchorPoint(0.5,0.5);this.setContentSize(cc.director.getWinSize())}});cc.Scene.create=function(){return new cc.Scene};cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",cb:null,target:null,init:function(){var g=this,f=200,k=g._bgLayer=new cc.LayerColor(cc.color(255,255,255,255));g.addChild(k,0);var j=24,h=-f/2+100;cc._loaderImage&&(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(b,a){f=a.height;g._initStage(a,cc.visibleRect.center)}),j=14,h=-f/2-10);j=g._label=new cc.LabelTTF("Loading... 0%","Arial",j);j.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,h)));j.setColor(cc.color(0,0,0));k.addChild(this._label,10);return !0},_initStage:function(e,d){var f=this._texture2d=new cc.Texture2D;f.initWithElement(e);f.handleLoadedTexture();f=this._logo=new cc.Sprite(f);f.setScale(cc.contentScaleFactor());f.x=d.x;f.y=d.y;this._bgLayer.addChild(f,10)},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.schedule(this._startLoading,0.3)},onExit:function(){cc.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(e,d,f){cc.isString(e)&&(e=[e]);this.resources=e||[];this.cb=d;this.target=f},_startLoading:function(){var b=this;b.unschedule(b._startLoading);cc.loader.load(b.resources,function(a,f,e){a=Math.min(e/f*100|0,100);b._label.setString("Loading... "+a+"%")},function(){b.cb&&(document.getElementById(cc.game.config.id).style.backgroundColor="black",b.cb.call(b.target))})}});cc.LoaderScene.preload=function(f,e,h){var g=cc;g.loaderScene||(g.loaderScene=new cc.LoaderScene,g.loaderScene.init());g.loaderScene.initWithResources(f,e,h);cc.director.runScene(g.loaderScene);return g.loaderScene};cc.Layer=cc.Node.extend({_className:"Layer",ctor:function(){var b=cc.Node.prototype;b.ctor.call(this);this._ignoreAnchorPointForPosition=!0;b.setAnchorPoint.call(this,0.5,0.5);b.setContentSize.call(this,cc.winSize)},init:function(){this._ignoreAnchorPointForPosition=!0;this.setAnchorPoint(0.5,0.5);this.setContentSize(cc.winSize);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!1;return !0},bake:function(){this._renderCmd.bake()},unbake:function(){this._renderCmd.unbake()},isBaked:function(){return this._isBaked},addChild:function(e,d,f){cc.Node.prototype.addChild.call(this,e,d,f);this._renderCmd._bakeForAddChild(e)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Layer.CanvasRenderCmd(this):new cc.Layer.WebGLRenderCmd(this)}});cc.Layer.create=function(){return new cc.Layer};cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(d,c){this.width=d;this.height=c},changeWidth:function(b){this.width=b},changeHeight:function(b){this.height=b},setOpacityModifyRGB:function(b){},isOpacityModifyRGB:function(){return !1},ctor:function(e,d,f){cc.Layer.prototype.ctor.call(this);this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);cc.LayerColor.prototype.init.call(this,e,d,f)},init:function(f,e,h){cc._renderType!==cc._RENDER_TYPE_CANVAS&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR));var g=cc.director.getWinSize();f=f||cc.color(0,0,0,255);e=void 0===e?g.width:e;h=void 0===h?g.height:h;g=this._realColor;g.r=f.r;g.g=f.g;g.b=f.b;this._realOpacity=f.a;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty);cc.LayerColor.prototype.setContentSize.call(this,e,h);return !0},setBlendFunc:function(e,d){var f=this._blendFunc;void 0===d?(f.src=e.src,f.dst=e.dst):(f.src=e,f.dst=d);this._renderCmd.updateBlendFunc(f)},_setWidth:function(b){cc.Node.prototype._setWidth.call(this,b);this._renderCmd._updateSquareVerticesWidth(b)},_setHeight:function(b){cc.Node.prototype._setHeight.call(this,b);this._renderCmd._updateSquareVerticesHeight(b)},setContentSize:function(d,c){cc.Layer.prototype.setContentSize.call(this,d,c);this._renderCmd._updateSquareVertices(d,c)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LayerColor.CanvasRenderCmd(this):new cc.LayerColor.WebGLRenderCmd(this)}});cc.LayerColor.create=function(e,d,f){return new cc.LayerColor(e,d,f)};(function(){var b=cc.LayerColor.prototype;cc.defineGetterSetter(b,"width",b._getWidth,b._setWidth);cc.defineGetterSetter(b,"height",b._getHeight,b._setHeight)})();cc.LayerGradient=cc.LayerColor.extend({_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_className:"LayerGradient",_colorStops:[],ctor:function(f,e,h,g){cc.LayerColor.prototype.ctor.call(this);this._endColor=cc.color(0,0,0,255);this._alongVector=cc.p(0,-1);this._endOpacity=this._startOpacity=255;g&&g instanceof Array?(this._colorStops=g,g.splice(0,0,{p:0,color:f||cc.color.BLACK}),g.push({p:1,color:e||cc.color.BLACK})):this._colorStops=[{p:0,color:f||cc.color.BLACK},{p:1,color:e||cc.color.BLACK}];cc.LayerGradient.prototype.init.call(this,f,e,h,g)},init:function(f,e,h,g){f=f||cc.color(0,0,0,255);e=e||cc.color(0,0,0,255);h=h||cc.p(0,-1);g=this._endColor;this._startOpacity=f.a;g.r=e.r;g.g=e.g;g.b=e.b;this._endOpacity=e.a;this._alongVector=h;this._compressedInterpolation=!0;cc.LayerColor.prototype.init.call(this,cc.color(f.r,f.g,f.b,255));this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty);return !0},setContentSize:function(d,c){cc.LayerColor.prototype.setContentSize.call(this,d,c);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setWidth:function(b){cc.LayerColor.prototype._setWidth.call(this,b);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},_setHeight:function(b){cc.LayerColor.prototype._setHeight.call(this,b);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getStartColor:function(){return cc.color(this._realColor)},setStartColor:function(d){this.color=d;var c=this._colorStops;c&&0<c.length&&(c=c[0].color,c.r=d.r,c.g=d.g,c.b=d.b)},setEndColor:function(d){var c=this._endColor;c.r=d.r;c.g=d.g;c.b=d.b;(c=this._colorStops)&&0<c.length&&(c=c[c.length-1].color,c.r=d.r,c.g=d.g,c.b=d.b);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},getEndColor:function(){return cc.color(this._endColor)},setStartOpacity:function(d){this._startOpacity=d;var c=this._colorStops;c&&0<c.length&&(c[0].color.a=d);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(d){this._endOpacity=d;var c=this._colorStops;c&&0<c.length&&(c[c.length-1].color.a=d);this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getEndOpacity:function(){return this._endOpacity},setVector:function(b){this._alongVector.x=b.x;this._alongVector.y=b.y;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(b){this._compressedInterpolation=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.gradientDirty)},getColorStops:function(){return this._colorStops},setColorStops:function(b){this._colorStops=b;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty|cc.Node._dirtyFlags.gradientDirty)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LayerGradient.CanvasRenderCmd(this):new cc.LayerGradient.WebGLRenderCmd(this)}});cc.LayerGradient.create=function(f,e,h,g){return new cc.LayerGradient(f,e,h,g)};(function(){var b=cc.LayerGradient.prototype;cc.defineGetterSetter(b,"startColor",b.getStartColor,b.setStartColor);cc.defineGetterSetter(b,"endColor",b.getEndColor,b.setEndColor);cc.defineGetterSetter(b,"startOpacity",b.getStartOpacity,b.setStartOpacity);cc.defineGetterSetter(b,"endOpacity",b.getEndOpacity,b.setEndOpacity);cc.defineGetterSetter(b,"vector",b.getVector,b.setVector);cc.defineGetterSetter(b,"colorStops",b.getColorStops,b.setColorStops)})();cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(b){cc.Layer.prototype.ctor.call(this);b instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,b):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(b){0<b.length&&null==b[b.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers);this._layers=b;this._enabledLayer=0;this.addChild(this._layers[this._enabledLayer]);return !0},switchTo:function(b){b>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=b,this.addChild(this._layers[b]))},switchToAndReleaseMe:function(b){b>=this._layers.length?cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=b,this.addChild(this._layers[b]))},addLayer:function(b){b?this._layers.push(b):cc.log(cc._LogInfos.LayerMultiplex_addLayer)}});cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))};(function(){cc.Layer.CanvasRenderCmd=function(c){cc.Node.CanvasRenderCmd.call(this,c);this._isBaked=!1;this._bakeSprite=null};var b=cc.Layer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);b.constructor=cc.Layer.CanvasRenderCmd;b.bake=function(){if(!this._isBaked){this._needDraw=!0;this._isBaked=this._cacheDirty=cc.renderer.childrenOrderDirty=!0;for(var e=this._node._children,g=0,f=e.length;g<f;g++){e[g]._renderCmd._setCachedParent(this)}this._bakeSprite||(this._bakeSprite=new cc.BakeSprite,this._bakeSprite.setAnchorPoint(0,0))}};b.unbake=function(){if(this._isBaked){cc.renderer.childrenOrderDirty=!0;this._isBaked=this._needDraw=!1;this._cacheDirty=!0;for(var e=this._node._children,g=0,f=e.length;g<f;g++){e[g]._renderCmd._setCachedParent(null)}}};b.isBaked=function(){return this._isBaked};b.rendering=function(){if(this._cacheDirty){var h=this._node,o=h._children,n=this._bakeSprite;this.transform(this.getParentRenderCmd(),!0);var m=this._getBoundingBoxForBake();m.width=0|m.width+0.5;m.height=0|m.height+0.5;var k=n.getCacheContext(),j=k.getContext();n.resetCanvasSize(m.width,m.height);k.setOffset(0-m.x,j.canvas.height-m.height+m.y);n.setPosition(m.x,m.y);h.sortAllChildren();cc.renderer._turnToCacheMode(this.__instanceId);h=0;for(m=o.length;h<m;h++){o[h].visit(this)}cc.renderer._renderingToCacheCanvas(k,this.__instanceId);n.transform();this._cacheDirty=!1}};b.visit=function(e){if(this._isBaked){var g=this._node,f=g._children.length;g._visible&&0!==f&&(this._syncStatus(e),cc.renderer.pushRenderCommand(this),this._bakeSprite.visit(this),this._dirtyFlag=0)}else{cc.Node.CanvasRenderCmd.prototype.visit.call(this,e)}};b._bakeForAddChild=function(c){c._parent===this._node&&this._isBaked&&c._renderCmd._setCachedParent(this)};b._getBoundingBoxForBake=function(){var h=null,o=this._node;if(!o._children||0===o._children.length){return cc.rect(0,0,10,10)}for(var n=o.getNodeToWorldTransform(),o=o._children,m=0,k=o.length;m<k;m++){var j=o[m];j&&j._visible&&(h?(j=j._getBoundingBoxToCurrentNode(n))&&(h=cc.rectUnion(h,j)):h=j._getBoundingBoxToCurrentNode(n))}return h}})();(function(){cc.LayerColor.CanvasRenderCmd=function(c){cc.Layer.CanvasRenderCmd.call(this,c);this._needDraw=!0;this._blendFuncStr="source-over";this._bakeRenderCmd=new cc.CustomRenderCmd(this,this._bakeRendering)};var b=cc.LayerColor.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);b.constructor=cc.LayerColor.CanvasRenderCmd;b.unbake=function(){cc.Layer.CanvasRenderCmd.prototype.unbake.call(this);this._needDraw=!0};b.rendering=function(j,t,s){j=j||cc._renderContext;var r=j.getContext(),p=this._node,o=this._displayedColor,n=this._displayedOpacity/255,m=p._contentSize.width,p=p._contentSize.height;0!==n&&(j.setCompositeOperation(this._blendFuncStr),j.setGlobalAlpha(n),j.setFillStyle("rgba("+(0|o.r)+","+(0|o.g)+","+(0|o.b)+", 1)"),j.setTransform(this._worldTransform,t,s),r.fillRect(0,0,m*t,-p*s),cc.g_NumberOfDraws++)};b.updateBlendFunc=function(c){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(c)};b._updateSquareVertices=b._updateSquareVerticesWidth=b._updateSquareVerticesHeight=function(){};b._bakeRendering=function(){if(this._cacheDirty){var j=this._node,r=this._bakeSprite,p=j._children,o=p.length;this.transform(this.getParentRenderCmd(),!0);var n=this._getBoundingBoxForBake();n.width=0|n.width+0.5;n.height=0|n.height+0.5;var m=r.getCacheContext(),k=m.getContext();r.resetCanvasSize(n.width,n.height);m.setOffset(0-n.x,k.canvas.height-n.height+n.y);r.setPosition(n.x,n.y);cc.renderer._turnToCacheMode(this.__instanceId);if(0<o){j.sortAllChildren();for(j=0;j<o;j++){if(n=p[j],0>n._localZOrder){n._renderCmd.visit(this)}else{break}}for(cc.renderer.pushRenderCommand(this);j<o;j++){p[j]._renderCmd.visit(this)}}else{cc.renderer.pushRenderCommand(this)}cc.renderer._renderingToCacheCanvas(m,this.__instanceId);r.transform();this._cacheDirty=!1}};b.visit=function(c){this._isBaked?this._node._visible&&(this._syncStatus(c),cc.renderer.pushRenderCommand(this._bakeRenderCmd),this._bakeSprite._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bakeSprite.visit(this),this._dirtyFlag=0):cc.Node.CanvasRenderCmd.prototype.visit.call(this)};b._getBoundingBoxForBake=function(){var g=this._node,m=cc.rect(0,0,g._contentSize.width,g._contentSize.height),k=g.getNodeToWorldTransform(),m=cc.rectApplyAffineTransform(m,g.getNodeToWorldTransform());if(!g._children||0===g._children.length){return m}for(var g=g._children,j=0;j<g.length;j++){var h=g[j];h&&h._visible&&(h=h._getBoundingBoxToCurrentNode(k),m=cc.rectUnion(m,h))}return m}})();(function(){cc.LayerGradient.RenderCmd={updateStatus:function(){var f=cc.Node._dirtyFlags,e=this._dirtyFlag,h=e&f.colorDirty,g=e&f.opacityDirty;h&&this._updateDisplayColor();g&&this._updateDisplayOpacity();e&f.transformDirty&&this.transform(null,!0);(h||g||e&f.gradientDirty)&&this._updateColor();this._dirtyFlag=0}}})();(function(){cc.LayerGradient.CanvasRenderCmd=function(c){cc.LayerColor.CanvasRenderCmd.call(this,c);this._needDraw=!0;this._startPoint=cc.p(0,0);this._endPoint=cc.p(0,0);this._endStopStr=this._startStopStr=null};var b=cc.LayerGradient.CanvasRenderCmd.prototype=Object.create(cc.LayerColor.CanvasRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,b);b.constructor=cc.LayerGradient.CanvasRenderCmd;b.rendering=function(v,u,t){v=v||cc._renderContext;var s=v.getContext(),r=this._node,p=this._displayedOpacity/255;if(0!==p){var o=r._contentSize.width,n=r._contentSize.height;v.setCompositeOperation(this._blendFuncStr);v.setGlobalAlpha(p);p=s.createLinearGradient(this._startPoint.x*u,this._startPoint.y*t,this._endPoint.x*u,this._endPoint.y*t);if(r._colorStops){for(var j=0;j<r._colorStops.length;j++){p.addColorStop(r._colorStops[j].p,this._colorStopsStr[j])}}else{p.addColorStop(0,this._startStopStr),p.addColorStop(1,this._endStopStr)}v.setFillStyle(p);v.setTransform(this._worldTransform,u,t);s.fillRect(0,0,o*u,-n*t);cc.g_NumberOfDraws++}};b._syncStatus=function(g){var m=cc.Node._dirtyFlags,k=this._dirtyFlag,j=g?g._node:null;j&&j._cascadeColorEnabled&&g._dirtyFlag&m.colorDirty&&(k|=m.colorDirty);j&&j._cascadeOpacityEnabled&&g._dirtyFlag&m.opacityDirty&&(k|=m.opacityDirty);g&&g._dirtyFlag&m.transformDirty&&(k|=m.transformDirty);var j=k&m.colorDirty,h=k&m.opacityDirty;this._dirtyFlag=k;j&&this._syncDisplayColor();h&&this._syncDisplayOpacity();k&m.transformDirty&&this.transform(g);(j||h||k&m.gradientDirty)&&this._updateColor()};b._updateColor=function(){var g=this._node,m=g._contentSize,k=0.5*m.width,m=0.5*m.height;this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty;var j=cc.pAngleSigned(cc.p(0,-1),g._alongVector),j=cc.pRotateByAngle(cc.p(0,-1),cc.p(0,0),j),h=Math.min(Math.abs(1/j.x),Math.abs(1/j.y));this._startPoint.x=k*-j.x*h+k;this._startPoint.y=m*j.y*h-m;this._endPoint.x=k*j.x*h+k;this._endPoint.y=m*-j.y*h-m;k=this._displayedColor;m=g._endColor;j=g._startOpacity/255;h=g._endOpacity/255;this._startStopStr="rgba("+Math.round(k.r)+","+Math.round(k.g)+","+Math.round(k.b)+","+j.toFixed(4)+")";this._endStopStr="rgba("+Math.round(m.r)+","+Math.round(m.g)+","+Math.round(m.b)+","+h.toFixed(4)+")";if(g._colorStops){for(this._endOpacity=this._startOpacity=0,this._colorStopsStr=[],k=0;k<g._colorStops.length;k++){m=g._colorStops[k].color,j=null==m.a?1:m.a/255,this._colorStopsStr.push("rgba("+Math.round(m.r)+","+Math.round(m.g)+","+Math.round(m.b)+","+j.toFixed(4)+")")}}}})();(function(){cc.Layer.WebGLRenderCmd=function(c){cc.Node.WebGLRenderCmd.call(this,c)};var b=cc.Layer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);b.constructor=cc.Layer.WebGLRenderCmd;b.bake=function(){};b.unbake=function(){};b._bakeForAddChild=function(){}})();(function(){cc.LayerColor.WebGLRenderCmd=function(f){cc.Layer.WebGLRenderCmd.call(this,f);this._needDraw=!0;this._squareVerticesAB=new ArrayBuffer(32);this._squareColorsAB=new ArrayBuffer(16);f=this._squareVerticesAB;var j=this._squareColorsAB,h=cc.Vertex2F.BYTES_PER_ELEMENT,g=cc.Color.BYTES_PER_ELEMENT;this._squareVertices=[new cc.Vertex2F(0,0,f,0),new cc.Vertex2F(0,0,f,h),new cc.Vertex2F(0,0,f,2*h),new cc.Vertex2F(0,0,f,3*h)];this._squareColors=[cc.color(0,0,0,255,j,0),cc.color(0,0,0,255,j,g),cc.color(0,0,0,255,j,2*g),cc.color(0,0,0,255,j,3*g)];this._verticesFloat32Buffer=cc._renderContext.createBuffer();this._colorsUint8Buffer=cc._renderContext.createBuffer()};var b=cc.LayerColor.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);b.constructor=cc.LayerColor.WebGLRenderCmd;b.rendering=function(d){d=d||cc._renderContext;var e=this._node;this._shaderProgram.use();this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR);cc.glBlendFunc(e._blendFunc.src,e._blendFunc.dst);d.bindBuffer(d.ARRAY_BUFFER,this._verticesFloat32Buffer);d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0);d.bindBuffer(d.ARRAY_BUFFER,this._colorsUint8Buffer);d.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,d.UNSIGNED_BYTE,!0,0,0);d.drawArrays(d.TRIANGLE_STRIP,0,this._squareVertices.length)};b._updateSquareVertices=function(e,g){var f=this._squareVertices;void 0===g?(f[1].x=e.width,f[2].y=e.height,f[3].x=e.width,f[3].y=e.height):(f[1].x=e,f[2].y=g,f[3].x=e,f[3].y=g);this._bindLayerVerticesBufferData()};b._updateSquareVerticesWidth=function(d){var e=this._squareVertices;e[1].x=d;e[3].x=d;this._bindLayerVerticesBufferData()};b._updateSquareVerticesHeight=function(d){var e=this._squareVertices;e[2].y=d;e[3].y=d;this._bindLayerVerticesBufferData()};b._updateColor=function(){for(var f=this._displayedColor,j=this._displayedOpacity,h=this._squareColors,g=0;4>g;g++){h[g].r=f.r,h[g].g=f.g,h[g].b=f.b,h[g].a=j}this._bindLayerColorsBufferData()};b._bindLayerVerticesBufferData=function(){var c=cc._renderContext;c.bindBuffer(c.ARRAY_BUFFER,this._verticesFloat32Buffer);c.bufferData(c.ARRAY_BUFFER,this._squareVerticesAB,c.STATIC_DRAW)};b._bindLayerColorsBufferData=function(){var c=cc._renderContext;c.bindBuffer(c.ARRAY_BUFFER,this._colorsUint8Buffer);c.bufferData(c.ARRAY_BUFFER,this._squareColorsAB,c.STATIC_DRAW)};b.updateBlendFunc=function(c){}})();(function(){cc.LayerGradient.WebGLRenderCmd=function(c){cc.LayerColor.WebGLRenderCmd.call(this,c);this._needDraw=!0;this._clipRect=new cc.Rect;this._clippingRectDirty=!1};var b=cc.LayerGradient.WebGLRenderCmd.prototype=Object.create(cc.LayerColor.WebGLRenderCmd.prototype);cc.inject(cc.LayerGradient.RenderCmd,b);b.constructor=cc.LayerGradient.WebGLRenderCmd;b._syncStatus=function(g){var m=cc.Node._dirtyFlags,k=this._dirtyFlag,j=g?g._node:null;j&&j._cascadeColorEnabled&&g._dirtyFlag&m.colorDirty&&(k|=m.colorDirty);j&&j._cascadeOpacityEnabled&&g._dirtyFlag&m.opacityDirty&&(k|=m.opacityDirty);g&&g._dirtyFlag&m.transformDirty&&(k|=m.transformDirty);var j=k&m.colorDirty,h=k&m.opacityDirty;this._dirtyFlag=k;j&&this._syncDisplayColor();h&&this._syncDisplayOpacity();this.transform(g);(j||h||k&m.gradientDirty)&&this._updateColor()};b._updateColor=function(){this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.gradientDirty;var A=this._node,z=A._colorStops;if(z&&!(2>z.length)){this._clippingRectDirty=!0;var y=z.length,x=2*y,w,v=A._contentSize;this._squareVerticesAB=new ArrayBuffer(8*x);this._squareColorsAB=new ArrayBuffer(4*x);var u=this._squareVertices,t=this._squareColors;u.length=0;t.length=0;var r=this._squareVerticesAB,o=this._squareColorsAB,j=cc.Vertex2F.BYTES_PER_ELEMENT,B=cc.Color.BYTES_PER_ELEMENT;for(w=0;w<x;w++){u.push(new cc.Vertex2F(0,0,r,j*w)),t.push(cc.color(0,0,0,255,o,B*w))}o=Math.PI+cc.pAngleSigned(cc.p(0,-1),A._alongVector);A=cc.p(v.width/2,v.height/2);w=Math.round(cc.radiansToDegrees(o));x=cc.affineTransformMake(1,0,0,1,A.x,A.y);x=cc.affineTransformRotate(x,o);90>w?(j=cc.p(-A.x,A.y),w=cc.p(A.x,A.y)):180>w?(j=cc.p(A.x,A.y),w=cc.p(A.x,-A.y)):270>w?(j=cc.p(A.x,-A.y),w=cc.p(-A.x,-A.y)):(j=cc.p(-A.x,-A.y),w=cc.p(-A.x,A.y));r=Math.sin(o);o=Math.cos(o);j=Math.abs((j.x*o-j.y*r)/A.x);w=Math.abs((w.x*r+w.y*o)/A.y);x=cc.affineTransformScale(x,j,w);for(w=0;w<y;w++){r=z[w].p*v.height,o=cc.pointApplyAffineTransform(-A.x,r-A.y,x),u[2*w].x=o.x,u[2*w].y=o.y,r=cc.pointApplyAffineTransform(v.width-A.x,r-A.y,x),u[2*w+1].x=r.x,u[2*w+1].y=r.y}v=this._displayedOpacity/255;for(w=0;w<y;w++){u=z[w].color,A=t[2*w],x=t[2*w+1],A.r=u.r,A.g=u.g,A.b=u.b,A.a=u.a*v,x.r=u.r,x.g=u.g,x.b=u.b,x.a=u.a*v}this._bindLayerVerticesBufferData();this._bindLayerColorsBufferData()}};b.rendering=function(e){e=e||cc._renderContext;var g=this._node,f=this._getClippingRect();e.enable(e.SCISSOR_TEST);cc.view.setScissorInPoints(f.x,f.y,f.width,f.height);this._shaderProgram.use();this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR);cc.glBlendFunc(g._blendFunc.src,g._blendFunc.dst);e.bindBuffer(e.ARRAY_BUFFER,this._verticesFloat32Buffer);e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0);e.bindBuffer(e.ARRAY_BUFFER,this._colorsUint8Buffer);e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,0,0);e.drawArrays(e.TRIANGLE_STRIP,0,this._squareVertices.length);e.disable(e.SCISSOR_TEST)};b._getClippingRect=function(){if(this._clippingRectDirty){var d=this._node,e=cc.rect(0,0,d._contentSize.width,d._contentSize.height),d=d.getNodeToWorldTransform();this._clipRect=cc._rectApplyAffineTransformIn(e,d)}return this._clipRect}})();cc._tmp.PrototypeSprite=function(){var b=cc.Sprite.prototype;cc.defineGetterSetter(b,"opacityModifyRGB",b.isOpacityModifyRGB,b.setOpacityModifyRGB);cc.defineGetterSetter(b,"opacity",b.getOpacity,b.setOpacity);cc.defineGetterSetter(b,"color",b.getColor,b.setColor);cc.defineGetterSetter(b,"flippedX",b.isFlippedX,b.setFlippedX);cc.defineGetterSetter(b,"flippedY",b.isFlippedY,b.setFlippedY);cc.defineGetterSetter(b,"offsetX",b._getOffsetX);cc.defineGetterSetter(b,"offsetY",b._getOffsetY);cc.defineGetterSetter(b,"texture",b.getTexture,b.setTexture);cc.defineGetterSetter(b,"textureRectRotated",b.isTextureRectRotated);cc.defineGetterSetter(b,"batchNode",b.getBatchNode,b.setBatchNode);cc.defineGetterSetter(b,"quad",b.getQuad)};cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_className:"Sprite",ctor:function(e,d,f){cc.Node.prototype.ctor.call(this);this._shouldBeHidden=!1;this._offsetPosition=cc.p(0,0);this._unflippedOffsetPositionFromCenter=cc.p(0,0);this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._rect=cc.rect(0,0,0,0);this._softInit(e,d,f)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},isDirty:function(){return this.dirty},setDirty:function(b){this.dirty=b},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},setAtlasIndex:function(b){this.atlasIndex=b},getTextureRect:function(){return cc.rect(this._rect)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(b){this.textureAtlas=b},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(d){cc.assert(d,cc._LogInfos.Sprite_initWithSpriteFrame);d.textureLoaded()||(this._textureLoaded=!1,d.addEventListener("load",this._renderCmd._spriteFrameLoadedCallback,this));var c=cc._renderType===cc._RENDER_TYPE_CANVAS?!1:d._rotated,c=this.initWithTexture(d.getTexture(),d.getRect(),c);this.setSpriteFrame(d);return c},initWithSpriteFrameName:function(d){cc.assert(d,cc._LogInfos.Sprite_initWithSpriteFrameName);var c=cc.spriteFrameCache.getSpriteFrame(d);cc.assert(c,d+cc._LogInfos.Sprite_initWithSpriteFrameName1);return this.initWithSpriteFrame(c)},useBatchNode:function(b){this.textureAtlas=b.getTextureAtlas();this._batchNode=b},setVertexRect:function(d){var c=this._rect;c.x=d.x;c.y=d.y;c.width=d.width;c.height=d.height},sortAllChildren:function(){if(this._reorderChildDirty){var g=this._children,f=g.length,k,j,h;for(k=1;k<f;k++){h=g[k];for(j=k-1;0<=j;){if(h._localZOrder<g[j]._localZOrder){g[j+1]=g[j]}else{if(h._localZOrder===g[j]._localZOrder&&h.arrivalOrder<g[j].arrivalOrder){g[j+1]=g[j]}else{break}}j--}g[j+1]=h}this._batchNode&&this._arrayMakeObjectsPerformSelector(g,cc.Node._stateCallbackType.sortAllChildren);this._reorderChildDirty=!1}},reorderChild:function(d,c){cc.assert(d,cc._LogInfos.Sprite_reorderChild_2);-1===this._children.indexOf(d)?cc.log(cc._LogInfos.Sprite_reorderChild):c!==d.zIndex&&(this._batchNode&&!this._reorderChildDirty&&(this._setReorderChildDirtyRecursively(),this._batchNode.reorderBatch(!0)),cc.Node.prototype.reorderChild.call(this,d,c))},removeChild:function(d,c){this._batchNode&&this._batchNode.removeSpriteFromAtlas(d);cc.Node.prototype.removeChild.call(this,d,c)},setVisible:function(b){cc.Node.prototype.setVisible.call(this,b);this._renderCmd.setDirtyRecursively(!0)},removeAllChildren:function(g){var f=this._children,k=this._batchNode;if(k&&null!=f){for(var j=0,h=f.length;j<h;j++){k.removeSpriteFromAtlas(f[j])}}cc.Node.prototype.removeAllChildren.call(this,g);this._hasChildren=!1},ignoreAnchorPointForPosition:function(b){this._batchNode?cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition):cc.Node.prototype.ignoreAnchorPointForPosition.call(this,b)},setFlippedX:function(b){this._flippedX!==b&&(this._flippedX=b,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(b){this._flippedY!==b&&(this._flippedY=b,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:function(b){this._opacityModifyRGB!==b&&(this._opacityModifyRGB=b,this._renderCmd._setColorDirty())},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setDisplayFrameWithAnimationName:function(e,d){cc.assert(e,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);var f=cc.animationCache.getAnimation(e);f?(f=f.getFrames()[d])?this.setSpriteFrame(f.getSpriteFrame()):cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2):cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=!0;for(var b=this._parent;b&&b!==this._batchNode;){b._setReorderChildDirtyRecursively(),b=b.parent}}},getTexture:function(){return this._texture},_softInit:function(e,d,f){if(void 0===e){cc.Sprite.prototype.init.call(this)}else{if(cc.isString(e)){"#"===e[0]?(d=e.substr(1,e.length-1),(d=cc.spriteFrameCache.getSpriteFrame(d))?this.initWithSpriteFrame(d):cc.log("%s does not exist",e)):cc.Sprite.prototype.init.call(this,e,d)}else{if("object"===typeof e){if(e instanceof cc.Texture2D){this.initWithTexture(e,d,f)}else{if(e instanceof cc.SpriteFrame){this.initWithSpriteFrame(e)}else{if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){d=new cc.Texture2D,d.initWithElement(e),d.handleLoadedTexture(),this.initWithTexture(d)}}}}}}},getQuad:function(){return this._renderCmd.getQuad()},setBlendFunc:function(e,d){var f=this._blendFunc;void 0===d?(f.src=e.src,f.dst=e.dst):(f.src=e,f.dst=d);this._renderCmd.updateBlendFunc(f)},init:function(){if(0<arguments.length){return this.initWithFile(arguments[0],arguments[1])}cc.Node.prototype.init.call(this);this.dirty=this._recursiveDirty=!1;this._blendFunc.src=cc.BLEND_SRC;this._blendFunc.dst=cc.BLEND_DST;this.texture=null;this._flippedX=this._flippedY=!1;this.anchorY=this.anchorX=0.5;this._offsetPosition.x=0;this._offsetPosition.y=0;this._hasChildren=!1;this._renderCmd._init();this.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0));return !0},initWithFile:function(f,e){cc.assert(f,cc._LogInfos.Sprite_initWithFile);var h=cc.textureCache.getTextureForKey(f);if(h){if(!e){var g=h.getContentSize();e=cc.rect(0,0,g.width,g.height)}return this.initWithTexture(h,e)}h=cc.textureCache.addImage(f);return this.initWithTexture(h,e||cc.rect(0,0,h._contentSize.width,h._contentSize.height))},initWithTexture:function(g,f,k,j){cc.assert(0!==arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture);k=k||!1;g=this._renderCmd._handleTextureForRotatedTexture(g,f,k,j);if(!cc.Node.prototype.init.call(this)){return !1}this._batchNode=null;this.dirty=this._recursiveDirty=!1;this._opacityModifyRGB=!0;this._blendFunc.src=cc.BLEND_SRC;this._blendFunc.dst=cc.BLEND_DST;this._flippedX=this._flippedY=!1;this.setAnchorPoint(0.5,0.5);this._offsetPosition.x=0;this._offsetPosition.y=0;this._hasChildren=!1;this._renderCmd._init();var h=g.isLoaded();this._textureLoaded=h;if(!h){return this._rectRotated=k,f&&(this._rect.x=f.x,this._rect.y=f.y,this._rect.width=f.width,this._rect.height=f.height),this.texture&&this.texture.removeEventListener("load",this),g.addEventListener("load",this._renderCmd._textureLoadedCallback,this),this.texture=g,!0}f||(f=cc.rect(0,0,g.width,g.height));this._renderCmd._checkTextureBoundary(g,f,k);this.texture=g;this.setTextureRect(f,k);this.setBatchNode(null);return !0},setTextureRect:function(f,e,h,g){this._rectRotated=e||!1;this.setContentSize(h||f);this.setVertexRect(f);this._renderCmd._setTextureCoords(f,g);f=this._unflippedOffsetPositionFromCenter.x;e=this._unflippedOffsetPositionFromCenter.y;this._flippedX&&(f=-f);this._flippedY&&(e=-e);h=this._rect;this._offsetPosition.x=f+(this._contentSize.width-h.width)/2;this._offsetPosition.y=e+(this._contentSize.height-h.height)/2;this._batchNode?this.dirty=!0:this._renderCmd._resetForBatchNode()},updateTransform:function(){this._renderCmd.updateTransform()},addChild:function(e,d,f){cc.assert(e,cc._LogInfos.CCSpriteBatchNode_addChild_2);null==d&&(d=e._localZOrder);null==f&&(f=e.tag);this._renderCmd._setBatchNodeForAddChild(e)&&(cc.Node.prototype.addChild.call(this,e,d,f),this._hasChildren=!0)},setSpriteFrame:function(e){var d=this;cc.isString(e)&&(e=cc.spriteFrameCache.getSpriteFrame(e),cc.assert(e,cc._LogInfos.Sprite_setSpriteFrame));this.setNodeDirty(!0);var f=e.getOffset();d._unflippedOffsetPositionFromCenter.x=f.x;d._unflippedOffsetPositionFromCenter.y=f.y;f=e.getTexture();e.textureLoaded()?(f!==d._texture&&(d.texture=f),d.setTextureRect(e.getRect(),e.isRotated(),e.getOriginalSize())):(d._textureLoaded=!1,e.addEventListener("load",function(b){d._textureLoaded=!0;var g=b.getTexture();g!==d._texture&&(d.texture=g);d.setTextureRect(b.getRect(),b.isRotated(),b.getOriginalSize());d.dispatchEvent("load");d.setColor(d.color)},d));this._renderCmd._updateForSetSpriteFrame(f)},setDisplayFrame:function(b){cc.log(cc._LogInfos.Sprite_setDisplayFrame);this.setSpriteFrame(b)},isFrameDisplayed:function(b){return this._renderCmd.isFrameDisplayed(b)},displayFrame:function(){return this.getSpriteFrame()},getSpriteFrame:function(){return new cc.SpriteFrame(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:function(b){(this._batchNode=b)?(this._transformToBatch=cc.affineTransformIdentity(),this.textureAtlas=this._batchNode.getTextureAtlas()):(this.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED,this.textureAtlas=null,this.dirty=this._recursiveDirty=!1,this._renderCmd._resetForBatchNode())},setTexture:function(b){if(!b){return this._renderCmd._setTexture(null)}cc.isString(b)?(b=cc.textureCache.addImage(b),b._textureLoaded?(this._clearRect(),this._renderCmd._setTexture(b),this._changeRectWithTexture(b.getContentSize()),this.setColor(this._realColor),this._textureLoaded=!0):b.addEventListener("load",function(){this._clearRect();this._renderCmd._setTexture(b);this._changeRectWithTexture(b.getContentSize());this.setColor(this._realColor);this._textureLoaded=!0},this)):(cc.assert(b instanceof cc.Texture2D,cc._LogInfos.Sprite_setTexture_2),this._clearRect(),this._changeRectWithTexture(b.getContentSize()),this._renderCmd._setTexture(b))},_clearRect:function(){var d=this._texture;if(d){var d=d._contentSize,c=this._rect;d.width===c.width&&d.height===c.height&&(c.width=c.height=0)}},_changeRectWithTexture:function(d){if(d&&(d.width||d.height)){var c=this.getTextureRect();c.height||c.width||(d.x=d.x||0,d.y=d.y||0,d.width=d.width||0,d.height=d.height||0,this.setTextureRect(d))}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.Sprite.CanvasRenderCmd(this):new cc.Sprite.WebGLRenderCmd(this)}});cc.Sprite.create=function(e,d,f){return new cc.Sprite(e,d,f)};cc.Sprite.createWithTexture=cc.Sprite.create;cc.Sprite.createWithSpriteFrameName=cc.Sprite.create;cc.Sprite.createWithSpriteFrame=cc.Sprite.create;cc.Sprite.INDEX_NOT_INITIALIZED=-1;cc.EventHelper.prototype.apply(cc.Sprite.prototype);cc.assert(cc.isFunction(cc._tmp.PrototypeSprite),cc._LogInfos.MissingFile,"SpritesPropertyDefine.js");cc._tmp.PrototypeSprite();delete cc._tmp.PrototypeSprite;(function(){cc.Sprite.CanvasRenderCmd=function(c){cc.Node.CanvasRenderCmd.call(this,c);this._needDraw=!0;this._textureCoord={renderX:0,renderY:0,x:0,y:0,width:0,height:0,validRect:!1};this._blendFuncStr="source-over";this._colorized=!1;this._originalTexture=null};var b=cc.Sprite.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);b.constructor=cc.Sprite.CanvasRenderCmd;b._init=function(){};b.setDirtyRecursively=function(c){};b._resetForBatchNode=function(){};b._setTexture=function(d){var e=this._node;e._texture!==d&&(d?(d.getHtmlElementObj() instanceof HTMLImageElement&&(this._originalTexture=d),e._textureLoaded=d._textureLoaded):e._textureLoaded=!1,e._texture=d)};b._setColorDirty=function(){this.setDirtyFlag(cc.Node._dirtyFlags.colorDirty|cc.Node._dirtyFlags.opacityDirty)};b.isFrameDisplayed=function(d){var e=this._node;return d.getTexture()!==e._texture?!1:cc.rectEqualToRect(d.getRect(),e._rect)};b.updateBlendFunc=function(c){this._blendFuncStr=cc.Node.CanvasRenderCmd._getCompositeOperationByBlendFunc(c)};b._setBatchNodeForAddChild=function(c){return !0};b._handleTextureForRotatedTexture=function(f,j,h,g){h&&f.isLoaded()&&(f=f.getHtmlElementObj(),f=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(f,j,g),g=new cc.Texture2D,g.initWithElement(f),g.handleLoadedTexture(),f=g,j.x=j.y=0,this._node._rect=cc.rect(0,0,j.width,j.height));return f};b._checkTextureBoundary=function(e,g,f){e&&e.url&&(f=g.y+g.height,g.x+g.width>e.width&&cc.error(cc._LogInfos.RectWidth,e.url),f>e.height&&cc.error(cc._LogInfos.RectHeight,e.url));this._node._originalTexture=e};b.rendering=function(z,y,x){var w=this._node,v=this._textureCoord,u=this._displayedOpacity/255;if((!w._texture||0!==v.width&&0!==v.height&&w._texture._textureLoaded)&&0!==u){z=z||cc._renderContext;var t=z.getContext(),s=w._offsetPosition.x,r=w._rect.height,o=w._rect.width,j=-w._offsetPosition.y-r;z.setTransform(this._worldTransform,y,x);z.setCompositeOperation(this._blendFuncStr);z.setGlobalAlpha(u);(w._flippedX||w._flippedY)&&z.save();w._flippedX&&(s=-s-o,t.scale(-1,1));w._flippedY&&(j=w._offsetPosition.y,t.scale(1,-1));w._texture?(u=w._texture._htmlElementObj,""!==w._texture._pattern?(z.setFillStyle(t.createPattern(u,w._texture._pattern)),t.fillRect(s*y,j*x,o*y,r*x)):this._colorized?t.drawImage(u,0,0,v.width,v.height,s*y,j*x,o*y,r*x):t.drawImage(u,v.renderX,v.renderY,v.width,v.height,s*y,j*x,o*y,r*x)):(u=w._contentSize,v.validRect&&(v=this._displayedColor,z.setFillStyle("rgba("+v.r+","+v.g+","+v.b+",1)"),t.fillRect(s*y,j*x,u.width*y,u.height*x)));(w._flippedX||w._flippedY)&&z.restore();cc.g_NumberOfDraws++}};b._updateColor=cc.sys._supportCanvasNewBlendModes?function(){var g=this._node,m=this._displayedColor;if(255===m.r&&255===m.g&&255===m.b){this._colorized&&(this._colorized=!1,g.texture=this._originalTexture)}else{var k,j=g._texture,h=this._textureCoord;j&&h.validRect&&this._originalTexture&&(k=j.getHtmlElementObj())&&(this._colorized=!0,k instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor&&this._originalTexture._htmlElementObj!==k?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,m,h,k):(k=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(this._originalTexture._htmlElementObj,m,h),j=new cc.Texture2D,j.initWithElement(k),j.handleLoadedTexture(),g.texture=j))}}:function(){var g=this._node,m=this._displayedColor;if(255===m.r&&255===m.g&&255===m.b){this._colorized&&(this._colorized=!1,g.texture=this._originalTexture)}else{var k,j=g._texture,h=this._textureCoord;j&&h.validRect&&this._originalTexture&&(k=j.getHtmlElementObj())&&(j=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj()))&&(this._colorized=!0,k instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor?cc.Sprite.CanvasRenderCmd._generateTintImage(k,j,m,h,k):(k=cc.Sprite.CanvasRenderCmd._generateTintImage(k,j,m,h),j=new cc.Texture2D,j.initWithElement(k),j.handleLoadedTexture(),g.texture=j))}};b.getQuad=function(){return null};b._updateForSetSpriteFrame=function(e,g){var f=this._node;f._rectRotated&&(f._originalTexture=e);this._colorized=!1;this._textureCoord.renderX=this._textureCoord.x;this._textureCoord.renderY=this._textureCoord.y;g&&(f=f.getColor(),255===f.r&&255===f.g&&255===f.b||this._updateColor())};b.updateTransform=function(){var d=this._node;if(d.dirty){var e=d._parent;!d._visible||e&&e!==d._batchNode&&e._shouldBeHidden?d._shouldBeHidden=!0:(d._shouldBeHidden=!1,d._transformToBatch=e&&e!==d._batchNode?cc.affineTransformConcat(this.getNodeToParentTransform(),e._transformToBatch):this.getNodeToParentTransform());d._recursiveDirty=!1;d.dirty=!1}d._hasChildren&&d._arrayMakeObjectsPerformSelector(d._children,cc.Node._stateCallbackType.updateTransform)};b._updateDisplayColor=function(c){cc.Node.CanvasRenderCmd.prototype._updateDisplayColor.call(this,c)};b._spriteFrameLoadedCallback=function(c){this.setTextureRect(c.getRect(),c.isRotated(),c.getOriginalSize());this._renderCmd._updateColor();this.dispatchEvent("load")};b._textureLoadedCallback=function(e){if(!this._textureLoaded){this._textureLoaded=!0;var g=this._rect,f=this._renderCmd;g?cc._rectEqualToZero(g)&&(g.width=e.width,g.height=e.height):g=cc.rect(0,0,e.width,e.height);this.texture=f._originalTexture=e;this.setTextureRect(g,this._rectRotated);e=f._displayedColor;255===e.r&&255===e.g&&255===e.b||f._updateColor();this.setBatchNode(this._batchNode);this.dispatchEvent("load")}};b._setTextureCoords=function(f,j){void 0===j&&(j=!0);var h=this._textureCoord,g=j?cc.contentScaleFactor():1;h.renderX=h.x=0|f.x*g;h.renderY=h.y=0|f.y*g;h.width=0|f.width*g;h.height=0|f.height*g;h.validRect=!(0===h.width||0===h.height||0>h.x||0>h.y);this._colorized&&(this._node._texture=this._originalTexture,this._colorized=!1)};cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply=function(g,m,k,j){j=j||cc.newElement("canvas");k=k||cc.rect(0,0,g.width,g.height);var h=j.getContext("2d");j.width!==k.width||j.height!==k.height?(j.width=k.width,j.height=k.height):h.globalCompositeOperation="source-over";h.fillStyle="rgb("+(0|m.r)+","+(0|m.g)+","+(0|m.b)+")";h.fillRect(0,0,k.width,k.height);h.globalCompositeOperation="multiply";h.drawImage(g,k.x,k.y,k.width,k.height,0,0,k.width,k.height);h.globalCompositeOperation="destination-atop";h.drawImage(g,k.x,k.y,k.width,k.height,0,0,k.width,k.height);return j};cc.Sprite.CanvasRenderCmd._generateTintImage=function(x,w,v,u,t){u||(u=cc.rect(0,0,x.width,x.height));x=v.r/255;var s=v.g/255;v=v.b/255;var r=Math.min(u.width,w[0].width),p=Math.min(u.height,w[0].height),o;t?(o=t.getContext("2d"),o.clearRect(0,0,r,p)):(t=cc.newElement("canvas"),t.width=r,t.height=p,o=t.getContext("2d"));o.save();o.globalCompositeOperation="lighter";var j=o.globalAlpha;0<x&&(o.globalAlpha=x*j,o.drawImage(w[0],u.x,u.y,r,p,0,0,r,p));0<s&&(o.globalAlpha=s*j,o.drawImage(w[1],u.x,u.y,r,p,0,0,r,p));0<v&&(o.globalAlpha=v*j,o.drawImage(w[2],u.x,u.y,r,p,0,0,r,p));1>x+s+v&&(o.globalAlpha=j,o.drawImage(w[3],u.x,u.y,r,p,0,0,r,p));o.restore();return t};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor=function(f){function j(){var x=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor,w=f.width,v=f.height;h[0].width=w;h[0].height=v;h[1].width=w;h[1].height=v;h[2].width=w;h[2].height=v;h[3].width=w;h[3].height=v;x.canvas.width=w;x.canvas.height=v;var u=x.canvas.getContext("2d");u.drawImage(f,0,0);x.tempCanvas.width=w;x.tempCanvas.height=v;for(var u=u.getImageData(0,0,w,v).data,t=0;4>t;t++){var o=h[t].getContext("2d");o.getImageData(0,0,w,v).data;x.tempCtx.drawImage(f,0,0);for(var d=x.tempCtx.getImageData(0,0,w,v),y=d.data,a=0;a<u.length;a+=4){y[a]=0===t?u[a]:0,y[a+1]=1===t?u[a+1]:0,y[a+2]=2===t?u[a+2]:0,y[a+3]=u[a+3]}o.putImageData(d,0,0)}f.onload=null}if(f.channelCache){return f.channelCache}var h=[cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas")];try{j()}catch(g){f.onload=j}return f.channelCache=h};cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.canvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas=cc.newElement("canvas");cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCtx=cc.Sprite.CanvasRenderCmd._generateTextureCacheForColor.tempCanvas.getContext("2d");cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas=function(g,m,k){if(!g){return null}if(!m){return g}k=null==k?!0:k;var j=cc.newElement("canvas");j.width=m.width;j.height=m.height;var h=j.getContext("2d");h.translate(j.width/2,j.height/2);k?h.rotate(-1.5707963267948966):h.rotate(1.5707963267948966);h.drawImage(g,m.x,m.y,m.height,m.width,-m.height/2,-m.width/2,m.height,m.width);return j}})();(function(){cc.Sprite.WebGLRenderCmd=function(c){cc.Node.WebGLRenderCmd.call(this,c);this._needDraw=!0;this._quad=new cc.V3F_C4B_T2F_Quad;this._quadWebBuffer=cc._renderContext.createBuffer();this._quadDirty=!0;this._recursiveDirty=this._dirty=!1};var b=cc.Sprite.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);b.constructor=cc.Sprite.WebGLRenderCmd;b.updateBlendFunc=function(c){};b.setDirtyFlag=function(c){cc.Node.WebGLRenderCmd.prototype.setDirtyFlag.call(this,c);this._dirty=!0};b.setDirtyRecursively=function(g){this._dirty=this._recursiveDirty=g;for(var m=this._node._children,k,j=m?m.length:0,h=0;h<j;h++){k=m[h],k instanceof cc.Sprite&&k._renderCmd.setDirtyRecursively(g)}};b._setBatchNodeForAddChild=function(d){var e=this._node;if(e._batchNode){if(!(d instanceof cc.Sprite)){return cc.log(cc._LogInfos.Sprite_addChild),!1}d.texture._webTextureObj!==e.textureAtlas.texture._webTextureObj&&cc.log(cc._LogInfos.Sprite_addChild_2);e._batchNode.appendChild(d);e._reorderChildDirty||e._setReorderChildDirtyRecursively()}return !0};b._handleTextureForRotatedTexture=function(c){return c};b.isFrameDisplayed=function(d){var e=this._node;return cc.rectEqualToRect(d.getRect(),e._rect)&&d.getTexture().getName()===e._texture.getName()&&cc.pointEqualToPoint(d.getOffset(),e._unflippedOffsetPositionFromCenter)};b._init=function(){var d={r:255,g:255,b:255,a:255},e=this._quad;e.bl.colors=d;e.br.colors=d;e.tl.colors=d;e.tr.colors=d;this._quadDirty=!0};b._resetForBatchNode=function(){var g=this._node,m=g._offsetPosition.x,k=g._offsetPosition.y,j=m+g._rect.width,g=k+g._rect.height,h=this._quad;h.bl.vertices={x:m,y:k,z:0};h.br.vertices={x:j,y:k,z:0};h.tl.vertices={x:m,y:g,z:0};h.tr.vertices={x:j,y:g,z:0};this._quadDirty=!0};b.getQuad=function(){return this._quad};b._updateForSetSpriteFrame=function(){};b._spriteFrameLoadedCallback=function(c){this.setTextureRect(c.getRect(),c.isRotated(),c.getOriginalSize());this.dispatchEvent("load")};b._textureLoadedCallback=function(e){var g=this._renderCmd;if(!this._textureLoaded){this._textureLoaded=!0;var f=this._rect;f?cc._rectEqualToZero(f)&&(f.width=e.width,f.height=e.height):f=cc.rect(0,0,e.width,e.height);this.texture=e;this.setTextureRect(f,this._rectRotated);this.setBatchNode(this._batchNode);g._quadDirty=!0;this.dispatchEvent("load")}};b._setTextureCoords=function(v,u){void 0===u&&(u=!0);u&&(v=cc.rectPointsToPixels(v));var t=this._node,s=t._batchNode?t.textureAtlas.texture:t._texture;if(s){var r=s.pixelsWidth,p=s.pixelsHeight,o,n,j=this._quad;t._rectRotated?(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(2*v.x+1)/(2*r),r=s+(2*v.height-2)/(2*r),o=(2*v.y+1)/(2*p),p=o+(2*v.width-2)/(2*p)):(s=v.x/r,r=(v.x+v.height)/r,o=v.y/p,p=(v.y+v.width)/p),t._flippedX&&(n=o,o=p,p=n),t._flippedY&&(n=s,s=r,r=n),j.bl.texCoords.u=s,j.bl.texCoords.v=o,j.br.texCoords.u=s,j.br.texCoords.v=p,j.tl.texCoords.u=r,j.tl.texCoords.v=o,j.tr.texCoords.u=r,j.tr.texCoords.v=p):(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(s=(2*v.x+1)/(2*r),r=s+(2*v.width-2)/(2*r),o=(2*v.y+1)/(2*p),p=o+(2*v.height-2)/(2*p)):(s=v.x/r,r=(v.x+v.width)/r,o=v.y/p,p=(v.y+v.height)/p),t._flippedX&&(n=s,s=r,r=n),t._flippedY&&(n=o,o=p,p=n),j.bl.texCoords.u=s,j.bl.texCoords.v=p,j.br.texCoords.u=r,j.br.texCoords.v=p,j.tl.texCoords.u=s,j.tl.texCoords.v=o,j.tr.texCoords.u=r,j.tr.texCoords.v=o);this._quadDirty=!0}};b.transform=function(d,e){cc.Node.WebGLRenderCmd.prototype.transform.call(this,d,e);this._dirty=!0};b._setColorDirty=function(){};b._updateColor=function(){var e=this._displayedColor,g=this._displayedOpacity,f=this._node,e={r:e.r,g:e.g,b:e.b,a:g};f._opacityModifyRGB&&(e.r*=g/255,e.g*=g/255,e.b*=g/255);g=this._quad;g.bl.colors=e;g.br.colors=e;g.tl.colors=e;g.tr.colors=e;f._batchNode&&(f.atlasIndex!==cc.Sprite.INDEX_NOT_INITIALIZED?f.textureAtlas.updateQuad(g,f.atlasIndex):this._dirty=!0);this._quadDirty=!0};b._updateBlendFunc=function(){if(this._batchNode){cc.log(cc._LogInfos.Sprite__updateBlendFunc)}else{var c=this._node;c._texture&&c._texture.hasPremultipliedAlpha()?(c._blendFunc.src=cc.BLEND_SRC,c._blendFunc.dst=cc.BLEND_DST,c.opacityModifyRGB=!0):(c._blendFunc.src=cc.SRC_ALPHA,c._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA,c.opacityModifyRGB=!1)}};b._setTexture=function(d){var e=this._node;if(e._batchNode){if(e._batchNode.texture!==d){cc.log(cc._LogInfos.Sprite_setTexture);return}}else{e._texture!==d&&(e._textureLoaded=d?d._textureLoaded:!1,e._texture=d,this._updateBlendFunc())}this._shaderProgram=d?cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR):cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR)};b.updateTransform=function(){var F=this._node;if(this._dirty){var E=this._quad,D=F._parent;if(!F._visible||D&&D!==F._batchNode&&D._shouldBeHidden){E.br.vertices=E.tl.vertices=E.tr.vertices=E.bl.vertices={x:0,y:0,z:0},F._shouldBeHidden=!0}else{F._shouldBeHidden=!1;0!==this._dirtyFlag&&(this.updateStatus(),this._dirtyFlag=0);F._transformToBatch=D&&D!==F._batchNode?cc.affineTransformConcat(this.getNodeToParentTransform(),D._transformToBatch):this.getNodeToParentTransform();var C=F._transformToBatch,B=F._rect,D=F._offsetPosition.x,A=F._offsetPosition.y,z=D+B.width,y=A+B.height,x=C.tx,w=C.ty,o=C.a,J=C.b,j=C.d,H=-C.c,C=D*o-A*H+x,B=D*J+A*j+w,I=z*o-A*H+x,A=z*J+A*j+w,G=z*o-y*H+x,z=z*J+y*j+w,x=D*o-y*H+x,D=D*J+y*j+w,y=F._vertexZ;cc.SPRITEBATCHNODE_RENDER_SUBPIXEL||(C|=0,B|=0,I|=0,A|=0,G|=0,z|=0,x|=0,D|=0);E.bl.vertices={x:C,y:B,z:y};E.br.vertices={x:I,y:A,z:y};E.tl.vertices={x:x,y:D,z:y};E.tr.vertices={x:G,y:z,z:y}}F.textureAtlas.updateQuad(E,F.atlasIndex);this._dirty=F._recursiveDirty=!1}F._hasChildren&&F._arrayMakeObjectsPerformSelector(F._children,cc.Node._stateCallbackType.updateTransform)};b._checkTextureBoundary=function(e,g,f){e&&e.url&&(f?(f=g.x+g.height,g=g.y+g.width):(f=g.x+g.width,g=g.y+g.height),f>e.width&&cc.error(cc._LogInfos.RectWidth,e.url),g>e.height&&cc.error(cc._LogInfos.RectHeight,e.url))};b.rendering=function(e){var g=this._node,f=g._texture;f&&!f._textureLoaded||0===this._displayedOpacity||(e=e||cc._renderContext,f?f._textureLoaded&&(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFunc(g._blendFunc.src,g._blendFunc.dst),cc.glBindTexture2DN(0,f),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX),e.bindBuffer(e.ARRAY_BUFFER,this._quadWebBuffer),this._quadDirty&&(e.bufferData(e.ARRAY_BUFFER,this._quad.arrayBuffer,e.DYNAMIC_DRAW),this._quadDirty=!1),e.vertexAttribPointer(0,3,e.FLOAT,!1,24,0),e.vertexAttribPointer(1,4,e.UNSIGNED_BYTE,!0,24,12),e.vertexAttribPointer(2,2,e.FLOAT,!1,24,16),e.drawArrays(e.TRIANGLE_STRIP,0,4)):(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),cc.glBlendFunc(g._blendFunc.src,g._blendFunc.dst),cc.glBindTexture2D(null),cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR),e.bindBuffer(e.ARRAY_BUFFER,this._quadWebBuffer),this._quadDirty&&(e.bufferData(e.ARRAY_BUFFER,this._quad.arrayBuffer,e.STATIC_DRAW),this._quadDirty=!1),e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,e.FLOAT,!1,24,0),e.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,e.UNSIGNED_BYTE,!0,24,12),e.drawArrays(e.TRIANGLE_STRIP,0,4)),cc.g_NumberOfDraws++,0===cc.SPRITE_DEBUG_DRAW&&!g._showNode)||(cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.current_stack.stack.push(cc.current_stack.top),cc.current_stack.top=this._stackMatrix,1===cc.SPRITE_DEBUG_DRAW||g._showNode?(g=this._quad,g=[cc.p(g.tl.vertices.x,g.tl.vertices.y),cc.p(g.bl.vertices.x,g.bl.vertices.y),cc.p(g.br.vertices.x,g.br.vertices.y),cc.p(g.tr.vertices.x,g.tr.vertices.y)],cc._drawingUtil.drawPoly(g,4,!0)):2===cc.SPRITE_DEBUG_DRAW&&(f=g.getTextureRect(),g=g.getOffsetPosition(),g=[cc.p(g.x,g.y),cc.p(g.x+f.width,g.y),cc.p(g.x+f.width,g.y+f.height),cc.p(g.x,g.y+f.height)],cc._drawingUtil.drawPoly(g,4,!0)),cc.current_stack.top=cc.current_stack.stack.pop())}})();cc.SpriteBatchNode=cc.Node.extend({_blendFunc:null,_descendants:null,_className:"SpriteBatchNode",ctor:function(e,d){cc.Node.prototype.ctor.call(this);this._descendants=[];this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);var f;d=d||cc.SpriteBatchNode.DEFAULT_CAPACITY;cc.isString(e)?(f=cc.textureCache.getTextureForKey(e))||(f=cc.textureCache.addImage(e)):e instanceof cc.Texture2D&&(f=e);f&&this.initWithTexture(f,d)},addSpriteWithoutQuad:function(j,h,p){cc.assert(j,cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad_2);if(!(j instanceof cc.Sprite)){return cc.log(cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad),null}j.atlasIndex=h;var o=0,n,m=this._descendants;if(m&&0<m.length){for(o=0,n=m.length;o<n;o++){var k=m[o];if(k&&k.atlasIndex>=h){break}}}m.splice(o,0,j);cc.Node.prototype.addChild.call(this,j,h,p);this.reorderBatch(!1);return this},getTextureAtlas:function(){return this._renderCmd.getTextureAtlas()},setTextureAtlas:function(b){this._renderCmd.getTextureAtlas(b)},getDescendants:function(){return this._descendants},initWithFile:function(e,d){var f=cc.textureCache.getTextureForKey(e);f||(f=cc.textureCache.addImage(e));return this.initWithTexture(f,d)},_setNodeDirtyForCache:function(){this._renderCmd&&this._renderCmd._setNodeDirtyForCache&&this._renderCmd._setNodeDirtyForCache()},init:function(e,d){var f=cc.textureCache.getTextureForKey(e);f||(f=cc.textureCache.addImage(e));return this.initWithTexture(f,d)},increaseAtlasCapacity:function(){this._renderCmd.increaseAtlasCapacity()},removeChildAtIndex:function(d,c){this.removeChild(this._children[d],c)},rebuildIndexInOrder:function(g,f){var k=g.children;if(k&&0<k.length){for(var j=0;j<k.length;j++){var h=k[j];h&&0>h.zIndex&&(f=this.rebuildIndexInOrder(h,f))}}!g===this&&(g.atlasIndex=f,f++);if(k&&0<k.length){for(j=0;j<k.length;j++){(h=k[j])&&0<=h.zIndex&&(f=this.rebuildIndexInOrder(h,f))}}return f},highestAtlasIndexInChild:function(d){var c=d.children;return c&&0!==c.length?this.highestAtlasIndexInChild(c[c.length-1]):d.atlasIndex},lowestAtlasIndexInChild:function(d){var c=d.children;return c&&0!==c.length?this.lowestAtlasIndexInChild(c[c.length-1]):d.atlasIndex},atlasIndexForChild:function(h,g){var n=h.parent,m=n.children,k=m.indexOf(h),j=null;0<k&&k<cc.UINT_MAX&&(j=m[k-1]);return n===this?0===k?0:this.highestAtlasIndexInChild(j)+1:0===k?0>g?n.atlasIndex:n.atlasIndex+1:0>j.zIndex&&0>g||0<=j.zIndex&&0<=g?this.highestAtlasIndexInChild(j)+1:n.atlasIndex+1},reorderBatch:function(b){this._reorderChildDirty=b},setBlendFunc:function(d,c){this._blendFunc=void 0===c?d:{src:d,dst:c}},getBlendFunc:function(){return new cc.BlendFunc(this._blendFunc.src,this._blendFunc.dst)},reorderChild:function(d,c){cc.assert(d,cc._LogInfos.SpriteBatchNode_reorderChild_2);-1===this._children.indexOf(d)?cc.log(cc._LogInfos.SpriteBatchNode_reorderChild):c!==d.zIndex&&cc.Node.prototype.reorderChild.call(this,d,c)},removeChild:function(d,c){null!=d&&(-1===this._children.indexOf(d)?cc.log(cc._LogInfos.SpriteBatchNode_removeChild):(this.removeSpriteFromAtlas(d),cc.Node.prototype.removeChild.call(this,d,c)))},updateQuadFromSprite:function(d,c){cc.assert(d,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2);d instanceof cc.Sprite?(this._renderCmd.checkAtlasCapacity(),d.batchNode=this,d.atlasIndex=c,d.dirty=!0,d.updateTransform()):cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},insertQuadFromSprite:function(d,c){cc.assert(d,cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite_2);d instanceof cc.Sprite?(this._renderCmd.insertQuad(d,c),d.batchNode=this,d.atlasIndex=c,d.dirty=!0,d.updateTransform(),this._renderCmd.cutting(d,c)):cc.log(cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite)},initWithTexture:function(d,c){this._children.length=0;this._descendants.length=0;c=c||cc.SpriteBatchNode.DEFAULT_CAPACITY;this._renderCmd.initWithTexture(d,c);return !0},insertChild:function(j,h){j.batchNode=this;j.atlasIndex=h;j.dirty=!0;this._renderCmd.insertQuad(j,h);this._descendants.splice(h,0,j);var p=h+1,o=this._descendants;if(o&&0<o.length){for(;p<o.length;p++){o[p].atlasIndex++}}var o=j.children,n,m;if(o){for(p=0,m=o.length||0;p<m;p++){if(n=o[p]){var k=this.atlasIndexForChild(n,n.zIndex);this.insertChild(n,k)}}}},appendChild:function(e){this._reorderChildDirty=!0;e.batchNode=this;e.dirty=!0;this._descendants.push(e);var d=this._descendants.length-1;e.atlasIndex=d;this._renderCmd.insertQuad(e,d);e=e.children;for(var d=0,f=e.length||0;d<f;d++){this.appendChild(e[d])}},removeSpriteFromAtlas:function(f){this._renderCmd.removeQuadAtIndex(f.atlasIndex);f.batchNode=null;var e=this._descendants,h=e.indexOf(f);if(-1!==h){e.splice(h,1);for(var g=e.length;h<g;++h){e[h].atlasIndex--}}if(f=f.children){for(e=0,h=f.length||0;e<h;e++){f[e]&&this.removeSpriteFromAtlas(f[e])}}},getTexture:function(){return this._renderCmd.getTexture()},setTexture:function(b){this._renderCmd.setTexture(b)},addChild:function(e,d,f){cc.assert(null!=e,cc._LogInfos.CCSpriteBatchNode_addChild_3);this._renderCmd.isValidChild(e)&&(d=null==d?e.zIndex:d,f=null==f?e.tag:f,cc.Node.prototype.addChild.call(this,e,d,f),this.appendChild(e))},removeAllChildren:function(f){var e=this._descendants;if(e&&0<e.length){for(var h=0,g=e.length;h<g;h++){e[h]&&(e[h].batchNode=null)}}cc.Node.prototype.removeAllChildren.call(this,f);this._descendants.length=0;this._renderCmd.removeAllQuads()},sortAllChildren:function(){if(this._reorderChildDirty){var h=this._children,g,n=0,m=h.length,k;for(g=1;g<m;g++){var j=h[g],n=g-1;for(k=h[n];0<=n&&(j._localZOrder<k._localZOrder||j._localZOrder===k._localZOrder&&j.arrivalOrder<k.arrivalOrder);){h[n+1]=k,n-=1,k=h[n]}h[n+1]=j}0<h.length&&(this._arrayMakeObjectsPerformSelector(h,cc.Node._stateCallbackType.sortAllChildren),this._renderCmd.updateChildrenAtlasIndex(h));this._reorderChildDirty=!1}},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.SpriteBatchNode.CanvasRenderCmd(this):new cc.SpriteBatchNode.WebGLRenderCmd(this)}});_p=cc.SpriteBatchNode.prototype;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);cc.defineGetterSetter(_p,"textureAtlas",_p.getTextureAtlas,_p.setTextureAtlas);cc.defineGetterSetter(_p,"descendants",_p.getDescendants);cc.SpriteBatchNode.DEFAULT_CAPACITY=29;cc.SpriteBatchNode.create=function(d,c){return new cc.SpriteBatchNode(d,c)};cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create;(function(){cc.SpriteBatchNode.CanvasRenderCmd=function(c){cc.Node.CanvasRenderCmd.call(this,c);this._originalTexture=this._texture=null};var b=cc.SpriteBatchNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);b.constructor=cc.SpriteBatchNode.CanvasRenderCmd;b.checkAtlasCapacity=function(){};b.isValidChild=function(c){return c instanceof cc.Sprite?!0:(cc.log(cc._LogInfos.Sprite_addChild_4),!1)};b.initWithTexture=function(d,e){this._texture=this._originalTexture=d};b.insertQuad=function(d,e){};b.increaseAtlasCapacity=function(){};b.removeQuadAtIndex=function(){};b.removeAllQuads=function(){};b.getTexture=function(){return this._texture};b.setTexture=function(e){this._texture=e;for(var g=this._node._children,f=0;f<g.length;f++){g[f].setTexture(e)}};b.updateChildrenAtlasIndex=function(e){for(var g=this._node._descendants.length=0,f=e.length;g<f;g++){this._updateAtlasIndex(e[g])}};b._updateAtlasIndex=function(g){var m=this._node._descendants,k=g.children,j,h=k.length;for(j=0;j<h;j++){if(0>k[j]._localZOrder){m.push(k[j])}else{break}}for(m.push(g);j<h;j++){m.push(k[j])}};b.getTextureAtlas=function(){};b.setTextureAtlas=function(c){};b.cutting=function(d,e){this._node._children.splice(e,0,d)}})();(function(){cc.SpriteBatchNode.WebGLRenderCmd=function(c){cc.Node.WebGLRenderCmd.call(this,c);this._needDraw=!0;this._textureAtlas=null};var b=cc.SpriteBatchNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);b.constructor=cc.SpriteBatchNode.WebGLRenderCmd;b.isValidChild=function(c){return c instanceof cc.Sprite?c.texture!=this.getTexture()?(cc.log(cc._LogInfos.Sprite_addChild_5),!1):!0:(cc.log(cc._LogInfos.Sprite_addChild_4),!1)};b.rendering=function(){var c=this._node;0!==this._textureAtlas.totalQuads&&(this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix),c._arrayMakeObjectsPerformSelector(c._children,cc.Node._stateCallbackType.updateTransform),cc.glBlendFunc(c._blendFunc.src,c._blendFunc.dst),this._textureAtlas.drawQuads())};b.visit=function(e){var g=this._node;if(g._visible){g._parent&&g._parent._renderCmd&&(this._curLevel=g._parent._renderCmd._curLevel+1);var f=cc.current_stack;f.stack.push(f.top);this._dirtyFlag&cc.Node._dirtyFlags.transformDirty||this.transform(e);this.updateStatus(e);f.top=this._stackMatrix;g.sortAllChildren();cc.renderer.pushRenderCommand(this);this._dirtyFlag=0;f.top=f.stack.pop()}};b.checkAtlasCapacity=function(d){for(var e=this._textureAtlas;d>=e.capacity||e.capacity===e.totalQuads;){this.increaseAtlasCapacity()}};b.increaseAtlasCapacity=function(){var d=this._textureAtlas.capacity,e=Math.floor(4*(d+1)/3);cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity,d,e);this._textureAtlas.resizeCapacity(e)||cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity_2)};b.initWithTexture=function(d,e){this._textureAtlas=new cc.TextureAtlas;this._textureAtlas.initWithTexture(d,e);this._updateBlendFunc();this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR)};b.insertQuad=function(e,g){var f=this._textureAtlas;f.totalQuads>=f.capacity&&this.increaseAtlasCapacity();f.insertQuad(e.quad,g)};b.removeQuadAtIndex=function(c){this._textureAtlas.removeQuadAtIndex(c)};b.getTexture=function(){return this._textureAtlas.texture};b.setTexture=function(c){this._textureAtlas.setTexture(c);c&&this._updateBlendFunc()};b.removeAllQuads=function(){this._textureAtlas.removeAllQuads()};b._swap=function(j,r){var p=this._node._descendants,o=this._textureAtlas,n=o.quads,m=p[j],k=cc.V3F_C4B_T2F_QuadCopy(n[j]);p[r].atlasIndex=j;p[j]=p[r];o.updateQuad(n[r],j);p[r]=m;o.updateQuad(k,r)};b._updateAtlasIndex=function(h,o){var n=0,m=h.children;m&&(n=m.length);var k=0;if(0===n){k=h.atlasIndex,h.atlasIndex=o,h.arrivalOrder=0,k!==o&&this._swap(k,o),o++}else{k=!0;0<=m[0].zIndex&&(k=h.atlasIndex,h.atlasIndex=o,h.arrivalOrder=0,k!==o&&this._swap(k,o),o++,k=!1);for(n=0;n<m.length;n++){var j=m[n];k&&0<=j.zIndex&&(k=h.atlasIndex,h.atlasIndex=o,h.arrivalOrder=0,k!==o&&this._swap(k,o),o++,k=!1);o=this._updateAtlasIndex(j,o)}k&&(k=h.atlasIndex,h.atlasIndex=o,h.arrivalOrder=0,k!==o&&this._swap(k,o),o++)}return o};b.updateChildrenAtlasIndex=function(e){for(var g=0,f=0;f<e.length;f++){g=this._updateAtlasIndex(e[f],g)}};b._updateBlendFunc=function(){if(!this._textureAtlas.texture.hasPremultipliedAlpha()){var c=this._node._blendFunc;c.src=cc.SRC_ALPHA;c.dst=cc.ONE_MINUS_SRC_ALPHA}};b.getTextureAtlas=function(){return this._textureAtlas};b.setTextureAtlas=function(c){c!==this._textureAtlas&&(this._textureAtlas=c)};b.cutting=function(){}})();cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var d=document.createElement("canvas");d.width=d.height=10;this._cacheCanvas=d;this._cacheContext=new cc.CanvasContextWrapper(d.getContext("2d"));var c=new cc.Texture2D;c.initWithElement(d);c.handleLoadedTexture();this.setTexture(c)},getCacheContext:function(){return this._cacheContext},getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(e,d){void 0===d&&(d=e.height,e=e.width);var f=this._cacheCanvas;f.width=e;f.height=d;this.getTexture().handleLoadedTexture();this.setTextureRect(cc.rect(0,0,e,d),!1)}});cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(e,d,f){this._spriteFrame=e||null;this._delayPerUnit=d||0;this._userInfo=f||null},clone:function(){var b=new cc.AnimationFrame;b.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo);return b},copyWithZone:function(b){return cc.clone(this)},copy:function(b){b=new cc.AnimationFrame;b.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo);return b},initWithSpriteFrame:function(e,d,f){this._spriteFrame=e;this._delayPerUnit=d;this._userInfo=f;return !0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(b){this._spriteFrame=b},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(b){this._delayPerUnit=b},getUserInfo:function(){return this._userInfo},setUserInfo:function(b){this._userInfo=b}});cc.AnimationFrame.create=function(e,d,f){return new cc.AnimationFrame(e,d,f)};cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(f,e,h){this._frames=[];if(void 0===f){this.initWithSpriteFrames(null,0)}else{var g=f[0];g&&(g instanceof cc.SpriteFrame?this.initWithSpriteFrames(f,e,h):g instanceof cc.AnimationFrame&&this.initWithAnimationFrames(f,e,h))}},getFrames:function(){return this._frames},setFrames:function(b){this._frames=b},addSpriteFrame:function(d){var c=new cc.AnimationFrame;c.initWithSpriteFrame(d,1,null);this._frames.push(c);this._totalDelayUnits++},addSpriteFrameWithFile:function(d){d=cc.textureCache.addImage(d);var c=cc.rect(0,0,0,0);c.width=d.width;c.height=d.height;d=new cc.SpriteFrame(d,c);this.addSpriteFrame(d)},addSpriteFrameWithTexture:function(e,d){var f=new cc.SpriteFrame(e,d);this.addSpriteFrame(f)},initWithAnimationFrames:function(f,e,h){cc.arrayVerifyType(f,cc.AnimationFrame);this._delayPerUnit=e;this._loops=void 0===h?1:h;this._totalDelayUnits=0;e=this._frames;for(h=e.length=0;h<f.length;h++){var g=f[h];e.push(g);this._totalDelayUnits+=g.getDelayUnits()}return !0},clone:function(){var b=new cc.Animation;b.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops);b.setRestoreOriginalFrame(this._restoreOriginalFrame);return b},copyWithZone:function(b){b=new cc.Animation;b.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops);b.setRestoreOriginalFrame(this._restoreOriginalFrame);return b},_copyFrames:function(){for(var d=[],c=0;c<this._frames.length;c++){d.push(this._frames[c].clone())}return d},copy:function(b){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(b){this._loops=b},setRestoreOriginalFrame:function(b){this._restoreOriginalFrame=b},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(b){this._delayPerUnit=b},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(g,f,k){cc.arrayVerifyType(g,cc.SpriteFrame);this._loops=void 0===k?1:k;this._delayPerUnit=f||0;this._totalDelayUnits=0;f=this._frames;f.length=0;if(g){for(k=0;k<g.length;k++){var j=g[k],h=new cc.AnimationFrame;h.initWithSpriteFrame(j,1,null);f.push(h)}this._totalDelayUnits+=g.length}return !0},retain:function(){},release:function(){}});cc.Animation.create=function(e,d,f){return new cc.Animation(e,d,f)};cc.Animation.createWithAnimationFrames=cc.Animation.create;cc.animationCache={_animations:{},addAnimation:function(d,c){this._animations[c]=d},removeAnimation:function(b){b&&this._animations[b]&&delete this._animations[b]},getAnimation:function(b){return this._animations[b]?this._animations[b]:null},_addAnimationsWithDictionary:function(k,j){var s=k.animations;if(s){var r=1,p=k.properties;if(p){for(var r=null!=p.format?parseInt(p.format):r,p=p.spritesheets,o=cc.spriteFrameCache,n=cc.path,m=0;m<p.length;m++){o.addSpriteFrames(n.changeBasename(j,p[m]))}}switch(r){case 1:this._parseVersion1(s);break;case 2:this._parseVersion2(s);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}}else{cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary)}},addAnimations:function(d){cc.assert(d,cc._LogInfos.animationCache_addAnimations_2);var c=cc.loader.getRes(d);c?this._addAnimationsWithDictionary(c,d):cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(u){var t=cc.spriteFrameCache,s;for(s in u){var r=u[s],p=r.frames,r=parseFloat(r.delay)||0,o=null;if(p){for(var o=[],n=0;n<p.length;n++){var m=t.getSpriteFrame(p[n]);if(m){var j=new cc.AnimationFrame;j.initWithSpriteFrame(m,1,null);o.push(j)}else{cc.log(cc._LogInfos.animationCache__parseVersion1_2,s,p[n])}}0===o.length?cc.log(cc._LogInfos.animationCache__parseVersion1_3,s):(o.length!==p.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,s),o=new cc.Animation(o,r,1),cc.animationCache.addAnimation(o,s))}else{cc.log(cc._LogInfos.animationCache__parseVersion1,s)}}},_parseVersion2:function(B){var A=cc.spriteFrameCache,z;for(z in B){var y=B[z],x=y.loop,w=parseInt(y.loops),x=x?cc.REPEAT_FOREVER:isNaN(w)?1:w,w=y.restoreOriginalFrame&&!0==y.restoreOriginalFrame?!0:!1,v=y.frames;if(v){for(var u=[],t=0;t<v.length;t++){var r=v[t],o=r.spriteframe,j=A.getSpriteFrame(o);if(j){var o=parseFloat(r.delayUnits)||0,r=r.notification,C=new cc.AnimationFrame;C.initWithSpriteFrame(j,o,r);u.push(C)}else{cc.log(cc._LogInfos.animationCache__parseVersion2_2,z,o)}}y=parseFloat(y.delayPerUnit)||0;v=new cc.Animation;v.initWithAnimationFrames(u,y,x);v.setRestoreOriginalFrame(w);cc.animationCache.addAnimation(v,z)}else{cc.log(cc._LogInfos.animationCache__parseVersion2,z)}}},_clear:function(){this._animations={}}};cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,ctor:function(g,f,k,j,h){this._offset=cc.p(0,0);this._offsetInPixels=cc.p(0,0);this._originalSize=cc.size(0,0);this._rotated=!1;this._originalSizeInPixels=cc.size(0,0);this._textureFilename="";this._texture=null;this._textureLoaded=!1;void 0!==g&&void 0!==f&&(void 0===k||void 0===j||void 0===h?this.initWithTexture(g,f):this.initWithTexture(g,f,k,j,h))},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},getRectInPixels:function(){var b=this._rectInPixels;return cc.rect(b.x,b.y,b.width,b.height)},setRectInPixels:function(b){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0));this._rectInPixels.x=b.x;this._rectInPixels.y=b.y;this._rectInPixels.width=b.width;this._rectInPixels.height=b.height;this._rect=cc.rectPixelsToPoints(b)},isRotated:function(){return this._rotated},setRotated:function(b){this._rotated=b},getRect:function(){var b=this._rect;return cc.rect(b.x,b.y,b.width,b.height)},setRect:function(b){this._rect||(this._rect=cc.rect(0,0,0,0));this._rect.x=b.x;this._rect.y=b.y;this._rect.width=b.width;this._rect.height=b.height;this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},setOffsetInPixels:function(b){this._offsetInPixels.x=b.x;this._offsetInPixels.y=b.y;cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(b){this._originalSizeInPixels.width=b.width;this._originalSizeInPixels.height=b.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(b){this._originalSize.width=b.width;this._originalSize.height=b.height},getTexture:function(){if(this._texture){return this._texture}if(""!==this._textureFilename){var b=cc.textureCache.addImage(this._textureFilename);b&&(this._textureLoaded=b.isLoaded());return b}return null},setTexture:function(d){if(this._texture!==d){var c=d.isLoaded();this._textureLoaded=c;this._texture=d;c||d.addEventListener("load",function(g){this._textureLoaded=!0;if(this._rotated&&cc._renderType===cc._RENDER_TYPE_CANVAS){var f=g.getHtmlElementObj(),f=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(f,this.getRect()),h=new cc.Texture2D;h.initWithElement(f);h.handleLoadedTexture();this.setTexture(h);f=this.getRect();this.setRect(cc.rect(0,0,f.width,f.height))}f=this._rect;0===f.width&&0===f.height&&(f=g.width,g=g.height,this._rect.width=f,this._rect.height=g,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=f,this._originalSize.height=g);this.dispatchEvent("load")},this)}},getOffset:function(){return cc.p(this._offset)},setOffset:function(b){this._offset.x=b.x;this._offset.y=b.y},clone:function(){var b=new cc.SpriteFrame;b.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels);b.setTexture(this._texture);return b},copyWithZone:function(){var b=new cc.SpriteFrame;b.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels);b.setTexture(this._texture);return b},copy:function(){return this.copyWithZone()},initWithTexture:function(j,h,p,o,n){2===arguments.length&&(h=cc.rectPointsToPixels(h));o=o||cc.p(0,0);n=n||h;p=p||!1;cc.isString(j)?(this._texture=null,this._textureFilename=j):j instanceof cc.Texture2D&&this.setTexture(j);j=this.getTexture();this._rectInPixels=h;h=this._rect=cc.rectPixelsToPoints(h);if(j&&j.url&&j.isLoaded()){var m,k;p?(m=h.x+h.height,k=h.y+h.width):(m=h.x+h.width,k=h.y+h.height);m>j.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,j.url);k>j.getPixelsHigh()&&cc.error(cc._LogInfos.RectHeight,j.url)}this._offsetInPixels.x=o.x;this._offsetInPixels.y=o.y;cc._pointPixelsToPointsOut(o,this._offset);this._originalSizeInPixels.width=n.width;this._originalSizeInPixels.height=n.height;cc._sizePixelsToPointsOut(n,this._originalSize);this._rotated=p;return !0}});cc.EventHelper.prototype.apply(cc.SpriteFrame.prototype);cc.SpriteFrame.create=function(g,f,k,j,h){return new cc.SpriteFrame(g,f,k,j,h)};cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create;cc.SpriteFrame._frameWithTextureForCanvas=function(h,g,n,m,k){var j=new cc.SpriteFrame;j._texture=h;j._rectInPixels=g;j._rect=cc.rectPixelsToPoints(g);j._offsetInPixels.x=m.x;j._offsetInPixels.y=m.y;cc._pointPixelsToPointsOut(j._offsetInPixels,j._offset);j._originalSizeInPixels.width=k.width;j._originalSizeInPixels.height=k.height;cc._sizePixelsToPointsOut(j._originalSizeInPixels,j._originalSize);j._rotated=n;return j};cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(b){return(b=this._CCNS_REG2.exec(b))?cc.rect(parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3]),parseFloat(b[4])):cc.rect(0,0,0,0)},_pointFromString:function(b){return(b=this._CCNS_REG1.exec(b))?cc.p(parseFloat(b[1]),parseFloat(b[2])):cc.p(0,0)},_sizeFromString:function(b){return(b=this._CCNS_REG1.exec(b))?cc.size(parseFloat(b[1]),parseFloat(b[2])):cc.size(0,0)},_getFrameConfig:function(d){var c=cc.loader.getRes(d);cc.assert(c,cc._LogInfos.spriteFrameCache__getFrameConfig_2,d);cc.loader.release(d);if(c._inited){return this._frameConfigCache[d]=c}this._frameConfigCache[d]=this._parseFrameConfig(c);return this._frameConfigCache[d]},_getFrameConfigByJsonObject:function(d,c){cc.assert(c,cc._LogInfos.spriteFrameCache__getFrameConfig_2,d);this._frameConfigCache[d]=this._parseFrameConfig(c);return this._frameConfigCache[d]},_parseFrameConfig:function(u){var t=u.frames,s=u.metadata||u.meta;u={};var r={},p=0;s&&(p=s.format,p=1>=p.length?parseInt(p):p,r.image=s.textureFileName||s.textureFileName||s.image);for(var o in t){var n=t[o];if(n){s={};if(0==p){s.rect=cc.rect(n.x,n.y,n.width,n.height);s.rotated=!1;s.offset=cc.p(n.offsetX,n.offsetY);var m=n.originalWidth,n=n.originalHeight;m&&n||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig);m=Math.abs(m);n=Math.abs(n);s.size=cc.size(m,n)}else{if(1==p||2==p){s.rect=this._rectFromString(n.frame),s.rotated=n.rotated||!1,s.offset=this._pointFromString(n.offset),s.size=this._sizeFromString(n.sourceSize)}else{if(3==p){var m=this._sizeFromString(n.spriteSize),j=this._rectFromString(n.textureRect);m&&(j=cc.rect(j.x,j.y,m.width,m.height));s.rect=j;s.rotated=n.textureRotated||!1;s.offset=this._pointFromString(n.spriteOffset);s.size=this._sizeFromString(n.spriteSourceSize);s.aliases=n.aliases}else{m=n.frame,j=n.sourceSize,o=n.filename||o,s.rect=cc.rect(m.x,m.y,m.w,m.h),s.rotated=n.rotated||!1,s.offset=cc.p(0,0),s.size=cc.size(j.w,j.h)}}}u[o]=s}}return{_inited:!0,frames:u,meta:r}},_addSpriteFramesByObject:function(e,d,f){cc.assert(e,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);d&&d.frames&&(d=this._frameConfigCache[e]||this._getFrameConfigByJsonObject(e,d),this._createSpriteFrames(e,d,f))},_createSpriteFrames:function(w,v,u){var t=v.frames;v=v.meta;u?u instanceof cc.Texture2D||(cc.isString(u)?u=cc.textureCache.addImage(u):cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3)):(u=cc.path.changeBasename(w,v.image||".png"),u=cc.textureCache.addImage(u));w=this._spriteFramesAliases;v=this._spriteFrames;for(var s in t){var r=t[s],p=v[s];if(!p){p=new cc.SpriteFrame(u,r.rect,r.rotated,r.offset,r.size);if(r=r.aliases){for(var o=0,n=r.length;o<n;o++){var j=r[o];w[j]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,j);w[j]=s}}cc._renderType===cc._RENDER_TYPE_CANVAS&&p.isRotated()&&p.getTexture().isLoaded()&&(r=p.getTexture().getHtmlElementObj(),r=cc.Sprite.CanvasRenderCmd._cutRotateImageToCanvas(r,p.getRectInPixels()),o=new cc.Texture2D,o.initWithElement(r),o.handleLoadedTexture(),p.setTexture(o),r=p._rect,p.setRect(cc.rect(0,0,r.width,r.height)));v[s]=p}}},addSpriteFrames:function(e,d){cc.assert(e,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var f=this._frameConfigCache[e]||cc.loader.getRes(e);f&&f.frames&&(f=this._frameConfigCache[e]||this._getFrameConfig(e),this._createSpriteFrames(e,f,d))},_checkConflict:function(d){d=d.frames;for(var c in d){this._spriteFrames[c]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,c)}},addSpriteFrame:function(d,c){this._spriteFrames[c]=d},removeSpriteFrames:function(){this._spriteFrames={};this._spriteFramesAliases={}},removeSpriteFrameByName:function(b){b&&(this._spriteFramesAliases[b]&&delete this._spriteFramesAliases[b],this._spriteFrames[b]&&delete this._spriteFrames[b])},removeSpriteFramesFromFile:function(g){var f=this._spriteFrames,k=this._spriteFramesAliases;if(g=this._frameConfigCache[g]){g=g.frames;for(var j in g){if(f[j]){delete f[j];for(var h in k){k[h]===j&&delete k[h]}}}}},removeSpriteFramesFromTexture:function(h){var g=this._spriteFrames,n=this._spriteFramesAliases,m;for(m in g){var k=g[m];if(k&&k.getTexture()===h){delete g[m];for(var j in n){n[j]===m&&delete n[j]}}}},getSpriteFrame:function(e){var d=this._spriteFrames[e];if(!d){var f=this._spriteFramesAliases[e];f&&((d=this._spriteFrames[f.toString()])||delete this._spriteFramesAliases[e])}return d},_clear:function(){this._spriteFrames={};this._spriteFramesAliases={};this._frameConfigCache={}}};cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var b=this._valueDict;b["cocos2d.x.version"]=cc.ENGINE_VERSION;b["cocos2d.x.compiled_with_profiler"]=!1;b["cocos2d.x.compiled_with_gl_state_cache"]=cc.ENABLE_GL_STATE_CACHE;this._inited=!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return !1},supportsS3TC:function(){return !1},supportsATITC:function(){return !1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(b){return -1<this._GlExtensions.indexOf(b)},getValue:function(e,d){this._inited||this._init();var f=this._valueDict;return f[e]?f[e]:d},setValue:function(d,c){this._valueDict[d]=c},dumpInfo:function(){0===cc.ENABLE_GL_STATE_CACHE&&(cc.log(""),cc.log(cc._LogInfos.configuration_dumpInfo),cc.log(""))},gatherGPUInfo:function(){if(cc._renderType!==cc._RENDER_TYPE_CANVAS){this._inited||this._init();var f=cc._renderContext,e=this._valueDict;e["gl.vendor"]=f.getParameter(f.VENDOR);e["gl.renderer"]=f.getParameter(f.RENDERER);e["gl.version"]=f.getParameter(f.VERSION);this._GlExtensions="";for(var h=f.getSupportedExtensions(),g=0;g<h.length;g++){this._GlExtensions+=h[g]+" "}this._maxTextureSize=f.getParameter(f.MAX_TEXTURE_SIZE);e["gl.max_texture_size"]=this._maxTextureSize;this._maxTextureUnits=f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS);e["gl.max_texture_units"]=this._maxTextureUnits;this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc");e["gl.supports_PVRTC"]=this._supportsPVRTC;this._supportsNPOT=!1;e["gl.supports_NPOT"]=this._supportsNPOT;this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888");e["gl.supports_BGRA8888"]=this._supportsBGRA8888;this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer");e["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer;this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object");e["gl.supports_vertex_array_object"]=this._supportsShareableVAO;cc.checkGLErrorDebug()}},loadConfigFile:function(e){this._inited||this._init();var d=cc.loader.getRes(e);if(!d){throw"Please load the resource first : "+e}cc.assert(d,cc._LogInfos.configuration_loadConfigFile_2,e);if(d=d.data){for(var f in d){this._valueDict[f]=d[f]}}else{cc.log(cc._LogInfos.configuration_loadConfigFile,e)}}};cc.g_NumberOfDraws=0;cc.GLToClipTransform=function(d){cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,d);var c=new cc.math.Matrix4;cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,c);d.multiply(c)};cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_accumDt:0,_contentScaleFactor:1,_displayStats:!1,_deltaTime:0,_frameRate:0,_FPSLabel:null,_SPFLabel:null,_drawsLabel:null,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_frames:0,_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterDraw:null,_eventAfterVisit:null,_eventAfterUpdate:null,ctor:function(){var b=this;b._lastUpdate=Date.now();cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){b._lastUpdate=Date.now()})},init:function(){this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS;this._scenesStack=[];this._projection=cc.Director.PROJECTION_DEFAULT;this._projectionDelegate=null;this._frameRate=this._accumDt=0;this._displayStats=!1;this._totalFrames=this._frames=0;this._lastUpdate=Date.now();this._purgeDirectorInNextLoop=this._paused=!1;this._winSizeInPoints=cc.size(0,0);this._openGLView=null;this._contentScaleFactor=1;this._scheduler=new cc.Scheduler;cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1)):this._actionManager=null;this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW);this._eventAfterDraw.setUserData(this);this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT);this._eventAfterVisit.setUserData(this);this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE);this._eventAfterUpdate.setUserData(this);this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED);this._eventProjectionChanged.setUserData(this);return !0},calculateDeltaTime:function(){var b=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=!1):this._deltaTime=(b-this._lastUpdate)/1000;0<cc.game.config[cc.game.CONFIG_KEY.debugMode]&&0.2<this._deltaTime&&(this._deltaTime=1/60);this._lastUpdate=b},convertToGL:null,convertToUI:null,drawScene:function(){var b=cc.renderer;this.calculateDeltaTime();this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate));this._clear();this._nextScene&&this.setNextScene();this._beforeVisitScene&&this._beforeVisitScene();this._runningScene&&(!0===b.childrenOrderDirty?(cc.renderer.clearRenderCommands(),this._runningScene._renderCmd._curLevel=0,this._runningScene.visit(),b.resetFlag()):!0===b.transformDirty()&&b.transform(),cc.eventManager.dispatchEvent(this._eventAfterVisit));this._notificationNode&&this._notificationNode.visit();this._displayStats&&this._showStats();this._afterVisitScene&&this._afterVisitScene();b.rendering(cc._renderContext);cc.eventManager.dispatchEvent(this._eventAfterDraw);this._totalFrames++;this._displayStats&&this._calculateMPF()},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(0.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene);this._scenesStack.pop();var b=this._scenesStack.length;0===b?this.end():(this._sendCleanupToScene=!0,this._nextScene=this._scenesStack[b-1])},purgeCachedData:function(){cc.animationCache._clear();cc.spriteFrameCache._clear();cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAll();cc.eventManager&&cc.eventManager.setEnabled(!1);this._runningScene&&(this._runningScene.onExitTransitionDidStart(),this._runningScene.onExit(),this._runningScene.cleanup());this._nextScene=this._runningScene=null;this._scenesStack.length=0;this.stopAnimation();this.purgeCachedData();cc.checkGLErrorDebug()},pushScene:function(b){cc.assert(b,cc._LogInfos.Director_pushScene);this._sendCleanupToScene=!1;this._scenesStack.push(b);this._nextScene=b},runScene:function(d){cc.assert(d,cc._LogInfos.Director_pushScene);if(this._runningScene){var c=this._scenesStack.length;0===c?(this._sendCleanupToScene=!0,this._scenesStack[c]=d):(this._sendCleanupToScene=!0,this._scenesStack[c-1]=d);this._nextScene=d}else{this.pushScene(d),this.startAnimation()}},resume:function(){this._paused&&(this.setAnimationInterval(this._oldAnimationInterval),(this._lastUpdate=Date.now())||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(b){b!==this._contentScaleFactor&&(this._contentScaleFactor=b,this._createStatsLabel())},setDepthTest:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(b){this._nextDeltaTimeZero=b},setNextScene:function(){var d=!1,c=!1;cc.TransitionScene&&(d=this._runningScene?this._runningScene instanceof cc.TransitionScene:!1,c=this._nextScene?this._nextScene instanceof cc.TransitionScene:!1);if(!c){if(c=this._runningScene){c.onExitTransitionDidStart(),c.onExit()}this._sendCleanupToScene&&c&&c.cleanup()}this._runningScene=this._nextScene;cc.renderer.childrenOrderDirty=!0;this._nextScene=null;d||null===this._runningScene||(this._runningScene.onEnter(),this._runningScene.onEnterTransitionDidFinish())},setNotificationNode:function(b){this._notificationNode=b},getDelegate:function(){return this._projectionDelegate},setDelegate:function(b){this._projectionDelegate=b},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,_showStats:function(){this._frames++;this._accumDt+=this._deltaTime;this._FPSLabel&&this._SPFLabel&&this._drawsLabel?(this._accumDt>cc.DIRECTOR_FPS_INTERVAL&&(this._SPFLabel.string=this._secondsPerFrame.toFixed(3),this._frameRate=this._frames/this._accumDt,this._accumDt=this._frames=0,this._FPSLabel.string=this._frameRate.toFixed(1),this._drawsLabel.string=(0|cc.g_NumberOfDraws).toString()),this._FPSLabel.visit(),this._SPFLabel.visit(),this._drawsLabel.visit()):this._createStatsLabel();cc.g_NumberOfDraws=0},isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return this._displayStats},setDisplayStats:function(b){this._displayStats=b},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(f){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var e=this._scenesStack,h=e.length;if(0===h){this.end()}else{if(!(f>h)){for(;h>f;){var g=e.pop();g.running&&(g.onExitTransitionDidStart(),g.onExit());g.cleanup();h--}this._nextScene=e[e.length-1];this._sendCleanupToScene=!1}}},getScheduler:function(){return this._scheduler},setScheduler:function(b){this._scheduler!==b&&(this._scheduler=b)},getActionManager:function(){return this._actionManager},setActionManager:function(b){this._actionManager!==b&&(this._actionManager=b)},getDeltaTime:function(){return this._deltaTime},_createStatsLabel:null,_calculateMPF:function(){this._secondsPerFrame=(Date.now()-this._lastUpdate)/1000}});cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed";cc.Director.EVENT_AFTER_DRAW="director_after_draw";cc.Director.EVENT_AFTER_VISIT="director_after_visit";cc.Director.EVENT_AFTER_UPDATE="director_after_update";cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0;this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(b){this._animationInterval=b;this.invalid||(this.stopAnimation(),this.startAnimation())}});cc.Director.sharedDirector=null;cc.Director.firstUseDirector=!0;cc.Director._getInstance=function(){cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init());return cc.Director.sharedDirector};cc.defaultFPS=60;cc.Director.PROJECTION_2D=0;cc.Director.PROJECTION_3D=1;cc.Director.PROJECTION_CUSTOM=3;cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D;cc._renderType===cc._RENDER_TYPE_CANVAS?(_p=cc.Director.prototype,_p.setProjection=function(b){this._projection=b;cc.eventManager.dispatchEvent(this._eventProjectionChanged)},_p.setDepthTest=function(){},_p.setOpenGLView=function(b){this._winSizeInPoints.width=cc._canvas.width;this._winSizeInPoints.height=cc._canvas.height;this._openGLView=b||cc.view;cc.eventManager&&cc.eventManager.setEnabled(!0)},_p._clear=function(){var d=this._openGLView.getViewPortRect(),c=cc._renderContext.getContext();c.setTransform(1,0,0,1,0,0);c.clearRect(-d.x,d.y,d.width,d.height)},_p._createStatsLabel=function(){var b=0,b=this._winSizeInPoints.width>this._winSizeInPoints.height?0|this._winSizeInPoints.height/320*24:0|this._winSizeInPoints.width/320*24;this._FPSLabel=new cc.LabelTTF("000.0","Arial",b);this._SPFLabel=new cc.LabelTTF("0.000","Arial",b);this._drawsLabel=new cc.LabelTTF("0000","Arial",b);b=cc.DIRECTOR_STATS_POSITION;this._drawsLabel.setPosition(this._drawsLabel.width/2+b.x,5*this._drawsLabel.height/2+b.y);this._SPFLabel.setPosition(this._SPFLabel.width/2+b.x,3*this._SPFLabel.height/2+b.y);this._FPSLabel.setPosition(this._FPSLabel.width/2+b.x,this._FPSLabel.height/2+b.y)},_p.getVisibleSize=function(){return this.getWinSize()},_p.getVisibleOrigin=function(){return cc.p(0,0)}):(cc.Director._fpsImage=new Image,cc._addEventListener(cc.Director._fpsImage,"load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage));cc._renderType===cc._RENDER_TYPE_WEBGL&&function(){cc.DirectorDelegate=cc.Class.extend({updateProjection:function(){}});var b=cc.Director.prototype;b.setProjection=function(j){var r=this._winSizeInPoints;this.setViewport();var p=this._openGLView,o=p._viewPortRect.x/p._scaleX,n=p._viewPortRect.y/p._scaleY;switch(j){case cc.Director.PROJECTION_2D:cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLLoadIdentity();p=cc.math.Matrix4.createOrthographicProjection(-o,r.width-o,-n,r.height-n,-1024,1024);cc.kmGLMultMatrix(p);cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLLoadIdentity();break;case cc.Director.PROJECTION_3D:var m=this.getZEye(),k=new cc.math.Matrix4,p=new cc.math.Matrix4;cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLLoadIdentity();k=cc.math.Matrix4.createPerspectiveProjection(60,r.width/r.height,0.1,2*m);cc.kmGLMultMatrix(k);cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLLoadIdentity();m=new cc.math.Vec3(-o+r.width/2,-n+r.height/2,m);r=new cc.math.Vec3(-o+r.width/2,-n+r.height/2,0);o=new cc.math.Vec3(0,1,0);p.lookAt(m,r,o);cc.kmGLMultMatrix(p);break;case cc.Director.PROJECTION_CUSTOM:this._projectionDelegate&&this._projectionDelegate.updateProjection();break;default:cc.log(cc._LogInfos.Director_setProjection)}this._projection=j;cc.eventManager.dispatchEvent(this._eventProjectionChanged);cc.setProjectionMatrixDirty();cc.renderer.childrenOrderDirty=!0};b.setDepthTest=function(d){var e=cc._renderContext;d?(e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL)):e.disable(e.DEPTH_TEST)};b.setOpenGLView=function(c){this._winSizeInPoints.width=cc._canvas.width;this._winSizeInPoints.height=cc._canvas.height;this._openGLView=c||cc.view;c=cc.configuration;c.gatherGPUInfo();c.dumpInfo();this._createStatsLabel();this.setGLDefaultValues();cc.eventManager&&cc.eventManager.setEnabled(!0)};b._clear=function(){var c=cc._renderContext;c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)};b._beforeVisitScene=function(){cc.kmGLPushMatrix()};b._afterVisitScene=function(){cc.kmGLPopMatrix()};b._createStatsLabel=function(){if(!cc.LabelAtlas){this._createStatsLabelForCanvas()}else{if(null!=cc.Director._fpsImageLoaded&&!1!==cc.Director._fpsImageLoaded){var e=new cc.Texture2D;e.initWithElement(cc.Director._fpsImage);e.handleLoadedTexture();var g=cc.view.getDesignResolutionSize().height/320;0===g&&(g=this._winSizeInPoints.height/320);var f=new cc.LabelAtlas;f._setIgnoreContentScaleFactor(!0);f.initWithString("00.0",e,12,32,".");f.scale=g;this._FPSLabel=f;f=new cc.LabelAtlas;f._setIgnoreContentScaleFactor(!0);f.initWithString("0.000",e,12,32,".");f.scale=g;this._SPFLabel=f;f=new cc.LabelAtlas;f._setIgnoreContentScaleFactor(!0);f.initWithString("000",e,12,32,".");f.scale=g;this._drawsLabel=f;e=cc.DIRECTOR_STATS_POSITION;this._drawsLabel.setPosition(e.x,34*g+e.y);this._SPFLabel.setPosition(e.x,17*g+e.y);this._FPSLabel.setPosition(e)}}};b._createStatsLabelForCanvas=function(){var c=0,c=this._winSizeInPoints.width>this._winSizeInPoints.height?0|this._winSizeInPoints.height/320*24:0|this._winSizeInPoints.width/320*24;this._FPSLabel=new cc.LabelTTF("000.0","Arial",c);this._SPFLabel=new cc.LabelTTF("0.000","Arial",c);this._drawsLabel=new cc.LabelTTF("0000","Arial",c);c=cc.DIRECTOR_STATS_POSITION;this._drawsLabel.setPosition(this._drawsLabel.width/2+c.x,5*this._drawsLabel.height/2+c.y);this._SPFLabel.setPosition(this._SPFLabel.width/2+c.x,3*this._SPFLabel.height/2+c.y);this._FPSLabel.setPosition(this._FPSLabel.width/2+c.x,this._FPSLabel.height/2+c.y)};b.convertToGL=function(f){var j=new cc.math.Matrix4;cc.GLToClipTransform(j);var h=j.inverse(),j=j.mat[14]/j.mat[15],g=this._openGLView.getDesignResolutionSize();f=new cc.math.Vec3(2*f.x/g.width-1,1-2*f.y/g.height,j);f.transformCoord(h);return cc.p(f.x,f.y)};b.convertToUI=function(d){var e=new cc.math.Matrix4;cc.GLToClipTransform(e);d=new cc.math.Vec3(d.x,d.y,0);d.transformCoord(e);e=this._openGLView.getDesignResolutionSize();return cc.p(e.width*(0.5*d.x+0.5),e.height*(0.5*-d.y+0.5))};b.getVisibleSize=function(){return this._openGLView.getVisibleSize()};b.getVisibleOrigin=function(){return this._openGLView.getVisibleOrigin()};b.getZEye=function(){return this._winSizeInPoints.height/1.1566};b.setViewport=function(){var d=this._openGLView;if(d){var e=this._winSizeInPoints;d.setViewPortInPoints(-d._viewPortRect.x/d._scaleX,-d._viewPortRect.y/d._scaleY,e.width,e.height)}};b.getOpenGLView=function(){return this._openGLView};b.getProjection=function(){return this._projection};b.setAlphaBlending=function(c){c?cc.glBlendFunc(cc.BLEND_SRC,cc.BLEND_DST):cc.glBlendFunc(cc._renderContext.ONE,cc._renderContext.ZERO)};b.setGLDefaultValues=function(){this.setAlphaBlending(!0);this.setDepthTest(!1);this.setProjection(this._projection);cc._renderContext.clearColor(0,0,0,1)}}();cc.Camera=cc.Class.extend({_eyeX:null,_eyeY:null,_eyeZ:null,_centerX:null,_centerY:null,_centerZ:null,_upX:null,_upY:null,_upZ:null,_dirty:!1,_lookupMatrix:null,ctor:function(){this._lookupMatrix=new cc.math.Matrix4;this.restore()},description:function(){return"\x3cCCCamera | center \x3d("+this._centerX+","+this._centerY+","+this._centerZ+")\x3e"},setDirty:function(b){this._dirty=b},isDirty:function(){return this._dirty},restore:function(){this._eyeX=this._eyeY=0;this._eyeZ=cc.Camera.getZEye();this._upX=this._centerX=this._centerY=this._centerZ=0;this._upY=1;this._upZ=0;this._lookupMatrix.identity();this._dirty=!1},locate:function(){if(this._dirty){var e=new cc.math.Vec3(this._eyeX,this._eyeY,this._eyeZ),d=new cc.math.Vec3(this._centerX,this._centerY,this._centerZ),f=new cc.math.Vec3(this._upX,this._upY,this._upZ);this._lookupMatrix.lookAt(e,d,f);this._dirty=!1}cc.kmGLMultMatrix(this._lookupMatrix)},_locateForRenderer:function(f){if(this._dirty){var e=new cc.math.Vec3(this._eyeX,this._eyeY,this._eyeZ),h=new cc.math.Vec3(this._centerX,this._centerY,this._centerZ),g=new cc.math.Vec3(this._upX,this._upY,this._upZ);this._lookupMatrix.lookAt(e,h,g);this._dirty=!1}f.multiply(this._lookupMatrix)},setEyeXYZ:function(e,d,f){this.setEye(e,d,f)},setEye:function(e,d,f){this._eyeX=e;this._eyeY=d;this._eyeZ=f;this._dirty=!0},setCenterXYZ:function(e,d,f){this.setCenter(e,d,f)},setCenter:function(e,d,f){this._centerX=e;this._centerY=d;this._centerZ=f;this._dirty=!0},setUpXYZ:function(e,d,f){this.setUp(e,d,f)},setUp:function(e,d,f){this._upX=e;this._upY=d;this._upZ=f;this._dirty=!0},getEyeXYZ:function(e,d,f){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getEye:function(){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getCenterXYZ:function(e,d,f){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getCenter:function(){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getUpXYZ:function(e,d,f){return{x:this._upX,y:this._upY,z:this._upZ}},getUp:function(){return{x:this._upX,y:this._upY,z:this._upZ}},_DISALLOW_COPY_AND_ASSIGN:function(b){}});cc.Camera.getZEye=function(){return cc.FLT_EPSILON};cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1;cc.ListEntry=function(j,h,p,o,n,m,k){this.prev=j;this.next=h;this.callback=p;this.target=o;this.priority=n;this.paused=m;this.markedForDeletion=k};cc.HashUpdateEntry=function(g,f,k,j,h){this.list=g;this.entry=f;this.target=k;this.callback=j;this.hh=h};cc.HashTimerEntry=cc.hashSelectorEntry=function(j,h,p,o,n,m,k){this.timers=j;this.target=h;this.timerIndex=p;this.currentTimer=o;this.currentTimerSalvaged=n;this.paused=m;this.hh=k};cc.Timer=cc.Class.extend({_scheduler:null,_elapsed:0,_runForever:!1,_useDelay:!1,_timesExecuted:0,_repeat:0,_delay:0,_interval:0,getInterval:function(){return this._interval},setInterval:function(b){this._interval=b},setupTimerWithInterval:function(e,d,f){this._elapsed=-1;this._interval=e;this._delay=f;this._useDelay=0<this._delay;this._repeat=d;this._runForever=this._repeat===cc.REPEAT_FOREVER},trigger:function(){return 0},cancel:function(){return 0},ctor:function(){this._scheduler=null;this._elapsed=-1;this._useDelay=this._runForever=!1;this._interval=this._delay=this._repeat=this._timesExecuted=0},update:function(b){-1===this._elapsed?this._timesExecuted=this._elapsed=0:(this._elapsed+=b,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))}});cc.TimerTargetSelector=cc.Timer.extend({_target:null,_selector:null,ctor:function(){this._selector=this._target=null},initWithSelector:function(h,g,n,m,k,j){this._scheduler=h;this._target=n;this._selector=g;this.setupTimerWithInterval(m,k,j);return !0},getSelector:function(){return this._selector},trigger:function(){this._target&&this._selector&&this._target.call(this._selector,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._selector,this._target)}});cc.TimerTargetCallback=cc.Timer.extend({_target:null,_callback:null,_key:null,ctor:function(){this._callback=this._target=null},initWithCallback:function(j,h,p,o,n,m,k){this._scheduler=j;this._target=p;this._callback=h;this._key=o;this.setupTimerWithInterval(n,m,k);return !0},getCallback:function(){return this._callback},getKey:function(){return this._key},trigger:function(){this._callback&&this._callback.call(this._target,this._elapsed)},cancel:function(){this._scheduler.unschedule(this._callback,this._target)}});cc.Scheduler=cc.Class.extend({_timeScale:1,_updatesNegList:null,_updates0List:null,_updatesPosList:null,_hashForTimers:null,_arrayForTimers:null,_hashForUpdates:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,ctor:function(){this._timeScale=1;this._updatesNegList=[];this._updates0List=[];this._updatesPosList=[];this._hashForUpdates={};this._hashForTimers={};this._currentTarget=null;this._updateHashLocked=this._currentTargetSalvaged=!1;this._arrayForTimers=[]},_schedulePerFrame:function(g,f,k,j){var h=this._hashForUpdates[f.__instanceId];if(h&&h.entry){if(h.entry.priority!==k){if(this._updateHashLocked){cc.log("warning: you CANNOT change update priority in scheduled function");h.entry.markedForDeletion=!1;h.entry.paused=j;return}this.unscheduleUpdate(f)}else{h.entry.markedForDeletion=!1;h.entry.paused=j;return}}0===k?this._appendIn(this._updates0List,g,f,j):0>k?this._priorityIn(this._updatesNegList,g,f,k,j):this._priorityIn(this._updatesPosList,g,f,k,j)},_removeHashElement:function(b){delete this._hashForTimers[b.target.__instanceId];cc.arrayRemoveObject(this._arrayForTimers,b);b.Timer=null;b.target=null},_removeUpdateFromHash:function(b){if(b=this._hashForUpdates[b.target.__instanceId]){cc.arrayRemoveObject(b.list,b.entry),delete this._hashForUpdates[b.target.__instanceId],b.entry=null,b.target=null}},_priorityIn:function(h,g,n,m,k){g=new cc.ListEntry(null,null,g,n,m,k,!1);if(h){k=h.length-1;for(var j=0;j<=k&&!(m<h[j].priority);j++){}h.splice(j,0,g)}else{h=[],h.push(g)}this._hashForUpdates[n.__instanceId]=new cc.HashUpdateEntry(h,g,n,null);return h},_appendIn:function(f,e,h,g){e=new cc.ListEntry(null,null,e,h,0,g,!1);f.push(e);this._hashForUpdates[h.__instanceId]=new cc.HashUpdateEntry(f,e,h,null,null)},setTimeScale:function(b){this._timeScale=b},getTimeScale:function(){return this._timeScale},update:function(g){this._updateHashLocked=!0;1!==this._timeScale&&(g*=this._timeScale);var f,k,j,h;f=0;k=this._updatesNegList;for(j=k.length;f<j;f++){h=k[f],h.paused||h.markedForDeletion||h.callback(g)}f=0;k=this._updates0List;for(j=k.length;f<j;f++){h=k[f],h.paused||h.markedForDeletion||h.callback(g)}f=0;k=this._updatesPosList;for(j=k.length;f<j;f++){h=k[f],h.paused||h.markedForDeletion||h.callback(g)}j=this._arrayForTimers;for(f=0;f<j.length;f++){this._currentTarget=k=j[f];this._currentTargetSalvaged=!1;if(!k.paused){for(k.timerIndex=0;k.timerIndex<k.timers.length;++k.timerIndex){k.currentTimer=k.timers[k.timerIndex],k.currentTimerSalvaged=!1,k.currentTimer.update(g),k.currentTimer=null}}this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&this._removeHashElement(this._currentTarget)}f=0;for(k=this._updatesNegList;f<k.length;){h=k[f],h.markedForDeletion?this._removeUpdateFromHash(h):f++}f=0;for(k=this._updates0List;f<k.length;){h=k[f],h.markedForDeletion?this._removeUpdateFromHash(h):f++}f=0;for(k=this._updatesPosList;f<k.length;){h=k[f],h.markedForDeletion?this._removeUpdateFromHash(h):f++}this._updateHashLocked=!1;this._currentTarget=null},scheduleCallbackForTarget:function(h,g,n,m,k,j){this.schedule(g,h,n,m,k,j,h.__instanceId+"")},schedule:function(A,z,y,x,w,v,u){var t=!1;if("function"!==typeof A){var s=A,t=!0}!1===t?5===arguments.length&&(u=w,v=x,w=0,x=cc.REPEAT_FOREVER):4===arguments.length&&(v=x,x=cc.REPEAT_FOREVER,w=0);cc.assert(z,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3);!1===t&&cc.assert(u,"key should not be empty!");var r=this._hashForTimers[z.__instanceId];r?cc.assert(r.paused===v,""):(r=new cc.HashTimerEntry(null,z,0,null,null,v,null),this._arrayForTimers.push(r),this._hashForTimers[z.__instanceId]=r);var o,j;if(null==r.timers){r.timers=[]}else{if(!1===t){for(j=0;j<r.timers.length;j++){if(o=r.timers[j],A===o._callback){cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,o.getInterval().toFixed(4),y.toFixed(4));o._interval=y;return}}}else{for(j=0;j<r.timers.length;++j){if((o=r.timers[j])&&s===o.getSelector()){cc.log("CCScheduler#scheduleSelector. Selector already scheduled. Updating interval from: %.4f to %.4f",o.getInterval(),y);o.setInterval(y);return}}}}!1===t?(o=new cc.TimerTargetCallback,o.initWithCallback(this,A,z,u,y,x,w)):(o=new cc.TimerTargetSelector,o.initWithSelector(this,s,z,y,x,w));r.timers.push(o)},scheduleUpdate:function(e,d,f){this._schedulePerFrame(function(a){e.update(a)},e,d,f)},_getUnscheduleMark:function(d,c){switch(typeof d){case"number":case"string":return d===c.getKey();case"function":return d===c._callback;default:return d===c.getSelector()}},unschedule:function(j,h){if(h&&j){var p=this._hashForTimers[h.__instanceId];if(p){for(var o=p.timers,n=0,m=o.length;n<m;n++){var k=o[n];if(this._getUnscheduleMark(j,k)){k!==p.currentTimer||p.currentTimerSalvaged||(p.currentTimerSalvaged=!0);o.splice(n,1);p.timerIndex>=n&&p.timerIndex--;0===o.length&&(this._currentTarget===p?this._currentTargetSalvaged=!0:this._removeHashElement(p));break}}}}},unscheduleUpdate:function(b){null!=b&&(b=this._hashForUpdates[b.__instanceId])&&(this._updateHashLocked?b.entry.markedForDeletion=!0:this._removeUpdateFromHash(b.entry))},unscheduleAllForTarget:function(d){if(null!=d){var c=this._hashForTimers[d.__instanceId];c&&(-1<c.timers.indexOf(c.currentTimer)&&!c.currentTimerSalvaged&&(c.currentTimerSalvaged=!0),c.timers.length=0,this._currentTarget===c?this._currentTargetSalvaged=!0:this._removeHashElement(c));this.unscheduleUpdate(d)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(f){var e,h,g=this._arrayForTimers;for(e=0;e<g.length;e++){h=g[e],this.unscheduleAllForTarget(h.target)}g=0;if(0>f){for(e=0;e<this._updatesNegList.length;){g=this._updatesNegList.length,(h=this._updatesNegList[e])&&h.priority>=f&&this.unscheduleUpdate(h.target),g==this._updatesNegList.length&&e++}}if(0>=f){for(e=0;e<this._updates0List.length;){g=this._updates0List.length,(h=this._updates0List[e])&&this.unscheduleUpdate(h.target),g==this._updates0List.length&&e++}}for(e=0;e<this._updatesPosList.length;){g=this._updatesPosList.length,(h=this._updatesPosList[e])&&h.priority>=f&&this.unscheduleUpdate(h.target),g==this._updatesPosList.length&&e++}},isScheduled:function(f,e){cc.assert(f,"Argument key must not be empty");cc.assert(e,"Argument target must be non-nullptr");var h=this._hashForUpdates[e.__instanceId];if(!h){return !1}if(null!=h.timers){for(var h=h.timers,g=0;g<h.length;++g){if(f===h[g].getKey()){return !0}}}return !1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(h){var g=[],n,m=this._arrayForTimers,k,j;k=0;for(j=m.length;k<j;k++){if(n=m[k]){n.paused=!0,g.push(n.target)}}if(0>h){for(k=0;k<this._updatesNegList.length;k++){(n=this._updatesNegList[k])&&n.priority>=h&&(n.paused=!0,g.push(n.target))}}if(0>=h){for(k=0;k<this._updates0List.length;k++){if(n=this._updates0List[k]){n.paused=!0,g.push(n.target)}}}for(k=0;k<this._updatesPosList.length;k++){(n=this._updatesPosList[k])&&n.priority>=h&&(n.paused=!0,g.push(n.target))}return g},resumeTargets:function(d){if(d){for(var c=0;c<d.length;c++){this.resumeTarget(d[c])}}},pauseTarget:function(d){cc.assert(d,cc._LogInfos.Scheduler_pauseTarget);var c=this._hashForTimers[d.__instanceId];c&&(c.paused=!0);if(d=this._hashForUpdates[d.__instanceId]){d.entry.paused=!0}},resumeTarget:function(d){cc.assert(d,cc._LogInfos.Scheduler_resumeTarget);var c=this._hashForTimers[d.__instanceId];c&&(c.paused=!1);if(d=this._hashForUpdates[d.__instanceId]){d.entry.paused=!1}},isTargetPaused:function(d){cc.assert(d,cc._LogInfos.Scheduler_isTargetPaused);var c=this._hashForTimers[d.__instanceId];return c?c.paused:(d=this._hashForUpdates[d.__instanceId])?d.entry.paused:!1},scheduleUpdateForTarget:function(e,d,f){this.scheduleUpdate(e,d,f)},unscheduleCallbackForTarget:function(d,c){this.unschedule(c,d)},unscheduleUpdateForTarget:function(b){this.unscheduleUpdate(b)},unscheduleAllCallbacksForTarget:function(b){this.unschedule(b.__instanceId+"",b)},unscheduleAllCallbacks:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(b){this.unscheduleAllWithMinPriority(b)}});cc.Scheduler.PRIORITY_SYSTEM=-2147483648;cc.PI2=2*Math.PI;cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(b){this._renderContext=b},drawPoint:function(g,f){f||(f=1);var k=cc.view.getScaleX(),j=cc.view.getScaleY(),j=cc.p(g.x*k,g.y*j),h=this._renderContext.getContext();h.beginPath();h.arc(j.x,-j.y,f*k,0,2*Math.PI,!1);h.closePath();h.fill()},drawPoints:function(j,h,p){if(null!=j){p||(p=1);h=this._renderContext.getContext();var o=cc.view.getScaleX(),n=cc.view.getScaleY();h.beginPath();for(var m=0,k=j.length;m<k;m++){h.arc(j[m].x*o,-j[m].y*n,p*o,0,2*Math.PI,!1)}h.closePath();h.fill()}},drawLine:function(g,f){var k=this._renderContext.getContext(),j=cc.view.getScaleX(),h=cc.view.getScaleY();k.beginPath();k.moveTo(g.x*j,-g.y*h);k.lineTo(f.x*j,-f.y*h);k.closePath();k.stroke()},drawRect:function(d,c){this.drawLine(cc.p(d.x,d.y),cc.p(c.x,d.y));this.drawLine(cc.p(c.x,d.y),cc.p(c.x,c.y));this.drawLine(cc.p(c.x,c.y),cc.p(d.x,c.y));this.drawLine(cc.p(d.x,c.y),cc.p(d.x,d.y))},drawSolidRect:function(e,d,f){e=[e,cc.p(d.x,e.y),d,cc.p(e.x,d.y)];this.drawSolidPoly(e,4,f)},drawPoly:function(k,j,s,r){r=r||!1;if(null!=k){if(3>k.length){throw Error("Polygon's point must greater than 2")}var p=k[0];j=this._renderContext.getContext();var o=cc.view.getScaleX(),n=cc.view.getScaleY();j.beginPath();j.moveTo(p.x*o,-p.y*n);for(var p=1,m=k.length;p<m;p++){j.lineTo(k[p].x*o,-k[p].y*n)}s&&j.closePath();r?j.fill():j.stroke()}},drawSolidPoly:function(e,d,f){this.setDrawColor(f.r,f.g,f.b,f.a);this.drawPoly(e,d,!0,!0)},drawCircle:function(j,h,p,o,n){n=n||!1;o=this._renderContext.getContext();var m=cc.view.getScaleX(),k=cc.view.getScaleY();o.beginPath();o.arc(0|j.x*m,0|-(j.y*k),h*m,-p,-(p-2*Math.PI),!1);n&&o.lineTo(0|j.x*m,0|-(j.y*k));o.stroke()},drawQuadBezier:function(u,t,s,r){for(var p=this._cacheArray,o=p.length=0,n=0;n<r;n++){var m=Math.pow(1-o,2)*u.x+2*(1-o)*o*t.x+o*o*s.x,j=Math.pow(1-o,2)*u.y+2*(1-o)*o*t.y+o*o*s.y;p.push(cc.p(m,j));o+=1/r}p.push(cc.p(s.x,s.y));this.drawPoly(p,r+1,!1,!1)},drawCubicBezier:function(w,v,u,t,s){for(var r=this._cacheArray,p=r.length=0,o=0;o<s;o++){var n=Math.pow(1-p,3)*w.x+3*Math.pow(1-p,2)*p*v.x+3*(1-p)*p*p*u.x+p*p*p*t.x,j=Math.pow(1-p,3)*w.y+3*Math.pow(1-p,2)*p*v.y+3*(1-p)*p*p*u.y+p*p*p*t.y;r.push(cc.p(n,j));p+=1/s}r.push(cc.p(t.x,t.y));this.drawPoly(r,s+1,!1,!1)},drawCatmullRom:function(d,c){this.drawCardinalSpline(d,0.5,c)},drawCardinalSpline:function(k,j,s){cc._renderContext.setStrokeStyle("rgba(255,255,255,1)");var r=this._cacheArray;r.length=0;for(var p,o,n=1/k.length,m=0;m<s+1;m++){o=m/s,1===o?(p=k.length-1,o=1):(p=0|o/n,o=(o-n*p)/n),p=cc.CardinalSplineAt(cc.getControlPointAt(k,p-1),cc.getControlPointAt(k,p-0),cc.getControlPointAt(k,p+1),cc.getControlPointAt(k,p+2),j,o),r.push(p)}this.drawPoly(r,s+1,!1,!1)},drawImage:function(j,h,p,o,n){var m=arguments.length,k=this._renderContext.getContext();switch(m){case 2:k.drawImage(j,h.x,-(h.y+j.height));break;case 3:k.drawImage(j,h.x,-(h.y+p.height),p.width,p.height);break;case 5:k.drawImage(j,h.x,h.y,p.width,p.height,o.x,-(o.y+n.height),n.width,n.height);break;default:throw Error("Argument must be non-nil")}},drawStar:function(h,g,n){h=h||this._renderContext;var m=h.getContext();g*=cc.view.getScaleX();n="rgba("+(0|n.r)+","+(0|n.g)+","+(0|n.b);h.setFillStyle(n+",1)");var k=g/10;m.beginPath();m.moveTo(-g,g);m.lineTo(0,k);m.lineTo(g,g);m.lineTo(k,0);m.lineTo(g,-g);m.lineTo(0,-k);m.lineTo(-g,-g);m.lineTo(-k,0);m.lineTo(-g,g);m.closePath();m.fill();var j=m.createRadialGradient(0,0,k,0,0,g);j.addColorStop(0,n+", 1)");j.addColorStop(0.3,n+", 0.8)");j.addColorStop(1,n+", 0.0)");h.setFillStyle(j);m.beginPath();m.arc(0,0,g-k,0,cc.PI2,!1);m.closePath();m.fill()},drawColorBall:function(g,f,k){g=g||this._renderContext;var j=g.getContext();f*=cc.view.getScaleX();k="rgba("+(0|k.r)+","+(0|k.g)+","+(0|k.b);var h=j.createRadialGradient(0,0,f/10,0,0,f);h.addColorStop(0,k+", 1)");h.addColorStop(0.3,k+", 0.8)");h.addColorStop(0.6,k+", 0.4)");h.addColorStop(1,k+", 0.0)");g.setFillStyle(h);j.beginPath();j.arc(0,0,f,0,cc.PI2,!1);j.closePath();j.fill()},fillText:function(e,d,f){this._renderContext.getContext().fillText(e,d,-f)},setDrawColor:function(f,e,h,g){this._renderContext.setFillStyle("rgba("+f+","+e+","+h+","+g/255+")");this._renderContext.setStrokeStyle("rgba("+f+","+e+","+h+","+g/255+")")},setPointSize:function(b){},setLineWidth:function(b){this._renderContext.getContext().lineWidth=b*cc.view.getScaleX()}});cc.DrawingPrimitiveWebGL=cc.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:-1,_colorArray:null,_pointSizeLocation:-1,_pointSize:-1,ctor:function(b){null==b&&(b=cc._renderContext);if(!b instanceof WebGLRenderingContext){throw"Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext"}this._renderContext=b;this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){this._initialized||(this._shader=cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR),this._colorLocation=this._renderContext.getUniformLocation(this._shader.getProgram(),"u_color"),this._pointSizeLocation=this._renderContext.getUniformLocation(this._shader.getProgram(),"u_pointSize"),this._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(e){this.lazy_init();var d=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);d.uniform4fv(this._colorLocation,this._colorArray);this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var f=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,f);d.bufferData(d.ARRAY_BUFFER,new Float32Array([e.x,e.y]),d.STATIC_DRAW);d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0);d.drawArrays(d.POINTS,0,1);d.deleteBuffer(f);cc.incrementGLDraws(1)},drawPoints:function(f,e){if(f&&0!==f.length){this.lazy_init();var h=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);h.uniform4fv(this._colorLocation,this._colorArray);this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var g=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,g);h.bufferData(h.ARRAY_BUFFER,this._pointsToTypeArray(f),h.STATIC_DRAW);h.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,0);h.drawArrays(h.POINTS,0,f.length);h.deleteBuffer(g);cc.incrementGLDraws(1)}},_pointsToTypeArray:function(e){for(var d=new Float32Array(2*e.length),f=0;f<e.length;f++){d[2*f]=e[f].x,d[2*f+1]=e[f].y}return d},drawLine:function(f,e){this.lazy_init();var h=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);h.uniform4fv(this._colorLocation,this._colorArray);var g=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,g);h.bufferData(h.ARRAY_BUFFER,this._pointsToTypeArray([f,e]),h.STATIC_DRAW);h.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,h.FLOAT,!1,0,0);h.drawArrays(h.LINES,0,2);h.deleteBuffer(g);cc.incrementGLDraws(1)},drawRect:function(d,c){this.drawLine(cc.p(d.x,d.y),cc.p(c.x,d.y));this.drawLine(cc.p(c.x,d.y),cc.p(c.x,c.y));this.drawLine(cc.p(c.x,c.y),cc.p(d.x,c.y));this.drawLine(cc.p(d.x,c.y),cc.p(d.x,d.y))},drawSolidRect:function(e,d,f){e=[e,cc.p(d.x,e.y),d,cc.p(e.x,d.y)];this.drawSolidPoly(e,4,f)},drawPoly:function(f,e,h){this.lazy_init();e=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);e.uniform4fv(this._colorLocation,this._colorArray);var g=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,g);e.bufferData(e.ARRAY_BUFFER,this._pointsToTypeArray(f),e.STATIC_DRAW);e.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,e.FLOAT,!1,0,0);h?e.drawArrays(e.LINE_LOOP,0,f.length):e.drawArrays(e.LINE_STRIP,0,f.length);e.deleteBuffer(g);cc.incrementGLDraws(1)},drawSolidPoly:function(e,d,f){this.lazy_init();f&&this.setDrawColor(f.r,f.g,f.b,f.a);d=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);d.uniform4fv(this._colorLocation,this._colorArray);f=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,f);d.bufferData(d.ARRAY_BUFFER,this._pointsToTypeArray(e),d.STATIC_DRAW);d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,0,0);d.drawArrays(d.TRIANGLE_FAN,0,e.length);d.deleteBuffer(f);cc.incrementGLDraws(1)},drawCircle:function(w,v,u,t,s){this.lazy_init();var r=1;s&&r++;var p=2*Math.PI/t;if(s=new Float32Array(2*(t+2))){for(var o=0;o<=t;o++){var n=o*p,j=v*Math.cos(n+u)+w.x,n=v*Math.sin(n+u)+w.y;s[2*o]=j;s[2*o+1]=n}s[2*(t+1)]=w.x;s[2*(t+1)+1]=w.y;w=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);w.uniform4fv(this._colorLocation,this._colorArray);v=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,v);w.bufferData(w.ARRAY_BUFFER,s,w.STATIC_DRAW);w.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,w.FLOAT,!1,0,0);w.drawArrays(w.LINE_STRIP,0,t+r);w.deleteBuffer(v);cc.incrementGLDraws(1)}},drawQuadBezier:function(j,h,p,o){this.lazy_init();for(var n=new Float32Array(2*(o+1)),m=0,k=0;k<o;k++){n[2*k]=Math.pow(1-m,2)*j.x+2*(1-m)*m*h.x+m*m*p.x,n[2*k+1]=Math.pow(1-m,2)*j.y+2*(1-m)*m*h.y+m*m*p.y,m+=1/o}n[2*o]=p.x;n[2*o+1]=p.y;j=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);j.uniform4fv(this._colorLocation,this._colorArray);h=j.createBuffer();j.bindBuffer(j.ARRAY_BUFFER,h);j.bufferData(j.ARRAY_BUFFER,n,j.STATIC_DRAW);j.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,j.FLOAT,!1,0,0);j.drawArrays(j.LINE_STRIP,0,o+1);j.deleteBuffer(h);cc.incrementGLDraws(1)},drawCubicBezier:function(k,j,s,r,p){this.lazy_init();for(var o=new Float32Array(2*(p+1)),n=0,m=0;m<p;m++){o[2*m]=Math.pow(1-n,3)*k.x+3*Math.pow(1-n,2)*n*j.x+3*(1-n)*n*n*s.x+n*n*n*r.x,o[2*m+1]=Math.pow(1-n,3)*k.y+3*Math.pow(1-n,2)*n*j.y+3*(1-n)*n*n*s.y+n*n*n*r.y,n+=1/p}o[2*p]=r.x;o[2*p+1]=r.y;k=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);k.uniform4fv(this._colorLocation,this._colorArray);j=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,j);k.bufferData(k.ARRAY_BUFFER,o,k.STATIC_DRAW);k.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,k.FLOAT,!1,0,0);k.drawArrays(k.LINE_STRIP,0,p+1);k.deleteBuffer(j);cc.incrementGLDraws(1)},drawCatmullRom:function(d,c){this.drawCardinalSpline(d,0.5,c)},drawCardinalSpline:function(k,j,s){this.lazy_init();for(var r=new Float32Array(2*(s+1)),p,o,n=1/k.length,m=0;m<s+1;m++){o=m/s,1===o?(p=k.length-1,o=1):(p=0|o/n,o=(o-n*p)/n),p=cc.cardinalSplineAt(cc.getControlPointAt(k,p-1),cc.getControlPointAt(k,p),cc.getControlPointAt(k,p+1),cc.getControlPointAt(k,p+2),j,o),r[2*m]=p.x,r[2*m+1]=p.y}k=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);k.uniform4fv(this._colorLocation,this._colorArray);j=k.createBuffer();k.bindBuffer(k.ARRAY_BUFFER,j);k.bufferData(k.ARRAY_BUFFER,r,k.STATIC_DRAW);k.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,k.FLOAT,!1,0,0);k.drawArrays(k.LINE_STRIP,0,s+1);k.deleteBuffer(j);cc.incrementGLDraws(1)},setDrawColor:function(f,e,h,g){this._colorArray[0]=f/255;this._colorArray[1]=e/255;this._colorArray[2]=h/255;this._colorArray[3]=g/255},setPointSize:function(b){this._pointSize=b*cc.contentScaleFactor()},setLineWidth:function(b){this._renderContext.lineWidth&&this._renderContext.lineWidth(b)}});cc._tmp.PrototypeLabelTTF=function(){var b=cc.LabelTTF.prototype;cc.defineGetterSetter(b,"color",b.getColor,b.setColor);cc.defineGetterSetter(b,"opacity",b.getOpacity,b.setOpacity);cc.defineGetterSetter(b,"string",b.getString,b.setString);cc.defineGetterSetter(b,"textAlign",b.getHorizontalAlignment,b.setHorizontalAlignment);cc.defineGetterSetter(b,"verticalAlign",b.getVerticalAlignment,b.setVerticalAlignment);cc.defineGetterSetter(b,"fontSize",b.getFontSize,b.setFontSize);cc.defineGetterSetter(b,"fontName",b.getFontName,b.setFontName);cc.defineGetterSetter(b,"font",b._getFont,b._setFont);cc.defineGetterSetter(b,"boundingWidth",b._getBoundingWidth,b._setBoundingWidth);cc.defineGetterSetter(b,"boundingHeight",b._getBoundingHeight,b._setBoundingHeight);cc.defineGetterSetter(b,"fillStyle",b._getFillStyle,b.setFontFillColor);cc.defineGetterSetter(b,"strokeStyle",b._getStrokeStyle,b._setStrokeStyle);cc.defineGetterSetter(b,"lineWidth",b._getLineWidth,b._setLineWidth);cc.defineGetterSetter(b,"shadowOffsetX",b._getShadowOffsetX,b._setShadowOffsetX);cc.defineGetterSetter(b,"shadowOffsetY",b._getShadowOffsetY,b._setShadowOffsetY);cc.defineGetterSetter(b,"shadowOpacity",b._getShadowOpacity,b._setShadowOpacity);cc.defineGetterSetter(b,"shadowBlur",b._getShadowBlur,b._setShadowBlur)};cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColor:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_textFillColor:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,_needUpdateTexture:!1,_lineWidths:null,_className:"LabelTTF",_fontStyle:"normal",_fontWeight:"normal",_lineHeight:"normal",initWithString:function(h,g,n,m,k,j){h=h?h+"":"";n=n||16;m=m||cc.size(0,0);k=k||cc.TEXT_ALIGNMENT_LEFT;j=j||cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=!1;this._dimensions=cc.size(m.width,m.height);this._fontName=g||"Arial";this._hAlignment=k;this._vAlignment=j;this._fontSize=n;this._renderCmd._setFontStyle(this._fontName,n,this._fontStyle,this._fontWeight);this.string=h;this._renderCmd._setColorsString();this._renderCmd._updateTexture();this._setUpdateTextureDirty();return !0},_setUpdateTextureDirty:function(){this._needUpdateTexture=!0;this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)},ctor:function(h,g,n,m,k,j){cc.Sprite.prototype.ctor.call(this);this._dimensions=cc.size(0,0);this._hAlignment=cc.TEXT_ALIGNMENT_LEFT;this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=!1;this._fontName="Arial";this._shadowEnabled=!1;this._shadowOffset=cc.p(0,0);this._shadowBlur=this._shadowOpacity=0;this._strokeEnabled=!1;this._strokeColor=cc.color(255,255,255,255);this._strokeSize=0;this._textFillColor=cc.color(255,255,255,255);this._strokeShadowOffsetY=this._strokeShadowOffsetX=0;this._needUpdateTexture=!1;this._lineWidths=[];this._renderCmd._setColorsString();this._textureLoaded=!0;g&&g instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(h,g):cc.LabelTTF.prototype.initWithString.call(this,h,g,n,m,k,j)},init:function(){return this.initWithString(" ",this._fontName,this._fontSize)},description:function(){return"\x3ccc.LabelTTF | FontName \x3d"+this._fontName+" FontSize \x3d "+this._fontSize.toFixed(1)+"\x3e"},getLineHeight:function(){return !this._lineHeight||this._lineHeight.charAt?this._renderCmd._getFontClientHeight():this._lineHeight||this._renderCmd._getFontClientHeight()},setLineHeight:function(b){this._lineHeight=b},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:function(d,c){this._updateWithTextDefinition(c,!1);this.string=d;return !0},setTextDefinition:function(b){b&&this._updateWithTextDefinition(b,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},enableShadow:function(f,e,h,g){null!=f.r&&null!=f.g&&null!=f.b&&null!=f.a?this._enableShadow(f,e,h):this._enableShadowNoneColor(f,e,h,g)},_enableShadowNoneColor:function(g,f,k,j){k=k||0.5;!1===this._shadowEnabled&&(this._shadowEnabled=!0);var h=this._shadowOffset;if(h&&h.x!==g||h._y!==f){h.x=g,h.y=f}this._shadowOpacity!==k&&(this._shadowOpacity=k);this._renderCmd._setColorsString();this._shadowBlur!==j&&(this._shadowBlur=j);this._setUpdateTextureDirty()},_enableShadow:function(e,d,f){this._shadowColor||(this._shadowColor=cc.color(255,255,255,128));this._shadowColor.r=e.r;this._shadowColor.g=e.g;this._shadowColor.b=e.b;this._enableShadowNoneColor(d.width||d.x||0,d.height||d.y||0,null!=e.a?e.a/255:0.5,f)},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(b){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset.x!==b&&(this._shadowOffset.x=b,this._setUpdateTextureDirty())},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(b){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset._y!==b&&(this._shadowOffset._y=b,this._setUpdateTextureDirty())},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(b){!1===this._shadowEnabled&&(this._shadowEnabled=!0);if(this._shadowOffset.x!==b.x||this._shadowOffset.y!==b.y){this._shadowOffset.x=b.x,this._shadowOffset.y=b.y,this._setUpdateTextureDirty()}},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(b){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOpacity!==b&&(this._shadowOpacity=b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty())},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(b){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowBlur!==b&&(this._shadowBlur=b,this._setUpdateTextureDirty())},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=!1,this._setUpdateTextureDirty())},enableStroke:function(e,d){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var f=this._strokeColor;if(f.r!==e.r||f.g!==e.g||f.b!==e.b){f.r=e.r,f.g=e.g,f.b=e.b,this._renderCmd._setColorsString()}this._strokeSize!==d&&(this._strokeSize=d||0);this._setUpdateTextureDirty()},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(d){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var c=this._strokeColor;if(c.r!==d.r||c.g!==d.g||c.b!==d.b){c.r=d.r,c.g=d.g,c.b=d.b,this._renderCmd._setColorsString(),this._setUpdateTextureDirty()}},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(b){!1===this._strokeEnabled&&(this._strokeEnabled=!0);this._strokeSize!==b&&(this._strokeSize=b||0,this._setUpdateTextureDirty())},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._setUpdateTextureDirty())},setFontFillColor:function(d){var c=this._textFillColor;if(c.r!==d.r||c.g!==d.g||c.b!==d.b){c.r=d.r,c.g=d.g,c.b=d.b,this._renderCmd._setColorsString(),this._needUpdateTexture=!0}},_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(e,d){e.fontDimensions?(this._dimensions.width=e.boundingWidth,this._dimensions.height=e.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0);this._hAlignment=e.textAlign;this._vAlignment=e.verticalAlign;this._fontName=e.fontName;this._fontSize=e.fontSize||12;this._lineHeight=e.lineHeight?e.lineHeight:this._fontSize;this._renderCmd._setFontStyle(e);e.shadowEnabled&&this.enableShadow(e.shadowOffsetX,e.shadowOffsetY,e.shadowOpacity,e.shadowBlur);e.strokeEnabled&&this.enableStroke(e.strokeStyle,e.lineWidth);this.setFontFillColor(e.fillStyle);d&&this._renderCmd._updateTexture();var f=cc.Node._dirtyFlags;this._renderCmd.setDirtyFlag(f.colorDirty|f.opacityDirty|f.textDirty)},_prepareTextDefinition:function(e){var d=new cc.FontDefinition;e?(d.fontSize=this._fontSize,d.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,d.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(d.fontSize=this._fontSize,d.boundingWidth=this._dimensions.width,d.boundingHeight=this._dimensions.height);d.fontName=this._fontName;d.textAlign=this._hAlignment;d.verticalAlign=this._vAlignment;if(this._strokeEnabled){d.strokeEnabled=!0;var f=this._strokeColor;d.strokeStyle=cc.color(f.r,f.g,f.b);d.lineWidth=this._strokeSize}else{d.strokeEnabled=!1}this._shadowEnabled?(d.shadowEnabled=!0,d.shadowBlur=this._shadowBlur,d.shadowOpacity=this._shadowOpacity,d.shadowOffsetX=(e?cc.contentScaleFactor():1)*this._shadowOffset.x,d.shadowOffsetY=(e?cc.contentScaleFactor():1)*this._shadowOffset.y):d._shadowEnabled=!1;e=this._textFillColor;d.fillStyle=cc.color(e.r,e.g,e.b);return d},setString:function(b){b=String(b);this._originalText!==b&&(this._originalText=b+"",this._updateString(),this._setUpdateTextureDirty(),this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty))},_updateString:function(){this._string&&""!==this._string||this._string===this._originalText||(cc.renderer.childrenOrderDirty=!0);this._string=this._originalText},setHorizontalAlignment:function(b){b!==this._hAlignment&&(this._hAlignment=b,this._setUpdateTextureDirty())},setVerticalAlignment:function(b){b!==this._vAlignment&&(this._vAlignment=b,this._setUpdateTextureDirty())},setDimensions:function(e,d){var f;void 0===d?(f=e.width,d=e.height):f=e;if(f!==this._dimensions.width||d!==this._dimensions.height){this._dimensions.width=f,this._dimensions.height=d,this._updateString(),this._setUpdateTextureDirty()}},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(b){b!==this._dimensions.width&&(this._dimensions.width=b,this._updateString(),this._setUpdateTextureDirty())},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(b){b!==this._dimensions.height&&(this._dimensions.height=b,this._updateString(),this._setUpdateTextureDirty())},setFontSize:function(b){this._fontSize!==b&&(this._fontSize=b,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},setFontName:function(b){this._fontName&&this._fontName!==b&&(this._fontName=b,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFont:function(){return this._renderCmd._getFontStyle()},_setFont:function(b){if(b=cc.LabelTTF._fontStyleRE.exec(b)){this._fontSize=parseInt(b[1]),this._fontName=b[2],this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty()}},getContentSize:function(){this._needUpdateTexture&&this._renderCmd._updateTTF();return cc.Sprite.prototype.getContentSize.call(this)},_getWidth:function(){this._needUpdateTexture&&this._renderCmd._updateTTF();return cc.Sprite.prototype._getWidth.call(this)},_getHeight:function(){this._needUpdateTexture&&this._renderCmd._updateTTF();return cc.Sprite.prototype._getHeight.call(this)},setTextureRect:function(e,d,f){cc.Sprite.prototype.setTextureRect.call(this,e,d,f,!1)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_CANVAS?new cc.LabelTTF.CanvasRenderCmd(this):new cc.LabelTTF.WebGLRenderCmd(this)},_setFontStyle:function(b){this._fontStyle!==b&&(this._fontStyle=b,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontStyle:function(){return this._fontStyle},_setFontWeight:function(b){this._fontWeight!==b&&(this._fontWeight=b,this._renderCmd._setFontStyle(this._fontName,this._fontSize,this._fontStyle,this._fontWeight),this._setUpdateTextureDirty())},_getFontWeight:function(){return this._fontWeight}});cc.assert(cc.isFunction(cc._tmp.PrototypeLabelTTF),cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js");cc._tmp.PrototypeLabelTTF();delete cc._tmp.PrototypeLabelTTF;cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/;cc.LabelTTF.create=function(h,g,n,m,k,j){return new cc.LabelTTF(h,g,n,m,k,j)};cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create;cc.LabelTTF._SHADER_PROGRAM=cc.USE_LA88_LABELS?cc.SHADER_POSITION_TEXTURECOLOR:cc.SHADER_POSITION_TEXTUREA8COLOR;cc.LabelTTF.__labelHeightDiv=cc.newElement("div");cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial";cc.LabelTTF.__labelHeightDiv.style.position="absolute";cc.LabelTTF.__labelHeightDiv.style.left="-100px";cc.LabelTTF.__labelHeightDiv.style.top="-100px";cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal";document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1);cc.LabelTTF.__getFontHeightByDiv=function(f,e){if(f instanceof cc.FontDefinition){var h=cc.LabelTTF.__fontHeightCache[f._getCanvasFontStr()];if(0<h){return h}var g=cc.LabelTTF.__labelHeightDiv;g.innerHTML="ajghl~!";g.style.fontFamily=f.fontName;g.style.fontSize=f.fontSize+"px";g.style.fontStyle=f.fontStyle;g.style.fontWeight=f.fontWeight;h=g.clientHeight;cc.LabelTTF.__fontHeightCache[f._getCanvasFontStr()]=h;g.innerHTML="";return h}h=cc.LabelTTF.__fontHeightCache[f+"."+e];if(0<h){return h}g=cc.LabelTTF.__labelHeightDiv;g.innerHTML="ajghl~!";g.style.fontFamily=f;g.style.fontSize=e+"px";h=g.clientHeight;cc.LabelTTF.__fontHeightCache[f+"."+e]=h;g.innerHTML="";return h};cc.LabelTTF.__fontHeightCache={};cc.LabelTTF._textAlign=["left","center","right"];cc.LabelTTF._textBaseline=["top","middle","bottom"];cc.LabelTTF.wrapInspection=!0;cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)/;cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/;cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)$/;cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+$/;cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]/;(function(){cc.LabelTTF.RenderCmd=function(){this._fontClientHeight=18;this._fontStyleStr="";this._shadowColorStr="rgba(128, 128, 128, 0.5)";this._strokeColorStr="";this._fillColorStr="rgba(255,255,255,1)";this._labelContext=this._labelCanvas=null;this._lineWidths=[];this._strings=[];this._isMultiLine=!1};var b=cc.LabelTTF.RenderCmd.prototype;b.constructor=cc.LabelTTF.RenderCmd;b._getLabelContext=function(){if(this._labelContext){return this._labelContext}var e=this._node;if(!this._labelCanvas){var g=cc.newElement("canvas");g.width=1;g.height=1;var f=new cc.Texture2D;f.initWithElement(g);e.setTexture(f);this._labelCanvas=g}return this._labelContext=this._labelCanvas.getContext("2d")};b._setFontStyle=function(f,j,h,g){f instanceof cc.FontDefinition?(this._fontStyleStr=f._getCanvasFontStr(),this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(f)):(this._fontStyleStr=h+" "+g+" "+j+"px '"+f+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(f,j))};b._getFontStyle=function(){return this._fontStyleStr};b._getFontClientHeight=function(){return this._fontClientHeight};b._updateTexture=function(){this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.textDirty;var h=this._node,o=this._getLabelContext(),n=this._labelCanvas,m=h._contentSize;if(0===h._string.length){return n.width=1,n.height=m.height||1,h._texture&&h._texture.handleLoadedTexture(),h.setTextureRect(cc.rect(0,0,1,m.height)),!0}o.font=this._fontStyleStr;this._updateTTF();var k=m.width,m=m.height,j=n.width===k&&n.height===m;n.width=k;n.height=m;j&&o.clearRect(0,0,k,m);this._drawTTFInCanvas(o);h._texture&&h._texture.handleLoadedTexture();h.setTextureRect(cc.rect(0,0,k,m));return !0};b._measureConfig=function(){this._getLabelContext().font=this._fontStyleStr};b._measure=function(c){return this._getLabelContext().measureText(c).width};b._updateTTF=function(){var h=this._node,o=h._dimensions.width,n,m,k=this._lineWidths;k.length=0;this._isMultiLine=!1;this._measureConfig();if(0!==o){for(this._strings=h._string.split("\n"),n=0;n<this._strings.length;n++){this._checkWarp(this._strings,n,o)}}else{for(this._strings=h._string.split("\n"),n=0,m=this._strings.length;n<m;n++){k.push(this._measure(this._strings[n]))}}0<this._strings.length&&(this._isMultiLine=!0);m=n=0;h._strokeEnabled&&(n=m=2*h._strokeSize);if(h._shadowEnabled){var j=h._shadowOffset;n+=2*Math.abs(j.x);m+=2*Math.abs(j.y)}o=0===o?this._isMultiLine?cc.size(Math.ceil(Math.max.apply(Math,k)+n),Math.ceil(this._fontClientHeight*this._strings.length+m)):cc.size(Math.ceil(this._measure(h._string)+n),Math.ceil(this._fontClientHeight+m)):0===h._dimensions.height?this._isMultiLine?cc.size(Math.ceil(o+n),Math.ceil(h.getLineHeight()*this._strings.length+m)):cc.size(Math.ceil(o+n),Math.ceil(h.getLineHeight()+m)):cc.size(Math.ceil(o+n),Math.ceil(h._dimensions.height+m));"normal"!==h._getFontStyle()&&(o.width=Math.ceil(o.width+0.3*h._fontSize));h.setContentSize(o);h._strokeShadowOffsetX=n;h._strokeShadowOffsetY=m;h=h._anchorPoint;this._anchorPointInPoints.x=0.5*n+(o.width-n)*h.x;this._anchorPointInPoints.y=0.5*m+(o.height-m)*h.y};b._drawTTFInCanvas=function(z){if(z){var y=this._node,x=y._strokeShadowOffsetX,w=y._strokeShadowOffsetY,v=y._contentSize.height-w,u=y._vAlignment,t=y._hAlignment,s=y._strokeSize;z.setTransform(1,0,0,1,0.5*x,v+0.5*w);z.font!==this._fontStyleStr&&(z.font=this._fontStyleStr);z.fillStyle=this._fillColorStr;var r=w=0,o=y._strokeEnabled;o&&(z.lineWidth=2*s,z.strokeStyle=this._strokeColorStr);y._shadowEnabled&&(s=y._shadowOffset,z.shadowColor=this._shadowColorStr,z.shadowOffsetX=s.x,z.shadowOffsetY=-s.y,z.shadowBlur=y._shadowBlur);z.textBaseline=cc.LabelTTF._textBaseline[u];z.textAlign=cc.LabelTTF._textAlign[t];var j=y._contentSize.width-x,x=y.getLineHeight(),s=(x-this._fontClientHeight)/2,w=t===cc.TEXT_ALIGNMENT_RIGHT?w+j:t===cc.TEXT_ALIGNMENT_CENTER?w+j/2:w+0;if(this._isMultiLine){for(y=this._strings.length,u===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?r=x-2*s+v-x*y:u===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(r=(x-2*s)/2+(v-x*y)/2),u=0;u<y;u++){t=this._strings[u],j=-v+(x*u+s)+r,o&&z.strokeText(t,w,j),z.fillText(t,w,j)}}else{u!==cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM&&(r=u===cc.VERTICAL_TEXT_ALIGNMENT_TOP?r-v:r-0.5*v),o&&z.strokeText(y._string,w,r),z.fillText(y._string,w,r)}}};b._checkWarp=function(z,y,x){var w=z[y],v=this._measure(w);if(v>x&&1<w.length){for(var u=x/v*w.length|0,t=w.substr(u),s=v-this._measure(t),r,o=0,j=0;s>x&&100>j++;){u*=x/s,u|=0,t=w.substr(u),s=v-this._measure(t)}for(j=0;s<x&&100>j++;){t&&(o=(r=cc.LabelTTF._wordRex.exec(t))?r[0].length:1,r=t),u+=o,t=w.substr(u),s=v-this._measure(t)}u-=o;0===u&&(u=1,r=r.substr(1));x=w.substr(0,u);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(r||t)&&(v=cc.LabelTTF._lastWordRex.exec(x),u-=v?v[0].length:0,r=w.substr(u),x=w.substr(0,u));cc.LabelTTF._firsrEnglish.test(r)&&(v=cc.LabelTTF._lastEnglish.exec(x))&&x!==v[0]&&(u-=v[0].length,r=w.substr(u),x=w.substr(0,u));z[y]=r||t;z.splice(y,0,x)}}})();(function(){cc.LabelTTF.CanvasRenderCmd=function(c){cc.Sprite.CanvasRenderCmd.call(this,c);cc.LabelTTF.RenderCmd.call(this)};cc.LabelTTF.CanvasRenderCmd.prototype=Object.create(cc.Sprite.CanvasRenderCmd.prototype);cc.inject(cc.LabelTTF.RenderCmd.prototype,cc.LabelTTF.CanvasRenderCmd.prototype);var b=cc.LabelTTF.CanvasRenderCmd.prototype;b.constructor=cc.LabelTTF.CanvasRenderCmd;b.updateStatus=function(){var f=cc.Node._dirtyFlags,j=this._dirtyFlag,h=j&f.colorDirty,g=j&f.opacityDirty;h&&this._updateDisplayColor();g&&this._updateDisplayOpacity();h?this._updateColor():j&f.textDirty&&this._updateTexture();this._dirtyFlag&f.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)};b._syncStatus=function(g){var m=cc.Node._dirtyFlags,k=this._dirtyFlag,j=g?g._node:null;j&&j._cascadeColorEnabled&&g._dirtyFlag&m.colorDirty&&(k|=m.colorDirty);j&&j._cascadeOpacityEnabled&&g._dirtyFlag&m.opacityDirty&&(k|=m.opacityDirty);g&&g._dirtyFlag&m.transformDirty&&(k|=m.transformDirty);var j=k&m.colorDirty,h=k&m.opacityDirty;this._dirtyFlag=k;j&&this._syncDisplayColor();h&&this._syncDisplayOpacity();j?this._updateColor():k&m.textDirty&&this._updateTexture();k&m.transformDirty&&this.transform(g)};b._setColorsString=function(){var j=this._displayedColor,r=this._node,p=r._shadowColor||this._displayedColor,o=r._strokeColor,n=r._textFillColor,m=j.r/255,k=j.g/255,j=j.b/255;this._shadowColorStr="rgba("+(0|m*p.r)+","+(0|k*p.g)+","+(0|j*p.b)+","+r._shadowOpacity+")";this._fillColorStr="rgba("+(0|m*n.r)+","+(0|k*n.g)+","+(0|j*n.b)+", 1)";this._strokeColorStr="rgba("+(0|m*o.r)+","+(0|k*o.g)+","+(0|j*o.b)+", 1)"};b._updateColor=function(){this._setColorsString();this._updateTexture()}})();(function(){cc.LabelTTF.WebGLRenderCmd=function(c){cc.Sprite.WebGLRenderCmd.call(this,c);cc.LabelTTF.RenderCmd.call(this);this.setShaderProgram(cc.shaderCache.programForKey(cc.LabelTTF._SHADER_PROGRAM))};var b=cc.LabelTTF.WebGLRenderCmd.prototype=Object.create(cc.Sprite.WebGLRenderCmd.prototype);cc.inject(cc.LabelTTF.RenderCmd.prototype,b);b.constructor=cc.LabelTTF.WebGLRenderCmd;b._setColorsString=function(){this.setDirtyFlag(cc.Node._dirtyFlags.textDirty);var f=this._node,j=f._strokeColor,h=f._textFillColor,g=f._shadowColor||this._displayedColor;this._shadowColorStr="rgba("+(0|g.r)+","+(0|g.g)+","+(0|g.b)+","+f._shadowOpacity+")";this._fillColorStr="rgba("+(0|h.r)+","+(0|h.g)+","+(0|h.b)+", 1)";this._strokeColorStr="rgba("+(0|j.r)+","+(0|j.g)+","+(0|j.b)+", 1)"};b.updateStatus=function(){var f=cc.Node._dirtyFlags,j=this._dirtyFlag,h=j&f.colorDirty,g=j&f.opacityDirty;h&&this._updateDisplayColor();g&&this._updateDisplayOpacity();h||g?(this._setColorsString(),this._updateColor(),this._updateTexture()):j&f.textDirty&&this._updateTexture();this._dirtyFlag&f.transformDirty&&(this.transform(this.getParentRenderCmd(),!0),this._dirtyFlag^=this._dirtyFlag&cc.Node._dirtyFlags.transformDirty)};b._syncStatus=function(g){var m=cc.Node._dirtyFlags,k=this._dirtyFlag,j=g?g._node:null;j&&j._cascadeColorEnabled&&g._dirtyFlag&m.colorDirty&&(k|=m.colorDirty);j&&j._cascadeOpacityEnabled&&g._dirtyFlag&m.opacityDirty&&(k|=m.opacityDirty);g&&g._dirtyFlag&m.transformDirty&&(k|=m.transformDirty);var j=k&m.colorDirty,h=k&m.opacityDirty;this._dirtyFlag=k;j&&this._syncDisplayColor();h&&this._syncDisplayOpacity();j||h?(this._setColorsString(),this._updateColor(),this._updateTexture()):k&m.textDirty&&this._updateTexture();this.transform(g)}})();cc.HashElement=cc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:!1,paused:!1,hh:null,ctor:function(){this.actions=[];this.target=null;this.actionIndex=0;this.currentAction=null;this.paused=this.currentActionSalvaged=!1;this.hh=null}});cc.ActionManager=cc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:!1,_searchElementByTarget:function(e,d){for(var f=0;f<e.length;f++){if(d===e[f].target){return e[f]}}return null},ctor:function(){this._hashTargets={};this._arrayTargets=[];this._currentTarget=null;this._currentTargetSalvaged=!1},addAction:function(f,e,h){if(!f){throw"cc.ActionManager.addAction(): action must be non-null"}if(!e){throw"cc.ActionManager.addAction(): action must be non-null"}var g=this._hashTargets[e.__instanceId];g||(g=new cc.HashElement,g.paused=h,g.target=e,this._hashTargets[e.__instanceId]=g,this._arrayTargets.push(g));this._actionAllocWithHashElement(g);g.actions.push(f);f.startWithTarget(e)},removeAllActions:function(){for(var e=this._arrayTargets,d=0;d<e.length;d++){var f=e[d];f&&this.removeAllActionsFromTarget(f.target,!0)}},removeAllActionsFromTarget:function(e,d){if(null!=e){var f=this._hashTargets[e.__instanceId];f&&(-1===f.actions.indexOf(f.currentAction)||f.currentActionSalvaged||(f.currentActionSalvaged=!0),f.actions.length=0,this._currentTarget!==f||d?this._deleteHashElement(f):this._currentTargetSalvaged=!0)}},removeAction:function(e){if(null!=e){var d=e.getOriginalTarget();if(d=this._hashTargets[d.__instanceId]){for(var f=0;f<d.actions.length;f++){if(d.actions[f]===e){d.actions.splice(f,1);break}}}else{cc.log(cc._LogInfos.ActionManager_removeAction)}}},removeActionByTag:function(h,g){h===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_addAction);cc.assert(g,cc._LogInfos.ActionManager_addAction);var n=this._hashTargets[g.__instanceId];if(n){for(var m=n.actions.length,k=0;k<m;++k){var j=n.actions[k];if(j&&j.getTag()===h&&j.getOriginalTarget()===g){this._removeActionAtIndex(k,n);break}}}},getActionByTag:function(g,f){g===cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_getActionByTag);var k=this._hashTargets[f.__instanceId];if(k){if(null!=k.actions){for(var j=0;j<k.actions.length;++j){var h=k.actions[j];if(h&&h.getTag()===g){return h}}}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,g)}return null},numberOfRunningActionsInTarget:function(b){return(b=this._hashTargets[b.__instanceId])?b.actions?b.actions.length:0:0},pauseTarget:function(b){if(b=this._hashTargets[b.__instanceId]){b.paused=!0}},resumeTarget:function(b){if(b=this._hashTargets[b.__instanceId]){b.paused=!1}},pauseAllRunningActions:function(){for(var f=[],e=this._arrayTargets,h=0;h<e.length;h++){var g=e[h];g&&!g.paused&&(g.paused=!0,f.push(g.target))}return f},resumeTargets:function(d){if(d){for(var c=0;c<d.length;c++){d[c]&&this.resumeTarget(d[c])}}},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(d,c){c.actions[d]!==c.currentAction||c.currentActionSalvaged||(c.currentActionSalvaged=!0);c.actions.splice(d,1);c.actionIndex>=d&&c.actionIndex--;0===c.actions.length&&(this._currentTarget===c?this._currentTargetSalvaged=!0:this._deleteHashElement(c))},_deleteHashElement:function(b){b&&(delete this._hashTargets[b.target.__instanceId],cc.arrayRemoveObject(this._arrayTargets,b),b.actions=null,b.target=null)},_actionAllocWithHashElement:function(b){null==b.actions&&(b.actions=[])},update:function(g){for(var f=this._arrayTargets,k,j=0;j<f.length;j++){k=this._currentTarget=f[j];if(!k.paused){for(k.actionIndex=0;k.actionIndex<(k.actions?k.actions.length:0);k.actionIndex++){if(k.currentAction=k.actions[k.actionIndex],k.currentAction){k.currentActionSalvaged=!1;k.currentAction.step(g*(k.currentAction._speedMethod?k.currentAction._speed:1));if(k.currentActionSalvaged){k.currentAction=null}else{if(k.currentAction.isDone()){k.currentAction.stop();var h=k.currentAction;k.currentAction=null;this.removeAction(h)}}k.currentAction=null}}}this._currentTargetSalvaged&&0===k.actions.length&&this._deleteHashElement(k)}}});cc.math=cc.math||{};cc.math.EPSILON=0.015625;cc.math.square=function(b){return b*b};cc.math.almostEqual=function(d,c){return d+cc.math.EPSILON>c&&d-cc.math.EPSILON<c};(function(d){d.math.Vec2=function(f,e){void 0===e?(this.x=f.x,this.y=f.y):(this.x=f||0,this.y=e||0)};var c=d.math.Vec2.prototype;c.fill=function(f,e){this.x=f;this.y=e};c.length=function(){return Math.sqrt(d.math.square(this.x)+d.math.square(this.y))};c.lengthSq=function(){return d.math.square(this.x)+d.math.square(this.y)};c.normalize=function(){var b=1/this.length();this.x*=b;this.y*=b;return this};d.math.Vec2.add=function(g,f,h){g.x=f.x+h.x;g.y=f.y+h.y;return g};c.add=function(b){this.x+=b.x;this.y+=b.y;return this};c.dot=function(b){return this.x*b.x+this.y*b.y};d.math.Vec2.subtract=function(g,f,h){g.x=f.x-h.x;g.y=f.y-h.y;return g};c.subtract=function(b){this.x-=b.x;this.y-=b.y;return this};c.transform=function(g){var f=this.x,h=this.y;this.x=f*g.mat[0]+h*g.mat[3]+g.mat[6];this.y=f*g.mat[1]+h*g.mat[4]+g.mat[7];return this};d.math.Vec2.scale=function(g,f,h){g.x=f.x*h;g.y=f.y*h;return g};c.scale=function(b){this.x*=b;this.y*=b;return this};c.equals=function(a){return this.x<a.x+d.math.EPSILON&&this.x>a.x-d.math.EPSILON&&this.y<a.y+d.math.EPSILON&&this.y>a.y-d.math.EPSILON}})(cc);(function(d){d.kmVec3=d.math.Vec3=function(g,f,h){g&&void 0===f?(this.x=g.x,this.y=g.y,this.z=g.z):(this.x=g||0,this.y=f||0,this.z=h||0)};d.math.vec3=function(g,a,f){return new d.math.Vec3(g,a,f)};var c=d.math.Vec3.prototype;c.fill=function(g,f,h){g&&void 0===f?(this.x=g.x,this.y=g.y,this.z=g.z):(this.x=g,this.y=f,this.z=h);return this};c.length=function(){return Math.sqrt(d.math.square(this.x)+d.math.square(this.y)+d.math.square(this.z))};c.lengthSq=function(){return d.math.square(this.x)+d.math.square(this.y)+d.math.square(this.z)};c.normalize=function(){var b=1/this.length();this.x*=b;this.y*=b;this.z*=b;return this};c.cross=function(h){var g=this.x,k=this.y,j=this.z;this.x=k*h.z-j*h.y;this.y=j*h.x-g*h.z;this.z=g*h.y-k*h.x;return this};c.dot=function(b){return this.x*b.x+this.y*b.y+this.z*b.z};c.add=function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z;return this};c.subtract=function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z;return this};c.transform=function(h){var g=this.x,k=this.y,j=this.z;h=h.mat;this.x=g*h[0]+k*h[4]+j*h[8]+h[12];this.y=g*h[1]+k*h[5]+j*h[9]+h[13];this.z=g*h[2]+k*h[6]+j*h[10]+h[14];return this};c.transformNormal=function(h){var g=this.x,k=this.y,j=this.z;h=h.mat;this.x=g*h[0]+k*h[4]+j*h[8];this.y=g*h[1]+k*h[5]+j*h[9];this.z=g*h[2]+k*h[6]+j*h[10];return this};c.transformCoord=function(e){var a=new d.math.Vec4(this.x,this.y,this.z,1);a.transform(e);this.x=a.x/a.w;this.y=a.y/a.w;this.z=a.z/a.w;return this};c.scale=function(b){this.x*=b;this.y*=b;this.z*=b;return this};c.equals=function(e){var a=d.math.EPSILON;return this.x<e.x+a&&this.x>e.x-a&&this.y<e.y+a&&this.y>e.y-a&&this.z<e.z+a&&this.z>e.z-a};c.inverseTransform=function(e){e=e.mat;var a=new d.math.Vec3(this.x-e[12],this.y-e[13],this.z-e[14]);this.x=a.x*e[0]+a.y*e[1]+a.z*e[2];this.y=a.x*e[4]+a.y*e[5]+a.z*e[6];this.z=a.x*e[8]+a.y*e[9]+a.z*e[10];return this};c.inverseTransformNormal=function(h){var g=this.x,k=this.y,j=this.z;h=h.mat;this.x=g*h[0]+k*h[1]+j*h[2];this.y=g*h[4]+k*h[5]+j*h[6];this.z=g*h[8]+k*h[9]+j*h[10];return this};c.assignFrom=function(b){if(!b){return this}this.x=b.x;this.y=b.y;this.z=b.z;return this};d.math.Vec3.zero=function(b){b.x=b.y=b.z=0;return b};c.toTypeArray=function(){var b=new Float32Array(3);b[0]=this.x;b[1]=this.y;b[2]=this.z;return b}})(cc);(function(d){d.math.Vec4=function(h,g,k,j){h&&void 0===g?(this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w):(this.x=h||0,this.y=g||0,this.z=k||0,this.w=j||0)};d.kmVec4=d.math.Vec4;var c=d.math.Vec4.prototype;c.fill=function(h,g,k,j){h&&void 0===g?(this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w):(this.x=h,this.y=g,this.z=k,this.w=j)};c.add=function(b){if(!b){return this}this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this};c.dot=function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w};c.length=function(){return Math.sqrt(d.math.square(this.x)+d.math.square(this.y)+d.math.square(this.z)+d.math.square(this.w))};c.lengthSq=function(){return d.math.square(this.x)+d.math.square(this.y)+d.math.square(this.z)+d.math.square(this.w)};c.lerp=function(f,e){return this};c.normalize=function(){var b=1/this.length();this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this};c.scale=function(b){this.normalize();this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this};c.subtract=function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z;this.w-=b.w};c.transform=function(j){var h=this.x,n=this.y,m=this.z,k=this.w;j=j.mat;this.x=h*j[0]+n*j[4]+m*j[8]+k*j[12];this.y=h*j[1]+n*j[5]+m*j[9]+k*j[13];this.z=h*j[2]+n*j[6]+m*j[10]+k*j[14];this.w=h*j[3]+n*j[7]+m*j[11]+k*j[15];return this};d.math.Vec4.transformArray=function(a,m){for(var k=[],j=0;j<a.length;j++){var h=new d.math.Vec4(a[j]);h.transform(m);k.push(h)}return k};c.equals=function(a){var e=d.math.EPSILON;return this.x<a.x+e&&this.x>a.x-e&&this.y<a.y+e&&this.y>a.y-e&&this.z<a.z+e&&this.z>a.z-e&&this.w<a.w+e&&this.w>a.w-e};c.assignFrom=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this};c.toTypeArray=function(){var b=new Float32Array(4);b[0]=this.x;b[1]=this.y;b[2]=this.z;b[3]=this.w;return b}})(cc);(function(d){function c(a,g,f){g=new d.math.Vec2(g);g.subtract(a);f.x=-g.y;f.y=g.x;f.normalize()}d.math.Ray2=function(a,e){this.start=a||new d.math.Vec2;this.dir=e||new d.math.Vec2};d.math.Ray2.prototype.fill=function(h,g,k,j){this.start.x=h;this.start.y=g;this.dir.x=k;this.dir.y=j};d.math.Ray2.prototype.intersectLineSegment=function(A,z,y){var x=this.start.x,w=this.start.y,v=this.start.x+this.dir.x,u=this.start.y+this.dir.y,t=A.x,o=A.y,j=z.x,B=z.y,a=(B-o)*(v-x)-(j-t)*(u-w);if(a>-d.math.EPSILON&&a<d.math.EPSILON){return !1}o=((j-t)*(w-o)-(B-o)*(x-t))/a;t=x+o*(v-x);o=w+o*(u-w);if(t<Math.min(A.x,z.x)-d.math.EPSILON||t>Math.max(A.x,z.x)+d.math.EPSILON||o<Math.min(A.y,z.y)-d.math.EPSILON||o>Math.max(A.y,z.y)+d.math.EPSILON||t<Math.min(x,v)-d.math.EPSILON||t>Math.max(x,v)+d.math.EPSILON||o<Math.min(w,u)-d.math.EPSILON||o>Math.max(w,u)+d.math.EPSILON){return !1}y.x=t;y.y=o;return !0};d.math.Ray2.prototype.intersectTriangle=function(x,w,v,u,t){var r=new d.math.Vec2,o=new d.math.Vec2,j=new d.math.Vec2,b=10000,a=!1,y;this.intersectLineSegment(x,w,r)&&(a=!0,y=r.subtract(this.start).length(),y<b&&(o.x=r.x,o.y=r.y,b=y,c(x,w,j)));this.intersectLineSegment(w,v,r)&&(a=!0,y=r.subtract(this.start).length(),y<b&&(o.x=r.x,o.y=r.y,b=y,c(w,v,j)));this.intersectLineSegment(v,x,r)&&(a=!0,y=r.subtract(this.start).length(),y<b&&(o.x=r.x,o.y=r.y,c(v,x,j)));a&&(u.x=o.x,u.y=o.y,t&&(t.x=j.x,t.y=j.y));return a}})(cc);var Float32Array=Float32Array||Array;(function(e){e.math.Matrix3=function(b){this.mat=b&&b.mat?new Float32Array(b.mat):new Float32Array(9)};e.kmMat3=e.math.Matrix3;var d=e.math.Matrix3.prototype;d.fill=function(g){var c=this.mat;g=g.mat;c[0]=g[0];c[1]=g[1];c[2]=g[2];c[3]=g[3];c[4]=g[4];c[5]=g[5];c[6]=g[6];c[7]=g[7];c[8]=g[8];return this};d.adjugate=function(){var y=this.mat,x=y[0],w=y[1],v=y[2],u=y[3],t=y[4],r=y[5],o=y[6],j=y[7],z=y[8];y[0]=t*z-r*j;y[1]=v*j-w*z;y[2]=w*r-v*t;y[3]=r*o-u*z;y[4]=x*z-v*o;y[5]=v*u-x*r;y[6]=u*j-t*o;y[8]=x*t-w*u;return this};d.identity=function(){var b=this.mat;b[1]=b[2]=b[3]=b[5]=b[6]=b[7]=0;b[0]=b[4]=b[8]=1;return this};var f=new e.math.Matrix3;d.inverse=function(b){if(0===b){return this}f.assignFrom(this);b=1/b;this.adjugate();this.multiplyScalar(b);return this};d.isIdentity=function(){var b=this.mat;return 1===b[0]&&0===b[1]&&0===b[2]&&0===b[3]&&1===b[4]&&0===b[5]&&0===b[6]&&0===b[7]&&1===b[8]};d.transpose=function(){var m=this.mat,j=m[1],r=m[2],p=m[5],o=m[6],n=m[7];m[1]=m[3];m[2]=o;m[3]=j;m[5]=n;m[6]=r;m[7]=p;return this};d.determinant=function(){var g=this.mat,c=g[0]*g[4]*g[8]+g[1]*g[5]*g[6]+g[2]*g[3]*g[7];return c-=g[2]*g[4]*g[6]+g[0]*g[5]*g[7]+g[1]*g[3]*g[8]};d.multiply=function(R){var Q=this.mat,P=R.mat;R=Q[0];var O=Q[1],N=Q[2],M=Q[3],L=Q[4],K=Q[5],J=Q[6],G=Q[7],H=Q[8],E=P[0],F=P[1],D=P[2],C=P[3],j=P[4],B=P[5],o=P[6],I=P[7],P=P[8];Q[0]=R*E+M*F+J*D;Q[1]=O*E+L*F+G*D;Q[2]=N*E+K*F+H*D;Q[3]=N*E+K*F+H*D;Q[4]=O*C+L*j+G*B;Q[5]=N*C+K*j+H*B;Q[6]=R*o+M*I+J*P;Q[7]=O*o+L*I+G*P;Q[8]=N*o+K*I+H*P;return this};d.multiplyScalar=function(g){var c=this.mat;c[0]*=g;c[1]*=g;c[2]*=g;c[3]*=g;c[4]*=g;c[5]*=g;c[6]*=g;c[7]*=g;c[8]*=g;return this};e.math.Matrix3.rotationAxisAngle=function(a,p){var o=Math.cos(p),n=Math.sin(p),m=new e.math.Matrix3,j=m.mat;j[0]=o+a.x*a.x*(1-o);j[1]=a.z*n+a.y*a.x*(1-o);j[2]=-a.y*n+a.z*a.x*(1-o);j[3]=-a.z*n+a.x*a.y*(1-o);j[4]=o+a.y*a.y*(1-o);j[5]=a.x*n+a.z*a.y*(1-o);j[6]=a.y*n+a.x*a.z*(1-o);j[7]=-a.x*n+a.y*a.z*(1-o);j[8]=o+a.z*a.z*(1-o);return m};d.assignFrom=function(a){if(this===a){return e.log("cc.math.Matrix3.assign(): current matrix equals matIn"),this}var g=this.mat;a=a.mat;g[0]=a[0];g[1]=a[1];g[2]=a[2];g[3]=a[3];g[4]=a[4];g[5]=a[5];g[6]=a[6];g[7]=a[7];g[8]=a[8];return this};d.equals=function(a){if(this===a){return !0}var k=e.math.EPSILON,j=this.mat;a=a.mat;for(var h=0;9>h;++h){if(!(j[h]+k>a[h]&&j[h]-k<a[h])){return !1}}return !0};e.math.Matrix3.createByRotationX=function(a){var h=new e.math.Matrix3,g=h.mat;g[0]=1;g[1]=0;g[2]=0;g[3]=0;g[4]=Math.cos(a);g[5]=Math.sin(a);g[6]=0;g[7]=-Math.sin(a);g[8]=Math.cos(a);return h};e.math.Matrix3.createByRotationY=function(a){var h=new e.math.Matrix3,g=h.mat;g[0]=Math.cos(a);g[1]=0;g[2]=-Math.sin(a);g[3]=0;g[4]=1;g[5]=0;g[6]=Math.sin(a);g[7]=0;g[8]=Math.cos(a);return h};e.math.Matrix3.createByRotationZ=function(a){var h=new e.math.Matrix3,g=h.mat;g[0]=Math.cos(a);g[1]=-Math.sin(a);g[2]=0;g[3]=Math.sin(a);g[4]=Math.cos(a);g[5]=0;g[6]=0;g[7]=0;g[8]=1;return h};e.math.Matrix3.createByRotation=function(a){var h=new e.math.Matrix3,g=h.mat;g[0]=Math.cos(a);g[1]=Math.sin(a);g[2]=0;g[3]=-Math.sin(a);g[4]=Math.cos(a);g[5]=0;g[6]=0;g[7]=0;g[8]=1;return h};e.math.Matrix3.createByScale=function(a,h){var g=new e.math.Matrix3;g.identity();g.mat[0]=a;g.mat[4]=h;return g};e.math.Matrix3.createByTranslation=function(a,h){var g=new e.math.Matrix3;g.identity();g.mat[6]=a;g.mat[7]=h;return g};e.math.Matrix3.createByQuaternion=function(a){if(!a){return null}var h=new e.math.Matrix3,g=h.mat;g[0]=1-2*(a.y*a.y+a.z*a.z);g[1]=2*(a.x*a.y-a.w*a.z);g[2]=2*(a.x*a.z+a.w*a.y);g[3]=2*(a.x*a.y+a.w*a.z);g[4]=1-2*(a.x*a.x+a.z*a.z);g[5]=2*(a.y*a.z-a.w*a.x);g[6]=2*(a.x*a.z-a.w*a.y);g[7]=2*(a.y*a.z+a.w*a.x);g[8]=1-2*(a.x*a.x+a.y*a.y);return h};d.rotationToAxisAngle=function(){return e.math.Quaternion.rotationMatrix(this).toAxisAndAngle()}})(cc);(function(f){f.math.Matrix4=function(b){this.mat=b&&b.mat?new Float32Array(b.mat):new Float32Array(16)};f.kmMat4=f.math.Matrix4;var e=f.math.Matrix4.prototype;e.fill=function(j){for(var d=this.mat,k=0;16>k;k++){d[k]=j[k]}return this};f.kmMat4Identity=function(d){var c=d.mat;c[1]=c[2]=c[3]=c[4]=c[6]=c[7]=c[8]=c[9]=c[11]=c[12]=c[13]=c[14]=0;c[0]=c[5]=c[10]=c[15]=1;return d};e.identity=function(){var b=this.mat;b[1]=b[2]=b[3]=b[4]=b[6]=b[7]=b[8]=b[9]=b[11]=b[12]=b[13]=b[14]=0;b[0]=b[5]=b[10]=b[15]=1;return this};e.get=function(d,c){return this.mat[d+4*c]};e.set=function(j,d,k){this.mat[j+4*d]=k};e.swap=function(o,n,s,r){var p=this.mat,j=p[o+4*n];p[o+4*n]=p[s+4*r];p[s+4*r]=j};f.math.Matrix4._gaussj=function(B,A){var z,y=0,x=0,w,v,o,E,j=[0,0,0,0],C=[0,0,0,0],D=[0,0,0,0];for(z=0;4>z;z++){for(w=E=0;4>w;w++){if(1!==D[w]){for(v=0;4>v;v++){0===D[v]&&(o=Math.abs(B.get(w,v)),o>=E&&(E=o,x=w,y=v))}}}++D[y];if(x!==y){for(w=0;4>w;w++){B.swap(x,w,y,w)}for(w=0;4>w;w++){A.swap(x,w,y,w)}}C[z]=x;j[z]=y;if(0===B.get(y,y)){return !1}v=1/B.get(y,y);B.set(y,y,1);for(w=0;4>w;w++){B.set(y,w,B.get(y,w)*v)}for(w=0;4>w;w++){A.set(y,w,A.get(y,w)*v)}for(v=0;4>v;v++){if(v!==y){o=B.get(v,y);B.set(v,y,0);for(w=0;4>w;w++){B.set(v,w,B.get(v,w)-B.get(y,w)*o)}for(w=0;4>w;w++){A.set(v,w,B.get(v,w)-A.get(y,w)*o)}}}}for(w=3;0<=w;w--){if(C[w]!==j[w]){for(v=0;4>v;v++){B.swap(v,C[w],v,j[w])}}}return !0};var h=(new f.math.Matrix4).identity();f.kmMat4Inverse=function(a,j){var c=new f.math.Matrix4(j);if(!1===f.math.Matrix4._gaussj(c,h)){return null}a.assignFrom(c);return a};e.inverse=function(){var a=new f.math.Matrix4(this);return !1===f.math.Matrix4._gaussj(a,h)?null:a};e.isIdentity=function(){var b=this.mat;return 1===b[0]&&0===b[1]&&0===b[2]&&0===b[3]&&0===b[4]&&1===b[5]&&0===b[6]&&0===b[7]&&0===b[8]&&0===b[9]&&1===b[10]&&0===b[11]&&0===b[12]&&0===b[13]&&0===b[14]&&1===b[15]};e.transpose=function(){var B=this.mat,A=B[1],z=B[2],y=B[3],x=B[6],w=B[7],v=B[8],o=B[9],E=B[11],j=B[12],C=B[13],D=B[14];B[1]=B[4];B[2]=v;B[3]=j;B[4]=A;B[6]=o;B[7]=C;B[8]=z;B[9]=x;B[11]=D;B[12]=y;B[13]=w;B[14]=E;return this};f.kmMat4Multiply=function(ax,aw,av){var au=ax.mat,at=aw.mat,ar=av.mat;av=at[0];aw=at[1];var aq=at[2],ap=at[3],ak=at[4],am=at[5],ag=at[6],ai=at[7],ae=at[8],ac=at[9],W=at[10],aa=at[11],Y=at[12],ao=at[13],an=at[14],at=at[15],al=ar[0],aj=ar[1],ah=ar[2],af=ar[3],ad=ar[4],ab=ar[5],Z=ar[6],X=ar[7],V=ar[8],U=ar[9],T=ar[10],S=ar[11],R=ar[12],o=ar[13],j=ar[14],ar=ar[15];au[0]=al*av+aj*ak+ah*ae+af*Y;au[1]=al*aw+aj*am+ah*ac+af*ao;au[2]=al*aq+aj*ag+ah*W+af*an;au[3]=al*ap+aj*ai+ah*aa+af*at;au[4]=ad*av+ab*ak+Z*ae+X*Y;au[5]=ad*aw+ab*am+Z*ac+X*ao;au[6]=ad*aq+ab*ag+Z*W+X*an;au[7]=ad*ap+ab*ai+Z*aa+X*at;au[8]=V*av+U*ak+T*ae+S*Y;au[9]=V*aw+U*am+T*ac+S*ao;au[10]=V*aq+U*ag+T*W+S*an;au[11]=V*ap+U*ai+T*aa+S*at;au[12]=R*av+o*ak+j*ae+ar*Y;au[13]=R*aw+o*am+j*ac+ar*ao;au[14]=R*aq+o*ag+j*W+ar*an;au[15]=R*ap+o*ai+j*aa+ar*at;return ax};e.multiply=function(av){var au=this.mat,at=av.mat;av=au[0];var ar=au[1],aq=au[2],ap=au[3],ao=au[4],an=au[5],ai=au[6],ak=au[7],ae=au[8],ag=au[9],ac=au[10],aa=au[11],U=au[12],Y=au[13],W=au[14],am=au[15],al=at[0],aj=at[1],ah=at[2],af=at[3],ad=at[4],ab=at[5],Z=at[6],X=at[7],V=at[8],T=at[9],S=at[10],R=at[11],Q=at[12],o=at[13],j=at[14],at=at[15];au[0]=al*av+aj*ao+ah*ae+af*U;au[1]=al*ar+aj*an+ah*ag+af*Y;au[2]=al*aq+aj*ai+ah*ac+af*W;au[3]=al*ap+aj*ak+ah*aa+af*am;au[4]=ad*av+ab*ao+Z*ae+X*U;au[5]=ad*ar+ab*an+Z*ag+X*Y;au[6]=ad*aq+ab*ai+Z*ac+X*W;au[7]=ad*ap+ab*ak+Z*aa+X*am;au[8]=V*av+T*ao+S*ae+R*U;au[9]=V*ar+T*an+S*ag+R*Y;au[10]=V*aq+T*ai+S*ac+R*W;au[11]=V*ap+T*ak+S*aa+R*am;au[12]=Q*av+o*ao+j*ae+at*U;au[13]=Q*ar+o*an+j*ag+at*Y;au[14]=Q*aq+o*ai+j*ac+at*W;au[15]=Q*ap+o*ak+j*aa+at*am;return this};f.getMat4MultiplyValue=function(m,j){var p=m.mat,o=j.mat,n=new Float32Array(16);n[0]=p[0]*o[0]+p[4]*o[1]+p[8]*o[2]+p[12]*o[3];n[1]=p[1]*o[0]+p[5]*o[1]+p[9]*o[2]+p[13]*o[3];n[2]=p[2]*o[0]+p[6]*o[1]+p[10]*o[2]+p[14]*o[3];n[3]=p[3]*o[0]+p[7]*o[1]+p[11]*o[2]+p[15]*o[3];n[4]=p[0]*o[4]+p[4]*o[5]+p[8]*o[6]+p[12]*o[7];n[5]=p[1]*o[4]+p[5]*o[5]+p[9]*o[6]+p[13]*o[7];n[6]=p[2]*o[4]+p[6]*o[5]+p[10]*o[6]+p[14]*o[7];n[7]=p[3]*o[4]+p[7]*o[5]+p[11]*o[6]+p[15]*o[7];n[8]=p[0]*o[8]+p[4]*o[9]+p[8]*o[10]+p[12]*o[11];n[9]=p[1]*o[8]+p[5]*o[9]+p[9]*o[10]+p[13]*o[11];n[10]=p[2]*o[8]+p[6]*o[9]+p[10]*o[10]+p[14]*o[11];n[11]=p[3]*o[8]+p[7]*o[9]+p[11]*o[10]+p[15]*o[11];n[12]=p[0]*o[12]+p[4]*o[13]+p[8]*o[14]+p[12]*o[15];n[13]=p[1]*o[12]+p[5]*o[13]+p[9]*o[14]+p[13]*o[15];n[14]=p[2]*o[12]+p[6]*o[13]+p[10]*o[14]+p[14]*o[15];n[15]=p[3]*o[12]+p[7]*o[13]+p[11]*o[14]+p[15]*o[15];return n};f.kmMat4Assign=function(a,m){if(a===m){return f.log("cc.kmMat4Assign(): pOut equals pIn"),a}var k=a.mat,j=m.mat;k[0]=j[0];k[1]=j[1];k[2]=j[2];k[3]=j[3];k[4]=j[4];k[5]=j[5];k[6]=j[6];k[7]=j[7];k[8]=j[8];k[9]=j[9];k[10]=j[10];k[11]=j[11];k[12]=j[12];k[13]=j[13];k[14]=j[14];k[15]=j[15];return a};e.assignFrom=function(a){if(this===a){return f.log("cc.mat.Matrix4.assignFrom(): mat4 equals current matrix"),this}var d=this.mat;a=a.mat;d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return this};e.equals=function(a){if(this===a){return f.log("cc.kmMat4AreEqual(): pMat1 and pMat2 are same object."),!0}var m=this.mat;a=a.mat;for(var k=f.math.EPSILON,j=0;16>j;j++){if(!(m[j]+k>a[j]&&m[j]-k<a[j])){return !1}}return !0};f.math.Matrix4.createByRotationX=function(a,k){k=k||new f.math.Matrix4;var j=k.mat;j[0]=1;j[3]=j[2]=j[1]=0;j[4]=0;j[5]=Math.cos(a);j[6]=Math.sin(a);j[7]=0;j[8]=0;j[9]=-Math.sin(a);j[10]=Math.cos(a);j[11]=0;j[14]=j[13]=j[12]=0;j[15]=1;return k};f.math.Matrix4.createByRotationY=function(a,k){k=k||new f.math.Matrix4;var j=k.mat;j[0]=Math.cos(a);j[1]=0;j[2]=-Math.sin(a);j[3]=0;j[7]=j[6]=j[4]=0;j[5]=1;j[8]=Math.sin(a);j[9]=0;j[10]=Math.cos(a);j[11]=0;j[14]=j[13]=j[12]=0;j[15]=1;return k};f.math.Matrix4.createByRotationZ=function(a,k){k=k||new f.math.Matrix4;var j=k.mat;j[0]=Math.cos(a);j[1]=Math.sin(a);j[3]=j[2]=0;j[4]=-Math.sin(a);j[5]=Math.cos(a);j[7]=j[6]=0;j[11]=j[9]=j[8]=0;j[10]=1;j[14]=j[13]=j[12]=0;j[15]=1;return k};f.math.Matrix4.createByPitchYawRoll=function(y,x,w,v){v=v||new f.math.Matrix4;var u=Math.cos(y);y=Math.sin(y);var t=Math.cos(x);x=Math.sin(x);var o=Math.cos(w);w=Math.sin(w);var j=y*x,z=u*x,a=v.mat;a[0]=t*o;a[4]=t*w;a[8]=-x;a[1]=j*o-u*w;a[5]=j*w+u*o;a[9]=y*t;a[2]=z*o+y*w;a[6]=z*w-y*o;a[10]=u*t;a[3]=a[7]=a[11]=0;a[15]=1;return v};f.math.Matrix4.createByQuaternion=function(a,k){k=k||new f.math.Matrix4;var j=k.mat;j[0]=1-2*(a.y*a.y+a.z*a.z);j[1]=2*(a.x*a.y+a.z*a.w);j[2]=2*(a.x*a.z-a.y*a.w);j[3]=0;j[4]=2*(a.x*a.y-a.z*a.w);j[5]=1-2*(a.x*a.x+a.z*a.z);j[6]=2*(a.z*a.y+a.x*a.w);j[7]=0;j[8]=2*(a.x*a.z+a.y*a.w);j[9]=2*(a.y*a.z-a.x*a.w);j[10]=1-2*(a.x*a.x+a.y*a.y);j[11]=0;j[14]=j[13]=j[12]=0;j[15]=1;return k};f.math.Matrix4.createByRotationTranslation=function(a,m,k){k=k||new f.math.Matrix4;var j=k.mat;a=a.mat;j[0]=a[0];j[1]=a[1];j[2]=a[2];j[3]=0;j[4]=a[3];j[5]=a[4];j[6]=a[5];j[7]=0;j[8]=a[6];j[9]=a[7];j[10]=a[8];j[11]=0;j[12]=m.x;j[13]=m.y;j[14]=m.z;j[15]=1;return k};f.math.Matrix4.createByScale=function(a,o,n,m){m=m||new f.math.Matrix4;var j=m.mat;j[0]=a;j[5]=o;j[10]=n;j[15]=1;j[1]=j[2]=j[3]=j[4]=j[6]=j[7]=j[8]=j[9]=j[11]=j[12]=j[13]=j[14]=0;return m};f.kmMat4Translation=function(k,j,n,m){k.mat[0]=k.mat[5]=k.mat[10]=k.mat[15]=1;k.mat[1]=k.mat[2]=k.mat[3]=k.mat[4]=k.mat[6]=k.mat[7]=k.mat[8]=k.mat[9]=k.mat[11]=0;k.mat[12]=j;k.mat[13]=n;k.mat[14]=m;return k};f.math.Matrix4.createByTranslation=function(a,m,k,j){j=j||new f.math.Matrix4;j.identity();j.mat[12]=a;j.mat[13]=m;j.mat[14]=k;return j};e.getUpVec3=function(){var a=this.mat;return(new f.math.Vec3(a[4],a[5],a[6])).normalize()};e.getRightVec3=function(){var a=this.mat;return(new f.math.Vec3(a[0],a[1],a[2])).normalize()};e.getForwardVec3=function(){var a=this.mat;return(new f.math.Vec3(a[8],a[9],a[10])).normalize()};f.kmMat4PerspectiveProjection=function(j,t,r,p,o){var a=f.degreesToRadians(t/2);t=o-p;var s=Math.sin(a);if(0===t||0===s||0===r){return null}a=Math.cos(a)/s;j.identity();j.mat[0]=a/r;j.mat[5]=a;j.mat[10]=-(o+p)/t;j.mat[11]=-1;j.mat[14]=-2*p*o/t;j.mat[15]=0;return j};f.math.Matrix4.createPerspectiveProjection=function(j,t,r,p){var o=f.degreesToRadians(j/2);j=p-r;var a=Math.sin(o);if(0===j||0===a||0===t){return null}var o=Math.cos(o)/a,a=new f.math.Matrix4,s=a.mat;a.identity();s[0]=o/t;s[5]=o;s[10]=-(p+r)/j;s[11]=-1;s[14]=-2*r*p/j;s[15]=0;return a};f.kmMat4OrthographicProjection=function(p,o,u,s,r,j,t){p.identity();p.mat[0]=2/(u-o);p.mat[5]=2/(r-s);p.mat[10]=-2/(t-j);p.mat[12]=-((u+o)/(u-o));p.mat[13]=-((r+s)/(r-s));p.mat[14]=-((t+j)/(t-j));return p};f.math.Matrix4.createOrthographicProjection=function(j,v,t,r,o,a){var u=new f.math.Matrix4,s=u.mat;u.identity();s[0]=2/(v-j);s[5]=2/(r-t);s[10]=-2/(a-o);s[12]=-((v+j)/(v-j));s[13]=-((r+t)/(r-t));s[14]=-((a+o)/(a-o));return u};f.kmMat4LookAt=function(a,o,n,m){n=new f.math.Vec3(n);var j=new f.math.Vec3(m);n.subtract(o);n.normalize();j.normalize();m=new f.math.Vec3(n);m.cross(j);m.normalize();j=new f.math.Vec3(m);j.cross(n);m.normalize();a.identity();a.mat[0]=m.x;a.mat[4]=m.y;a.mat[8]=m.z;a.mat[1]=j.x;a.mat[5]=j.y;a.mat[9]=j.z;a.mat[2]=-n.x;a.mat[6]=-n.y;a.mat[10]=-n.z;o=f.math.Matrix4.createByTranslation(-o.x,-o.y,-o.z);a.multiply(o);return a};var g=new f.math.Matrix4;e.lookAt=function(a,n,m){n=new f.math.Vec3(n);var j=new f.math.Vec3(m);m=this.mat;n.subtract(a);n.normalize();j.normalize();var d=new f.math.Vec3(n);d.cross(j);d.normalize();j=new f.math.Vec3(d);j.cross(n);d.normalize();this.identity();m[0]=d.x;m[4]=d.y;m[8]=d.z;m[1]=j.x;m[5]=j.y;m[9]=j.z;m[2]=-n.x;m[6]=-n.y;m[10]=-n.z;g=f.math.Matrix4.createByTranslation(-a.x,-a.y,-a.z,g);this.multiply(g);return this};f.kmMat4RotationAxisAngle=function(a,m,k){var j=Math.cos(k);k=Math.sin(k);m=new f.math.Vec3(m);m.normalize();a.mat[0]=j+m.x*m.x*(1-j);a.mat[1]=m.z*k+m.y*m.x*(1-j);a.mat[2]=-m.y*k+m.z*m.x*(1-j);a.mat[3]=0;a.mat[4]=-m.z*k+m.x*m.y*(1-j);a.mat[5]=j+m.y*m.y*(1-j);a.mat[6]=m.x*k+m.z*m.y*(1-j);a.mat[7]=0;a.mat[8]=m.y*k+m.x*m.z*(1-j);a.mat[9]=-m.x*k+m.y*m.z*(1-j);a.mat[10]=j+m.z*m.z*(1-j);a.mat[11]=0;a.mat[12]=0;a.mat[13]=0;a.mat[14]=0;a.mat[15]=1;return a};f.math.Matrix4.createByAxisAndAngle=function(a,o,n){n=n||new f.math.Matrix4;var m=this.mat,j=Math.cos(o);o=Math.sin(o);a=new f.math.Vec3(a);a.normalize();m[0]=j+a.x*a.x*(1-j);m[1]=a.z*o+a.y*a.x*(1-j);m[2]=-a.y*o+a.z*a.x*(1-j);m[3]=0;m[4]=-a.z*o+a.x*a.y*(1-j);m[5]=j+a.y*a.y*(1-j);m[6]=a.x*o+a.z*a.y*(1-j);m[7]=0;m[8]=a.y*o+a.x*a.z*(1-j);m[9]=-a.x*o+a.y*a.z*(1-j);m[10]=j+a.z*a.z*(1-j);m[11]=0;m[12]=m[13]=m[14]=0;m[15]=1;return n};e.extractRotation=function(){var a=new f.math.Matrix3,k=this.mat,j=a.mat;j[0]=k[0];j[1]=k[1];j[2]=k[2];j[3]=k[4];j[4]=k[5];j[5]=k[6];j[6]=k[8];j[7]=k[9];j[8]=k[10];return a};e.extractPlane=function(a){var k=new f.math.Plane,j=this.mat;switch(a){case f.math.Plane.RIGHT:k.a=j[3]-j[0];k.b=j[7]-j[4];k.c=j[11]-j[8];k.d=j[15]-j[12];break;case f.math.Plane.LEFT:k.a=j[3]+j[0];k.b=j[7]+j[4];k.c=j[11]+j[8];k.d=j[15]+j[12];break;case f.math.Plane.BOTTOM:k.a=j[3]+j[1];k.b=j[7]+j[5];k.c=j[11]+j[9];k.d=j[15]+j[13];break;case f.math.Plane.TOP:k.a=j[3]-j[1];k.b=j[7]-j[5];k.c=j[11]-j[9];k.d=j[15]-j[13];break;case f.math.Plane.FAR:k.a=j[3]-j[2];k.b=j[7]-j[6];k.c=j[11]-j[10];k.d=j[15]-j[14];break;case f.math.Plane.NEAR:k.a=j[3]+j[2];k.b=j[7]+j[6];k.c=j[11]+j[10];k.d=j[15]+j[14];break;default:f.log("cc.math.Matrix4.extractPlane: Invalid plane index")}a=Math.sqrt(k.a*k.a+k.b*k.b+k.c*k.c);k.a/=a;k.b/=a;k.c/=a;k.d/=a;return k};e.toAxisAndAngle=function(){var a=this.extractRotation();return f.math.Quaternion.rotationMatrix(a).toAxisAndAngle()}})(cc);(function(d){d.math.Plane=function(h,g,k,j){h&&void 0===g?(this.a=h.a,this.b=h.b,this.c=h.c,this.d=h.d):(this.a=h||0,this.b=g||0,this.c=k||0,this.d=j||0)};d.kmPlane=d.math.Plane;var c=d.math.Plane.prototype;d.math.Plane.LEFT=0;d.math.Plane.RIGHT=1;d.math.Plane.BOTTOM=2;d.math.Plane.TOP=3;d.math.Plane.NEAR=4;d.math.Plane.FAR=5;d.math.Plane.POINT_INFRONT_OF_PLANE=0;d.math.Plane.POINT_BEHIND_PLANE=1;d.math.Plane.POINT_ON_PLANE=2;c.dot=function(b){return this.a*b.x+this.b*b.y+this.c*b.z+this.d*b.w};c.dotCoord=function(b){return this.a*b.x+this.b*b.y+this.c*b.z+this.d};c.dotNormal=function(b){return this.a*b.x+this.b*b.y+this.c*b.z};d.math.Plane.fromPointNormal=function(a,e){return new d.math.Plane(e.x,e.y,e.z,-e.dot(a))};d.math.Plane.fromPoints=function(a,j,h){j=new d.math.Vec3(j);h=new d.math.Vec3(h);var g=new d.math.Plane;j.subtract(a);h.subtract(a);j.cross(h);j.normalize();g.a=j.x;g.b=j.y;g.c=j.z;g.d=j.scale(-1).dot(a);return g};c.normalize=function(){var a=new d.math.Vec3(this.a,this.b,this.c),e=1/a.length();a.normalize();this.a=a.x;this.b=a.y;this.c=a.z;this.d*=e;return this};c.classifyPoint=function(a){a=this.a*a.x+this.b*a.y+this.c*a.z+this.d;return 0.001<a?d.math.Plane.POINT_INFRONT_OF_PLANE:-0.001>a?d.math.Plane.POINT_BEHIND_PLANE:d.math.Plane.POINT_ON_PLANE}})(cc);(function(d){d.math.Quaternion=function(h,g,k,j){h&&void 0===g?(this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w):(this.x=h||0,this.y=g||0,this.z=k||0,this.w=j||0)};d.kmQuaternion=d.math.Quaternion;var c=d.math.Quaternion.prototype;c.conjugate=function(b){this.x=-b.x;this.y=-b.y;this.z=-b.z;this.w=b.w;return this};c.dot=function(b){return this.w*b.w+this.x*b.x+this.y*b.y+this.z*b.z};c.exponential=function(){return this};c.identity=function(){this.z=this.y=this.x=0;this.w=1;return this};c.inverse=function(){var a=this.length();if(Math.abs(a)>d.math.EPSILON){return this.w=this.z=this.y=this.x=0,this}this.conjugate(this).scale(1/a);return this};c.isIdentity=function(){return 0===this.x&&0===this.y&&0===this.z&&1===this.w};c.length=function(){return Math.sqrt(this.lengthSq())};c.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w};c.multiply=function(j){var h=this.x,n=this.y,m=this.z,k=this.w;this.w=k*j.w-h*j.x-n*j.y-m*j.z;this.x=k*j.x+h*j.w+n*j.z-m*j.y;this.y=k*j.y+n*j.w+m*j.x-h*j.z;this.z=k*j.z+m*j.w+h*j.y-n*j.x;return this};c.normalize=function(){var a=this.length();if(Math.abs(a)<=d.math.EPSILON){throw"current quaternion is an invalid value"}this.scale(1/a);return this};c.rotationAxis=function(h,g){var k=0.5*g,j=Math.sin(k);this.w=Math.cos(k);this.x=h.x*j;this.y=h.y*j;this.z=h.z*j;return this};d.math.Quaternion.rotationMatrix=function(a){if(!a){return null}var m,k,j;m=[];k=a.mat;a=0;m[0]=k[0];m[1]=k[3];m[2]=k[6];m[4]=k[1];m[5]=k[4];m[6]=k[7];m[8]=k[2];m[9]=k[5];m[10]=k[8];m[15]=1;var h=m[0];a=h[0]+h[5]+h[10]+1;a>d.math.EPSILON?(a=2*Math.sqrt(a),m=(h[9]-h[6])/a,k=(h[2]-h[8])/a,j=(h[4]-h[1])/a,a*=0.25):h[0]>h[5]&&h[0]>h[10]?(a=2*Math.sqrt(1+h[0]-h[5]-h[10]),m=0.25*a,k=(h[4]+h[1])/a,j=(h[2]+h[8])/a,a=(h[9]-h[6])/a):h[5]>h[10]?(a=2*Math.sqrt(1+h[5]-h[0]-h[10]),m=(h[4]+h[1])/a,k=0.25*a,j=(h[9]+h[6])/a,a=(h[2]-h[8])/a):(a=2*Math.sqrt(1+h[10]-h[0]-h[5]),m=(h[2]+h[8])/a,k=(h[9]+h[6])/a,j=0.25*a,a=(h[4]-h[1])/a);return new d.math.Quaternion(m,k,j,a)};d.math.Quaternion.rotationYawPitchRoll=function(v,u,t){var s,r,p,o,j;s=d.degreesToRadians(u)/2;r=d.degreesToRadians(v)/2;p=d.degreesToRadians(t)/2;t=Math.cos(s);v=Math.cos(r);u=Math.cos(p);s=Math.sin(s);r=Math.sin(r);p=Math.sin(p);o=v*u;j=r*p;var a=new d.math.Quaternion;a.w=t*o+s*j;a.x=s*o-t*j;a.y=t*r*u+s*v*p;a.z=t*v*p-s*r*u;a.normalize();return a};c.slerp=function(a,m){if(this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w){return this}var k=this.dot(a),j=Math.acos(k),h=Math.sqrt(1-d.math.square(k)),k=Math.sin(m*j)/h,j=Math.sin((1-m)*j)/h,h=new d.math.Quaternion(a);this.scale(j);h.scale(k);this.add(h);return this};c.toAxisAndAngle=function(){var a,g,f=new d.math.Vec3;a=Math.acos(this.w);g=Math.sqrt(d.math.square(this.x)+d.math.square(this.y)+d.math.square(this.z));g>-d.math.EPSILON&&g<d.math.EPSILON||g<2*Math.PI+d.math.EPSILON&&g>2*Math.PI-d.math.EPSILON?(a=0,f.x=0,f.y=0,f.z=1):(a*=2,f.x=this.x/g,f.y=this.y/g,f.z=this.z/g,f.normalize());return{axis:f,angle:a}};c.scale=function(b){this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this};c.assignFrom=function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this};c.add=function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this};d.math.Quaternion.rotationBetweenVec3=function(a,o,n){var m=new d.math.Vec3(a),k=new d.math.Vec3(o);m.normalize();k.normalize();var j=m.dot(k);o=new d.math.Quaternion;if(1<=j){return o.identity(),o}-0.999999>j?Math.abs(n.lengthSq())<d.math.EPSILON?o.rotationAxis(n,Math.PI):(m=new d.math.Vec3(1,0,0),m.cross(a),Math.abs(m.lengthSq())<d.math.EPSILON&&(m.fill(0,1,0),m.cross(a)),m.normalize(),o.rotationAxis(m,Math.PI)):(a=Math.sqrt(2*(1+j)),n=1/a,m.cross(k),o.x=m.x*n,o.y=m.y*n,o.z=m.z*n,o.w=0.5*a,o.normalize());return o};c.multiplyVec3=function(a){var o=this.x,n=this.y,m=this.z,k=new d.math.Vec3(a),j=new d.math.Vec3(o,n,m),o=new d.math.Vec3(o,n,m);j.cross(a);o.cross(j);j.scale(2*q.w);o.scale(2);k.add(j);k.add(o);return k}})(cc);cc.math.AABB=function(d,c){this.min=d||new cc.math.Vec3;this.max=c||new cc.math.Vec3};cc.math.AABB.prototype.containsPoint=function(b){return b.x>=this.min.x&&b.x<=this.max.x&&b.y>=this.min.y&&b.y<=this.max.y&&b.z>=this.min.z&&b.z<=this.max.z};cc.math.AABB.containsPoint=function(d,c){return d.x>=c.min.x&&d.x<=c.max.x&&d.y>=c.min.y&&d.y<=c.max.y&&d.z>=c.min.z&&d.z<=c.max.z};cc.math.AABB.prototype.assignFrom=function(b){this.min.assignFrom(b.min);this.max.assignFrom(b.max)};cc.math.AABB.assign=function(d,c){d.min.assignFrom(c.min);d.max.assignFrom(c.max);return d};(function(d){d.math.Matrix4Stack=function(f,e){this.top=f;this.stack=e||[]};d.km_mat4_stack=d.math.Matrix4Stack;var c=d.math.Matrix4Stack.prototype;c.initialize=function(){this.stack.length=0;this.top=null};d.km_mat4_stack_push=function(a,e){a.stack.push(a.top);a.top=new d.math.Matrix4(e)};d.km_mat4_stack_pop=function(f,e){f.top=f.stack.pop()};d.km_mat4_stack_release=function(b){b.stack=null;b.top=null};c.push=function(a){a=a||this.top;this.stack.push(this.top);this.top=new d.math.Matrix4(a)};c.pop=function(){this.top=this.stack.pop()};c.release=function(){this._matrixPool=this.top=this.stack=null};c._getFromPool=function(a){var e=this._matrixPool;if(0===e.length){return new d.math.Matrix4(a)}e=e.pop();e.assignFrom(a);return e};c._putInPool=function(b){this._matrixPool.push(b)}})(cc);(function(e){e.KM_GL_MODELVIEW=5888;e.KM_GL_PROJECTION=5889;e.KM_GL_TEXTURE=5890;e.modelview_matrix_stack=new e.math.Matrix4Stack;e.projection_matrix_stack=new e.math.Matrix4Stack;e.texture_matrix_stack=new e.math.Matrix4Stack;e.current_stack=null;e.lazyInitialize=function(){var a=new e.math.Matrix4;e.modelview_matrix_stack.initialize();e.projection_matrix_stack.initialize();e.texture_matrix_stack.initialize();e.current_stack=e.modelview_matrix_stack;e.initialized=!0;a.identity();e.modelview_matrix_stack.push(a);e.projection_matrix_stack.push(a);e.texture_matrix_stack.push(a)};e.lazyInitialize();e.kmGLFreeAll=function(){e.modelview_matrix_stack.release();e.modelview_matrix_stack=null;e.projection_matrix_stack.release();e.projection_matrix_stack=null;e.texture_matrix_stack.release();e.texture_matrix_stack=null;e.initialized=!1;e.current_stack=null};e.kmGLPushMatrix=function(){e.current_stack.push(e.current_stack.top)};e.kmGLPushMatrixWitMat4=function(a){e.current_stack.stack.push(e.current_stack.top);a.assignFrom(e.current_stack.top);e.current_stack.top=a};e.kmGLPopMatrix=function(){e.current_stack.top=e.current_stack.stack.pop()};e.kmGLMatrixMode=function(a){switch(a){case e.KM_GL_MODELVIEW:e.current_stack=e.modelview_matrix_stack;break;case e.KM_GL_PROJECTION:e.current_stack=e.projection_matrix_stack;break;case e.KM_GL_TEXTURE:e.current_stack=e.texture_matrix_stack;break;default:throw"Invalid matrix mode specified"}};e.kmGLLoadIdentity=function(){e.current_stack.top.identity()};e.kmGLLoadMatrix=function(a){e.current_stack.top.assignFrom(a)};e.kmGLMultMatrix=function(a){e.current_stack.top.multiply(a)};var d=new e.math.Matrix4;e.kmGLTranslatef=function(g,b,a){g=e.math.Matrix4.createByTranslation(g,b,a,d);e.current_stack.top.multiply(g)};var f=new e.math.Vec3;e.kmGLRotatef=function(h,c,b,a){f.fill(c,b,a);h=e.math.Matrix4.createByAxisAndAngle(f,e.degreesToRadians(h),d);e.current_stack.top.multiply(h)};e.kmGLScalef=function(g,b,a){g=e.math.Matrix4.createByScale(g,b,a,d);e.current_stack.top.multiply(g)};e.kmGLGetMatrix=function(a,g){switch(a){case e.KM_GL_MODELVIEW:g.assignFrom(e.modelview_matrix_stack.top);break;case e.KM_GL_PROJECTION:g.assignFrom(e.projection_matrix_stack.top);break;case e.KM_GL_TEXTURE:g.assignFrom(e.texture_matrix_stack.top);break;default:throw"Invalid matrix mode specified"}}})(cc);cc.SHADER_POSITION_UCOLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor \x3d v_fragmentColor;      \n}\n";cc.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform    vec4 u_color;\nuniform float u_pointSize;\nvarying lowp vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    gl_PointSize \x3d u_pointSize;          \n    v_fragmentColor \x3d u_color;           \n}";cc.SHADER_POSITION_COLOR_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor \x3d v_fragmentColor; \n} ";cc.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying lowp vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color;             \n}";cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying mediump vec4 v_color;\nvarying mediump vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor \x3d v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor \x3d v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}";cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute mediump vec4 a_position; \nattribute mediump vec2 a_texcoord; \nattribute mediump vec4 a_color;\t\nvarying mediump vec4 v_color; \nvarying mediump vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color \x3d a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord \x3d a_texcoord; \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n}";cc.SHADER_POSITION_TEXTURE_FRAG="precision lowp float;   \nvarying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord);   \n}";cc.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord \x3d a_texCoord;               \n}";cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="precision lowp float;  \nuniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}";cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_texCoord \x3d a_texCoord;                 \n}";cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="precision lowp float;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}";cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}";cc.SHADER_POSITION_TEXTURE_COLOR_FRAG="precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}";cc.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d (CC_PMatrix * CC_MVMatrix) * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}";cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="precision lowp float;   \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor \x3d texture2D(CC_Texture0, v_texCoord);  \n    if ( texColor.a \x3c\x3d CC_alpha_value )          \n        discard; \n    gl_FragColor \x3d texColor * v_fragmentColor;  \n}";cc.SHADEREX_SWITCHMASK_FRAG="precision lowp float; \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   \x3d texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  \x3d texture2D(u_mask, v_texCoord); \n    vec4 finalColor \x3d vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    \x3d v_fragmentColor * finalColor; \n}";cc.shaderCache={TYPE_POSITION_TEXTURECOLOR:0,TYPE_POSITION_TEXTURECOLOR_ALPHATEST:1,TYPE_POSITION_COLOR:2,TYPE_POSITION_TEXTURE:3,TYPE_POSITION_TEXTURE_UCOLOR:4,TYPE_POSITION_TEXTURE_A8COLOR:5,TYPE_POSITION_UCOLOR:6,TYPE_POSITION_LENGTH_TEXTURECOLOR:7,TYPE_MAX:8,_programs:{},_init:function(){this.loadDefaultShaders();return !0},_loadDefaultShader:function(d,c){switch(c){case this.TYPE_POSITION_TEXTURECOLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_COLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_VERT,cc.SHADER_POSITION_COLOR_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;case this.TYPE_POSITION_TEXTURE:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_VERT,cc.SHADER_POSITION_TEXTURE_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_UCOLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT,cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_TEXTURE_A8COLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT,cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);break;case this.TYPE_POSITION_UCOLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_UCOLOR_VERT,cc.SHADER_POSITION_UCOLOR_FRAG);d.addAttribute("aVertex",cc.VERTEX_ATTRIB_POSITION);break;case this.TYPE_POSITION_LENGTH_TEXTURECOLOR:d.initWithVertexShaderByteArray(cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT,cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG);d.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);d.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);d.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);break;default:cc.log("cocos2d: cc.shaderCache._loadDefaultShader, error shader type");return}d.link();d.updateUniforms()},loadDefaultShaders:function(){var b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURECOLOR);this._programs[cc.SHADER_POSITION_TEXTURECOLOR]=b;this._programs.ShaderPositionTextureColor=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST);this._programs[cc.SHADER_POSITION_TEXTURECOLORALPHATEST]=b;this._programs.ShaderPositionTextureColorAlphaTest=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_COLOR);this._programs[cc.SHADER_POSITION_COLOR]=b;this._programs.ShaderPositionColor=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE);this._programs[cc.SHADER_POSITION_TEXTURE]=b;this._programs.ShaderPositionTexture=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE_UCOLOR);this._programs[cc.SHADER_POSITION_TEXTURE_UCOLOR]=b;this._programs.ShaderPositionTextureUColor=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE_A8COLOR);this._programs[cc.SHADER_POSITION_TEXTUREA8COLOR]=b;this._programs.ShaderPositionTextureA8Color=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_UCOLOR);this._programs[cc.SHADER_POSITION_UCOLOR]=b;this._programs.ShaderPositionUColor=b;b=new cc.GLProgram;this._loadDefaultShader(b,this.TYPE_POSITION_LENGTH_TEXTURECOLOR);this._programs[cc.SHADER_POSITION_LENGTHTEXTURECOLOR]=b;this._programs.ShaderPositionLengthTextureColor=b},reloadDefaultShaders:function(){var b=this.programForKey(cc.SHADER_POSITION_TEXTURECOLOR);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURECOLOR);b=this.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURECOLOR_ALPHATEST);b=this.programForKey(cc.SHADER_POSITION_COLOR);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_COLOR);b=this.programForKey(cc.SHADER_POSITION_TEXTURE);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE);b=this.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE_UCOLOR);b=this.programForKey(cc.SHADER_POSITION_TEXTUREA8COLOR);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_TEXTURE_A8COLOR);b=this.programForKey(cc.SHADER_POSITION_UCOLOR);b.reset();this._loadDefaultShader(b,this.TYPE_POSITION_UCOLOR)},programForKey:function(b){return this._programs[b]},getProgram:function(b){return this._programs[b]},addProgram:function(d,c){this._programs[c]=d}};cc.HashUniformEntry=function(e,d,f){this.value=e;this.location=d;this.hh=f||{}};cc.GLProgram=cc.Class.extend({_glContext:null,_programObj:null,_vertShader:null,_fragShader:null,_uniforms:null,_hashForUniforms:null,_usesTime:!1,_updateUniformLocation:function(g,f,k){if(null==g){return !1}k=!0;for(var j=null,h=0;h<this._hashForUniforms.length;h++){this._hashForUniforms[h].location==g&&(j=this._hashForUniforms[h])}j?j.value==f?k=!1:j.value=f:(j=new cc.HashUniformEntry,j.location=g,j.value=f,this._hashForUniforms.push(j));return k},_description:function(){return"\x3cCCGLProgram \x3d "+this.toString()+" | Program \x3d "+this._programObj.toString()+", VertexShader \x3d "+this._vertShader.toString()+", FragmentShader \x3d "+this._fragShader.toString()+"\x3e"},_compileShader:function(e,d,f){if(!f||!e){return !1}f=(cc.GLProgram._isHighpSupported()?"precision highp float;\n":"precision mediump float;\n")+"uniform mat4 CC_PMatrix;         \nuniform mat4 CC_MVMatrix;        \nuniform mat4 CC_MVPMatrix;       \nuniform vec4 CC_Time;            \nuniform vec4 CC_SinTime;         \nuniform vec4 CC_CosTime;         \nuniform vec4 CC_Random01;        \nuniform sampler2D CC_Texture0;   \n//CC INCLUDES END                \n"+f;this._glContext.shaderSource(e,f);this._glContext.compileShader(e);f=this._glContext.getShaderParameter(e,this._glContext.COMPILE_STATUS);f||(cc.log("cocos2d: ERROR: Failed to compile shader:\n"+this._glContext.getShaderSource(e)),d===this._glContext.VERTEX_SHADER?cc.log("cocos2d: \n"+this.vertexShaderLog()):cc.log("cocos2d: \n"+this.fragmentShaderLog()));return !0===f},ctor:function(e,d,f){this._uniforms=[];this._hashForUniforms=[];this._glContext=f||cc._renderContext;e&&d&&this.init(e,d)},destroyProgram:function(){this._hashForUniforms=this._uniforms=this._fragShader=this._vertShader=null;this._glContext.deleteProgram(this._programObj)},initWithVertexShaderByteArray:function(e,d){var f=this._glContext;this._programObj=f.createProgram();this._fragShader=this._vertShader=null;e&&(this._vertShader=f.createShader(f.VERTEX_SHADER),this._compileShader(this._vertShader,f.VERTEX_SHADER,e)||cc.log("cocos2d: ERROR: Failed to compile vertex shader"));d&&(this._fragShader=f.createShader(f.FRAGMENT_SHADER),this._compileShader(this._fragShader,f.FRAGMENT_SHADER,d)||cc.log("cocos2d: ERROR: Failed to compile fragment shader"));this._vertShader&&f.attachShader(this._programObj,this._vertShader);cc.checkGLErrorDebug();this._fragShader&&f.attachShader(this._programObj,this._fragShader);this._hashForUniforms.length=0;cc.checkGLErrorDebug();return !0},initWithString:function(d,c){return this.initWithVertexShaderByteArray(d,c)},initWithVertexShaderFilename:function(f,e){var h=cc.loader.getRes(f);if(!h){throw"Please load the resource firset : "+f}var g=cc.loader.getRes(e);if(!g){throw"Please load the resource firset : "+e}return this.initWithVertexShaderByteArray(h,g)},init:function(d,c){return this.initWithVertexShaderFilename(d,c)},addAttribute:function(d,c){this._glContext.bindAttribLocation(this._programObj,c,d)},link:function(){if(!this._programObj){return cc.log("cc.GLProgram.link(): Cannot link invalid program"),!1}this._glContext.linkProgram(this._programObj);this._vertShader&&this._glContext.deleteShader(this._vertShader);this._fragShader&&this._glContext.deleteShader(this._fragShader);this._fragShader=this._vertShader=null;return cc.game.config[cc.game.CONFIG_KEY.debugMode]&&!this._glContext.getProgramParameter(this._programObj,this._glContext.LINK_STATUS)?(cc.log("cocos2d: ERROR: Failed to link program: "+this._glContext.getProgramInfoLog(this._programObj)),cc.glDeleteProgram(this._programObj),this._programObj=null,!1):!0},use:function(){cc.glUseProgram(this._programObj)},updateUniforms:function(){this._uniforms[cc.UNIFORM_PMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_PMATRIX_S);this._uniforms[cc.UNIFORM_MVMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVMATRIX_S);this._uniforms[cc.UNIFORM_MVPMATRIX]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_MVPMATRIX_S);this._uniforms[cc.UNIFORM_TIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_TIME_S);this._uniforms[cc.UNIFORM_SINTIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SINTIME_S);this._uniforms[cc.UNIFORM_COSTIME]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_COSTIME_S);this._usesTime=null!=this._uniforms[cc.UNIFORM_TIME]||null!=this._uniforms[cc.UNIFORM_SINTIME]||null!=this._uniforms[cc.UNIFORM_COSTIME];this._uniforms[cc.UNIFORM_RANDOM01]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_RANDOM01_S);this._uniforms[cc.UNIFORM_SAMPLER]=this._glContext.getUniformLocation(this._programObj,cc.UNIFORM_SAMPLER_S);this.use();this.setUniformLocationWith1i(this._uniforms[cc.UNIFORM_SAMPLER],0)},getUniformLocationForName:function(b){if(!b){throw"cc.GLProgram.getUniformLocationForName(): uniform name should be non-null"}if(!this._programObj){throw"cc.GLProgram.getUniformLocationForName(): Invalid operation. Cannot get uniform location when program is not initialized"}return this._glContext.getUniformLocation(this._programObj,b)},getUniformMVPMatrix:function(){return this._uniforms[cc.UNIFORM_MVPMATRIX]},getUniformSampler:function(){return this._uniforms[cc.UNIFORM_SAMPLER]},setUniformLocationWith1i:function(d,c){this._updateUniformLocation(d,c)&&this._glContext.uniform1i(d,c)},setUniformLocationWith2i:function(e,d,f){this._updateUniformLocation(e,[d,f])&&this._glContext.uniform2i(e,d,f)},setUniformLocationWith3i:function(f,e,h,g){this._updateUniformLocation(f,[e,h,g])&&this._glContext.uniform3i(f,e,h,g)},setUniformLocationWith4i:function(g,f,k,j,h){this._updateUniformLocation(g,[f,k,j,h])&&this._glContext.uniform4i(g,f,k,j,h)},setUniformLocationWith2iv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform2iv(e,d)},setUniformLocationWith3iv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform3iv(e,d)},setUniformLocationWith4iv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform4iv(e,d)},setUniformLocationI32:function(d,c){this.setUniformLocationWith1i(d,c)},setUniformLocationWith1f:function(d,c){this._updateUniformLocation(d,c)&&this._glContext.uniform1f(d,c)},setUniformLocationWith2f:function(e,d,f){this._updateUniformLocation(e,[d,f])&&this._glContext.uniform2f(e,d,f)},setUniformLocationWith3f:function(f,e,h,g){this._updateUniformLocation(f,[e,h,g])&&this._glContext.uniform3f(f,e,h,g)},setUniformLocationWith4f:function(g,f,k,j,h){this._updateUniformLocation(g,[f,k,j,h])&&this._glContext.uniform4f(g,f,k,j,h)},setUniformLocationWith2fv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform2fv(e,d)},setUniformLocationWith3fv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform3fv(e,d)},setUniformLocationWith4fv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniform4fv(e,d)},setUniformLocationWithMatrix4fv:function(e,d,f){this._updateUniformLocation(e,d)&&this._glContext.uniformMatrix4fv(e,!1,d)},setUniformLocationF32:function(){if(!(2>arguments.length)){switch(arguments.length){case 2:this.setUniformLocationWith1f(arguments[0],arguments[1]);break;case 3:this.setUniformLocationWith2f(arguments[0],arguments[1],arguments[2]);break;case 4:this.setUniformLocationWith3f(arguments[0],arguments[1],arguments[2],arguments[3]);break;case 5:this.setUniformLocationWith4f(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}}},setUniformsForBuiltins:function(){var e=new cc.math.Matrix4,d=new cc.math.Matrix4,f=new cc.math.Matrix4;cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,e);cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,d);cc.kmMat4Multiply(f,e,d);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],e.mat,1);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],d.mat,1);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],f.mat,1);this._usesTime&&(e=cc.director,e=e.getTotalFrames()*e.getAnimationInterval(),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME],e/10,e,2*e,4*e),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME],e/8,e/4,e/2,Math.sin(e)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME],e/8,e/4,e/2,Math.cos(e)));-1!==this._uniforms[cc.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())},_setUniformsForBuiltinsForRenderer:function(e){if(e&&e._renderCmd){var d=new cc.math.Matrix4,f=new cc.math.Matrix4;cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,d);cc.kmMat4Multiply(f,d,e._renderCmd._stackMatrix);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],d.mat,1);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],e._renderCmd._stackMatrix.mat,1);this.setUniformLocationWithMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],f.mat,1);this._usesTime&&(e=cc.director,e=e.getTotalFrames()*e.getAnimationInterval(),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_TIME],e/10,e,2*e,4*e),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_SINTIME],e/8,e/4,e/2,Math.sin(e)),this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_COSTIME],e/8,e/4,e/2,Math.cos(e)));-1!==this._uniforms[cc.UNIFORM_RANDOM01]&&this.setUniformLocationWith4f(this._uniforms[cc.UNIFORM_RANDOM01],Math.random(),Math.random(),Math.random(),Math.random())}},setUniformForModelViewProjectionMatrix:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],!1,cc.getMat4MultiplyValue(cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top))},setUniformForModelViewProjectionMatrixWithMat4:function(b){cc.kmMat4Multiply(b,cc.projection_matrix_stack.top,cc.modelview_matrix_stack.top);this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVPMATRIX],!1,b.mat)},setUniformForModelViewAndProjectionMatrixWithMat4:function(){this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],!1,cc.modelview_matrix_stack.top.mat);this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],!1,cc.projection_matrix_stack.top.mat)},_setUniformForMVPMatrixWithMat4:function(b){if(!b){throw"modelView matrix is undefined."}this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_MVMATRIX],!1,b.mat);this._glContext.uniformMatrix4fv(this._uniforms[cc.UNIFORM_PMATRIX],!1,cc.projection_matrix_stack.top.mat)},vertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getVertexShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},getFragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._vertShader)},fragmentShaderLog:function(){return this._glContext.getShaderInfoLog(this._fragShader)},programLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},getProgramLog:function(){return this._glContext.getProgramInfoLog(this._programObj)},reset:function(){this._fragShader=this._vertShader=null;this._uniforms.length=0;this._glContext.deleteProgram(this._programObj);this._programObj=null;for(var b=0;b<this._hashForUniforms.length;b++){this._hashForUniforms[b].value=null,this._hashForUniforms[b]=null}this._hashForUniforms.length=0},getProgram:function(){return this._programObj},retain:function(){},release:function(){}});cc.GLProgram.create=function(d,c){return new cc.GLProgram(d,c)};cc.GLProgram._highpSupported=null;cc.GLProgram._isHighpSupported=function(){if(null==cc.GLProgram._highpSupported){var b=cc._renderContext,b=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT);cc.GLProgram._highpSupported=0!==b.precision}return cc.GLProgram._highpSupported};cc.setProgram=function(f,e){f.shaderProgram=e;var h=f.children;if(h){for(var g=0;g<h.length;g++){cc.setProgram(h[g],e)}}};cc._currentProjectionMatrix=-1;cc._vertexAttribPosition=!1;cc._vertexAttribColor=!1;cc._vertexAttribTexCoords=!1;cc.ENABLE_GL_STATE_CACHE&&(cc.MAX_ACTIVETEXTURE=16,cc._currentShaderProgram=-1,cc._currentBoundTexture=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],cc._blendingSource=-1,cc._blendingDest=-1,cc._GLServerState=0,cc.TEXTURE_ATLAS_USE_VAO&&(cc._uVAO=0));cc.glInvalidateStateCache=function(){cc.kmGLFreeAll();cc._currentProjectionMatrix=-1;cc._vertexAttribPosition=!1;cc._vertexAttribColor=!1;cc._vertexAttribTexCoords=!1;if(cc.ENABLE_GL_STATE_CACHE){cc._currentShaderProgram=-1;for(var b=0;b<cc.MAX_ACTIVETEXTURE;b++){cc._currentBoundTexture[b]=-1}cc._blendingSource=-1;cc._blendingDest=-1;cc._GLServerState=0}};cc.glUseProgram=function(b){b!==cc._currentShaderProgram&&(cc._currentShaderProgram=b,cc._renderContext.useProgram(b))};cc.ENABLE_GL_STATE_CACHE||(cc.glUseProgram=function(b){cc._renderContext.useProgram(b)});cc.glDeleteProgram=function(b){cc.ENABLE_GL_STATE_CACHE&&b===cc._currentShaderProgram&&(cc._currentShaderProgram=-1);gl.deleteProgram(b)};cc.glBlendFunc=function(d,c){if(d!==cc._blendingSource||c!==cc._blendingDest){cc._blendingSource=d,cc._blendingDest=c,cc.setBlending(d,c)}};cc.setBlending=function(e,d){var f=cc._renderContext;e===f.ONE&&d===f.ZERO?f.disable(f.BLEND):(f.enable(f.BLEND),cc._renderContext.blendFunc(e,d))};cc.glBlendFuncForParticle=function(e,d){if(e!==cc._blendingSource||d!==cc._blendingDest){cc._blendingSource=e;cc._blendingDest=d;var f=cc._renderContext;e===f.ONE&&d===f.ZERO?f.disable(f.BLEND):(f.enable(f.BLEND),f.blendFuncSeparate(f.SRC_ALPHA,d,e,d))}};cc.ENABLE_GL_STATE_CACHE||(cc.glBlendFunc=cc.setBlending);cc.glBlendResetToCache=function(){var b=cc._renderContext;b.blendEquation(b.FUNC_ADD);cc.ENABLE_GL_STATE_CACHE?cc.setBlending(cc._blendingSource,cc._blendingDest):cc.setBlending(b.BLEND_SRC,b.BLEND_DST)};cc.setProjectionMatrixDirty=function(){cc._currentProjectionMatrix=-1};cc.glEnableVertexAttribs=function(e){var d=cc._renderContext,f=e&cc.VERTEX_ATTRIB_FLAG_POSITION;f!==cc._vertexAttribPosition&&(f?d.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION):d.disableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),cc._vertexAttribPosition=f);f=e&cc.VERTEX_ATTRIB_FLAG_COLOR;f!==cc._vertexAttribColor&&(f?d.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR):d.disableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),cc._vertexAttribColor=f);e&=cc.VERTEX_ATTRIB_FLAG_TEX_COORDS;e!==cc._vertexAttribTexCoords&&(e?d.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS):d.disableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),cc._vertexAttribTexCoords=e)};cc.glBindTexture2D=function(b){cc.glBindTexture2DN(0,b)};cc.glBindTexture2DN=function(e,d){if(cc._currentBoundTexture[e]!==d){cc._currentBoundTexture[e]=d;var f=cc._renderContext;f.activeTexture(f.TEXTURE0+e);d?f.bindTexture(f.TEXTURE_2D,d._webTextureObj):f.bindTexture(f.TEXTURE_2D,null)}};cc.ENABLE_GL_STATE_CACHE||(cc.glBindTexture2DN=function(e,d){var f=cc._renderContext;f.activeTexture(f.TEXTURE0+e);d?f.bindTexture(f.TEXTURE_2D,d._webTextureObj):f.bindTexture(f.TEXTURE_2D,null)});cc.glDeleteTexture=function(b){cc.glDeleteTextureN(0,b)};cc.glDeleteTextureN=function(d,c){cc.ENABLE_GL_STATE_CACHE&&c===cc._currentBoundTexture[d]&&(cc._currentBoundTexture[d]=-1);cc._renderContext.deleteTexture(c)};cc.glBindVAO=function(b){cc.TEXTURE_ATLAS_USE_VAO&&cc.ENABLE_GL_STATE_CACHE&&cc._uVAO!==b&&(cc._uVAO=b)};cc.glEnable=function(b){};cc.v2fzero=function(){return{x:0,y:0}};cc.v2f=function(d,c){return{x:d,y:c}};cc.v2fadd=function(d,c){return cc.v2f(d.x+c.x,d.y+c.y)};cc.v2fsub=function(d,c){return cc.v2f(d.x-c.x,d.y-c.y)};cc.v2fmult=function(d,c){return cc.v2f(d.x*c,d.y*c)};cc.v2fperp=function(b){return cc.v2f(-b.y,b.x)};cc.v2fneg=function(b){return cc.v2f(-b.x,-b.y)};cc.v2fdot=function(d,c){return d.x*c.x+d.y*c.y};cc.v2fforangle=function(b){return cc.v2f(Math.cos(b),Math.sin(b))};cc.v2fnormalize=function(b){b=cc.pNormalize(cc.p(b.x,b.y));return cc.v2f(b.x,b.y)};cc.__v2f=function(b){return cc.v2f(b.x,b.y)};cc.__t=function(b){return{u:b.x,v:b.y}};cc.DrawNodeCanvas=cc.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,_className:"DrawNodeCanvas",ctor:function(){cc.Node.prototype.ctor.call(this);var b=this._renderCmd;b._buffer=this._buffer=[];b._drawColor=this._drawColor=cc.color(255,255,255,255);b._blendFunc=this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);this.init()},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(d,c){void 0===c?(this._blendFunc.src=d.src,this._blendFunc.dst=d.dst):(this._blendFunc.src=d,this._blendFunc.dst=c)},setLineWidth:function(b){this._lineWidth=b},getLineWidth:function(){return this._lineWidth},setDrawColor:function(d){var c=this._drawColor;c.r=d.r;c.g=d.g;c.b=d.b;c.a=null==d.a?255:d.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(g,f,k,j,h){j=null==j?this._lineWidth:j;h=h||this.getDrawColor();null==h.a&&(h.a=255);g=[g,cc.p(f.x,g.y),f,cc.p(g.x,f.y)];f=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);f.verts=g;f.lineWidth=j;f.lineColor=h;f.isClosePolygon=!0;f.isStroke=!0;f.lineCap="butt";if(f.fillColor=k){null==k.a&&(k.a=255),f.isFill=!0}this._buffer.push(f)},drawCircle:function(A,z,y,x,w,v,u){v=v||this._lineWidth;u=u||this.getDrawColor();null==u.a&&(u.a=255);for(var t=2*Math.PI/x,s=[],r=0;r<=x;r++){var o=r*t,j=z*Math.cos(o+y)+A.x,o=z*Math.sin(o+y)+A.y;s.push(cc.p(j,o))}w&&s.push(cc.p(A.x,A.y));A=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);A.verts=s;A.lineWidth=v;A.lineColor=u;A.isClosePolygon=!0;A.isStroke=!0;this._buffer.push(A)},drawQuadBezier:function(y,x,w,v,u,t){u=u||this._lineWidth;t=t||this.getDrawColor();null==t.a&&(t.a=255);for(var s=[],r=0,p=0;p<v;p++){var o=Math.pow(1-r,2)*y.x+2*(1-r)*r*x.x+r*r*w.x,j=Math.pow(1-r,2)*y.y+2*(1-r)*r*x.y+r*r*w.y;s.push(cc.p(o,j));r+=1/v}s.push(cc.p(w.x,w.y));y=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);y.verts=s;y.lineWidth=u;y.lineColor=t;y.isStroke=!0;y.lineCap="round";this._buffer.push(y)},drawCubicBezier:function(A,z,y,x,w,v,u){v=v||this._lineWidth;u=u||this.getDrawColor();null==u.a&&(u.a=255);for(var t=[],s=0,r=0;r<w;r++){var o=Math.pow(1-s,3)*A.x+3*Math.pow(1-s,2)*s*z.x+3*(1-s)*s*s*y.x+s*s*s*x.x,j=Math.pow(1-s,3)*A.y+3*Math.pow(1-s,2)*s*z.y+3*(1-s)*s*s*y.y+s*s*s*x.y;t.push(cc.p(o,j));s+=1/w}t.push(cc.p(x.x,x.y));A=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);A.verts=t;A.lineWidth=v;A.lineColor=u;A.isStroke=!0;A.lineCap="round";this._buffer.push(A)},drawCatmullRom:function(f,e,h,g){this.drawCardinalSpline(f,0.5,e,h,g)},drawCardinalSpline:function(w,v,u,t,s){t=t||this._lineWidth;s=s||this.getDrawColor();null==s.a&&(s.a=255);for(var r=[],p,o,n=1/w.length,j=0;j<u+1;j++){o=j/u,1===o?(p=w.length-1,o=1):(p=0|o/n,o=(o-n*p)/n),p=cc.cardinalSplineAt(cc.getControlPointAt(w,p-1),cc.getControlPointAt(w,p-0),cc.getControlPointAt(w,p+1),cc.getControlPointAt(w,p+2),v,o),r.push(p)}w=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);w.verts=r;w.lineWidth=t;w.lineColor=s;w.isStroke=!0;w.lineCap="round";this._buffer.push(w)},drawDot:function(f,e,h){h=h||this.getDrawColor();null==h.a&&(h.a=255);var g=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);g.verts=[f];g.lineWidth=e;g.fillColor=h;this._buffer.push(g)},drawDots:function(g,f,k){if(g&&0!=g.length){k=k||this.getDrawColor();null==k.a&&(k.a=255);for(var j=0,h=g.length;j<h;j++){this.drawDot(g[j],f,k)}}},drawSegment:function(g,f,k,j){k=k||this._lineWidth;j=j||this.getDrawColor();null==j.a&&(j.a=255);var h=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);h.verts=[g,f];h.lineWidth=2*k;h.lineColor=j;h.isStroke=!0;h.lineCap="round";this._buffer.push(h)},drawPoly_:function(g,f,k,j){k=null==k?this._lineWidth:k;j=j||this.getDrawColor();null==j.a&&(j.a=255);var h=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);h.verts=g;h.fillColor=f;h.lineWidth=k;h.lineColor=j;h.isClosePolygon=!0;h.isStroke=!0;h.lineCap="round";f&&(h.isFill=!0);this._buffer.push(h)},drawPoly:function(h,g,n,m){for(var k=[],j=0;j<h.length;j++){k.push(cc.p(h[j].x,h[j].y))}return this.drawPoly_(k,g,n,m)},clear:function(){this._buffer.length=0},_createRenderCmd:function(){return new cc.DrawNode.CanvasRenderCmd(this)}});cc.DrawNodeWebGL=cc.Node.extend({_bufferCapacity:0,_buffer:null,_trianglesArrayBuffer:null,_trianglesWebBuffer:null,_trianglesReader:null,_lineWidth:1,_drawColor:null,_blendFunc:null,_dirty:!1,_className:"DrawNodeWebGL",getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(d,c){void 0===c?(this._blendFunc.src=d.src,this._blendFunc.dst=d.dst):(this._blendFunc.src=d,this._blendFunc.dst=c)},ctor:function(){cc.Node.prototype.ctor.call(this);this._buffer=[];this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);this._drawColor=cc.color(255,255,255,255);this.init()},init:function(){return cc.Node.prototype.init.call(this)?(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0):!1},setLineWidth:function(b){this._lineWidth=b},getLineWidth:function(){return this._lineWidth},setDrawColor:function(d){var c=this._drawColor;c.r=d.r;c.g=d.g;c.b=d.b;c.a=d.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(g,f,k,j,h){j=null==j?this._lineWidth:j;h=h||this.getDrawColor();null==h.a&&(h.a=255);g=[g,cc.p(f.x,g.y),f,cc.p(g.x,f.y)];null==k?this._drawSegments(g,j,h,!0):this.drawPoly(g,k,j,h)},drawCircle:function(A,z,y,x,w,v,u){v=v||this._lineWidth;u=u||this.getDrawColor();null==u.a&&(u.a=255);var t=2*Math.PI/x,s=[],r;for(r=0;r<=x;r++){var o=r*t,j=z*Math.cos(o+y)+A.x,o=z*Math.sin(o+y)+A.y;s.push(cc.p(j,o))}w&&s.push(cc.p(A.x,A.y));v*=0.5;r=0;for(A=s.length;r<A-1;r++){this.drawSegment(s[r],s[r+1],v,u)}},drawQuadBezier:function(y,x,w,v,u,t){u=u||this._lineWidth;t=t||this.getDrawColor();null==t.a&&(t.a=255);for(var s=[],r=0,p=0;p<v;p++){var o=Math.pow(1-r,2)*y.x+2*(1-r)*r*x.x+r*r*w.x,j=Math.pow(1-r,2)*y.y+2*(1-r)*r*x.y+r*r*w.y;s.push(cc.p(o,j));r+=1/v}s.push(cc.p(w.x,w.y));this._drawSegments(s,u,t,!1)},drawCubicBezier:function(A,z,y,x,w,v,u){v=v||this._lineWidth;u=u||this.getDrawColor();null==u.a&&(u.a=255);for(var t=[],s=0,r=0;r<w;r++){var o=Math.pow(1-s,3)*A.x+3*Math.pow(1-s,2)*s*z.x+3*(1-s)*s*s*y.x+s*s*s*x.x,j=Math.pow(1-s,3)*A.y+3*Math.pow(1-s,2)*s*z.y+3*(1-s)*s*s*y.y+s*s*s*x.y;t.push(cc.p(o,j));s+=1/w}t.push(cc.p(x.x,x.y));this._drawSegments(t,v,u,!1)},drawCatmullRom:function(f,e,h,g){this.drawCardinalSpline(f,0.5,e,h,g)},drawCardinalSpline:function(w,v,u,t,s){t=t||this._lineWidth;s=s||this.getDrawColor();null==s.a&&(s.a=255);for(var r=[],p,o,n=1/w.length,j=0;j<u+1;j++){o=j/u,1===o?(p=w.length-1,o=1):(p=0|o/n,o=(o-n*p)/n),p=cc.cardinalSplineAt(cc.getControlPointAt(w,p-1),cc.getControlPointAt(w,p-0),cc.getControlPointAt(w,p+1),cc.getControlPointAt(w,p+2),v,o),r.push(p)}t*=0.5;w=0;for(v=r.length;w<v-1;w++){this.drawSegment(r[w],r[w+1],t,s)}},_render:function(){var d=cc._renderContext;cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);d.bindBuffer(d.ARRAY_BUFFER,this._trianglesWebBuffer);this._dirty&&(d.bufferData(d.ARRAY_BUFFER,this._trianglesArrayBuffer,d.STREAM_DRAW),this._dirty=!1);var c=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;d.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,d.FLOAT,!1,c,0);d.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,d.UNSIGNED_BYTE,!0,c,8);d.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,d.FLOAT,!1,c,12);d.drawArrays(d.TRIANGLES,0,3*this._buffer.length);cc.incrementGLDraws(1)},_ensureCapacity:function(g){var f=this._buffer;if(f.length+g>this._bufferCapacity){var k=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;this._bufferCapacity+=Math.max(this._bufferCapacity,g);if(null==f||0===f.length){this._buffer=[],this._trianglesArrayBuffer=new ArrayBuffer(k*this._bufferCapacity),this._trianglesReader=new Uint8Array(this._trianglesArrayBuffer)}else{g=[];for(var j=new ArrayBuffer(k*this._bufferCapacity),h=0;h<f.length;h++){g[h]=new cc.V2F_C4B_T2F_Triangle(f[h].a,f[h].b,f[h].c,j,h*k)}this._trianglesReader=new Uint8Array(j);this._trianglesArrayBuffer=j;this._buffer=g}}},drawDot:function(h,g,n){n=n||this.getDrawColor();null==n.a&&(n.a=255);var m={r:0|n.r,g:0|n.g,b:0|n.b,a:0|n.a};n={vertices:{x:h.x-g,y:h.y-g},colors:m,texCoords:{u:-1,v:-1}};var k={vertices:{x:h.x-g,y:h.y+g},colors:m,texCoords:{u:-1,v:1}},j={vertices:{x:h.x+g,y:h.y+g},colors:m,texCoords:{u:1,v:1}};h={vertices:{x:h.x+g,y:h.y-g},colors:m,texCoords:{u:1,v:-1}};this._ensureCapacity(6);this._buffer.push(new cc.V2F_C4B_T2F_Triangle(n,k,j,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT));this._buffer.push(new cc.V2F_C4B_T2F_Triangle(n,j,h,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT));this._dirty=!0},drawDots:function(g,f,k){if(g&&0!==g.length){k=k||this.getDrawColor();null==k.a&&(k.a=255);for(var j=0,h=g.length;j<h;j++){this.drawDot(g[j],f,k)}}},drawSegment:function(D,C,B,A){A=A||this.getDrawColor();null==A.a&&(A.a=255);B=B||0.5*this._lineWidth;this._ensureCapacity(18);A={r:0|A.r,g:0|A.g,b:0|A.b,a:0|A.a};var z=cc.__v2f(D),y=cc.__v2f(C);C=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(y,z)));D=cc.v2fperp(C);var x=cc.v2fmult(C,B),w=cc.v2fmult(D,B);B=cc.v2fsub(y,cc.v2fadd(x,w));var v=cc.v2fadd(y,cc.v2fsub(x,w)),u=cc.v2fsub(y,x),y=cc.v2fadd(y,x),t=cc.v2fsub(z,x),o=cc.v2fadd(z,x),E=cc.v2fsub(z,cc.v2fsub(x,w)),z=cc.v2fadd(z,cc.v2fadd(x,w)),x=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,w=this._trianglesArrayBuffer,j=this._buffer;j.push(new cc.V2F_C4B_T2F_Triangle({vertices:B,colors:A,texCoords:cc.__t(cc.v2fneg(cc.v2fadd(C,D)))},{vertices:v,colors:A,texCoords:cc.__t(cc.v2fsub(C,D))},{vertices:u,colors:A,texCoords:cc.__t(cc.v2fneg(C))},w,j.length*x));j.push(new cc.V2F_C4B_T2F_Triangle({vertices:y,colors:A,texCoords:cc.__t(C)},{vertices:v,colors:A,texCoords:cc.__t(cc.v2fsub(C,D))},{vertices:u,colors:A,texCoords:cc.__t(cc.v2fneg(C))},w,j.length*x));j.push(new cc.V2F_C4B_T2F_Triangle({vertices:y,colors:A,texCoords:cc.__t(C)},{vertices:t,colors:A,texCoords:cc.__t(cc.v2fneg(C))},{vertices:u,colors:A,texCoords:cc.__t(cc.v2fneg(C))},w,j.length*x));j.push(new cc.V2F_C4B_T2F_Triangle({vertices:y,colors:A,texCoords:cc.__t(C)},{vertices:t,colors:A,texCoords:cc.__t(cc.v2fneg(C))},{vertices:o,colors:A,texCoords:cc.__t(C)},w,j.length*x));j.push(new cc.V2F_C4B_T2F_Triangle({vertices:E,colors:A,texCoords:cc.__t(cc.v2fsub(D,C))},{vertices:t,colors:A,texCoords:cc.__t(cc.v2fneg(C))},{vertices:o,colors:A,texCoords:cc.__t(C)},w,j.length*x));j.push(new cc.V2F_C4B_T2F_Triangle({vertices:E,colors:A,texCoords:cc.__t(cc.v2fsub(D,C))},{vertices:z,colors:A,texCoords:cc.__t(cc.v2fadd(C,D))},{vertices:o,colors:A,texCoords:cc.__t(C)},w,j.length*x));this._dirty=!0},drawPoly:function(M,L,K,J){if(null==L){this._drawSegments(M,K,J,!0)}else{null==L.a&&(L.a=255);null==J.a&&(J.a=255);K=null==K?this._lineWidth:K;K*=0.5;L={r:0|L.r,g:0|L.g,b:0|L.b,a:0|L.a};J={r:0|J.r,g:0|J.g,b:0|J.b,a:0|J.a};var I=[],H,G,F,E,D=M.length;for(H=0;H<D;H++){G=cc.__v2f(M[(H-1+D)%D]);F=cc.__v2f(M[H]);E=cc.__v2f(M[(H+1)%D]);var C=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(F,G)));F=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(E,F)));C=cc.v2fmult(cc.v2fadd(C,F),1/(cc.v2fdot(C,F)+1));I[H]={offset:C,n:F}}C=0<K;this._ensureCapacity(3*(3*D-2));var B=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,z=this._trianglesArrayBuffer,A=this._buffer,x=!1==C?0.5:0;for(H=0;H<D-2;H++){G=cc.v2fsub(cc.__v2f(M[0]),cc.v2fmult(I[0].offset,x)),F=cc.v2fsub(cc.__v2f(M[H+1]),cc.v2fmult(I[H+1].offset,x)),E=cc.v2fsub(cc.__v2f(M[H+2]),cc.v2fmult(I[H+2].offset,x)),A.push(new cc.V2F_C4B_T2F_Triangle({vertices:G,colors:L,texCoords:cc.__t(cc.v2fzero())},{vertices:F,colors:L,texCoords:cc.__t(cc.v2fzero())},{vertices:E,colors:L,texCoords:cc.__t(cc.v2fzero())},z,A.length*B))}for(H=0;H<D;H++){x=(H+1)%D;G=cc.__v2f(M[H]);F=cc.__v2f(M[x]);E=I[H].n;var y=I[H].offset,o=I[x].offset,x=C?cc.v2fsub(G,cc.v2fmult(y,K)):cc.v2fsub(G,cc.v2fmult(y,0.5)),j=C?cc.v2fsub(F,cc.v2fmult(o,K)):cc.v2fsub(F,cc.v2fmult(o,0.5));G=C?cc.v2fadd(G,cc.v2fmult(y,K)):cc.v2fadd(G,cc.v2fmult(y,0.5));F=C?cc.v2fadd(F,cc.v2fmult(o,K)):cc.v2fadd(F,cc.v2fmult(o,0.5));C?(A.push(new cc.V2F_C4B_T2F_Triangle({vertices:x,colors:J,texCoords:cc.__t(cc.v2fneg(E))},{vertices:j,colors:J,texCoords:cc.__t(cc.v2fneg(E))},{vertices:F,colors:J,texCoords:cc.__t(E)},z,A.length*B)),A.push(new cc.V2F_C4B_T2F_Triangle({vertices:x,colors:J,texCoords:cc.__t(cc.v2fneg(E))},{vertices:G,colors:J,texCoords:cc.__t(E)},{vertices:F,colors:J,texCoords:cc.__t(E)},z,A.length*B))):(A.push(new cc.V2F_C4B_T2F_Triangle({vertices:x,colors:L,texCoords:cc.__t(cc.v2fzero())},{vertices:j,colors:L,texCoords:cc.__t(cc.v2fzero())},{vertices:F,colors:L,texCoords:cc.__t(E)},z,A.length*B)),A.push(new cc.V2F_C4B_T2F_Triangle({vertices:x,colors:L,texCoords:cc.__t(cc.v2fzero())},{vertices:G,colors:L,texCoords:cc.__t(E)},{vertices:F,colors:L,texCoords:cc.__t(E)},z,A.length*B)))}this._dirty=!0}},_drawSegments:function(G,F,E,D){F=null==F?this._lineWidth:F;E=E||this._drawColor;null==E.a&&(E.a=255);F*=0.5;if(!(0>=F)){E={r:0|E.r,g:0|E.g,b:0|E.b,a:0|E.a};var C=[],B,A,z,y,x=G.length;for(B=0;B<x;B++){A=cc.__v2f(G[(B-1+x)%x]);z=cc.__v2f(G[B]);y=cc.__v2f(G[(B+1)%x]);var w=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(z,A)));z=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(y,z)));y=cc.v2fmult(cc.v2fadd(w,z),1/(cc.v2fdot(w,z)+1));C[B]={offset:y,n:z}}this._ensureCapacity(3*(3*x-2));y=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;var w=this._trianglesArrayBuffer,o=this._buffer;D=D?x:x-1;for(B=0;B<D;B++){var K=(B+1)%x;A=cc.__v2f(G[B]);z=cc.__v2f(G[K]);var j=C[B].n,I=C[B].offset,J=C[K].offset,K=cc.v2fsub(A,cc.v2fmult(I,F)),H=cc.v2fsub(z,cc.v2fmult(J,F));A=cc.v2fadd(A,cc.v2fmult(I,F));z=cc.v2fadd(z,cc.v2fmult(J,F));o.push(new cc.V2F_C4B_T2F_Triangle({vertices:K,colors:E,texCoords:cc.__t(cc.v2fneg(j))},{vertices:H,colors:E,texCoords:cc.__t(cc.v2fneg(j))},{vertices:z,colors:E,texCoords:cc.__t(j)},w,o.length*y));o.push(new cc.V2F_C4B_T2F_Triangle({vertices:K,colors:E,texCoords:cc.__t(cc.v2fneg(j))},{vertices:A,colors:E,texCoords:cc.__t(j)},{vertices:z,colors:E,texCoords:cc.__t(j)},w,o.length*y))}this._dirty=!0}},clear:function(){this._buffer.length=0;this._dirty=!0},_createRenderCmd:function(){return new cc.DrawNode.WebGLRenderCmd(this)}});cc.DrawNode=cc._renderType===cc._RENDER_TYPE_WEBGL?cc.DrawNodeWebGL:cc.DrawNodeCanvas;cc.DrawNode.create=function(){return new cc.DrawNode};cc._DrawNodeElement=function(u,t,s,r,p,o,n,m,j){this.type=u;this.verts=t||null;this.fillColor=s||null;this.lineWidth=r||0;this.lineColor=p||null;this.lineCap=o||"butt";this.isClosePolygon=n||!1;this.isFill=m||!1;this.isStroke=j||!1};cc.DrawNode.TYPE_DOT=0;cc.DrawNode.TYPE_SEGMENT=1;cc.DrawNode.TYPE_POLY=2;(function(){cc.DrawNode.CanvasRenderCmd=function(b){cc.Node.CanvasRenderCmd.call(this,b);this._needDraw=!0;this._blendFunc=this._drawColor=this._buffer=null};cc.DrawNode.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.DrawNode.CanvasRenderCmd.prototype.constructor=cc.DrawNode.CanvasRenderCmd;cc.DrawNode.CanvasRenderCmd.prototype.rendering=function(j,h,p){j=j||cc._renderContext;j.getContext();var o=this._node._displayedOpacity/255;if(0!==o){j.setTransform(this._worldTransform,h,p);j.setGlobalAlpha(o);this._blendFunc&&this._blendFunc.src===cc.SRC_ALPHA&&this._blendFunc.dst===cc.ONE&&j.setCompositeOperation("lighter");for(var o=this._buffer,n=0,m=o.length;n<m;n++){var k=o[n];switch(k.type){case cc.DrawNode.TYPE_DOT:this._drawDot(j,k,h,p);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(j,k,h,p);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(j,k,h,p)}}}};cc.DrawNode.CanvasRenderCmd.prototype._drawDot=function(j,h,p,o){var n=h.fillColor,m=h.verts[0];h=h.lineWidth;var k=j.getContext();j.setFillStyle("rgba("+(0|n.r)+","+(0|n.g)+","+(0|n.b)+","+n.a/255+")");k.beginPath();k.arc(m.x*p,-m.y*o,h*p,0,2*Math.PI,!1);k.closePath();k.fill()};cc.DrawNode.CanvasRenderCmd.prototype._drawSegment=function(u,t,s,r){var p=t.lineColor,o=t.verts[0],n=t.verts[1],m=t.lineWidth;t=t.lineCap;var j=u.getContext();u.setStrokeStyle("rgba("+(0|p.r)+","+(0|p.g)+","+(0|p.b)+","+p.a/255+")");j.lineWidth=m*s;j.beginPath();j.lineCap=t;j.moveTo(o.x*s,-o.y*r);j.lineTo(n.x*s,-n.y*r);j.stroke()};cc.DrawNode.CanvasRenderCmd.prototype._drawPoly=function(B,A,z,y){var x=A.verts,w=A.lineCap;if(null!=x){var v=A.fillColor,u=A.lineWidth,t=A.lineColor,r=A.isClosePolygon,o=A.isFill;A=A.isStroke;var j=B.getContext(),C=x[0];j.lineCap=w;v&&B.setFillStyle("rgba("+(0|v.r)+","+(0|v.g)+","+(0|v.b)+","+v.a/255+")");u&&(j.lineWidth=u*z);t&&B.setStrokeStyle("rgba("+(0|t.r)+","+(0|t.g)+","+(0|t.b)+","+t.a/255+")");j.beginPath();j.moveTo(C.x*z,-C.y*y);B=1;for(w=x.length;B<w;B++){j.lineTo(x[B].x*z,-x[B].y*y)}r&&j.closePath();o&&j.fill();A&&j.stroke()}}})();(function(){cc.DrawNode.WebGLRenderCmd=function(b){cc.Node.WebGLRenderCmd.call(this,b);this._needDraw=!0};cc.DrawNode.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.DrawNode.WebGLRenderCmd.prototype.constructor=cc.DrawNode.WebGLRenderCmd;cc.DrawNode.WebGLRenderCmd.prototype.rendering=function(b){b=this._node;cc.glBlendFunc(b._blendFunc.src,b._blendFunc.dst);this._shaderProgram.use();this._shaderProgram._setUniformForMVPMatrixWithMat4(this._stackMatrix);b._render()}})();cc.ACTION_TAG_INVALID=-1;cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.target=this.originalTarget=null;this.tag=cc.ACTION_TAG_INVALID},copy:function(){cc.log("copy is deprecated. Please use clone instead.");return this.clone()},clone:function(){var b=new cc.Action;b.originalTarget=null;b.target=null;b.tag=this.tag;return b},isDone:function(){return !0},startWithTarget:function(b){this.target=this.originalTarget=b},stop:function(){this.target=null},step:function(b){cc.log("[Action step]. override me")},update:function(b){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(b){this.target=b},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(b){this.originalTarget=b},getTag:function(){return this.tag},setTag:function(b){this.tag=b},retain:function(){},release:function(){}});cc.action=function(){return new cc.Action};cc.Action.create=cc.action;cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this);this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(b){this._duration=b},reverse:function(){cc.log("cocos2d: FiniteTimeAction#reverse: Implement me");return null},clone:function(){return new cc.FiniteTimeAction}});cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(d,c){cc.Action.prototype.ctor.call(this);this._speed=0;this._innerAction=null;d&&this.initWithAction(d,c)},getSpeed:function(){return this._speed},setSpeed:function(b){this._speed=b},initWithAction:function(d,c){if(!d){throw"cc.Speed.initWithAction(): action must be non nil"}this._innerAction=d;this._speed=c;return !0},clone:function(){var b=new cc.Speed;b.initWithAction(this._innerAction.clone(),this._speed);return b},startWithTarget:function(b){cc.Action.prototype.startWithTarget.call(this,b);this._innerAction.startWithTarget(b)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},step:function(b){this._innerAction.step(b*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(b){this._innerAction!==b&&(this._innerAction=b)},getInnerAction:function(){return this._innerAction}});cc.speed=function(d,c){return new cc.Speed(d,c)};cc.Speed.create=cc.speed;cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(d,c){cc.Action.prototype.ctor.call(this);this._followedNode=null;this._boundaryFullyCovered=this._boundarySet=!1;this._fullScreenSize=this._halfScreenSize=null;this.bottomBoundary=this.topBoundary=this.rightBoundary=this.leftBoundary=0;this._worldRect=cc.rect(0,0,0,0);d&&(c?this.initWithTarget(d,c):this.initWithTarget(d))},clone:function(){var d=new cc.Follow,c=this._worldRect,c=new cc.Rect(c.x,c.y,c.width,c.height);d.initWithTarget(this._followedNode,c);return d},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(b){this._boundarySet=b},initWithTarget:function(e,d){if(!e){throw"cc.Follow.initWithAction(): followedNode must be non nil"}d=d||cc.rect(0,0,0,0);this._followedNode=e;this._worldRect=d;this._boundarySet=!cc._rectEqualToZero(d);this._boundaryFullyCovered=!1;var f=cc.director.getWinSize();this._fullScreenSize=cc.p(f.width,f.height);this._halfScreenSize=cc.pMult(this._fullScreenSize,0.5);this._boundarySet&&(this.leftBoundary=-(d.x+d.width-this._fullScreenSize.x),this.rightBoundary=-d.x,this.topBoundary=-d.y,this.bottomBoundary=-(d.y+d.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=this.bottomBoundary=(this.topBoundary+this.bottomBoundary)/2),this.topBoundary===this.bottomBoundary&&this.leftBoundary===this.rightBoundary&&(this._boundaryFullyCovered=!0));return !0},step:function(d){d=this._followedNode.x;var c=this._followedNode.y;d=this._halfScreenSize.x-d;c=this._halfScreenSize.y-c;this.target._renderCmd._dirtyFlag=0;this._boundarySet?this._boundaryFullyCovered||this.target.setPosition(cc.clampf(d,this.leftBoundary,this.rightBoundary),cc.clampf(c,this.bottomBoundary,this.topBoundary)):this.target.setPosition(d,c)},isDone:function(){return !this._followedNode.running},stop:function(){this.target=null;cc.Action.prototype.stop.call(this)}});cc.follow=function(d,c){return new cc.Follow(d,c)};cc.Follow.create=cc.follow;cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_timesForRepeat:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(b){this._timesForRepeat=this._speed=1;this._repeatForever=!1;this.MAX_VALUE=2;this._speedMethod=this._repeatMethod=!1;cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(b)},getElapsed:function(){return this._elapsed},initWithDuration:function(b){this._duration=0===b?cc.FLT_EPSILON:b;this._elapsed=0;return this._firstTick=!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(b){b._repeatForever=this._repeatForever;b._speed=this._speed;b._timesForRepeat=this._timesForRepeat;b._easeList=this._easeList;b._speedMethod=this._speedMethod;b._repeatMethod=this._repeatMethod},_reverseEaseList:function(d){if(this._easeList){d._easeList=[];for(var c=0;c<this._easeList.length;c++){d._easeList.push(this._easeList[c].reverse())}}},clone:function(){var b=new cc.ActionInterval(this._duration);this._cloneDecoration(b);return b},easing:function(d){this._easeList?this._easeList.length=0:this._easeList=[];for(var c=0;c<arguments.length;c++){this._easeList.push(arguments[c])}return this},_computeEaseTime:function(f){var e=this._easeList;if(!e||0===e.length){return f}for(var h=0,g=e.length;h<g;h++){f=e[h].easing(f)}return f},step:function(b){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=b;b=this._elapsed/(1.192092896e-7<this._duration?this._duration:1.192092896e-7);b=1>b?b:1;this.update(0<b?b:0);this._repeatMethod&&1<this._timesForRepeat&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(b){cc.Action.prototype.startWithTarget.call(this,b);this._elapsed=0;this._firstTick=!0},reverse:function(){cc.log("cc.IntervalAction: reverse not implemented.");return null},setAmplitudeRate:function(b){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass.");return 0},speed:function(b){if(0>=b){return cc.log("The speed parameter error"),this}this._speedMethod=!0;this._speed*=b;return this},getSpeed:function(){return this._speed},setSpeed:function(b){this._speed=b;return this},repeat:function(b){b=Math.round(b);if(isNaN(b)||1>b){return cc.log("The repeat parameter error"),this}this._repeatMethod=!0;this._timesForRepeat*=b;return this},repeatForever:function(){this._repeatMethod=!0;this._timesForRepeat=this.MAX_VALUE;this._repeatForever=!0;return this}});cc.actionInterval=function(b){return new cc.ActionInterval(b)};cc.ActionInterval.create=cc.actionInterval;cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(g){cc.ActionInterval.prototype.ctor.call(this);this._actions=[];var f=g instanceof Array?g:arguments,k=f.length-1;0<=k&&null==f[k]&&cc.log("parameters should not be ending with null in Javascript");if(0<=k){for(var j=f[0],h=1;h<k;h++){f[h]&&(j=cc.Sequence._actionOneTwo(j,f[h]))}this.initWithTwoActions(j,f[k])}},initWithTwoActions:function(d,c){if(!d||!c){throw"cc.Sequence.initWithTwoActions(): arguments must all be non nil"}this.initWithDuration(d._duration+c._duration);this._actions[0]=d;this._actions[1]=c;return !0},clone:function(){var b=new cc.Sequence;this._cloneDecoration(b);b.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._split=this._actions[0]._duration/this._duration;this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop();cc.Action.prototype.stop.call(this)},update:function(g){var f=0,k=this._split,j=this._actions,h=this._last;g=this._computeEaseTime(g);g<k?(g=0!==k?g/k:1,0===f&&1===h&&(j[1].update(0),j[1].stop())):(f=1,g=1===k?1:(g-k)/(1-k),-1===h&&(j[0].startWithTarget(this.target),j[0].update(1),j[0].stop()),h||(j[0].update(1),j[0].stop()));j=j[f];h===f&&j.isDone()||(h!==f&&j.startWithTarget(this.target),g*=j._timesForRepeat,j.update(1<g?g%1:g),this._last=f)},reverse:function(){var b=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.sequence=function(h){var g=h instanceof Array?h:arguments;0<g.length&&null==g[g.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var n,m,k,j;g&&0<g.length;){for(m=Array.prototype.shift.call(g),j=m._timesForRepeat||1,m._repeatMethod=!1,m._timesForRepeat=1,k=0,n||(n=m,k=1),k;k<j;k++){n=cc.Sequence._actionOneTwo(n,m)}}return n};cc.Sequence.create=cc.sequence;cc.Sequence._actionOneTwo=function(e,d){var f=new cc.Sequence;f.initWithTwoActions(e,d);return f};cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(d,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==c&&this.initWithAction(d,c)},initWithAction:function(d,c){return this.initWithDuration(d._duration*c)?(this._times=c,this._innerAction=d,d instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0):!1},clone:function(){var b=new cc.Repeat;this._cloneDecoration(b);b.initWithAction(this._innerAction.clone(),this._times);return b},startWithTarget:function(b){this._total=0;this._nextDt=this._innerAction._duration/this._duration;cc.ActionInterval.prototype.startWithTarget.call(this,b);this._innerAction.startWithTarget(b)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},update:function(g){g=this._computeEaseTime(g);var f=this._innerAction,k=this._duration,j=this._times,h=this._nextDt;if(g>=h){for(;g>h&&this._total<j;){f.update(1),this._total++,f.stop(),f.startWithTarget(this.target),this._nextDt=h+=f._duration/k}1<=g&&this._total<j&&this._total++;this._actionInstant||(this._total===j?(f.update(1),f.stop()):f.update(g-(h-f._duration/k)))}else{f.update(g*j%1)}},isDone:function(){return this._total===this._times},reverse:function(){var b=new cc.Repeat(this._innerAction.reverse(),this._times);this._cloneDecoration(b);this._reverseEaseList(b);return b},setInnerAction:function(b){this._innerAction!==b&&(this._innerAction=b)},getInnerAction:function(){return this._innerAction}});cc.repeat=function(d,c){return new cc.Repeat(d,c)};cc.Repeat.create=cc.repeat;cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(b){cc.ActionInterval.prototype.ctor.call(this);this._innerAction=null;b&&this.initWithAction(b)},initWithAction:function(b){if(!b){throw"cc.RepeatForever.initWithAction(): action must be non null"}this._innerAction=b;return !0},clone:function(){var b=new cc.RepeatForever;this._cloneDecoration(b);b.initWithAction(this._innerAction.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._innerAction.startWithTarget(b)},step:function(d){var c=this._innerAction;c.step(d);c.isDone()&&(c.startWithTarget(this.target),c.step(c.getElapsed()-c._duration))},isDone:function(){return !1},reverse:function(){var b=new cc.RepeatForever(this._innerAction.reverse());this._cloneDecoration(b);this._reverseEaseList(b);return b},setInnerAction:function(b){this._innerAction!==b&&(this._innerAction=b)},getInnerAction:function(){return this._innerAction}});cc.repeatForever=function(b){return new cc.RepeatForever(b)};cc.RepeatForever.create=cc.repeatForever;cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(g){cc.ActionInterval.prototype.ctor.call(this);this._two=this._one=null;var f=g instanceof Array?g:arguments,k=f.length-1;0<=k&&null==f[k]&&cc.log("parameters should not be ending with null in Javascript");if(0<=k){for(var j=f[0],h=1;h<k;h++){f[h]&&(j=cc.Spawn._actionOneTwo(j,f[h]))}this.initWithTwoActions(j,f[k])}},initWithTwoActions:function(g,f){if(!g||!f){throw"cc.Spawn.initWithTwoActions(): arguments must all be non null"}var k=!1,j=g._duration,h=f._duration;this.initWithDuration(Math.max(j,h))&&(this._one=g,this._two=f,j>h?this._two=cc.Sequence._actionOneTwo(f,cc.delayTime(j-h)):j<h&&(this._one=cc.Sequence._actionOneTwo(g,cc.delayTime(h-j))),k=!0);return k},clone:function(){var b=new cc.Spawn;this._cloneDecoration(b);b.initWithTwoActions(this._one.clone(),this._two.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._one.startWithTarget(b);this._two.startWithTarget(b)},stop:function(){this._one.stop();this._two.stop();cc.Action.prototype.stop.call(this)},update:function(b){b=this._computeEaseTime(b);this._one&&this._one.update(b);this._two&&this._two.update(b)},reverse:function(){var b=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.spawn=function(f){var e=f instanceof Array?f:arguments;0<e.length&&null==e[e.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var h=e[0],g=1;g<e.length;g++){null!=e[g]&&(h=cc.Spawn._actionOneTwo(h,e[g]))}return h};cc.Spawn.create=cc.spawn;cc.Spawn._actionOneTwo=function(e,d){var f=new cc.Spawn;f.initWithTwoActions(e,d);return f};cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);void 0!==d&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){return cc.ActionInterval.prototype.initWithDuration.call(this,e)?(this._dstAngleX=d||0,this._dstAngleY=f||this._dstAngleX,!0):!1},clone:function(){var b=new cc.RotateTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._dstAngleX,this._dstAngleY);return b},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var d=e.rotationX%360,f=this._dstAngleX-d;180<f&&(f-=360);-180>f&&(f+=360);this._startAngleX=d;this._diffAngleX=f;this._startAngleY=e.rotationY%360;e=this._dstAngleY-this._startAngleY;180<e&&(e-=360);-180>e&&(e+=360);this._diffAngleY=e},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(b){b=this._computeEaseTime(b);this.target&&(this.target.rotationX=this._startAngleX+this._diffAngleX*b,this.target.rotationY=this._startAngleY+this._diffAngleY*b)}});cc.rotateTo=function(e,d,f){return new cc.RotateTo(e,d,f)};cc.RotateTo.create=cc.rotateTo;cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);void 0!==d&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){return cc.ActionInterval.prototype.initWithDuration.call(this,e)?(this._angleX=d||0,this._angleY=f||this._angleX,!0):!1},clone:function(){var b=new cc.RotateBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._angleX,this._angleY);return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._startAngleX=b.rotationX;this._startAngleY=b.rotationY},update:function(b){b=this._computeEaseTime(b);this.target&&(this.target.rotationX=this._startAngleX+this._angleX*b,this.target.rotationY=this._startAngleY+this._angleY*b)},reverse:function(){var b=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.rotateBy=function(e,d,f){return new cc.RotateBy(e,d,f)};cc.RotateBy.create=cc.rotateBy;cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);this._positionDelta=cc.p(0,0);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);void 0!==d&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){return cc.ActionInterval.prototype.initWithDuration.call(this,e)?(void 0!==d.x&&(f=d.y,d=d.x),this._positionDelta.x=d,this._positionDelta.y=f,!0):!1},clone:function(){var b=new cc.MoveBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._positionDelta);return b},startWithTarget:function(d){cc.ActionInterval.prototype.startWithTarget.call(this,d);var c=d.getPositionX();d=d.getPositionY();this._previousPosition.x=c;this._previousPosition.y=d;this._startPosition.x=c;this._startPosition.y=d},update:function(h){h=this._computeEaseTime(h);if(this.target){var g=this._positionDelta.x*h;h*=this._positionDelta.y;var n=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var m=this.target.getPositionX(),k=this.target.getPositionY(),j=this._previousPosition;n.x=n.x+m-j.x;n.y=n.y+k-j.y;g+=n.x;h+=n.y;j.x=g;j.y=h;this.target.setPosition(g,h)}else{this.target.setPosition(n.x+g,n.y+h)}}},reverse:function(){var b=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.moveBy=function(e,d,f){return new cc.MoveBy(e,d,f)};cc.MoveBy.create=cc.moveBy;cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(e,d,f){cc.MoveBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);void 0!==d&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){return cc.MoveBy.prototype.initWithDuration.call(this,e,d,f)?(void 0!==d.x&&(f=d.y,d=d.x),this._endPosition.x=d,this._endPosition.y=f,!0):!1},clone:function(){var b=new cc.MoveTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._endPosition);return b},startWithTarget:function(b){cc.MoveBy.prototype.startWithTarget.call(this,b);this._positionDelta.x=this._endPosition.x-b.getPositionX();this._positionDelta.y=this._endPosition.y-b.getPositionY()}});cc.moveTo=function(e,d,f){return new cc.MoveTo(e,d,f)};cc.MoveTo.create=cc.moveTo;cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);void 0!==f&&this.initWithDuration(e,d,f)},initWithDuration:function(f,e,h){var g=!1;cc.ActionInterval.prototype.initWithDuration.call(this,f)&&(this._endSkewX=e,this._endSkewY=h,g=!0);return g},clone:function(){var b=new cc.SkewTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._endSkewX,this._endSkewY);return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._startSkewX=b.skewX%180;this._deltaX=this._endSkewX-this._startSkewX;180<this._deltaX&&(this._deltaX-=360);-180>this._deltaX&&(this._deltaX+=360);this._startSkewY=b.skewY%360;this._deltaY=this._endSkewY-this._startSkewY;180<this._deltaY&&(this._deltaY-=360);-180>this._deltaY&&(this._deltaY+=360)},update:function(b){b=this._computeEaseTime(b);this.target.skewX=this._startSkewX+this._deltaX*b;this.target.skewY=this._startSkewY+this._deltaY*b}});cc.skewTo=function(e,d,f){return new cc.SkewTo(e,d,f)};cc.SkewTo.create=cc.skewTo;cc.SkewBy=cc.SkewTo.extend({ctor:function(e,d,f){cc.SkewTo.prototype.ctor.call(this);void 0!==f&&this.initWithDuration(e,d,f)},initWithDuration:function(f,e,h){var g=!1;cc.SkewTo.prototype.initWithDuration.call(this,f,e,h)&&(this._skewX=e,this._skewY=h,g=!0);return g},clone:function(){var b=new cc.SkewBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._skewX,this._skewY);return b},startWithTarget:function(b){cc.SkewTo.prototype.startWithTarget.call(this,b);this._deltaX=this._skewX;this._deltaY=this._skewY;this._endSkewX=this._startSkewX+this._deltaX;this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var b=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.skewBy=function(e,d,f){return new cc.SkewBy(e,d,f)};cc.SkewBy.create=cc.skewBy;cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(g,f,k,j,h){cc.ActionInterval.prototype.ctor.call(this);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);this._delta=cc.p(0,0);void 0!==j&&this.initWithDuration(g,f,k,j,h)},initWithDuration:function(g,f,k,j,h){return cc.ActionInterval.prototype.initWithDuration.call(this,g)?(void 0===h&&(h=j,j=k,k=f.y,f=f.x),this._delta.x=f,this._delta.y=k,this._height=j,this._jumps=h,!0):!1},clone:function(){var b=new cc.JumpBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._delta,this._height,this._jumps);return b},startWithTarget:function(d){cc.ActionInterval.prototype.startWithTarget.call(this,d);var c=d.getPositionX();d=d.getPositionY();this._previousPosition.x=c;this._previousPosition.y=d;this._startPosition.x=c;this._startPosition.y=d},update:function(h){h=this._computeEaseTime(h);if(this.target){var g=h*this._jumps%1,g=4*this._height*g*(1-g),g=g+this._delta.y*h;h*=this._delta.x;var n=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var m=this.target.getPositionX(),k=this.target.getPositionY(),j=this._previousPosition;n.x=n.x+m-j.x;n.y=n.y+k-j.y;h+=n.x;g+=n.y;j.x=h;j.y=g;this.target.setPosition(h,g)}else{this.target.setPosition(n.x+h,n.y+g)}}},reverse:function(){var b=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.jumpBy=function(g,f,k,j,h){return new cc.JumpBy(g,f,k,j,h)};cc.JumpBy.create=cc.jumpBy;cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(g,f,k,j,h){cc.JumpBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);void 0!==j&&this.initWithDuration(g,f,k,j,h)},initWithDuration:function(g,f,k,j,h){return cc.JumpBy.prototype.initWithDuration.call(this,g,f,k,j,h)?(void 0===h&&(k=f.y,f=f.x),this._endPosition.x=f,this._endPosition.y=k,!0):!1},startWithTarget:function(b){cc.JumpBy.prototype.startWithTarget.call(this,b);this._delta.x=this._endPosition.x-this._startPosition.x;this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var b=new cc.JumpTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._endPosition,this._height,this._jumps);return b}});cc.jumpTo=function(g,f,k,j,h){return new cc.JumpTo(g,f,k,j,h)};cc.JumpTo.create=cc.jumpTo;cc.bezierAt=function(g,f,k,j,h){return Math.pow(1-h,3)*g+3*h*Math.pow(1-h,2)*f+3*Math.pow(h,2)*(1-h)*k+Math.pow(h,3)*j};cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(d,c){cc.ActionInterval.prototype.ctor.call(this);this._config=[];this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.ActionInterval.prototype.initWithDuration.call(this,d)?(this._config=c,!0):!1},clone:function(){var f=new cc.BezierBy;this._cloneDecoration(f);for(var e=[],h=0;h<this._config.length;h++){var g=this._config[h];e.push(cc.p(g.x,g.y))}f.initWithDuration(this._duration,e);return f},startWithTarget:function(d){cc.ActionInterval.prototype.startWithTarget.call(this,d);var c=d.getPositionX();d=d.getPositionY();this._previousPosition.x=c;this._previousPosition.y=d;this._startPosition.x=c;this._startPosition.y=d},update:function(h){h=this._computeEaseTime(h);if(this.target){var g=this._config,n=g[0].y,m=g[1].y,k=g[2].y,g=cc.bezierAt(0,g[0].x,g[1].x,g[2].x,h);h=cc.bezierAt(0,n,m,k,h);n=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var m=this.target.getPositionX(),k=this.target.getPositionY(),j=this._previousPosition;n.x=n.x+m-j.x;n.y=n.y+k-j.y;g+=n.x;h+=n.y;j.x=g;j.y=h;this.target.setPosition(g,h)}else{this.target.setPosition(n.x+g,n.y+h)}}},reverse:function(){var b=this._config,b=[cc.pAdd(b[1],cc.pNeg(b[2])),cc.pAdd(b[0],cc.pNeg(b[2])),cc.pNeg(b[2])],b=new cc.BezierBy(this._duration,b);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.bezierBy=function(d,c){return new cc.BezierBy(d,c)};cc.BezierBy.create=cc.bezierBy;cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(d,c){cc.BezierBy.prototype.ctor.call(this);this._toConfig=[];c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.ActionInterval.prototype.initWithDuration.call(this,d)?(this._toConfig=c,!0):!1},clone:function(){var b=new cc.BezierTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._toConfig);return b},startWithTarget:function(e){cc.BezierBy.prototype.startWithTarget.call(this,e);e=this._startPosition;var d=this._toConfig,f=this._config;f[0]=cc.pSub(d[0],e);f[1]=cc.pSub(d[1],e);f[2]=cc.pSub(d[2],e)}});cc.bezierTo=function(d,c){return new cc.BezierTo(d,c)};cc.BezierTo.create=cc.bezierTo;cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);void 0!==d&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){return cc.ActionInterval.prototype.initWithDuration.call(this,e)?(this._endScaleX=d,this._endScaleY=null!=f?f:d,!0):!1},clone:function(){var b=new cc.ScaleTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._endScaleX,this._endScaleY);return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._startScaleX=b.scaleX;this._startScaleY=b.scaleY;this._deltaX=this._endScaleX-this._startScaleX;this._deltaY=this._endScaleY-this._startScaleY},update:function(b){b=this._computeEaseTime(b);this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*b,this.target.scaleY=this._startScaleY+this._deltaY*b)}});cc.scaleTo=function(e,d,f){return new cc.ScaleTo(e,d,f)};cc.ScaleTo.create=cc.scaleTo;cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(b){cc.ScaleTo.prototype.startWithTarget.call(this,b);this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX;this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var b=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);this._cloneDecoration(b);this._reverseEaseList(b);return b},clone:function(){var b=new cc.ScaleBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._endScaleX,this._endScaleY);return b}});cc.scaleBy=function(e,d,f){return new cc.ScaleBy(e,d,f)};cc.ScaleBy.create=cc.scaleBy;cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(d,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.ActionInterval.prototype.initWithDuration.call(this,d)?(this._times=c,!0):!1},clone:function(){var b=new cc.Blink;this._cloneDecoration(b);b.initWithDuration(this._duration,this._times);return b},update:function(d){d=this._computeEaseTime(d);if(this.target&&!this.isDone()){var c=1/this._times;this.target.visible=d%c>c/2}},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._originalState=b.visible},stop:function(){this.target.visible=this._originalState;cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var b=new cc.Blink(this._duration,this._times);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.blink=function(d,c){return new cc.Blink(d,c)};cc.Blink.create=cc.blink;cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(d,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.ActionInterval.prototype.initWithDuration.call(this,d)?(this._toOpacity=c,!0):!1},clone:function(){var b=new cc.FadeTo;this._cloneDecoration(b);b.initWithDuration(this._duration,this._toOpacity);return b},update:function(d){d=this._computeEaseTime(d);var c=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=c+(this._toOpacity-c)*d},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._fromOpacity=b.opacity}});cc.fadeTo=function(d,c){return new cc.FadeTo(d,c)};cc.FadeTo.create=cc.fadeTo;cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(b){cc.FadeTo.prototype.ctor.call(this);null==b&&(b=0);this.initWithDuration(b,255)},reverse:function(){var b=new cc.FadeOut;b.initWithDuration(this._duration,0);this._cloneDecoration(b);this._reverseEaseList(b);return b},clone:function(){var b=new cc.FadeIn;this._cloneDecoration(b);b.initWithDuration(this._duration,this._toOpacity);return b},startWithTarget:function(b){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity);cc.FadeTo.prototype.startWithTarget.call(this,b)}});cc.fadeIn=function(b){return new cc.FadeIn(b)};cc.FadeIn.create=cc.fadeIn;cc.FadeOut=cc.FadeTo.extend({ctor:function(b){cc.FadeTo.prototype.ctor.call(this);null==b&&(b=0);this.initWithDuration(b,0)},reverse:function(){var b=new cc.FadeIn;b._reverseAction=this;b.initWithDuration(this._duration,255);this._cloneDecoration(b);this._reverseEaseList(b);return b},clone:function(){var b=new cc.FadeOut;this._cloneDecoration(b);b.initWithDuration(this._duration,this._toOpacity);return b}});cc.fadeOut=function(b){return new cc.FadeOut(b)};cc.FadeOut.create=cc.fadeOut;cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(f,e,h,g){cc.ActionInterval.prototype.ctor.call(this);this._to=cc.color(0,0,0);this._from=cc.color(0,0,0);void 0!==g&&this.initWithDuration(f,e,h,g)},initWithDuration:function(f,e,h,g){return cc.ActionInterval.prototype.initWithDuration.call(this,f)?(this._to=cc.color(e,h,g),!0):!1},clone:function(){var d=new cc.TintTo;this._cloneDecoration(d);var c=this._to;d.initWithDuration(this._duration,c.r,c.g,c.b);return d},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._from=this.target.color},update:function(e){e=this._computeEaseTime(e);var d=this._from,f=this._to;d&&(this.target.color=cc.color(d.r+(f.r-d.r)*e,d.g+(f.g-d.g)*e,d.b+(f.b-d.b)*e))}});cc.tintTo=function(f,e,h,g){return new cc.TintTo(f,e,h,g)};cc.TintTo.create=cc.tintTo;cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(f,e,h,g){cc.ActionInterval.prototype.ctor.call(this);void 0!==g&&this.initWithDuration(f,e,h,g)},initWithDuration:function(f,e,h,g){return cc.ActionInterval.prototype.initWithDuration.call(this,f)?(this._deltaR=e,this._deltaG=h,this._deltaB=g,!0):!1},clone:function(){var b=new cc.TintBy;this._cloneDecoration(b);b.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB);return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);b=b.color;this._fromR=b.r;this._fromG=b.g;this._fromB=b.b},update:function(b){b=this._computeEaseTime(b);this.target.color=cc.color(this._fromR+this._deltaR*b,this._fromG+this._deltaG*b,this._fromB+this._deltaB*b)},reverse:function(){var b=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);this._cloneDecoration(b);this._reverseEaseList(b);return b}});cc.tintBy=function(f,e,h,g){return new cc.TintBy(f,e,h,g)};cc.TintBy.create=cc.tintBy;cc.DelayTime=cc.ActionInterval.extend({update:function(b){},reverse:function(){var b=new cc.DelayTime(this._duration);this._cloneDecoration(b);this._reverseEaseList(b);return b},clone:function(){var b=new cc.DelayTime;this._cloneDecoration(b);b.initWithDuration(this._duration);return b}});cc.delayTime=function(b){return new cc.DelayTime(b)};cc.DelayTime.create=cc.delayTime;cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(b){cc.ActionInterval.prototype.ctor.call(this);this._other=null;b&&this.initWithAction(b)},initWithAction:function(b){if(!b){throw"cc.ReverseTime.initWithAction(): action must be non null"}if(b===this._other){throw"cc.ReverseTime.initWithAction(): the action was already passed in."}return cc.ActionInterval.prototype.initWithDuration.call(this,b._duration)?(this._other=b,!0):!1},clone:function(){var b=new cc.ReverseTime;this._cloneDecoration(b);b.initWithAction(this._other.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._other.startWithTarget(b)},update:function(b){b=this._computeEaseTime(b);this._other&&this._other.update(1-b)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop();cc.Action.prototype.stop.call(this)}});cc.reverseTime=function(b){return new cc.ReverseTime(b)};cc.ReverseTime.create=cc.reverseTime;cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,ctor:function(b){cc.ActionInterval.prototype.ctor.call(this);this._splitTimes=[];b&&this.initWithAnimation(b)},getAnimation:function(){return this._animation},setAnimation:function(b){this._animation=b},initWithAnimation:function(j){if(!j){throw"cc.Animate.initWithAnimation(): animation must be non-NULL"}var h=j.getDuration();if(this.initWithDuration(h*j.getLoops())){this._nextFrame=0;this.setAnimation(j);this._origFrame=null;this._executedLoops=0;var p=this._splitTimes,o=p.length=0,n=h/j.getTotalDelayUnits();j=j.getFrames();cc.arrayVerifyType(j,cc.AnimationFrame);for(var m=0;m<j.length;m++){var k=o*n/h,o=o+j[m].getDelayUnits();p.push(k)}return !0}return !1},clone:function(){var b=new cc.Animate;this._cloneDecoration(b);b.initWithAnimation(this._animation.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._animation.getRestoreOriginalFrame()&&(this._origFrame=b.displayFrame());this._executedLoops=this._nextFrame=0},update:function(g){g=this._computeEaseTime(g);1>g&&(g*=this._animation.getLoops(),(0|g)>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),g%=1);for(var f=this._animation.getFrames(),k=f.length,j=this._splitTimes,h=this._nextFrame;h<k;h++){if(j[h]<=g){this.target.setSpriteFrame(f[h].getSpriteFrame()),this._nextFrame=h+1}else{break}}},reverse:function(){var g=this._animation,f=g.getFrames(),k=[];cc.arrayVerifyType(f,cc.AnimationFrame);if(0<f.length){for(var j=f.length-1;0<=j;j--){var h=f[j];if(!h){break}k.push(h.clone())}}f=new cc.Animation(k,g.getDelayPerUnit(),g.getLoops());f.setRestoreOriginalFrame(g.getRestoreOriginalFrame());g=new cc.Animate(f);this._cloneDecoration(g);this._reverseEaseList(g);return g},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame);cc.Action.prototype.stop.call(this)}});cc.animate=function(b){return new cc.Animate(b)};cc.Animate.create=cc.animate;cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(d,c){cc.ActionInterval.prototype.ctor.call(this);c&&this.initWithTarget(d,c)},initWithTarget:function(d,c){return this.initWithDuration(c._duration)?(this._forcedTarget=d,this._action=c,!0):!1},clone:function(){var b=new cc.TargetedAction;this._cloneDecoration(b);b.initWithTarget(this._forcedTarget,this._action.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(b){b=this._computeEaseTime(b);this._action.update(b)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(b){this._forcedTarget!==b&&(this._forcedTarget=b)}});cc.targetedAction=function(d,c){return new cc.TargetedAction(d,c)};cc.TargetedAction.create=cc.targetedAction;cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return !0},step:function(b){this.update(1)},update:function(b){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}});cc.Show=cc.ActionInstant.extend({update:function(b){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}});cc.show=function(){return new cc.Show};cc.Show.create=cc.show;cc.Hide=cc.ActionInstant.extend({update:function(b){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}});cc.hide=function(){return new cc.Hide};cc.Hide.create=cc.hide;cc.ToggleVisibility=cc.ActionInstant.extend({update:function(b){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}});cc.toggleVisibility=function(){return new cc.ToggleVisibility};cc.ToggleVisibility.create=cc.toggleVisibility;cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(b){cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==b&&this.init(b)},update:function(b){this.target.removeFromParent(this._isNeedCleanUp)},init:function(b){this._isNeedCleanUp=b;return !0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}});cc.removeSelf=function(b){return new cc.RemoveSelf(b)};cc.RemoveSelf.create=cc.removeSelf;cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(b){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedX=!1;void 0!==b&&this.initWithFlipX(b)},initWithFlipX:function(b){this._flippedX=b;return !0},update:function(b){this.target.flippedX=this._flippedX},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var b=new cc.FlipX;b.initWithFlipX(this._flippedX);return b}});cc.flipX=function(b){return new cc.FlipX(b)};cc.FlipX.create=cc.flipX;cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(b){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedY=!1;void 0!==b&&this.initWithFlipY(b)},initWithFlipY:function(b){this._flippedY=b;return !0},update:function(b){this.target.flippedY=this._flippedY},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var b=new cc.FlipY;b.initWithFlipY(this._flippedY);return b}});cc.flipY=function(b){return new cc.FlipY(b)};cc.FlipY.create=cc.flipY;cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(d,c){cc.FiniteTimeAction.prototype.ctor.call(this);this._y=this._x=0;void 0!==d&&(void 0!==d.x&&(c=d.y,d=d.x),this.initWithPosition(d,c))},initWithPosition:function(d,c){this._x=d;this._y=c;return !0},update:function(b){this.target.setPosition(this._x,this._y)},clone:function(){var b=new cc.Place;b.initWithPosition(this._x,this._y);return b}});cc.place=function(d,c){return new cc.Place(d,c)};cc.Place.create=cc.place;cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_callFunc:null,_function:null,_data:null,ctor:function(e,d,f){cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==e&&(void 0===d?this.initWithFunction(e):this.initWithFunction(e,d,f))},initWithFunction:function(e,d,f){d?(this._data=f,this._callFunc=e,this._selectorTarget=d):e&&(this._function=e);return !0},execute:function(){null!=this._callFunc?this._callFunc.call(this._selectorTarget,this.target,this._data):this._function&&this._function.call(null,this.target)},update:function(b){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(b){b!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=b)},clone:function(){var b=new cc.CallFunc;this._selectorTarget?b.initWithFunction(this._callFunc,this._selectorTarget,this._data):this._function&&b.initWithFunction(this._function);return b}});cc.callFunc=function(e,d,f){return new cc.CallFunc(e,d,f)};cc.CallFunc.create=cc.callFunc;cc.ActionCamera=cc.ActionInterval.extend({_centerXOrig:0,_centerYOrig:0,_centerZOrig:0,_eyeXOrig:0,_eyeYOrig:0,_eyeZOrig:0,_upXOrig:0,_upYOrig:0,_upZOrig:0,ctor:function(){cc.ActionInterval.prototype.ctor.call(this);this._upZOrig=this._upYOrig=this._upXOrig=this._eyeZOrig=this._eyeYOrig=this._eyeXOrig=this._centerZOrig=this._centerYOrig=this._centerXOrig=0},startWithTarget:function(d){cc.ActionInterval.prototype.startWithTarget.call(this,d);d=d.getCamera();var c=d.getCenter();this._centerXOrig=c.x;this._centerYOrig=c.y;this._centerZOrig=c.z;c=d.getEye();this._eyeXOrig=c.x;this._eyeYOrig=c.y;this._eyeZOrig=c.z;d=d.getUp();this._upXOrig=d.x;this._upYOrig=d.y;this._upZOrig=d.z},clone:function(){return new cc.ActionCamera},reverse:function(){return new cc.ReverseTime(this)}});cc.OrbitCamera=cc.ActionCamera.extend({_radius:0,_deltaRadius:0,_angleZ:0,_deltaAngleZ:0,_angleX:0,_deltaAngleX:0,_radZ:0,_radDeltaZ:0,_radX:0,_radDeltaX:0,ctor:function(j,h,p,o,n,m,k){cc.ActionCamera.prototype.ctor.call(this);void 0!==k&&this.initWithDuration(j,h,p,o,n,m,k)},initWithDuration:function(j,h,p,o,n,m,k){return cc.ActionInterval.prototype.initWithDuration.call(this,j)?(this._radius=h,this._deltaRadius=p,this._angleZ=o,this._deltaAngleZ=n,this._angleX=m,this._deltaAngleX=k,this._radDeltaZ=cc.degreesToRadians(n),this._radDeltaX=cc.degreesToRadians(k),!0):!1},sphericalRadius:function(){var g,f;f=this.target.getCamera();var k=f.getEye();g=f.getCenter();f=k.x-g.x;var j=k.y-g.y;g=k.z-g.z;var k=Math.sqrt(Math.pow(f,2)+Math.pow(j,2)+Math.pow(g,2)),h=Math.sqrt(Math.pow(f,2)+Math.pow(j,2));0===h&&(h=cc.FLT_EPSILON);0===k&&(k=cc.FLT_EPSILON);g=Math.acos(g/k);f=0>f?Math.PI-Math.asin(j/h):Math.asin(j/h);return{newRadius:k/cc.Camera.getZEye(),zenith:g,azimuth:f}},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);b=this.sphericalRadius();isNaN(this._radius)&&(this._radius=b.newRadius);isNaN(this._angleZ)&&(this._angleZ=cc.radiansToDegrees(b.zenith));isNaN(this._angleX)&&(this._angleX=cc.radiansToDegrees(b.azimuth));this._radZ=cc.degreesToRadians(this._angleZ);this._radX=cc.degreesToRadians(this._angleX)},clone:function(){var b=new cc.OrbitCamera;b.initWithDuration(this._duration,this._radius,this._deltaRadius,this._angleZ,this._deltaAngleZ,this._angleX,this._deltaAngleX);return b},update:function(f){f=this._computeEaseTime(f);var e=(this._radius+this._deltaRadius*f)*cc.Camera.getZEye(),h=this._radZ+this._radDeltaZ*f,g=this._radX+this._radDeltaX*f;f=Math.sin(h)*Math.cos(g)*e+this._centerXOrig;g=Math.sin(h)*Math.sin(g)*e+this._centerYOrig;e=Math.cos(h)*e+this._centerZOrig;this.target.getCamera().setEye(f,g,e);this.target.setNodeDirty()}});cc.orbitCamera=function(j,h,p,o,n,m,k){return new cc.OrbitCamera(j,h,p,o,n,m,k)};cc.OrbitCamera.create=cc.orbitCamera;cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(b){cc.ActionInterval.prototype.ctor.call(this);b&&this.initWithAction(b)},initWithAction:function(b){if(!b){throw"cc.ActionEase.initWithAction(): action must be non nil"}return this.initWithDuration(b.getDuration())?(this._inner=b,!0):!1},clone:function(){var b=new cc.ActionEase;b.initWithAction(this._inner.clone());return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._inner.startWithTarget(this.target)},stop:function(){this._inner.stop();cc.ActionInterval.prototype.stop.call(this)},update:function(b){this._inner.update(b)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}});cc.actionEase=function(b){return new cc.ActionEase(b)};cc.ActionEase.create=cc.actionEase;cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(d,c){cc.ActionEase.prototype.ctor.call(this);void 0!==c&&this.initWithAction(d,c)},setRate:function(b){this._rate=b},getRate:function(){return this._rate},initWithAction:function(d,c){return cc.ActionEase.prototype.initWithAction.call(this,d)?(this._rate=c,!0):!1},clone:function(){var b=new cc.EaseRateAction;b.initWithAction(this._inner.clone(),this._rate);return b},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),1/this._rate)}});cc.easeRateAction=function(d,c){return new cc.EaseRateAction(d,c)};cc.EaseRateAction.create=cc.easeRateAction;cc.EaseIn=cc.EaseRateAction.extend({update:function(b){this._inner.update(Math.pow(b,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var b=new cc.EaseIn;b.initWithAction(this._inner.clone(),this._rate);return b}});cc.EaseIn.create=function(d,c){return new cc.EaseIn(d,c)};cc.easeIn=function(b){return{_rate:b,easing:function(c){return Math.pow(c,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}};cc.EaseOut=cc.EaseRateAction.extend({update:function(b){this._inner.update(Math.pow(b,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var b=new cc.EaseOut;b.initWithAction(this._inner.clone(),this._rate);return b}});cc.EaseOut.create=function(d,c){return new cc.EaseOut(d,c)};cc.easeOut=function(b){return{_rate:b,easing:function(c){return Math.pow(c,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}};cc.EaseInOut=cc.EaseRateAction.extend({update:function(b){b*=2;1>b?this._inner.update(0.5*Math.pow(b,this._rate)):this._inner.update(1-0.5*Math.pow(2-b,this._rate))},clone:function(){var b=new cc.EaseInOut;b.initWithAction(this._inner.clone(),this._rate);return b},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}});cc.EaseInOut.create=function(d,c){return new cc.EaseInOut(d,c)};cc.easeInOut=function(b){return{_rate:b,easing:function(c){c*=2;return 1>c?0.5*Math.pow(c,this._rate):1-0.5*Math.pow(2-c,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}};cc.EaseExponentialIn=cc.ActionEase.extend({update:function(b){this._inner.update(0===b?0:Math.pow(2,10*(b-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var b=new cc.EaseExponentialIn;b.initWithAction(this._inner.clone());return b}});cc.EaseExponentialIn.create=function(b){return new cc.EaseExponentialIn(b)};cc._easeExponentialInObj={easing:function(b){return 0===b?0:Math.pow(2,10*(b-1))},reverse:function(){return cc._easeExponentialOutObj}};cc.easeExponentialIn=function(){return cc._easeExponentialInObj};cc.EaseExponentialOut=cc.ActionEase.extend({update:function(b){this._inner.update(1===b?1:-Math.pow(2,-10*b)+1)},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var b=new cc.EaseExponentialOut;b.initWithAction(this._inner.clone());return b}});cc.EaseExponentialOut.create=function(b){return new cc.EaseExponentialOut(b)};cc._easeExponentialOutObj={easing:function(b){return 1===b?1:-Math.pow(2,-10*b)+1},reverse:function(){return cc._easeExponentialInObj}};cc.easeExponentialOut=function(){return cc._easeExponentialOutObj};cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(b){1!==b&&0!==b&&(b*=2,b=1>b?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2));this._inner.update(b)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var b=new cc.EaseExponentialInOut;b.initWithAction(this._inner.clone());return b}});cc.EaseExponentialInOut.create=function(b){return new cc.EaseExponentialInOut(b)};cc._easeExponentialInOutObj={easing:function(b){return 1!==b&&0!==b?(b*=2,1>b?0.5*Math.pow(2,10*(b-1)):0.5*(-Math.pow(2,-10*(b-1))+2)):b},reverse:function(){return cc._easeExponentialInOutObj}};cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj};cc.EaseSineIn=cc.ActionEase.extend({update:function(b){b=0===b||1===b?b:-1*Math.cos(b*Math.PI/2)+1;this._inner.update(b)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var b=new cc.EaseSineIn;b.initWithAction(this._inner.clone());return b}});cc.EaseSineIn.create=function(b){return new cc.EaseSineIn(b)};cc._easeSineInObj={easing:function(b){return 0===b||1===b?b:-1*Math.cos(b*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}};cc.easeSineIn=function(){return cc._easeSineInObj};cc.EaseSineOut=cc.ActionEase.extend({update:function(b){b=0===b||1===b?b:Math.sin(b*Math.PI/2);this._inner.update(b)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var b=new cc.EaseSineOut;b.initWithAction(this._inner.clone());return b}});cc.EaseSineOut.create=function(b){return new cc.EaseSineOut(b)};cc._easeSineOutObj={easing:function(b){return 0===b||1===b?b:Math.sin(b*Math.PI/2)},reverse:function(){return cc._easeSineInObj}};cc.easeSineOut=function(){return cc._easeSineOutObj};cc.EaseSineInOut=cc.ActionEase.extend({update:function(b){b=0===b||1===b?b:-0.5*(Math.cos(Math.PI*b)-1);this._inner.update(b)},clone:function(){var b=new cc.EaseSineInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}});cc.EaseSineInOut.create=function(b){return new cc.EaseSineInOut(b)};cc._easeSineInOutObj={easing:function(b){return 0===b||1===b?b:-0.5*(Math.cos(Math.PI*b)-1)},reverse:function(){return cc._easeSineInOutObj}};cc.easeSineInOut=function(){return cc._easeSineInOutObj};cc.EaseElastic=cc.ActionEase.extend({_period:0.3,ctor:function(d,c){cc.ActionEase.prototype.ctor.call(this);d&&this.initWithAction(d,c)},getPeriod:function(){return this._period},setPeriod:function(b){this._period=b},initWithAction:function(d,c){cc.ActionEase.prototype.initWithAction.call(this,d);this._period=null==c?0.3:c;return !0},reverse:function(){cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass.");return null},clone:function(){var b=new cc.EaseElastic;b.initWithAction(this._inner.clone(),this._period);return b}});cc.EaseElastic.create=function(d,c){return new cc.EaseElastic(d,c)};cc.EaseElasticIn=cc.EaseElastic.extend({update:function(d){var c=0;0===d||1===d?c=d:(c=this._period/4,d-=1,c=-Math.pow(2,10*d)*Math.sin((d-c)*Math.PI*2/this._period));this._inner.update(c)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var b=new cc.EaseElasticIn;b.initWithAction(this._inner.clone(),this._period);return b}});cc.EaseElasticIn.create=function(d,c){return new cc.EaseElasticIn(d,c)};cc._easeElasticInObj={easing:function(b){if(0===b||1===b){return b}b-=1;return -Math.pow(2,10*b)*Math.sin((b-0.075)*Math.PI*2/0.3)},reverse:function(){return cc._easeElasticOutObj}};cc.easeElasticIn=function(b){return b&&0.3!==b?{_period:b,easing:function(c){if(0===c||1===c){return c}c-=1;return -Math.pow(2,10*c)*Math.sin((c-this._period/4)*Math.PI*2/this._period)},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj};cc.EaseElasticOut=cc.EaseElastic.extend({update:function(d){var c=0;0===d||1===d?c=d:(c=this._period/4,c=Math.pow(2,-10*d)*Math.sin((d-c)*Math.PI*2/this._period)+1);this._inner.update(c)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var b=new cc.EaseElasticOut;b.initWithAction(this._inner.clone(),this._period);return b}});cc.EaseElasticOut.create=function(d,c){return new cc.EaseElasticOut(d,c)};cc._easeElasticOutObj={easing:function(b){return 0===b||1===b?b:Math.pow(2,-10*b)*Math.sin((b-0.075)*Math.PI*2/0.3)+1},reverse:function(){return cc._easeElasticInObj}};cc.easeElasticOut=function(b){return b&&0.3!==b?{_period:b,easing:function(c){return 0===c||1===c?c:Math.pow(2,-10*c)*Math.sin((c-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj};cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(e){var d=0,d=this._period;if(0===e||1===e){d=e}else{d||(d=this._period=0.3*1.5);var f=d/4;e=2*e-1;d=0>e?-0.5*Math.pow(2,10*e)*Math.sin((e-f)*Math.PI*2/d):Math.pow(2,-10*e)*Math.sin((e-f)*Math.PI*2/d)*0.5+1}this._inner.update(d)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var b=new cc.EaseElasticInOut;b.initWithAction(this._inner.clone(),this._period);return b}});cc.EaseElasticInOut.create=function(d,c){return new cc.EaseElasticInOut(d,c)};cc.easeElasticInOut=function(b){return{_period:b||0.3,easing:function(e){var g=0,g=this._period;if(0===e||1===e){g=e}else{g||(g=this._period=0.3*1.5);var f=g/4;e=2*e-1;g=0>e?-0.5*Math.pow(2,10*e)*Math.sin((e-f)*Math.PI*2/g):Math.pow(2,-10*e)*Math.sin((e-f)*Math.PI*2/g)*0.5+1}return g},reverse:function(){return cc.easeElasticInOut(this._period)}}};cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(b){if(b<1/2.75){return 7.5625*b*b}if(b<2/2.75){return b-=1.5/2.75,7.5625*b*b+0.75}if(b<2.5/2.75){return b-=2.25/2.75,7.5625*b*b+0.9375}b-=2.625/2.75;return 7.5625*b*b+0.984375},clone:function(){var b=new cc.EaseBounce;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}});cc.EaseBounce.create=function(b){return new cc.EaseBounce(b)};cc.EaseBounceIn=cc.EaseBounce.extend({update:function(b){b=1-this.bounceTime(1-b);this._inner.update(b)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var b=new cc.EaseBounceIn;b.initWithAction(this._inner.clone());return b}});cc.EaseBounceIn.create=function(b){return new cc.EaseBounceIn(b)};cc._bounceTime=function(b){if(b<1/2.75){return 7.5625*b*b}if(b<2/2.75){return b-=1.5/2.75,7.5625*b*b+0.75}if(b<2.5/2.75){return b-=2.25/2.75,7.5625*b*b+0.9375}b-=2.625/2.75;return 7.5625*b*b+0.984375};cc._easeBounceInObj={easing:function(b){return 1-cc._bounceTime(1-b)},reverse:function(){return cc._easeBounceOutObj}};cc.easeBounceIn=function(){return cc._easeBounceInObj};cc.EaseBounceOut=cc.EaseBounce.extend({update:function(b){b=this.bounceTime(b);this._inner.update(b)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var b=new cc.EaseBounceOut;b.initWithAction(this._inner.clone());return b}});cc.EaseBounceOut.create=function(b){return new cc.EaseBounceOut(b)};cc._easeBounceOutObj={easing:function(b){return cc._bounceTime(b)},reverse:function(){return cc._easeBounceInObj}};cc.easeBounceOut=function(){return cc._easeBounceOutObj};cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(d){var c=0,c=0.5>d?0.5*(1-this.bounceTime(1-2*d)):0.5*this.bounceTime(2*d-1)+0.5;this._inner.update(c)},clone:function(){var b=new cc.EaseBounceInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}});cc.EaseBounceInOut.create=function(b){return new cc.EaseBounceInOut(b)};cc._easeBounceInOutObj={easing:function(b){return b=0.5>b?0.5*(1-cc._bounceTime(1-2*b)):0.5*cc._bounceTime(2*b-1)+0.5},reverse:function(){return cc._easeBounceInOutObj}};cc.easeBounceInOut=function(){return cc._easeBounceInOutObj};cc.EaseBackIn=cc.ActionEase.extend({update:function(b){this._inner.update(0===b||1===b?b:b*b*(2.70158*b-1.70158))},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var b=new cc.EaseBackIn;b.initWithAction(this._inner.clone());return b}});cc.EaseBackIn.create=function(b){return new cc.EaseBackIn(b)};cc._easeBackInObj={easing:function(b){return 0===b||1===b?b:b*b*(2.70158*b-1.70158)},reverse:function(){return cc._easeBackOutObj}};cc.easeBackIn=function(){return cc._easeBackInObj};cc.EaseBackOut=cc.ActionEase.extend({update:function(b){b-=1;this._inner.update(b*b*(2.70158*b+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var b=new cc.EaseBackOut;b.initWithAction(this._inner.clone());return b}});cc.EaseBackOut.create=function(b){return new cc.EaseBackOut(b)};cc._easeBackOutObj={easing:function(b){b-=1;return b*b*(2.70158*b+1.70158)+1},reverse:function(){return cc._easeBackInObj}};cc.easeBackOut=function(){return cc._easeBackOutObj};cc.EaseBackInOut=cc.ActionEase.extend({update:function(b){b*=2;1>b?this._inner.update(b*b*(3.5949095*b-2.5949095)/2):(b-=2,this._inner.update(b*b*(3.5949095*b+2.5949095)/2+1))},clone:function(){var b=new cc.EaseBackInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}});cc.EaseBackInOut.create=function(b){return new cc.EaseBackInOut(b)};cc._easeBackInOutObj={easing:function(b){b*=2;if(1>b){return b*b*(3.5949095*b-2.5949095)/2}b-=2;return b*b*(3.5949095*b+2.5949095)/2+1},reverse:function(){return cc._easeBackInOutObj}};cc.easeBackInOut=function(){return cc._easeBackInOutObj};cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(b){cc.ActionEase.prototype.ctor.call(this,b)},_updateTime:function(g,f,k,j,h){return Math.pow(1-h,3)*g+3*h*Math.pow(1-h,2)*f+3*Math.pow(h,2)*(1-h)*k+Math.pow(h,3)*j},update:function(b){b=this._updateTime(this._p0,this._p1,this._p2,this._p3,b);this._inner.update(b)},clone:function(){var b=new cc.EaseBezierAction;b.initWithAction(this._inner.clone());b.setBezierParamer(this._p0,this._p1,this._p2,this._p3);return b},reverse:function(){var b=new cc.EaseBezierAction(this._inner.reverse());b.setBezierParamer(this._p3,this._p2,this._p1,this._p0);return b},setBezierParamer:function(f,e,h,g){this._p0=f||0;this._p1=e||0;this._p2=h||0;this._p3=g||0}});cc.EaseBezierAction.create=function(b){return new cc.EaseBezierAction(b)};cc.easeBezierAction=function(f,e,h,g){return{easing:function(a){return cc.EaseBezierAction.prototype._updateTime(f,e,h,g,a)},reverse:function(){return cc.easeBezierAction(g,h,e,f)}}};cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(b){return Math.pow(b,2)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuadraticActionIn;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}});cc.EaseQuadraticActionIn.create=function(b){return new cc.EaseQuadraticActionIn(b)};cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}};cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn};cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(b){return -b*(b-2)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuadraticActionOut;b.initWithAction();return b},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}});cc.EaseQuadraticActionOut.create=function(b){return new cc.EaseQuadraticActionOut(b)};cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}};cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut};cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(d){var c=d;d*=2;1>d?c=d*d*0.5:(--d,c=-0.5*(d*(d-2)-1));return c},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuadraticActionInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}});cc.EaseQuadraticActionInOut.create=function(b){return new cc.EaseQuadraticActionInOut(b)};cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}};cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut};cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(b){return b*b*b*b},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuarticActionIn;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}});cc.EaseQuarticActionIn.create=function(b){return new cc.EaseQuarticActionIn(b)};cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}};cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn};cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(b){b-=1;return -(b*b*b*b-1)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuarticActionOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}});cc.EaseQuarticActionOut.create=function(b){return new cc.EaseQuarticActionOut(b)};cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}};cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut};cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(b){b*=2;if(1>b){return 0.5*b*b*b*b}b-=2;return -0.5*(b*b*b*b-2)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuarticActionInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}});cc.EaseQuarticActionInOut.create=function(b){return new cc.EaseQuarticActionInOut(b)};cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}};cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut};cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(b){return b*b*b*b*b},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuinticActionIn;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}});cc.EaseQuinticActionIn.create=function(b){return new cc.EaseQuinticActionIn(b)};cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}};cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn};cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(b){b-=1;return b*b*b*b*b+1},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuinticActionOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}});cc.EaseQuinticActionOut.create=function(b){return new cc.EaseQuinticActionOut(b)};cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}};cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut};cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(b){b*=2;if(1>b){return 0.5*b*b*b*b*b}b-=2;return 0.5*(b*b*b*b*b+2)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseQuinticActionInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}});cc.EaseQuinticActionInOut.create=function(b){return new cc.EaseQuinticActionInOut(b)};cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}};cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut};cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(b){return -1*(Math.sqrt(1-b*b)-1)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCircleActionIn;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}});cc.EaseCircleActionIn.create=function(b){return new cc.EaseCircleActionIn(b)};cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}};cc.easeCircleActionIn=function(){return cc._easeCircleActionIn};cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(b){b-=1;return Math.sqrt(1-b*b)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCircleActionOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}});cc.EaseCircleActionOut.create=function(b){return new cc.EaseCircleActionOut(b)};cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}};cc.easeCircleActionOut=function(){return cc._easeCircleActionOut};cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(b){b*=2;if(1>b){return -0.5*(Math.sqrt(1-b*b)-1)}b-=2;return 0.5*(Math.sqrt(1-b*b)+1)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCircleActionInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}});cc.EaseCircleActionInOut.create=function(b){return new cc.EaseCircleActionInOut(b)};cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}};cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut};cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(b){return b*b*b},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCubicActionIn;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}});cc.EaseCubicActionIn.create=function(b){return new cc.EaseCubicActionIn(b)};cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}};cc.easeCubicActionIn=function(){return cc._easeCubicActionIn};cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(b){b-=1;return b*b*b+1},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCubicActionOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}});cc.EaseCubicActionOut.create=function(b){return new cc.EaseCubicActionOut(b)};cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}};cc.easeCubicActionOut=function(){return cc._easeCubicActionOut};cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(b){b*=2;if(1>b){return 0.5*b*b*b}b-=2;return 0.5*(b*b*b+2)},update:function(b){this._inner.update(this._updateTime(b))},clone:function(){var b=new cc.EaseCubicActionInOut;b.initWithAction(this._inner.clone());return b},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}});cc.EaseCubicActionInOut.create=function(b){return new cc.EaseCubicActionInOut(b)};cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}};cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut};cc.cardinalSplineAt=function(w,v,u,t,s,r){var p=r*r,o=p*r,n=(1-s)/2;s=n*(-o+2*p-r);var j=n*(-o+p)+(2*o-3*p+1);r=n*(o-2*p+r)+(-2*o+3*p);p=n*(o-p);return cc.p(w.x*s+v.x*j+u.x*r+t.x*p,w.y*s+v.y*j+u.y*r+t.y*p)};cc.reverseControlPoints=function(e){for(var d=[],f=e.length-1;0<=f;f--){d.push(cc.p(e[f].x,e[f].y))}return d};cc.cloneControlPoints=function(e){for(var d=[],f=0;f<e.length;f++){d.push(cc.p(e[f].x,e[f].y))}return d};cc.copyControlPoints=cc.cloneControlPoints;cc.getControlPointAt=function(e,d){var f=Math.min(e.length-1,Math.max(d,0));return e[f]};cc.reverseControlPointsInline=function(g){for(var f=g.length,k=0|f/2,j=0;j<k;++j){var h=g[j];g[j]=g[f-j-1];g[f-j-1]=h}};cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(e,d,f){cc.ActionInterval.prototype.ctor.call(this);this._points=[];void 0!==f&&this.initWithDuration(e,d,f)},initWithDuration:function(e,d,f){if(!d||0===d.length){throw"Invalid configuration. It must at least have one control point"}return cc.ActionInterval.prototype.initWithDuration.call(this,e)?(this.setPoints(d),this._tension=f,!0):!1},clone:function(){var b=new cc.CardinalSplineTo;b.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension);return b},startWithTarget:function(b){cc.ActionInterval.prototype.startWithTarget.call(this,b);this._deltaT=1/(this._points.length-1);this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY());this._accumulatedDiff=cc.p(0,0)},update:function(f){f=this._computeEaseTime(f);var e,h=this._points;if(1===f){e=h.length-1,f=1}else{var g=this._deltaT;e=0|f/g;f=(f-g*e)/g}e=cc.cardinalSplineAt(cc.getControlPointAt(h,e-1),cc.getControlPointAt(h,e-0),cc.getControlPointAt(h,e+1),cc.getControlPointAt(h,e+2),this._tension,f);cc.ENABLE_STACKABLE_ACTIONS&&(h=this.target.getPositionX()-this._previousPosition.x,f=this.target.getPositionY()-this._previousPosition.y,0!==h||0!==f)&&(g=this._accumulatedDiff,h=g.x+h,f=g.y+f,g.x=h,g.y=f,e.x+=h,e.y+=f);this.updatePosition(e)},reverse:function(){var b=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,b,this._tension)},updatePosition:function(b){this.target.setPosition(b);this._previousPosition=b},getPoints:function(){return this._points},setPoints:function(b){this._points=b}});cc.cardinalSplineTo=function(e,d,f){return new cc.CardinalSplineTo(e,d,f)};cc.CardinalSplineTo.create=cc.cardinalSplineTo;cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(e,d,f){cc.CardinalSplineTo.prototype.ctor.call(this);this._startPosition=cc.p(0,0);void 0!==f&&this.initWithDuration(e,d,f)},startWithTarget:function(b){cc.CardinalSplineTo.prototype.startWithTarget.call(this,b);this._startPosition.x=b.getPositionX();this._startPosition.y=b.getPositionY()},reverse:function(){for(var f=this._points.slice(),e,h=f[0],g=1;g<f.length;++g){e=f[g],f[g]=cc.pSub(e,h),h=e}f=cc.reverseControlPoints(f);h=f[f.length-1];f.pop();h.x=-h.x;h.y=-h.y;f.unshift(h);for(g=1;g<f.length;++g){e=f[g],e.x=-e.x,e.y=-e.y,e.x+=h.x,e.y+=h.y,h=f[g]=e}return cc.cardinalSplineBy(this._duration,f,this._tension)},updatePosition:function(e){var d=this._startPosition,f=e.x+d.x;e=e.y+d.y;this._previousPosition.x=f;this._previousPosition.y=e;this.target.setPosition(f,e)},clone:function(){var b=new cc.CardinalSplineBy;b.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension);return b}});cc.cardinalSplineBy=function(e,d,f){return new cc.CardinalSplineBy(e,d,f)};cc.CardinalSplineBy.create=cc.cardinalSplineBy;cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(d,c){c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,d,c,0.5)},clone:function(){var b=new cc.CatmullRomTo;b.initWithDuration(this._duration,cc.copyControlPoints(this._points));return b}});cc.catmullRomTo=function(d,c){return new cc.CatmullRomTo(d,c)};cc.CatmullRomTo.create=cc.catmullRomTo;cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(d,c){cc.CardinalSplineBy.prototype.ctor.call(this);c&&this.initWithDuration(d,c)},initWithDuration:function(d,c){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,d,c,0.5)},clone:function(){var b=new cc.CatmullRomBy;b.initWithDuration(this._duration,cc.copyControlPoints(this._points));return b}});cc.catmullRomBy=function(d,c){return new cc.CatmullRomBy(d,c)};cc.CatmullRomBy.create=cc.catmullRomBy;cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(d,c){}});cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(f,e,h,g){cc.ActionInterval.prototype.ctor.call(this);this.key="";void 0!==g&&this.initWithDuration(f,e,h,g)},initWithDuration:function(f,e,h,g){return cc.ActionInterval.prototype.initWithDuration.call(this,f)?(this.key=e,this.to=g,this.from=h,!0):!1},startWithTarget:function(b){if(!b||!b.updateTweenAction){throw"cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function"}cc.ActionInterval.prototype.startWithTarget.call(this,b);this.delta=this.to-this.from},update:function(b){this.target.updateTweenAction(this.to-this.delta*(1-b),this.key)},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var b=new cc.ActionTween;b.initWithDuration(this._duration,this.key,this.from,this.to);return b}});cc.actionTween=function(f,e,h,g){return new cc.ActionTween(f,e,h,g)};cc.ActionTween.create=cc.actionTween;cc.LabelAtlas=cc.AtlasNode.extend({_string:null,_mapStartChar:null,_textureLoaded:!1,_className:"LabelAtlas",ctor:function(g,f,k,j,h){cc.AtlasNode.prototype.ctor.call(this);this._renderCmd.setCascade();f&&cc.LabelAtlas.prototype.initWithString.call(this,g,f,k,j,h)},_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelAtlas.WebGLRenderCmd(this):new cc.LabelAtlas.CanvasRenderCmd(this)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},initWithString:function(u,t,s,r,p){var o=u+"",n,m;if(void 0===s){s=cc.loader.getRes(t);if(1!==parseInt(s.version,10)){return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1}t=cc.path.changeBasename(t,s.textureFilename);r=cc.contentScaleFactor();n=parseInt(s.itemWidth,10)/r;m=parseInt(s.itemHeight,10)/r;s=String.fromCharCode(parseInt(s.firstChar,10))}else{n=s||0,m=r||0,s=p||" "}var j=null,j=t instanceof cc.Texture2D?t:cc.textureCache.addImage(t);this._textureLoaded=t=j.isLoaded();t||(this._string=o,j.addEventListener("load",function(b){this.initWithTexture(j,n,m,o.length);this.string=this._string;this.setColor(this._renderCmd._displayedColor);this.dispatchEvent("load")},this));return this.initWithTexture(j,n,m,o.length)?(this._mapStartChar=s,this.string=o,!0):!1},setColor:function(b){cc.AtlasNode.prototype.setColor.call(this,b);this._renderCmd.updateAtlasValues()},getString:function(){return this._string},addChild:function(e,d,f){this._renderCmd._addChild(e);cc.Node.prototype.addChild.call(this,e,d,f)},updateAtlasValues:function(){this._renderCmd.updateAtlasValues()},setString:function(d){d=String(d);var c=d.length;this._string=d;this.setContentSize(c*this._itemWidth,this._itemHeight);this._renderCmd.setString(d);this._renderCmd.updateAtlasValues();this.quadsToDraw=c}});(function(){var b=cc.LabelAtlas.prototype;cc.defineGetterSetter(b,"opacity",b.getOpacity,b.setOpacity);cc.defineGetterSetter(b,"color",b.getColor,b.setColor);cc.defineGetterSetter(b,"string",b.getString,b.setString)})();cc.LabelAtlas.create=function(g,f,k,j,h){return new cc.LabelAtlas(g,f,k,j,h)};(function(){cc.LabelAtlas.CanvasRenderCmd=function(c){cc.AtlasNode.CanvasRenderCmd.call(this,c);this._needDraw=!1};var b=cc.LabelAtlas.CanvasRenderCmd.prototype=Object.create(cc.AtlasNode.CanvasRenderCmd.prototype);b.constructor=cc.LabelAtlas.CanvasRenderCmd;b.setCascade=function(){var c=this._node;c._cascadeOpacityEnabled=!0;c._cascadeColorEnabled=!1};b.updateAtlasValues=function(){for(var x=this._node,w=x._string||"",v=w.length,u=this._texture,t=x._itemWidth,s=x._itemHeight,r=0;r<v;r++){var p=w.charCodeAt(r)-x._mapStartChar.charCodeAt(0),o=parseInt(p%x._itemsPerRow,10),p=parseInt(p/x._itemsPerRow,10),o=cc.rect(o*t,p*s,t,s),p=w.charCodeAt(r),j=x.getChildByTag(r);j?32===p?(j.init(),j.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(j.initWithTexture(u,o),j.visible=!0):(j=new cc.Sprite,32===p?(j.init(),j.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):j.initWithTexture(u,o),cc.Node.prototype.addChild.call(x,j,0,r));j.setPosition(r*t+t/2,s/2)}};b.setString=function(f){f=this._node;if(f._children){f=f._children;for(var j=f.length,h=0;h<j;h++){var g=f[h];g&&!g._lateChild&&(g.visible=!1)}}};b._addChild=function(){child._lateChild=!0}})();(function(){cc.LabelAtlas.WebGLRenderCmd=function(c){cc.AtlasNode.WebGLRenderCmd.call(this,c);this._needDraw=!0};var b=cc.LabelAtlas.WebGLRenderCmd.prototype=Object.create(cc.AtlasNode.WebGLRenderCmd.prototype);b.constructor=cc.LabelAtlas.WebGLRenderCmd;b.setCascade=function(){var c=this._node;c._cascadeOpacityEnabled=!0;c._cascadeColorEnabled=!0};b.rendering=function(c){cc.AtlasNode.WebGLRenderCmd.prototype.rendering.call(this,c);cc.LABELATLAS_DEBUG_DRAW&&(c=this._node.getContentSize(),c=[cc.p(0,0),cc.p(c.width,0),cc.p(c.width,c.height),cc.p(0,c.height)],cc._drawingUtil.drawPoly(c,4,!0))};b.updateAtlasValues=function(){var R=this._node,Q=R._string,P=Q.length,O=this._textureAtlas,N=O.texture,M=N.pixelsWidth,N=N.pixelsHeight,L=R._itemWidth,K=R._itemHeight;R._ignoreContentScaleFactor||(L=R._itemWidth*cc.contentScaleFactor(),K=R._itemHeight*cc.contentScaleFactor());P>O.getCapacity()&&cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var J=O.quads,I=this._displayedColor,I={r:I.r,g:I.g,b:I.b,a:R._displayedOpacity},H=R._itemWidth,F=0;F<P;F++){var G=Q.charCodeAt(F)-R._mapStartChar.charCodeAt(0),D=G%R._itemsPerRow,E=0|G/R._itemsPerRow,C;cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(D=(2*D*L+1)/(2*M),G=D+(2*L-2)/(2*M),E=(2*E*K+1)/(2*N),C=E+(2*K-2)/(2*N)):(D=D*L/M,G=D+L/M,E=E*K/N,C=E+K/N);var B=J[F],j=B.tl,A=B.tr,o=B.bl,B=B.br;j.texCoords.u=D;j.texCoords.v=E;A.texCoords.u=G;A.texCoords.v=E;o.texCoords.u=D;o.texCoords.v=C;B.texCoords.u=G;B.texCoords.v=C;o.vertices.x=F*H;o.vertices.y=0;o.vertices.z=0;B.vertices.x=F*H+H;B.vertices.y=0;B.vertices.z=0;j.vertices.x=F*H;j.vertices.y=R._itemHeight;j.vertices.z=0;A.vertices.x=F*H+H;A.vertices.y=R._itemHeight;A.vertices.z=0;j.colors=I;A.colors=I;o.colors=I;B.colors=I}0<P&&(O.dirty=!0,R=O.totalQuads,P>R&&O.increaseTotalQuadsWith(P-R))};b.setString=function(c){c=c.length;c>this._textureAtlas.totalQuads&&this._textureAtlas.resizeCapacity(c)};b._addChild=function(){}})();cc.LABEL_AUTOMATIC_WIDTH=-1;cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_reusedChar:null,_textureLoaded:!1,_className:"LabelBMFont",_createRenderCmd:function(){return cc._renderType===cc._RENDER_TYPE_WEBGL?new cc.LabelBMFont.WebGLRenderCmd(this):new cc.LabelBMFont.CanvasRenderCmd(this)},_setString:function(g,f){f?this._initialString=g:this._string=g;var k=this._children;if(k){for(var j=0;j<k.length;j++){var h=k[j];h&&h.setVisible(!1)}}this._textureLoaded&&(this.createFontChars(),f&&this.updateLabel())},ctor:function(g,f,k,j,h){cc.SpriteBatchNode.prototype.ctor.call(this);this._imageOffset=cc.p(0,0);this._reusedChar=[];this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0;this.initWithString(g,f,k,j,h)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(d,c){this.addEventListener("load",d,c)},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(e){this._opacityModifyRGB=e;if(e=this._children){for(var d=0;d<e.length;d++){var f=e[d];f&&(f.opacityModifyRGB=this._opacityModifyRGB)}}},_changeTextureColor:function(){this._renderCmd._changeTextureColor()},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(h,g,n,m,k){h=h||"";this._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");if(g){var j=cc.loader.getRes(g);if(!j){return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1}this._config=j;this._fntFile=g;g=cc.textureCache.addImage(j.atlasName);(this._textureLoaded=j=g.isLoaded())||g.addEventListener("load",function(b){this._textureLoaded=!0;this.initWithTexture(b,this._initialString.length);this.setString(this._initialString,!0);this.dispatchEvent("load")},this)}else{g=new cc.Texture2D,j=new Image,g.initWithElement(j),this._textureLoaded=!1}return this.initWithTexture(g,h.length)?(this._alignment=m||cc.TEXT_ALIGNMENT_LEFT,this._imageOffset=k||cc.p(0,0),this._width=null==n?-1:n,this._realOpacity=255,this._realColor=cc.color(255,255,255,255),this._contentSize.width=0,this._contentSize.height=0,this.setAnchorPoint(0.5,0.5),this._renderCmd._initBatchTexture(),this.setString(h,!0),!0):!1},createFontChars:function(){var G=this._renderCmd._texture||this.textureAtlas.texture,F=0,E=cc.size(0,0),D=0,C=1,B=this._string,A=B?B.length:0;if(0!==A){var z,y=this._config,x=y.kerningDict,w=y.commonHeight,o=y.fontDefDictionary;for(z=0;z<A-1;z++){10===B.charCodeAt(z)&&C++}var K=w*C,C=-(w-w*C),j=-1;for(z=0;z<A;z++){if(w=B.charCodeAt(z),0!==w){if(10===w){F=0,C-=y.commonHeight}else{var I=x[j<<16|w&65535]||0,J=o[w];if(J){var H=cc.rect(J.rect.x,J.rect.y,J.rect.width,J.rect.height),H=cc.rectPixelsToPoints(H);H.x+=this._imageOffset.x;H.y+=this._imageOffset.y;(j=this.getChildByTag(z))?this._renderCmd._updateCharTexture(j,H,w):(j=new cc.Sprite,j.initWithTexture(G,H,!1),j._newTextureWhenChangeColor=!0,this.addChild(j,0,z));j.opacityModifyRGB=this._opacityModifyRGB;this._renderCmd._updateCharColorAndOpacity(j);H=cc.p(F+J.xOffset+0.5*J.rect.width+I,C+(y.commonHeight-J.yOffset)-0.5*H.height*cc.contentScaleFactor());j.setPosition(cc.pointPixelsToPoints(H));F+=J.xAdvance+I;j=w;D<F&&(D=F)}else{cc.log("cocos2d: LabelBMFont: character not found "+B[z])}}}}E.width=J&&J.xAdvance<J.rect.width?D-J.xAdvance+J.rect.width:D;E.height=K;this.setContentSize(cc.sizePixelsToPoints(E))}},updateString:function(g){var f=this._children;if(f){for(var k=0,j=f.length;k<j;k++){var h=f[k];h&&(h.visible=!1)}}this._config&&this.createFontChars();g||this.updateLabel()},getString:function(){return this._initialString},setString:function(d,c){d=String(d);null==c&&(c=!0);null!=d&&cc.isString(d)||(d+="");this._initialString=d;this._setString(d,c)},_setStringForSetter:function(b){this.setString(b,!1)},setCString:function(b){this.setString(b,!0)},_getCharsWidth:function(f,e){if(0>=e){return 0}var h=this.getChildByTag(f),g=this.getChildByTag(f+e);return this._getLetterPosXLeft(g)-this._getLetterPosXLeft(h)},_checkWarp:function(A,z,y,x){for(var w=A[z],v=0,u=0;u<z;u++){v+=A[u].length}var v=v+z-x,t=this._getCharsWidth(v,A[z].length-1);if(t>y&&1<w.length){x=y/t*w.length|0;for(var u=w.substr(x),s=t-this._getCharsWidth(v+x,u.length-1),r,o=0,j=0;s>y&&100>j++;){x*=y/s,x|=0,u=w.substr(x),s=t-this._getCharsWidth(v+x,u.length-1)}for(j=0;s<y&&100>j++;){u&&(o=(r=cc.LabelTTF._wordRex.exec(u))?r[0].length:1,r=u),this._lineBreakWithoutSpaces&&(o=0),x+=o,u=w.substr(x),s=t-this._getCharsWidth(v+x,u.length-1)}x-=o;0===x&&(x=1,r=r.substr(1));y=w.substr(0,x);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(r||u)&&(o=(v=cc.LabelTTF._lastWordRex.exec(y))?v[0].length:0,this._lineBreakWithoutSpaces&&(o=0),x-=o,r=w.substr(x),y=w.substr(0,x));cc.LabelTTF._firsrEnglish.test(r)&&(v=cc.LabelTTF._lastEnglish.exec(y))&&y!==v[0]&&(o=v[0].length,this._lineBreakWithoutSpaces&&(o=0),x-=o,r=w.substr(x),y=w.substr(0,x));A[z]=r||u;A.splice(z,0,y)}},updateLabel:function(){this.string=this._initialString;var u,t,s;if(0<this._width){var r=this.string.split("\n"),p="",o=0,n=0;for(u=0;u<r.length;u++){n=r.length,this._checkWarp(r,u,this._width*this._scaleX,o),n<r.length&&o++,0<u&&(p+="\n"),p+=r[u]}p+=String.fromCharCode(0);this._setString(p,!1)}if(this._alignment!==cc.TEXT_ALIGNMENT_LEFT){for(r=u=0,p=this._string.length,o=[],n=0;n<p;n++){if(10===this._string[n].charCodeAt(0)||0===this._string[n].charCodeAt(0)){t=0;var m=o.length;if(0===m){r++}else{if(s=u+m-1+r,!(0>s)){var j=this.getChildByTag(s);if(null!=j){t=j.getPositionX()+j._getWidth()/2;j=0;switch(this._alignment){case cc.TEXT_ALIGNMENT_CENTER:j=this.width/2-t/2;break;case cc.TEXT_ALIGNMENT_RIGHT:j=this.width-t}if(0!==j){for(t=0;t<m;t++){s=u+t+r,0>s||(s=this.getChildByTag(s))&&(s.x+=j)}}u+=m;r++;o.length=0}}}}else{o.push(this._string[u])}}}},setAlignment:function(b){this._alignment=b;this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(b){this._width=b;this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(b){this._lineBreakWithoutSpaces=b;this.updateLabel()},setScale:function(d,c){cc.Node.prototype.setScale.call(this,d,c);this.updateLabel()},setScaleX:function(b){cc.Node.prototype.setScaleX.call(this,b);this.updateLabel()},setScaleY:function(b){cc.Node.prototype.setScaleY.call(this,b);this.updateLabel()},setFntFile:function(d){if(null!=d&&d!==this._fntFile){var c=cc.loader.getRes(d);c?(this._fntFile=d,this._config=c,d=cc.textureCache.addImage(c.atlasName),this._textureLoaded=c=d.isLoaded(),this.texture=d,this._renderCmd._updateFntFileTexture(),c?this.createFontChars():d.addEventListener("load",function(b){this._textureLoaded=!0;this.texture=b;this.createFontChars();this._changeTextureColor();this.updateLabel();this.dispatchEvent("load")},this)):cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file")}},getFntFile:function(){return this._fntFile},setTexture:function(b){this._renderCmd.setTexture(b)},setAnchorPoint:function(d,c){cc.Node.prototype.setAnchorPoint.call(this,d,c);this.updateLabel()},_setAnchorX:function(b){cc.Node.prototype._setAnchorX.call(this,b);this.updateLabel()},_setAnchorY:function(b){cc.Node.prototype._setAnchorY.call(this,b);this.updateLabel()},_atlasNameFromFntFile:function(b){},_kerningAmountForFirst:function(f,e){var h=0;if(this._configuration.kerningDictionary){var g=this._configuration.kerningDictionary[(f<<16|e&65535).toString()];g&&(h=g.amount)}return h},_getLetterPosXLeft:function(b){return b.getPositionX()*this._scaleX-b._getWidth()*this._scaleX*b._getAnchorX()},_getLetterPosXRight:function(b){return b.getPositionX()*this._scaleX+b._getWidth()*this._scaleX*b._getAnchorX()},_isspace_unicode:function(b){b=b.charCodeAt(0);return 9<=b&&13>=b||32===b||133===b||160===b||5760===b||8192<=b&&8202>=b||8232===b||8233===b||8239===b||8287===b||12288===b},_utf8_trim_ws:function(e){var d=e.length;if(!(0>=d)&&(d-=1,this._isspace_unicode(e[d]))){for(var f=d-1;0<=f;--f){if(this._isspace_unicode(e[f])){d=f}else{break}}this._utf8_trim_from(e,d)}},_utf8_trim_from:function(e,d){var f=e.length;d>=f||0>d||e.splice(d,f)}});(function(){var b=cc.LabelBMFont.prototype;cc.EventHelper.prototype.apply(b);cc.defineGetterSetter(b,"string",b.getString,b._setStringForSetter);cc.defineGetterSetter(b,"boundingWidth",b._getBoundingWidth,b.setBoundingWidth);cc.defineGetterSetter(b,"textAlign",b._getAlignment,b.setAlignment)})();cc.LabelBMFont.create=function(g,f,k,j,h){return new cc.LabelBMFont(g,f,k,j,h)};cc._fntLoader={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(j){j=j.match(this.ITEM_EXP);var h={};if(j){for(var p=0,o=j.length;p<o;p++){var n=j[p],m=n.indexOf("\x3d"),k=n.substring(0,m),n=n.substring(m+1);n.match(this.INT_EXP)?n=parseInt(n):'"'===n[0]&&(n=n.substring(1,n.length-1));h[k]=n}}return h},parseFnt:function(k,j){var s={},r=this._parseStrToObj(k.match(this.INFO_EXP)[0]).padding.split(",");parseInt(r[0]);parseInt(r[1]);parseInt(r[2]);parseInt(r[3]);r=this._parseStrToObj(k.match(this.COMMON_EXP)[0]);s.commonHeight=r.lineHeight;if(cc._renderType===cc._RENDER_TYPE_WEBGL){var p=cc.configuration.getMaxTextureSize();(r.scaleW>p.width||r.scaleH>p.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==r.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");r=this._parseStrToObj(k.match(this.PAGE_EXP)[0]);0!==r.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found");s.atlasName=cc.path.changeBasename(j,r.file);for(var o=k.match(this.CHAR_EXP),n=s.fontDefDictionary={},r=0,p=o.length;r<p;r++){var m=this._parseStrToObj(o[r]);n[m.id]={rect:{x:m.x,y:m.y,width:m.width,height:m.height},xOffset:m.xoffset,yOffset:m.yoffset,xAdvance:m.xadvance}}o=s.kerningDict={};if(n=k.match(this.KERNING_EXP)){for(r=0,p=n.length;r<p;r++){m=this._parseStrToObj(n[r]),o[m.first<<16|m.second&65535]=m.amount}}return s},load:function(g,f,k,j){var h=this;cc.loader.loadTxt(g,function(b,d){if(b){return j(b)}j(null,h.parseFnt(d,f))})}};cc.loader.register(["fnt"],cc._fntLoader);(function(){cc.LabelBMFont.CanvasRenderCmd=function(c){cc.SpriteBatchNode.CanvasRenderCmd.call(this,c);this._needDraw=!0};var b=cc.LabelBMFont.CanvasRenderCmd.prototype=Object.create(cc.SpriteBatchNode.CanvasRenderCmd.prototype);b.constructor=cc.LabelBMFont.CanvasRenderCmd;b.rendering=function(){void 0};b._updateCharTexture=function(e,g,f){32===f?e.setTextureRect(g,!1,cc.size(0,0)):(e.setTextureRect(g,!1),e.visible=!0)};b._updateCharColorAndOpacity=function(c){c._displayedColor=this._displayedColor;c._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty);c._displayedOpacity=this._displayedOpacity;c._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)};b._updateFntFileTexture=function(){var c=this._node;c._originalTexture=c.texture};b.setTexture=function(j){for(var r=this._node._children,p=this._displayedColor,o=0;o<r.length;o++){var n=r[o],m=n._renderCmd,k=m._displayedColor;if(this._texture===m._texture||k.r===p.r&&k.g===p.g&&k.b===p.b){n.texture=j}}this._texture=j};b._changeTextureColor=cc.sys._supportCanvasNewBlendModes?function(){var g=this._node,m=g.getTexture();if(m&&0<m.getContentSize().width){var k=this._originalTexture.getHtmlElementObj();if(k){var j=m.getHtmlElementObj(),h=cc.rect(0,0,k.width,k.height);j instanceof HTMLCanvasElement&&!g._rectRotated?cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(k,this._displayedColor,h,j):(j=cc.Sprite.CanvasRenderCmd._generateTintImageWithMultiply(k,this._displayedColor,h),m=new cc.Texture2D,m.initWithElement(j),m.handleLoadedTexture());g.setTexture(m)}}}:function(){var f=this._node,j,h=f.getTexture();if(h&&0<h.getContentSize().width&&(j=h.getHtmlElementObj())){var g=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());g&&(j instanceof HTMLCanvasElement&&!this._rectRotated?(cc.Sprite.CanvasRenderCmd._generateTintImage(j,g,this._displayedColor,null,j),this.setTexture(h)):(j=cc.Sprite.CanvasRenderCmd._generateTintImage(j,g,this._displayedColor),h=new cc.Texture2D,h.initWithElement(j),h.handleLoadedTexture(),f.setTexture(h)))}};b._updateChildrenDisplayedOpacity=function(c){cc.Node.prototype.updateDisplayedOpacity.call(c,this._displayedOpacity)};b._updateChildrenDisplayedColor=function(c){cc.Node.prototype.updateDisplayedColor.call(c,this._displayedColor)};b._initBatchTexture=function(){}})();(function(){cc.LabelBMFont.WebGLRenderCmd=function(c){cc.SpriteBatchNode.WebGLRenderCmd.call(this,c);this._needDraw=!0};var b=cc.LabelBMFont.WebGLRenderCmd.prototype=Object.create(cc.SpriteBatchNode.WebGLRenderCmd.prototype);b.constructor=cc.LabelBMFont.WebGLRenderCmd;b._updateCharTexture=function(e,g,f){e.setTextureRect(g,!1);e.visible=!0};b._updateFntFileTexture=function(){};b._changeTextureColor=function(){};b._updateChildrenDisplayedOpacity=function(c){c.updateDisplayedOpacity(this._displayedOpacity)};b._updateChildrenDisplayedColor=function(c){c.updateDisplayedColor(this._displayedColor)};b._initBatchTexture=function(){var e=this._node,g=e.textureAtlas.texture;e._opacityModifyRGB=g.hasPremultipliedAlpha();var f=e._reusedChar=new cc.Sprite;f.initWithTexture(g,cc.rect(0,0,0,0),!1);f.batchNode=e};b.rendering=function(d){cc.SpriteBatchNode.WebGLRenderCmd.prototype.rendering.call(this,d);d=this._node;if(cc.LABELBMFONT_DEBUG_DRAW){d=d.getContentSize();var e=cc.p(0|-this._anchorPointInPoints.x,0|-this._anchorPointInPoints.y);d=[cc.p(e.x,e.y),cc.p(e.x+d.width,e.y),cc.p(e.x+d.width,e.y+d.height),cc.p(e.x,e.y+d.height)];cc._drawingUtil.setDrawColor(0,255,0,255);cc._drawingUtil.drawPoly(d,4,!0)}};b._updateCharColorAndOpacity=function(){}})();cc._globalFontSize=cc.ITEM_SIZE;cc._globalFontName="Arial";cc._globalFontNameRelease=!1;cc.MenuItem=cc.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(e,d){var f=cc.Node.prototype;f.ctor.call(this);this._callback=this._target=null;this._enabled=this._isSelected=!1;f.setAnchorPoint.call(this,0.5,0.5);this._target=d||null;if(this._callback=e||null){this._enabled=!0}},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(b){},isOpacityModifyRGB:function(){return !1},setTarget:function(d,c){this._target=c;this._callback=d},isEnabled:function(){return this._enabled},setEnabled:function(b){this._enabled=b},initWithCallback:function(d,c){this.anchorY=this.anchorX=0.5;this._target=c;this._callback=d;this._enabled=!0;this._isSelected=!1;return !0},rect:function(){var e=this._position,d=this._contentSize,f=this._anchorPoint;return cc.rect(e.x-d.width*f.x,e.y-d.height*f.y,d.width,d.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(d,c){this._target=c;this._callback=d},activate:function(){if(this._enabled){var d=this._target,c=this._callback;if(c){if(d&&cc.isString(c)){d[c](this)}else{d&&cc.isFunction(c)?c.call(d,this):c(this)}}}}});_p=cc.MenuItem.prototype;cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled);cc.MenuItem.create=function(d,c){return new cc.MenuItem(d,c)};cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_originalScale:0,_colorBackup:null,ctor:function(e,d,f){cc.MenuItem.prototype.ctor.call(this,d,f);this._colorBackup=this._label=this._disabledColor=null;e&&(this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(e),this.cascadeOpacity=this.cascadeColor=!0)},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(b){this._disabledColor=b},getLabel:function(){return this._label},setLabel:function(b){b&&(this.addChild(b),b.anchorX=0,b.anchorY=0,this.width=b.width,this.height=b.height);this._label&&this.removeChild(this._label,!0);this._label=b},setEnabled:function(d){if(this._enabled!==d){var c=this._label;d?c.color=this._colorBackup:(this._colorBackup=c.color,c.color=this._disabledColor)}cc.MenuItem.prototype.setEnabled.call(this,d)},setOpacity:function(b){this._label.opacity=b},getOpacity:function(){return this._label.opacity},setColor:function(b){this._label.color=b},getColor:function(){return this._label.color},initWithLabel:function(e,d,f){this.initWithCallback(d,f);this._originalScale=1;this._colorBackup=cc.color.WHITE;this._disabledColor=cc.color(126,126,126);this.setLabel(e);return this.cascadeOpacity=this.cascadeColor=!0},setString:function(b){this._label.string=b;this.width=this._label.width;this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,cc.MenuItem.prototype.activate.call(this))},selected:function(){if(this._enabled){cc.MenuItem.prototype.selected.call(this);var b=this.getActionByTag(cc.ZOOM_ACTION_TAG);b?this.stopAction(b):this._originalScale=this.scale;b=cc.scaleTo(0.1,1.2*this._originalScale);b.setTag(cc.ZOOM_ACTION_TAG);this.runAction(b)}},unselected:function(){if(this._enabled){cc.MenuItem.prototype.unselected.call(this);this.stopActionByTag(cc.ZOOM_ACTION_TAG);var b=cc.scaleTo(0.1,this._originalScale);b.setTag(cc.ZOOM_ACTION_TAG);this.runAction(b)}}});_p=cc.MenuItemLabel.prototype;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor);cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel);cc.MenuItemLabel.create=function(e,d,f){return new cc.MenuItemLabel(e,d,f)};cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(k,j,s,r,p,o,n){var m;k&&0<k.length&&(m=new cc.LabelAtlas(k,j,s,r,p));cc.MenuItemLabel.prototype.ctor.call(this,m,o,n)},initWithString:function(k,j,s,r,p,o,n){if(!k||0===k.length){throw"cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0"}var m=new cc.LabelAtlas;m.initWithString(k,j,s,r,p);this.initWithLabel(m,o,n);return !0}});cc.MenuItemAtlasFont.create=function(j,h,p,o,n,m,k){return new cc.MenuItemAtlasFont(j,h,p,o,n,m,k)};cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(f,e,h){var g;f&&0<f.length?(this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,g=new cc.LabelTTF(f,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName="");cc.MenuItemLabel.prototype.ctor.call(this,g,e,h)},initWithString:function(e,d,f){if(!e||0===e.length){throw"Value should be non-null and its length should be greater than 0"}this._fontName=cc._globalFontName;this._fontSize=cc._globalFontSize;e=new cc.LabelTTF(e,this._fontName,this._fontSize);this.initWithLabel(e,d,f);return !0},setFontSize:function(b){this._fontSize=b;this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(b){this._fontName=b;this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var b=new cc.LabelTTF(this._label.string,this._fontName,this._fontSize);this.setLabel(b)}});cc.MenuItemFont.setFontSize=function(b){cc._globalFontSize=b};cc.MenuItemFont.fontSize=function(){return cc._globalFontSize};cc.MenuItemFont.setFontName=function(b){cc._globalFontNameRelease&&(cc._globalFontName="");cc._globalFontName=b;cc._globalFontNameRelease=!0};_p=cc.MenuItemFont.prototype;cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize);cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName);cc.MenuItemFont.fontName=function(){return cc._globalFontName};cc.MenuItemFont.create=function(e,d,f){return new cc.MenuItemFont(e,d,f)};cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(k,j,s,r,p){cc.MenuItem.prototype.ctor.call(this);this._disabledImage=this._selectedImage=this._normalImage=null;if(void 0!==j){var o,n,m;void 0!==p?(o=s,m=r,n=p):void 0!==r&&cc.isFunction(r)?(o=s,m=r):void 0!==r&&cc.isFunction(s)?(n=r,m=s,o=null):void 0===s&&(o=null);this.initWithNormalSprite(k,j,o,m,n)}},getNormalImage:function(){return this._normalImage},setNormalImage:function(b){this._normalImage!==b&&(b&&(this.addChild(b,0,cc.NORMAL_TAG),b.anchorX=0,b.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=b,this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),b.textureLoaded&&!b.textureLoaded()&&b.addEventListener("load",function(c){this.width=c.width;this.height=c.height},this))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(b){this._selectedImage!==b&&(b&&(this.addChild(b,0,cc.SELECTED_TAG),b.anchorX=0,b.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=b,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(b){this._disabledImage!==b&&(b&&(this.addChild(b,0,cc.DISABLE_TAG),b.anchorX=0,b.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=b,this._updateImagesVisibility())},initWithNormalSprite:function(g,f,k,j,h){this.initWithCallback(j,h);this.setNormalImage(g);this.setSelectedImage(f);this.setDisabledImage(k);if(g=this._normalImage){this.width=g.width,this.height=g.height,g.textureLoaded&&!g.textureLoaded()&&g.addEventListener("load",function(b){this.width=b.width;this.height=b.height;this.cascadeOpacity=this.cascadeColor=!0},this)}return this.cascadeOpacity=this.cascadeColor=!0},setColor:function(b){this._normalImage.color=b;this._selectedImage&&(this._selectedImage.color=b);this._disabledImage&&(this._disabledImage.color=b)},getColor:function(){return this._normalImage.color},setOpacity:function(b){this._normalImage.opacity=b;this._selectedImage&&(this._selectedImage.opacity=b);this._disabledImage&&(this._disabledImage.opacity=b)},getOpacity:function(){return this._normalImage.opacity},selected:function(){cc.MenuItem.prototype.selected.call(this);this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=!0):this._normalImage.visible=!0)},unselected:function(){cc.MenuItem.prototype.unselected.call(this);this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage&&(this._disabledImage.visible=!1))},setEnabled:function(b){this._enabled!==b&&(cc.MenuItem.prototype.setEnabled.call(this,b),this._updateImagesVisibility())},_updateImagesVisibility:function(){var e=this._normalImage,d=this._selectedImage,f=this._disabledImage;this._enabled?(e&&(e.visible=!0),d&&(d.visible=!1),f&&(f.visible=!1)):f?(e&&(e.visible=!1),d&&(d.visible=!1),f&&(f.visible=!0)):(e&&(e.visible=!0),d&&(d.visible=!1))}});_p=cc.MenuItemSprite.prototype;cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage);cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage);cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage);cc.MenuItemSprite.create=function(g,f,k,j,h){return new cc.MenuItemSprite(g,f,k,j,h||void 0)};cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(w,v,u,t,s){var r=null,p=null,o=null,n=null,j=null;void 0===w?cc.MenuItemSprite.prototype.ctor.call(this):(r=new cc.Sprite(w),v&&(p=new cc.Sprite(v)),void 0===t?n=u:void 0===s?(n=u,j=t):s&&(o=new cc.Sprite(u),n=t,j=s),cc.MenuItemSprite.prototype.ctor.call(this,r,p,o,n,j))},setNormalSpriteFrame:function(b){this.setNormalImage(new cc.Sprite(b))},setSelectedSpriteFrame:function(b){this.setSelectedImage(new cc.Sprite(b))},setDisabledSpriteFrame:function(b){this.setDisabledImage(new cc.Sprite(b))},initWithNormalImage:function(k,j,s,r,p){var o=null,n=null,m=null;k&&(o=new cc.Sprite(k));j&&(n=new cc.Sprite(j));s&&(m=new cc.Sprite(s));return this.initWithNormalSprite(o,n,m,r,p)}});cc.MenuItemImage.create=function(g,f,k,j,h){return new cc.MenuItemImage(g,f,k,j,h)};cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this);this._selectedIndex=0;this.subItems=[];this._opacity=0;this._color=cc.color.WHITE;0<arguments.length&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(d){this._opacity=d;if(this.subItems&&0<this.subItems.length){for(var c=0;c<this.subItems.length;c++){this.subItems[c].opacity=d}}this._color.a=d},getColor:function(){var b=this._color;return cc.color(b.r,b.g,b.b,b.a)},setColor:function(d){var c=this._color;c.r=d.r;c.g=d.g;c.b=d.b;if(this.subItems&&0<this.subItems.length){for(c=0;c<this.subItems.length;c++){this.subItems[c].setColor(d)}}void 0===d.a||d.a_undefined||this.setOpacity(d.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(e){if(e!==this._selectedIndex){this._selectedIndex=e;(e=this.getChildByTag(cc.CURRENT_ITEM))&&e.removeFromParent(!1);e=this.subItems[this._selectedIndex];this.addChild(e,0,cc.CURRENT_ITEM);var d=e.width,f=e.height;this.width=d;this.height=f;e.setPosition(d/2,f/2)}},getSubItems:function(){return this.subItems},setSubItems:function(b){this.subItems=b},initWithItems:function(f){var e=f.length;cc.isFunction(f[f.length-2])?(this.initWithCallback(f[f.length-2],f[f.length-1]),e-=2):cc.isFunction(f[f.length-1])?(this.initWithCallback(f[f.length-1],null),e-=1):this.initWithCallback(null,null);for(var h=this.subItems,g=h.length=0;g<e;g++){f[g]&&h.push(f[g])}this._selectedIndex=cc.UINT_MAX;this.setSelectedIndex(0);return this.cascadeOpacity=this.cascadeColor=!0},addSubItem:function(b){this.subItems.push(b)},activate:function(){this._enabled&&this.setSelectedIndex((this._selectedIndex+1)%this.subItems.length);cc.MenuItem.prototype.activate.call(this)},selected:function(){cc.MenuItem.prototype.selected.call(this);this.subItems[this._selectedIndex].selected()},unselected:function(){cc.MenuItem.prototype.unselected.call(this);this.subItems[this._selectedIndex].unselected()},setEnabled:function(e){if(this._enabled!==e){cc.MenuItem.prototype.setEnabled.call(this,e);var d=this.subItems;if(d&&0<d.length){for(var f=0;f<d.length;f++){d[f].enabled=e}}}},selectedItem:function(){return this.subItems[this._selectedIndex]},getSelectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.setSelectedIndex(this._selectedIndex)}});_p=cc.MenuItemToggle.prototype;cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex);cc.MenuItemToggle.create=function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var b=new cc.MenuItemToggle;b.initWithItems(Array.prototype.slice.apply(arguments));return b};cc.MENU_STATE_WAITING=0;cc.MENU_STATE_TRACKING_TOUCH=1;cc.MENU_HANDLER_PRIORITY=-128;cc.DEFAULT_PADDING=5;cc.Menu=cc.Layer.extend({enabled:!1,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(f){cc.Layer.prototype.ctor.call(this);this._color=cc.color.WHITE;this.enabled=!1;this._opacity=255;this._selectedItem=null;this._state=-1;this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled});0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var e=arguments.length,h;if(0===e){h=[]}else{if(1===e){h=f instanceof Array?f:[f]}else{if(1<e){h=[];for(var g=0;g<e;g++){arguments[g]&&h.push(arguments[g])}}}}this.initWithArray(h)},onEnter:function(){var b=this._touchListener;b._isRegistered()||cc.eventManager.addListener(b,this);cc.Node.prototype.onEnter.call(this)},isEnabled:function(){return this.enabled},setEnabled:function(b){this.enabled=b},initWithItems:function(e){var d=[];if(e){for(var f=0;f<e.length;f++){e[f]&&d.push(e[f])}}return this.initWithArray(d)},initWithArray:function(d){if(cc.Layer.prototype.init.call(this)){this.enabled=!0;var c=cc.winSize;this.setPosition(c.width/2,c.height/2);this.setContentSize(c);this.setAnchorPoint(0.5,0.5);this.ignoreAnchorPointForPosition(!0);if(d){for(c=0;c<d.length;c++){this.addChild(d[c],c)}}this._selectedItem=null;this._state=cc.MENU_STATE_WAITING;return this.cascadeOpacity=this.cascadeColor=!0}return !1},addChild:function(e,d,f){if(!(e instanceof cc.MenuItem)){throw"cc.Menu.addChild() : Menu only supports MenuItem objects as children"}cc.Layer.prototype.addChild.call(this,e,d,f)},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(k){var j=-k,s=this._children,r,p,o,n;if(s&&0<s.length){p=0;for(r=s.length;p<r;p++){j+=s[p].height*s[p].scaleY+k}var m=j/2;p=0;for(r=s.length;p<r;p++){n=s[p],o=n.height,j=n.scaleY,n.setPosition(0,m-o*j/2),m-=o*j+k}}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(k){var j=-k,s=this._children,r,p,o,n;if(s&&0<s.length){r=0;for(p=s.length;r<p;r++){j+=s[r].width*s[r].scaleX+k}var m=-j/2;r=0;for(p=s.length;r<p;r++){n=s[r],j=n.scaleX,o=s[r].width,n.setPosition(m+o*j/2,0),m+=o*j+k}}},alignItemsInColumns:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var D=[],C=0;C<arguments.length;C++){D.push(arguments[C])}var B=-5,A=0,z=0,y=0,x,w,v,u=this._children;if(u&&0<u.length){for(C=0,v=u.length;C<v;C++){A>=D.length||!(x=D[A])||(w=u[C].height,z=z>=w||isNaN(w)?z:w,++y,y>=x&&(B+=z+5,z=y=0,++A))}}var t=cc.director.getWinSize(),o=x=z=A=0,E=0,B=B/2;if(u&&0<u.length){for(C=0,v=u.length;C<v;C++){var j=u[C];0===x&&(x=D[A],E=o=t.width/(1+x));w=j._getHeight();z=z>=w||isNaN(w)?z:w;j.setPosition(E-t.width/2,B-w/2);E+=o;++y;y>=x&&(B-=z+5,z=x=y=0,++A)}}},alignItemsInRows:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var E=[],D;for(D=0;D<arguments.length;D++){E.push(arguments[D])}var C=[],B=[],A=-10,z=-5,y=0,x=0,w=0,v,t,o,G,j=this._children;if(j&&0<j.length){for(D=0,o=j.length;D<o;D++){(t=j[D],y>=E.length||!(v=E[y]))||(G=t.width,x=x>=G||isNaN(G)?x:G,z+=t.height+5,++w,w>=v&&(C.push(x),B.push(z),A+=x+10,x=w=0,z=-5,++y))}}z=cc.director.getWinSize();v=x=y=0;var A=-A/2,F=0;if(j&&0<j.length){for(D=0,o=j.length;D<o;D++){t=j[D],0===v&&(v=E[y],F=B[y]),G=t._getWidth(),x=x>=G||isNaN(G)?x:G,t.setPosition(A+C[y]/2,F-z.height/2),F-=t.height+10,++w,w>=v&&(A+=x+5,x=v=w=0,++y)}}},removeChild:function(d,c){null!=d&&(d instanceof cc.MenuItem?(this._selectedItem===d&&(this._selectedItem=null),cc.Node.prototype.removeChild.call(this,d,c)):cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children"))},_onTouchBegan:function(f,e){var h=e.getCurrentTarget();if(h._state!==cc.MENU_STATE_WAITING||!h._visible||!h.enabled){return !1}for(var g=h.parent;null!=g;g=g.parent){if(!g.isVisible()){return !1}}h._selectedItem=h._itemForTouch(f);return h._selectedItem?(h._state=cc.MENU_STATE_TRACKING_TOUCH,h._selectedItem.selected(),h._selectedItem.setNodeDirty(),!0):!1},_onTouchEnded:function(e,d){var f=d.getCurrentTarget();f._state!==cc.MENU_STATE_TRACKING_TOUCH?cc.log("cc.Menu.onTouchEnded(): invalid state"):(f._selectedItem&&(f._selectedItem.unselected(),f._selectedItem.setNodeDirty(),f._selectedItem.activate()),f._state=cc.MENU_STATE_WAITING)},_onTouchCancelled:function(e,d){var f=d.getCurrentTarget();f._state!==cc.MENU_STATE_TRACKING_TOUCH?cc.log("cc.Menu.onTouchCancelled(): invalid state"):(this._selectedItem&&(f._selectedItem.unselected(),f._selectedItem.setNodeDirty()),f._state=cc.MENU_STATE_WAITING)},_onTouchMoved:function(f,e){var h=e.getCurrentTarget();if(h._state!==cc.MENU_STATE_TRACKING_TOUCH){cc.log("cc.Menu.onTouchMoved(): invalid state")}else{var g=h._itemForTouch(f);g!==h._selectedItem&&(h._selectedItem&&(h._selectedItem.unselected(),h._selectedItem.setNodeDirty()),h._selectedItem=g,h._selectedItem&&(h._selectedItem.selected(),h._selectedItem.setNodeDirty()))}},onExit:function(){this._state===cc.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),this._selectedItem=null),this._state=cc.MENU_STATE_WAITING);cc.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(b){},isOpacityModifyRGB:function(){return !1},_itemForTouch:function(h){h=h.getLocation();var g=this._children,n;if(g&&0<g.length){for(var m=g.length-1;0<=m;m--){if(n=g[m],n.isVisible()&&n.isEnabled()){var k=n.convertToNodeSpace(h),j=n.rect();j.x=0;j.y=0;if(cc.rectContainsPoint(j,k)){return n}}}}return null}});_p=cc.Menu.prototype;cc.Menu.create=function(d){var c=arguments.length;0<c&&null==arguments[c-1]&&cc.log("parameters should not be ending with null in Javascript");return 0===c?new cc.Menu:1===c?new cc.Menu(d):new cc.Menu(Array.prototype.slice.call(arguments,0))};(function(){var h=cc.sys,g={common:{multichannel:!0,webAudio:cc.sys._supportWebAudio,auto:!0}};g[h.BROWSER_TYPE_IE]={multichannel:!0,webAudio:cc.sys._supportWebAudio,auto:!0,emptied:!0};g[h.BROWSER_TYPE_ANDROID]={multichannel:!1,webAudio:!1,auto:!1};g[h.BROWSER_TYPE_CHROME]={multichannel:!0,webAudio:!0,auto:!1};g[h.BROWSER_TYPE_FIREFOX]={multichannel:!0,webAudio:!0,auto:!0,delay:!0};g[h.BROWSER_TYPE_UC]={multichannel:!0,webAudio:!1,auto:!1};g[h.BROWSER_TYPE_QQ]={multichannel:!1,webAudio:!1,auto:!0};g[h.BROWSER_TYPE_OUPENG]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_WECHAT]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_360]={multichannel:!1,webAudio:!1,auto:!0};g[h.BROWSER_TYPE_MIUI]={multichannel:!1,webAudio:!1,auto:!0};g[h.BROWSER_TYPE_LIEBAO]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_SOUGOU]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_BAIDU]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_BAIDU_APP]={multichannel:!1,webAudio:!1,auto:!1,replay:!0,emptied:!0};g[h.BROWSER_TYPE_SAFARI]={multichannel:!0,webAudio:!0,auto:!1,webAudioCallback:function(b){document.createElement("audio").src=b}};var n,m;try{var k=navigator.userAgent.toLowerCase();switch(h.browserType){case h.BROWSER_TYPE_IE:m=k.match(/(msie |rv:)([\d.]+)/);break;case h.BROWSER_TYPE_FIREFOX:m=k.match(/(firefox\/|rv:)([\d.]+)/);break;case h.BROWSER_TYPE_CHROME:m=k.match(/chrome\/([\d.]+)/);break;case h.BROWSER_TYPE_BAIDU:m=k.match(/baidubrowser\/([\d.]+)/);break;case h.BROWSER_TYPE_UC:m=k.match(/ucbrowser\/([\d.]+)/);break;case h.BROWSER_TYPE_QQ:m=k.match(/qqbrowser\/([\d.]+)/);break;case h.BROWSER_TYPE_OUPENG:m=k.match(/oupeng\/([\d.]+)/);break;case h.BROWSER_TYPE_WECHAT:m=k.match(/micromessenger\/([\d.]+)/);break;case h.BROWSER_TYPE_SAFARI:m=k.match(/safari\/([\d.]+)/);break;case h.BROWSER_TYPE_MIUI:m=k.match(/miuibrowser\/([\d.]+)/)}n=m?m[1]:""}catch(j){console.log(j)}if(n){switch(h.browserType){case h.BROWSER_TYPE_CHROME:30>parseInt(n)&&(g[h.BROWSER_TYPE_CHROME]={multichannel:!1,webAudio:!0,auto:!1});break;case h.BROWSER_TYPE_MIUI:if(n=n.match(/\d+/g),2>n[0]||2===n[0]&&0===n[1]&&1>=n[2]){g[h.BROWSER_TYPE_MIUI].auto=!1}}}if(cc.sys.isMobile){cc.__audioSupport=cc.sys.os!==cc.sys.OS_IOS?g[h.browserType]||g.common:g[h.BROWSER_TYPE_SAFARI]}else{switch(h.browserType){case h.BROWSER_TYPE_IE:cc.__audioSupport=g[h.BROWSER_TYPE_IE];break;case h.BROWSER_TYPE_FIREFOX:cc.__audioSupport=g[h.BROWSER_TYPE_FIREFOX];break;default:cc.__audioSupport=g.common}}})();cc.Audio=cc.Class.extend({volume:1,loop:!1,src:null,_touch:!1,_playing:!1,_AUDIO_TYPE:"AUDIO",_pause:!1,_buffer:null,_currentSource:null,_startTime:null,_currentTime:null,_context:null,_volume:null,_ignoreEnded:!1,_element:null,ctor:function(e,d,f){e&&(this._context=e);d&&(this._volume=d);e&&d&&(this._AUDIO_TYPE="WEBAUDIO");this.src=f},_setBufferCallback:null,setBuffer:function(d){if(d){var c=this._playing;this._AUDIO_TYPE="WEBAUDIO";this._buffer&&this._buffer!==d&&this.getPlaying()&&this.stop();this._buffer=d;c&&this.play();this._volume.gain.value=this.volume;this._setBufferCallback&&this._setBufferCallback(d)}},_setElementCallback:null,setElement:function(d){if(d){var c=this._playing;this._AUDIO_TYPE="AUDIO";this._element&&this._element!==d&&this.getPlaying()&&this.stop();this._element=d;c&&this.play();d.volume=this.volume;d.loop=this.loop;this._setElementCallback&&this._setElementCallback(d)}},play:function(d,c){this._playing=!0;this.loop=void 0===c?this.loop:c;"AUDIO"===this._AUDIO_TYPE?this._playOfAudio(d):this._playOfWebAudio(d)},getPlaying:function(){if(!this._playing){return this._playing}if("AUDIO"===this._AUDIO_TYPE){var b=this._element;return !b||this._pause||b.ended?this._playing=!1:!0}return(b=this._currentSource)?null==b.playbackState?this._playing:this._currentTime+this._context.currentTime-this._startTime<this._currentSource.buffer.duration:!0},_playOfWebAudio:function(f){var e=this._currentSource;if(this._buffer){if(!this._pause&&e){if(0===this._context.currentTime||this._currentTime+this._context.currentTime-this._startTime>this._currentSource.buffer.duration){this._stopOfWebAudio()}else{return}}e=this._context.createBufferSource();e.buffer=this._buffer;e.connect(this._volume);e.loop=this.loop;this._startTime=this._context.currentTime;this._currentTime=f||0;if(e.start){e.start(0,f||0)}else{if(e.noteGrainOn){var h=e.buffer.duration;this.loop?e.noteGrainOn(0,f,h):e.noteGrainOn(0,f,h-f)}else{e.noteOn(0)}}this._currentSource=e;var g=this;e.onended=function(){g._ignoreEnded?g._ignoreEnded=!1:g._playing=!1}}},_playOfAudio:function(){var b=this._element;b&&(b.loop=this.loop,b.play())},stop:function(){this._playing=!1;"AUDIO"===this._AUDIO_TYPE?this._stopOfAudio():this._stopOfWebAudio()},_stopOfWebAudio:function(){var b=this._currentSource;this._ignoreEnded=!0;b&&(b.stop(0),this._currentSource=null)},_stopOfAudio:function(){var b=this._element;b&&(b.pause(),b.duration&&Infinity!==b.duration&&(b.currentTime=0))},pause:function(){!1!==this.getPlaying()&&(this._playing=!1,this._pause=!0,"AUDIO"===this._AUDIO_TYPE?this._pauseOfAudio():this._pauseOfWebAudio())},_pauseOfWebAudio:function(){this._currentTime+=this._context.currentTime-this._startTime;var b=this._currentSource;b&&b.stop(0)},_pauseOfAudio:function(){var b=this._element;b&&b.pause()},resume:function(){this._pause&&("AUDIO"===this._AUDIO_TYPE?this._resumeOfAudio():this._resumeOfWebAudio(),this._pause=!1,this._playing=!0)},_resumeOfWebAudio:function(){var b=this._currentSource;b&&(this._startTime=this._context.currentTime,this._playOfWebAudio(this._currentTime%b.buffer.duration))},_resumeOfAudio:function(){var b=this._element;b&&b.play()},setVolume:function(b){1<b&&(b=1);0>b&&(b=0);this.volume=b;"AUDIO"===this._AUDIO_TYPE?this._element&&(this._element.volume=b):this._volume&&(this._volume.gain.value=b)},getVolume:function(){return this.volume},cloneNode:function(){var e,d;if("AUDIO"===this._AUDIO_TYPE){e=new cc.Audio;var f=document.createElement("audio");f.src=this.src;e.setElement(f)}else{f=this._context.createGain(),f.gain.value=1,f.connect(this._context.destination),e=new cc.Audio(this._context,f,this.src),this._buffer?e.setBuffer(this._buffer):(d=this,this._setBufferCallback=function(a){e.setBuffer(a);d._setBufferCallback=null})}e._AUDIO_TYPE=this._AUDIO_TYPE;return e}});(function(u){var t=u.webAudio,s=u.multichannel,r=u.auto,p=[];(function(){var d=document.createElement("audio");if(d.canPlayType){var c=d.canPlayType('audio/ogg; codecs\x3d"vorbis"');c&&""!==c&&p.push(".ogg");(c=d.canPlayType("audio/mpeg"))&&""!==c&&p.push(".mp3");(c=d.canPlayType('audio/wav; codecs\x3d"1"'))&&""!==c&&p.push(".wav");(c=d.canPlayType("audio/mp4"))&&""!==c&&p.push(".mp4");(d=d.canPlayType("audio/x-m4a"))&&""!==d&&p.push(".m4a")}})();try{if(t){var o=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext);u.delay&&setTimeout(function(){o=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},0)}}catch(n){t=!1,cc.log("browser don't support webAudio")}var m={cache:{},load:function(x,h,f,e){if(0===p.length){return e("can not support audio!")}var b=cc.path.extname(x),A=[b];for(f=0;f<p.length;f++){b!==p[f]&&A.push(p[f])}var B;if(m.cache[h]){return e(null,m.cache[h])}if(t){try{var z=o.createGain();z.gain.value=1;z.connect(o.destination);B=new cc.Audio(o,z,x)}catch(y){t=!1,cc.log("browser don't support webAudio"),B=new cc.Audio(null,null,x)}}else{B=new cc.Audio(null,null,x)}this.loadAudioFromExtList(x,A,B,e);m.cache[h]=B},loadAudioFromExtList:function(C,h,f,e){if(0===h.length){var a="can not found the resource of audio! Last match url is : ",a=a+C.replace(/\.(.*)?$/,"(");p.forEach(function(c){a+=c+"|"});a=a.replace(/\|$/,")");return e(a)}C=cc.path.changeExtname(C,h.splice(0,1));if(t){u.webAudioCallback&&u.webAudioCallback(C);var H=new XMLHttpRequest;H.open("GET",C,!0);H.responseType="arraybuffer";H.onload=function(){o.decodeAudioData(H.response,function(c){f.setBuffer(c);e(null,f)},function(){m.loadAudioFromExtList(C,h,f,e)})};H.send()}else{var I=document.createElement("audio"),G=!1,F=!1,B=setTimeout(function(){0===I.readyState?b():(F=!0,I.pause(),document.body.removeChild(I),e("audio load timeout : "+C,f))},10000),E=function(){if(!G){I.pause();try{I.currentTime=0,I.volume=1}catch(c){}document.body.removeChild(I);f.setElement(I);I.removeEventListener("canplaythrough",E,!1);I.removeEventListener("error",D,!1);I.removeEventListener("emptied",b,!1);!F&&e(null,f);G=!0;clearTimeout(B)}},D=function(){G&&(I.pause(),document.body.removeChild(I),I.removeEventListener("canplaythrough",E,!1),I.removeEventListener("error",D,!1),I.removeEventListener("emptied",b,!1),!F&&m.loadAudioFromExtList(C,h,f,e),G=!0,clearTimeout(B))},b=function(){F=!0;E();e(null,f)};cc._addEventListener(I,"canplaythrough",E,!1);cc._addEventListener(I,"error",D,!1);u.emptied&&cc._addEventListener(I,"emptied",b,!1);I.src=C;document.body.appendChild(I);I.volume=0;I.play()}}};cc.loader.register(["mp3","ogg","wav","mp4","m4a"],m);cc.audioEngine={_currMusic:null,_musicVolume:1,willPlayMusic:function(){return !1},playMusic:function(e,d){var f=this._currMusic;f&&f.src!==e&&f.getPlaying()&&f.stop();f=m.cache[e];f||(cc.loader.load(e),f=m.cache[e]);f.play(0,d);f.setVolume(this._musicVolume);this._currMusic=f},stopMusic:function(d){var c=this._currMusic;c&&(c.stop(),d&&cc.loader.release(c.src))},pauseMusic:function(){var b=this._currMusic;b&&b.pause()},resumeMusic:function(){var b=this._currMusic;b&&b.resume()},rewindMusic:function(){var b=this._currMusic;b&&(b.stop(),b.play())},getMusicVolume:function(){return this._musicVolume},setMusicVolume:function(d){d-=0;isNaN(d)&&(d=1);1<d&&(d=1);0>d&&(d=0);this._musicVolume=d;var c=this._currMusic;c&&c.setVolume(d)},isMusicPlaying:function(){var b=this._currMusic;return b?b.getPlaying():!1},_audioPool:{},_maxAudioInstance:5,_effectVolume:1,playEffect:function(b,v){if(!s){return null}var k=this._audioPool[b];k||(k=this._audioPool[b]=[]);var h;for(h=0;h<k.length&&k[h].getPlaying();h++){}if(k[h]){c=k[h],c.setVolume(this._effectVolume),c.play(0,v)}else{if(!t&&h>this._maxAudioInstance){cc.log("Error: %s greater than %d",b,this._maxAudioInstance)}else{var c=m.cache[b];c||(cc.loader.load(b),c=m.cache[b]);c=c.cloneNode();c.setVolume(this._effectVolume);c.loop=v||!1;c.play();k.push(c)}}return c},setEffectsVolume:function(g){g-=0;isNaN(g)&&(g=1);1<g&&(g=1);0>g&&(g=0);this._effectVolume=g;var f=this._audioPool,v;for(v in f){var k=f[v];if(Array.isArray(k)){for(var h=0;h<k.length;h++){k[h].setVolume(g)}}}},getEffectsVolume:function(){return this._effectVolume},pauseEffect:function(b){b&&b.pause()},pauseAllEffects:function(){var f=this._audioPool,e;for(e in f){for(var h=f[e],g=0;g<f[e].length;g++){h[g].getPlaying()&&h[g].pause()}}},resumeEffect:function(b){b&&b.resume()},resumeAllEffects:function(){var f=this._audioPool,e;for(e in f){for(var h=f[e],g=0;g<f[e].length;g++){h[g].resume()}}},stopEffect:function(b){b&&b.stop()},stopAllEffects:function(){var f=this._audioPool,e;for(e in f){for(var h=f[e],g=0;g<f[e].length;g++){h[g].stop()}}},unloadEffect:function(d){if(d){cc.loader.release(d);var c=this._audioPool[d];c&&(c.length=0);delete this._audioPool[d];delete m.cache[d]}},end:function(){this.stopMusic();this.stopAllEffects()},_pauseCache:[],_pausePlaying:function(){var f=this._currMusic;f&&f.getPlaying()&&(f.pause(),this._pauseCache.push(f));var f=this._audioPool,e;for(e in f){for(var h=f[e],g=0;g<f[e].length;g++){h[g].getPlaying()&&(h[g].pause(),this._pauseCache.push(h[g]))}}},_resumePlaying:function(){for(var d=this._pauseCache,c=0;c<d.length;c++){d[c].resume()}d.length=0}};if(!r){var j=function(){var a=cc.audioEngine._currMusic;a&&!1===a._touch&&a._playing&&a.getPlaying()&&(a._touch=!0,a.play(0,a.loop),!u.replay&&cc._canvas.removeEventListener("touchstart",j))};setTimeout(function(){cc._canvas&&cc._canvas.addEventListener("touchstart",j,!1)},150)}cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.audioEngine._pausePlaying()});cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.audioEngine._resumePlaying()})})(cc.__audioSupport);var res={Item0_png:"res/0.png",Item1_png:"res/1.png",Item2_png:"res/2.png",Item3_png:"res/3.png",Item4_png:"res/4.png",Item5_png:"res/5.png",Item6_png:"res/6.png",Item7_png:"res/7.png",ColorBg1_png:"res/bg/1.png",ColorBg2_png:"res/bg/2.png",ColorBg3_png:"res/bg/3.png",ColorBg4_png:"res/bg/4.png",ColorBg5_png:"res/bg/5.png",ColorBg6_png:"res/bg/6.png",ColorBg7_png:"res/bg/7.png",Shadow1_png:"res/shadow/1.png",Shadow2_png:"res/shadow/2.png",Shadow3_png:"res/shadow/3.png",Shadow4_png:"res/shadow/4.png",Shadow5_png:"res/shadow/5.png",Shadow6_png:"res/shadow/6.png",Shadow7_png:"res/shadow/7.png",Num_png:"res/num.png",Circle_png:"res/circle.png",Bomb_mp3:"res/music/bomb.mp3",Bomb_ogg:"res/music/bomb.ogg",Put_mp3:"res/music/put.mp3",Put_ogg:"res/music/put.ogg",In_mp3:"res/music/in.mp3",In_ogg:"res/music/in.ogg",GameOver_mp3:"res/music/game_over.mp3",GameOver_ogg:"res/music/game_over.ogg",IconGame_png:"res/icon_moregame.png",IconReplay_png:"res/icon_replay.png",IconFacebook_png:"res/icon_facebook.png",IconTwitter_png:"res/icon_twitter.png",Facebook_png:"res/f_share.png",ShareArrow2_png:"res/share_arrow2.png",MoreGame2_png:"res/more_game.png",PlayAgain2_png:"res/play_again.png",GameOver2_png:"res/game_over2.png",GameOver_png:"res/game_over.png",ScoreBg_png:"res/score_bg.png",JiXuBtn_png:"res/jixuyouxi.png",ChouJiangBtn_png:"res/choujianganniu.png",Share_png:"res/fenxiangyixia.png",fenxiang_png:"res/fenxiang.png",fenxiang2_png:"res/fenxiang2.png",MoreGame_png:"res/moregame.png"},g_resources=[],i;for(i in res){g_resources.push(res[i])}GameStartFlag=!1;AD_REAL_H=GameMainLayer=IOS_FLAG=null;FaceBookFlag=TwitterFlag=!1;var GameLayer=cc.Layer.extend({sprite:null,ctor:function(){this._super();this.init();this.showGameInfo();return !0},showGameInfo:function(){if(GameStartFlag){this.gameStart()}else{GameStartFlag=!0;cc.director.pause();var b=new GameInfoLayer;this.addChild(b,100)}},gameStart:function(){this.playGame()},checkHost:function(){var b;b=window.location.href.substr(7,14);b=hex_md5(b);"72c4cc272fe7185382beacb7c0bb7958"!=b&&"29dee435d50bd51af98611fcd629b797"!=b&&cc.director.pause()},initFacebookSDK:function(){},size:null,init:function(){this.size=cc.director.getVisibleSize();this.initSystem();this.initBottomEdgeY();this.initBg();this.initCircleItem();this.initScore()},bottomEdgeY:null,AD_H:55,initBottomEdgeY:function(){if(IOS_FLAG){var e=navigator.userAgent.toLowerCase();0<e.indexOf("twitter")&&(this.AD_H+=107,document.getElementById("googleads").style.bottom="107px",TwitterFlag=!0);0<e.indexOf("fbios")&&(this.AD_H+=107,document.getElementById("googleads").style.bottom="107px",FaceBookFlag=!0)}var e=cc.view.getFrameSize(),d=this.size;this.bottomEdgeY=e=this.AD_H*(PC_FLAG?d.height/e.height:d.width/e.width);d=new cc.DrawNode;d.drawRect(cc.p(0,0),cc.p(this.size.width,e-2),cc.color("#000000"),2,cc.color("#ffffff"));var f=new cc.Sprite;this.addChild(f,15);f.addChild(d,15);AD_REAL_H=e},initSystem:function(){var b=cc.sys;IOS_FLAG=b.os===b.OS_IOS||b.os===b.OS_OSX?!0:!1},initBg:function(){var b=new cc.LayerColor(cc.color("#1c1c1c"));this.addChild(b);this.initBgCircle();this.initBgItem()},tileObj:null,itemW:77,itemH:87,itemSubH:null,itemDisX:null,itemDisY:null,centerP:null,initBgItem:function(){this.tileObj={};this.itemSubH=Math.tan(30*Math.PI/180)*(this.itemW/2);var A=cc.p(this.size.width/2,this.size.height/2);A.y=this.size.height-(this.size.height-(this.circle.y+this.circle.height/2+50))/2;this.centerP=A;var z=this.itemH-this.itemSubH+12;this.itemDisX=this.itemW+8.5;this.itemDisY=z;for(var A=cc.p(A.x,A.y-3*z),y,x,w,v=-3,u=4,t=0;7>t;t++){x=A.y+t*z;w=2*-Math.floor(u/2);0==t%2?(y=(this.itemW+8.5)/2,w+=1):y=0;y=A.x-Math.floor(u/2)*(this.itemW+8.5)+y;for(var s=0;s<u;s++){var r=this.getItem(0);this.addChild(r);r.x=y+s*(this.itemW+8.5);r.y=x;var o=(w+2*s).toString(),j=v.toString();this.tileObj[o]||(this.tileObj[o]={});this.tileObj[o][j]={};this.tileObj[o][j].bgItem=r;r.logicX=o;r.logicY=j}3>t?u++:u--;v++}},circle:null,circleP:null,initBgCircle:function(){var b=new cc.Sprite(res.Circle_png);this.addChild(b,1);this.circle=b;b.x=this.size.width/2;b.y=this.bottomEdgeY+b.height/2+5;b.opacity=180;this.circleP=b.getPosition()},getItem:function(d){null==d&&(d=this.getItemRandomColor());var c=new cc.Sprite("res/"+d+".png");c.colorId=d.toString();0!=d&&this.createBgItemColor(c,c.colorId);return c},getItemRandomColor:function(){var g=this.curMaxPoint+1;if(7<=g){if(0.03>=Math.random()){return cc.log(" in 0.01 _____ "),7}g=6}var f=Number(Math.ceil((100-7*g)/this.curTotalPoint*100)/100);cc.log("------------");cc.log("rate: "+f);for(var k=[],j=g;0<j;j--){var h=7+f*j;cc.log("value: "+h);k.push(h)}j=Math.floor(100*Math.random());cc.log("randomNum : "+j);for(f=h=0;f<j;){f+=k[h];console.log(f,k[h],h);if(f>=j){return cc.log("index + 1 : "+(h+1)),h+1}h++}cc.log(" no index .. ");g=Math.ceil(Math.random()*g);8<=g&&(g=7);return g},circleItem:null,initCircleItem:function(f,e){this.circleItem&&this.circleItem.removeFromParent();var h=this.getCircleItem(e);h.setPosition(this.circleP);this.circleItem=h;if(f){h.scale=0.2;var g=cc.sequence(cc.scaleTo(0.08,1),cc.callFunc(function(d,c){c.canTouch=!0},this,this));h.runAction(g)}},getCircleItem:function(f){var e=new cc.Sprite;this.addChild(e,2);if(4==f||!f&&0.05>Math.random()){return f=this.getItem(),e.addChild(f,2),e.itemArr=[f],f.offX=f.x,f.offY=f.y,e}var h;h=f?f:Math.ceil(3*Math.random());f=this.getItem();var g=this.getItem();e.addChild(f,2);e.addChild(g,2);e.itemArr=[f,g];switch(h){case 1:f.x=this.itemDisX/4;f.y=this.itemDisY/2;g.x=-this.itemDisX/4;g.y=-this.itemDisY/2;break;case 2:f.x=this.itemDisX/2;f.y=0;g.x=-this.itemDisX/2;g.y=0;break;case 3:f.x=this.itemDisX/4,f.y=-this.itemDisY/2,g.x=-this.itemDisX/4,g.y=this.itemDisY/2}f.offX=f.x;f.offY=f.y;g.offX=g.x;g.offY=g.y;return e},scoreTf:null,score:0,initScore:function(){var b=new cc.LabelAtlas("0",res.Num_png,43,42,"0");this.addChild(b);b.attr({x:this.size.width/2,y:this.circle.y+this.circle.height/2+10,anchorX:0.5,anchorY:0});this.scoreTf=b},addScore1:function(b){this.score+=b;this.scoreTf.string=this.score.toString()},refreshTitle:function(){this.title.x=this.scoreTf.x-this.scoreTf.width-30},playScoreTarget:0,playScore:0,playSubScore:0,addScore:function(b){this.playScoreTarget=this.score+b;this.score+=b;this.scoreTf.string=this.playScore.toString();this.playSubScore=Math.ceil((this.playScoreTarget-this.playScore)/20);this.schedule(this.scoreUpdateFunc,0.05)},scoreUpdateFunc:function(){this.playScore+=this.playSubScore;this.playScore>=this.playScoreTarget?(this.unschedule(this.scoreUpdateFunc),this.scoreTf.string=this.score.toString()):this.scoreTf.string=this.playScore.toString()},showScore:function(f,e){var h=f.getPosition(),g=new cc.LabelTTF("+"+e.toString(),null,60);g.setPosition(h);g.setColor(cc.color("#ffffff"));g.setAnchorPoint(cc.p(0.5,0.5));g.enableShadow(cc.color("#000000"),cc.size(3,-3),1);this.addChild(g,5);h=cc.sequence(cc.moveBy(0.4,cc.p(0,100)).easing(cc.easeCircleActionOut()),cc.spawn(cc.moveBy(0.4,cc.p(0,-100)).easing(cc.easeCircleActionIn()),cc.fadeOut(0.4).easing(cc.easeCircleActionIn())),cc.callFunc(function(d,c){d.removeFromParent()},this,this));g.runAction(h)},playGame:function(){this.createListener();this.scheduleUpdate()},update:function(b){this.updateCircle()},circleSpeed:1,updateCircle:function(){this.circle.rotation+=this.circleSpeed;360<=this.circle.rotation&&(this.circle.rotation-=360)},createListener:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan,onTouchMoved:this.onTouchMoved,onTouchEnded:this.onTouchEnded,onTouchCancelled:this.onTouchEnded},this)},canTouch:!0,onTouchBegan:function(e,d){var f=d.getCurrentTarget();if(e.getLocation().y<f.bottomEdgeY){return document.documentElement.scrollTop=document.body.scrollTop=0,!1}if(f.canTouch&&!f.gameEndFlag&&!f.touchMoveFlag){return f.touchBegan(e,d),!0}},onTouchMoved:function(d,c){c.getCurrentTarget().touchMove(d,c)},onTouchEnded:function(d,c){c.getCurrentTarget().touchEnd(d,c)},touchedFlag:!1,startTouchP:null,oldLocation:null,canPutFlag:!1,curPieceArr:null,curItemIndex:null,touchBegan:function(e,d){this.canPutFlag=!1;var f=e.getLocation();this.startTouchP=this.oldLocation=f;this.touchedFlag=f.y<=this.circle.y+this.circle.height/2?!0:!1},touchMoveFlag:!1,moveOffYLen:120,touchMove:function(g,f){if(this.touchedFlag){var k=g.getLocation();if(this.touchMoveFlag||!(15>=cc.pDistance(this.startTouchP,k))){if(this.touchMoveFlag){var j=this.oldLocation,h=k.x-j.x,j=k.y-j.y;this.oldLocation=k;this.circleItem.x+=h;this.circleItem.y+=j}else{this.touchMoveFlag=!0,k.y+=this.moveOffYLen,this.circleItem.runAction(cc.moveBy(0.05,cc.p(0,this.moveOffYLen)))}this.checkCanPut()}}},drawTest:function(f){for(var e=this.circleItem.itemArr,h=0;h<e.length;h++){var g=new cc.DrawNode;f=cc.p(e[h].offX,e[h].offY);f.x+=this.circleItem.x;f.y+=this.circleItem.y;g.drawDot(f,10,cc.color("#aa0000"));this.addChild(g,10)}},touchEnd:function(){this.touchedFlag?this.touchMoveFlag?(this.touchMoveFlag=!1,this.hideOldLightTiles(),this.canPutFlag?this.putTile():this.backOldPosition()):this.curRectRotation():this.touchMoveFlag=!1},putTile:function(){this.canTouch=!1;for(var e=this.oldLightTiles,d=0;d<e.length;d++){var f=e[d].bgItem.item;f.removeFromParent();this.addChild(f,2);f.setPosition(f.colorBgItem.getPosition());f.logicX=e[d].bgItem.logicX;f.logicY=e[d].bgItem.logicY;f.colorBgItem.removeFromParent();e[d].buildingFlag=!0;e[d].building=f}SoundUtile.playMusic("res/music/put");this.checkCanPop()},oldLightTiles:null,canPutFlag:null,checkCanPut:function(){for(var h=this.circleItem.itemArr,g=this.tileObj,n=[],m,k=0;k<h.length;k++){m=!1;var j=cc.p(h[k].offX,h[k].offY);j.x+=this.circleItem.x;j.y+=this.circleItem.y;j=this.pointToTile(j);g[j.x.toString()]&&(j=g[j.x.toString()][j.y.toString()])&&!j.buildingFlag&&(n.push(j),j.bgItem.item=h[k],m=!0);if(!m){break}}this.hideOldLightTiles();if(m){for(k=0;k<n.length;k++){this.showBgItemColor(n[k].bgItem,n[k].bgItem.item)}this.oldLightTiles=n}this.canPutFlag=m},checkGameEnd:function(){function w(b){if(t[targetLogicX]&&t[targetLogicX][targetLogicY]){var c=t[targetLogicX][targetLogicY];c.checkEndFlag||c.building||(c.checkEndFlag=!0,u[b]||(u[b]=!0,v.push(Number(b))))}}var v=[],u={},t=this.tileObj,s,r,p;for(p in t){var o=t[p],n;for(n in o){if(o[n].building||(s=p,r=n,u["4"]||(u["4"]=!0,v.push(4)),targetLogicX=(Number(s)+1).toString(),targetLogicY=(Number(r)+1).toString(),w("1"),targetLogicX=(Number(s)-1).toString(),targetLogicY=(Number(r)-1).toString(),w("1"),targetLogicX=(Number(s)-2).toString(),targetLogicY=r.toString(),w("2"),targetLogicX=(Number(s)+2).toString(),targetLogicY=(Number(r)+0).toString(),w("2"),targetLogicX=(Number(s)-1).toString(),targetLogicY=(Number(r)+1).toString(),w("3"),targetLogicX=(Number(s)+1).toString(),targetLogicY=(Number(r)-1).toString(),w("3")),4<=v.length){break}}if(4<=v.length){break}}for(p in t){for(n in o=t[p],o){o[n].checkEndFlag=!1}}if(0>=v.length){this.gameEnd()}else{var j;4>v.length&&(s=Math.floor(Math.random()*v.length),j=v[s]);this.initCircleItem(!0,j)}},cleanFlag:function(){var g=this.tileObj,f;for(f in g){var k=g[f],j;for(j in k){var h=k[j];h.checkedFlag=!1;h.building&&(h.building.moveSpeed=0,h.building.moveTarget=null)}}this.popArr=[];this.popTotalArr=[]},pointToTile:function(e){var d=this.itemDisY,f=Math.round((e.x-this.centerP.x)/(this.itemDisX/2));e=Math.round((e.y-this.centerP.y)/d);return cc.p(f,e)},tileToPoint:function(d,c){return cc.p(this.itemDisX/2*d+this.centerP.x,c*this.itemDisY+this.centerP.y)},showBgItemColor:function(e,d){var f=d.colorBgItem;f.setPosition(e.getPosition());f.setVisible(!0)},createBgItemColor:function(e,d){var f=this.getColorBgItem(d);f.setVisible(!1);e.colorBgItem=f},bgColorObj:null,getColorBgItem:function(b){b=new cc.Sprite("res/bg/"+b+".png");this.addChild(b,1);b.opacity=130;return b},hideOldLightTiles:function(){for(var d=this.circleItem.itemArr,c=0;c<d.length;c++){d[c].colorBgItem.setVisible(!1)}},backOldPosition:function(){this.circleItem.stopAllActions();this.canTouch=!1;var b=new cc.Sequence(cc.moveTo(0.1,this.circleP),cc.callFunc(function(d,e){e.canTouch=!0},this,this));this.circleItem.runAction(b)},curRectRotation:function(){var b=new cc.Sequence(cc.rotateBy(0.15,180),cc.callFunc(function(d,e){e.changeCircleItemP();e.canTouch=!0},this,this));this.circleItem.setPosition(this.circleP);this.canTouch=!1;this.circleItem.runAction(b)},changeCircleItemP:function(){for(var d=this.circleItem.itemArr,c=0;c<d.length;c++){d[c].offX*=-1,d[c].offY*=-1}},popTotalArr:null,popArr:null,SPEED_LEN:0.2,checkCanPop:function(){function j(d,c){d.removeFromParent();c.tileObj[d.logicX][d.logicY].buildingFlag=!1;c.tileObj[d.logicX][d.logicY].building=null}this.popTotalArr=[];this.cleanFlag();this.moveEndCount=0;var h=this.oldLightTiles;this.sortOldTileArr();for(var p=0;p<h.length;p++){var o=h[p].building;o.moveSpeed&&0!=o.moveSpeed||(o.moveSpeed=0,this.popArr=[o],this.checkOneItemCanPop(h[p]),3<=this.popArr.length&&this.popTotalArr.push(this.popArr))}if(0<this.popTotalArr.length){for(p=0;p<this.popTotalArr.length;p++){h=this.popTotalArr[p];h.sort(function(d,c){return c.moveSpeed-d.moveSpeed});for(var n=0;n<h.length;n++){if(o=h[n],o.setLocalZOrder(2+n),0<o.moveSpeed){var m=this.SPEED_LEN/o.moveSpeed,k=this.tileToPoint(o.moveTarget.logicX,o.moveTarget.logicY),m=cc.sequence(cc.moveTo(m,k),cc.callFunc(function(a,f){if(a.moveTarget.moveTarget){var e=this.tileToPoint(a.moveTarget.moveTarget.logicX,a.moveTarget.moveTarget.logicY),e=cc.sequence(cc.moveTo(this.SPEED_LEN/a.moveSpeed,e),cc.callFunc(function(d,g){j(d,g)},f,f));a.runAction(e)}else{j(a,f)}},this,this));o.runAction(m);1==o.moveSpeed&&this.addShadowAnimation(o)}else{m=cc.sequence(cc.delayTime(this.SPEED_LEN),cc.callFunc(this.oneMoveEnd,this,this)),o.runAction(m),o.eatCount=h.length}}}}else{this.checkGameEnd()}},addShadowAnimation:function(f){var e=f.getPosition(),h=f.moveTarget.getPosition(),h=MyUtil.getAngleByPoints(e,h),e=new cc.Sprite("res/shadow/"+f.colorId+".png");this.addChild(e);e.x=f.x;e.y=f.y;h*=-1;f.x<f.moveTarget.x&&(h+=180);var g=f.moveTarget.x-f.x;f=f.moveTarget.y-f.y;e.rotation=h;f=cc.sequence(cc.delayTime(this.SPEED_LEN/4),cc.spawn(cc.moveBy(0.2,cc.p(g/2,f/2))),cc.callFunc(function(d,c){d.removeFromParent()},this,this));e.runAction(f)},moveEndCount:0,oneMoveEnd:function(e,d){d.addItemPoint(e);var f=Number(e.colorId)*e.eatCount;d.addScore(f);d.showScore(e,f);d.moveEndCount++;d.moveEndCount>=d.popTotalArr.length&&(f=d.bombItem?cc.sequence(cc.delayTime(0.1),cc.callFunc(function(g,c){c.bombStart()},d,d)):cc.sequence(cc.delayTime(d.changePointTime),cc.callFunc(function(g,c){c.moveEnd()},d,d)),d.runAction(f))},bombPopArr:null,bombStart:function(){function j(){if(n[targetLogicX]&&n[targetLogicX][targetLogicY]){var b=n[targetLogicX][targetLogicY];b.building&&o.push(b.building)}}function h(e,d){var f=0.24;d==k.bombItem?(f=cc.sequence(cc.moveBy(f/6,cc.p(-3,3)),cc.moveBy(f/6,cc.p(6,-6)),cc.moveBy(f/6,cc.p(-6,0)),cc.moveBy(f/6,cc.p(6,6)),cc.moveBy(f/6,cc.p(-6,-3)),cc.moveBy(f/6,cc.p(3,0)),cc.delayTime(0.15)),f=cc.sequence(cc.delayTime(e),f,cc.callFunc(function(){SoundUtile.playMusic("res/music/bomb")},k,k),cc.spawn(cc.fadeOut(0.4).easing(cc.easeExponentialOut()),cc.scaleTo(0.4,3).easing(cc.easeExponentialOut())),cc.callFunc(k.bombEnd,k,k))):f=cc.sequence(cc.delayTime(e+(f+0.15)),cc.callFunc(function(r,g){var s=Number(r.colorId);g.addScore(s);g.showScore(r,s)},k,k),cc.spawn(cc.fadeOut(0.4).easing(cc.easeExponentialOut()),cc.scaleTo(0.4,3).easing(cc.easeExponentialOut())),cc.callFunc(k.bombEnd,k,k));d.runAction(f)}var p=this.bombItem;this.bombPopArr=[p];this.bombCount=0;var o=this.bombPopArr,n=this.tileObj,m=p.logicX,p=p.logicY,k=this;targetLogicX=(Number(m)-2).toString();targetLogicY=p.toString();j();targetLogicX=(Number(m)-1).toString();targetLogicY=(Number(p)+1).toString();j();targetLogicX=(Number(m)+1).toString();targetLogicY=(Number(p)+1).toString();j();targetLogicX=(Number(m)+2).toString();targetLogicY=(Number(p)+0).toString();j();targetLogicX=(Number(m)+1).toString();targetLogicY=(Number(p)-1).toString();j();targetLogicX=(Number(m)-1).toString();targetLogicY=(Number(p)-1).toString();j();h(0,o[0]);if(0<o.length){for(m=1;m<o.length;m++){h(0.12,o[m])}}this.showBombParticle()},showBombParticle:function(){},bombCount:0,bombEnd:function(e,d){this.bombCount++;var f=d.tileObj;f[e.logicX][e.logicY].buildingFlag=!1;f[e.logicX][e.logicY].building=null;e.removeFromParent();d.bombCount>=d.bombPopArr.length&&(d.bombItem=null,d.checkGameEnd())},curMaxPoint:1,curTotalPoint:3,changePointTime:0.25,addItemPoint:function(g){var f=Number(g.colorId)+1,k=f.toString();SoundUtile.playMusic("res/music/in");if(8<=f){this.bombItem=g}else{if(f>this.curMaxPoint){this.curMaxPoint=f;var j=0;6<f&&(f=6);for(var h=1;h<=f;h++){j+=h}this.curTotalPoint=j}g.setLocalZOrder(1);j=new cc.Sprite("res/"+k+".png");this.addChild(j,1);j.opacity=0;j.x=g.x;j.y=g.y;j.logicX=g.logicX;j.logicY=g.logicY;j.colorId=k;this.tileObj[j.logicX][j.logicY].building=j;j.oldItem=g;g=cc.sequence(cc.fadeIn(this.changePointTime),cc.callFunc(function(d,c){d.oldItem.removeFromParent();d.olditem=null},this,this));j.runAction(g)}},moveEnd:function(){for(var d=this.oldLightTiles,c=0;c<d.length;c++){d[c]&&!d[c].buildingFlag&&(d.splice(c,1),c--)}this.checkCanPop()},checkOneItemCanPop:function(w){function v(){if(s[r]&&s[r][p]&&(o=s[r][p],!o.checkedFlag&&o.building&&o.building.colorId==u.colorId&&-1==j.indexOf(o.building))){j.push(o.building);var b=2*u.moveSpeed;0==b&&(b=1);o.building.moveSpeed=b;o.building.moveTarget=u;n.push(o)}}if(!w.checkedFlag){w.checkedFlag=!0;var u=w.building;w=u.logicX;var t=u.logicY,s=this.tileObj,r,p,o,n=[],j=this.popArr;r=(Number(w)-2).toString();p=t.toString();v();r=(Number(w)-1).toString();p=(Number(t)+1).toString();v();r=(Number(w)+1).toString();p=(Number(t)+1).toString();v();r=(Number(w)+2).toString();p=(Number(t)+0).toString();v();r=(Number(w)+1).toString();p=(Number(t)-1).toString();v();r=(Number(w)-1).toString();p=(Number(t)-1).toString();v();if(0<n.length){for(w=0;w<n.length;w++){this.checkOneItemCanPop(n[w])}}}},sortOldTileArr:function(){function j(){p[targetLogicX]&&p[targetLogicX][targetLogicY]&&(tmpTileData=p[targetLogicX][targetLogicY],tmpTileData.building&&tmpTileData.building.colorId==n.colorId&&n.aroundNum++)}for(var h=this.oldLightTiles,p=this.tileObj,o=0;o<h.length;o++){var n=h[o].building;n.aroundNum=0;var m=n.logicX,k=n.logicY;targetLogicX=(Number(m)-2).toString();targetLogicY=k.toString();j();targetLogicX=(Number(m)-1).toString();targetLogicY=(Number(k)+1).toString();j();targetLogicX=(Number(m)+1).toString();targetLogicY=(Number(k)+1).toString();j();targetLogicX=(Number(m)+2).toString();targetLogicY=(Number(k)+0).toString();j();targetLogicX=(Number(m)+1).toString();targetLogicY=(Number(k)-1).toString();j();targetLogicX=(Number(m)-1).toString();targetLogicY=(Number(k)-1).toString();j()}h.sort(function(f,e){var r=f.building,g=e.building;return r.aroundNum==g.aroundNum?r.x!=g.x?r.x-g.x:r.y-g.y:g.aroundNum-r.aroundNum})},level:0,levelCurCount:0,levelTargetCount:15,levelUp:function(){this.level++},gameEndFlag:!1,gameEnd:function(){this.gameEndFlag=!0;this.unscheduleUpdate();cc.log("gameEnd");SoundUtile.playMusic("res/music/game_over");var d=new cc.Sprite(ChineseFlag?res.GameOver_png:res.GameOver2_png);this.addChild(d,19);d.attr({x:this.size.width/2,y:this.size.height/2-20+this.bottomEdgeY,opacity:0});var c=new cc.Sequence(cc.moveBy(1,cc.p(0,-20)).easing(cc.easeCubicActionOut()),cc.delayTime(0.7),cc.callFunc(this.gameEndCallBack,this,this));d.runAction(cc.fadeIn(0.8));d.runAction(c)},gameEndCallBack:function(d,c){c.gameEnd1()},gameEnd1:function(){cc.director.pause();this.unscheduleUpdate();var b=ChineseFlag?new GameEndLayer2:new EndLayerEnglish;this.endLayer=b;this.addChild(b,25);this.setGameScore()},setGameScore:function(){var d=this.score,c=cc.sys.localStorage.getItem("p79_score");c||(c=d);d>c;d>=c&&(c=d,cc.sys.localStorage.setItem("p79_score",c));this.endLayer.SetMaxScore(c);this.endLayer.showScore(d)},gameLose:function(){ChineseFlag&&(this.endLayer.SetTipLabel("\u83b7\u5f97\u5956\u54c1\u8fd8\u6709\u4e00\u6b65\u4e4b\u9065\uff01"))}}),MyUtil={getAngleByPoints:function(d,c){return 360*Math.atan((c.y-d.y)/(c.x-d.x))/(2*Math.PI)},getAngle:function(f,e,h,g){f=Math.abs(f-h);e=Math.abs(e-g);g=Math.sqrt(Math.pow(f,2)+Math.pow(e,2));e=Math.acos(e/g);return 180/(Math.PI/e)},getPointByCPAndAngleAndLen:function(f,e,h){var g=e*Math.PI/180;e=h*Math.cos(g);h*=Math.sin(g);return cc.p(f.x+h,f.y+e)}};SoundUtile={playMusic:function(b){IOS_FLAG?cc.audioEngine.playEffect(b+".mp3",!1):(b+=".ogg",cc.audioEngine.playMusic(b,!1))}};var GameScene=cc.Scene.extend({onEnter:function(){this._super();var b=new GameLayer;this.addChild(b)}});var EndLayer=cc.Layer.extend({tipLabel:null,chouJiangItem:null,moreGameItem:null,_shareLabel:null,ctor:function(e){this._super();e=cc.director.getVisibleSize();var d=new cc.DrawNode;this.addChild(d);d.clear();d.ctor();d.drawRect(cc.p(0,0),cc.p(e.width,e.height),cc.color(0,0,0,200),1,cc.color(0,0,0,255));this._shareLabel=new cc.Sprite.create(res.fenxiang_png);this._shareLabel.setAnchorPoint(1,1);this._shareLabel.x=e.width-25;this._shareLabel.y=e.height-20;this._shareLabel.setVisible(!1);this.addChild(this._shareLabel);this.tipLabel=new cc.LabelTTF("\u6210\u7ee9\u4e0d\u9519\uff0c\u8bd5\u8bd5\u624b\u6c14\uff01","Arial",45);this.tipLabel.x=e.width/2;this.tipLabel.y=e.height/2-45;this.addChild(this.tipLabel);d=new cc.MenuItemImage(res.JiXuBtn_png,res.JiXuBtn_png,function(){cc.log("JiXuBtn is clicked!");cc.director.runScene(new GameScene);cc.director.resume()},this);d.attr({x:e.width/2-150,y:e.height/5,anchorX:0.5,anchorY:0.5});var f=new cc.MenuItemSprite(new cc.Sprite(res.Share_png),new cc.Sprite(res.Share_png),function(){this._shareLabel.setVisible(!0)},this);f.attr({x:e.width/2+150,y:e.height/5,anchorX:0.5,anchorY:0.5});this.moreGameItem=new cc.MenuItemImage(res.MoreGame_png,res.MoreGame_png,function(){console.log(11)},this);this.moreGameItem.attr({x:e.width/2,y:e.height/2-150,anchorX:0.5,anchorY:0.5});e.x=0;e.y=0;this.addChild(e)},showScore:function(e){var d=cc.director.getVisibleSize(),f=new cc.Sprite(res.ScoreBg_png);this.addChild(f);f.attr({x:d.width/2,y:3*d.height/4+45});e=new cc.LabelTTF(e.toString(),"Arial",49);this.addChild(e);e.attr({x:d.width/2,y:3*d.height/4+45,color:cc.color("#000000")})},SetMaxScore:function(e){var d=cc.director.getVisibleSize(),f=new cc.LabelTTF("\u6700\u9ad8\u6210\u7ee9\uff1a"+e+"\u5206","Arial",45);this.addChild(f);f.attr({x:d.width/2,y:2*d.height/3-15});console.log("\u516d\u89d2\u62fc\u62fc\uff5e\u6211\u7684\u6700\u597d\u6210\u7ee9\uff1a"+e+"\u5206\uff0c\u6765\u8bd5\u4e00\u4e0b\uff1f")},SetTipLabel:function(b){this.tipLabel.string=b},SetChouJiangVisible:function(b){this.chouJiangItem.setVisible(b);this.moreGameItem.setVisible(b);b||this.tipLabel.setVisible(!0);""==sys_activityID&&(this.moreGameItem.setVisible(!0),this.tipLabel.setVisible(!1))}});var EndLayerEnglish=cc.Layer.extend({tipLabel:null,chouJiangItem:null,moreGameItem:null,_shareLabel:null,size:null,ctor:function(){this._super();var h=cc.director.getVisibleSize();h.height-=AD_REAL_H;this.size=h;var g=new cc.LayerColor(cc.color(0,0,0,230));this.addChild(g);cc.log("AD_REAL_H : "+AD_REAL_H);this.tipLabel=new cc.LabelTTF("","Arial",45);this.tipLabel.setAnchorPoint(0.5,1);this.tipLabel.x=h.width/2;this.tipLabel.y=2*h.height/3-130+AD_REAL_H;this.addChild(this.tipLabel);var g=h.height/2-200+AD_REAL_H,n=new cc.MenuItemImage(res.IconGame_png,res.IconGame_png,function(){console.log("IconGame_png")},this);n.attr({x:h.width/2,y:g+80,anchorX:0.5,anchorY:0.5});n.color=cc.color("#fcf253");n.scale=0.8;n.y-=0.1*n.height;var m=new cc.MenuItemImage(res.IconFacebook_png,res.IconFacebook_png,function(){this.onFacebookClick()},this);m.attr({x:h.width/2-130,y:g-80,anchorX:0.5,anchorY:0.5});var k=new cc.MenuItemImage(res.IconReplay_png,res.IconReplay_png,function(){cc.director.runScene(new GameScene);cc.director.resume()},this);k.attr({x:h.width/2+130,y:m.y,anchorX:0.5,anchorY:0.5});var j=new cc.MenuItemImage(res.IconTwitter_png,res.IconTwitter_png,function(){this.onTwitterClick()},this);j.attr({x:h.width/2,y:m.y,anchorX:0.5,anchorY:0.5});h=new cc.Menu(j,m,k,n);h.x=0;h.y=0;this.addChild(h);h=m.x-m.width/2;k=k.x+k.width/2;m=g-1;g+=1;n=new cc.DrawNode;n.drawRect(cc.p(h,m),cc.p(k,g),cc.color("#ffffff"),0,cc.color("#ffffff"));this.addChild(n)},showScore:function(e){var d=this.size,f=new cc.Sprite(res.ScoreBg_png);this.addChild(f);f.attr({x:d.width/2,y:2*d.height/3+AD_REAL_H});e=new cc.LabelTTF(e.toString(),"Arial",80);this.addChild(e);e.attr({x:d.width/2,y:2*d.height/3+AD_REAL_H,color:cc.color("#000000")})},bestScore:0,SetMaxScore:function(b){this.bestScore=b;this.tipLabel.string="Best : "+b;cc.log("this.tipLabel.x: "+this.tipLabel.x)},onTwitterClick:function(){console.log("onTwitterClick")},onFacebookClick:function(){console.log("onFacebookClick")},onShareSimpleLink:function(){}});var GameEndLayer2=cc.Layer.extend({tipLabel:null,chouJiangItem:null,moreGameItem:null,_shareLabel:null,ctor:function(){this._super();var e=cc.director.getVisibleSize(),d=new cc.LayerColor(cc.color(0,0,0,230));this.addChild(d);this._shareLabel=new cc.Sprite.create(res.fenxiang2_png);this._shareLabel.setAnchorPoint(1,1);this._shareLabel.x=e.width-25;this._shareLabel.y=e.height-20;this.addChild(this._shareLabel);d=new cc.LabelTTF("\u5206\u4eab\u7ed9\u670b\u53cb","Arial",40);d.setAnchorPoint(1,0.5);d.x=e.width-this._shareLabel.getContentSize().width;d.y=e.height-this._shareLabel.getContentSize().height/2-20;this.addChild(d);this.tipLabel=new cc.LabelTTF("","Arial",46,cc.size(600,600),cc.TEXT_ALIGNMENT_LEFT);this.tipLabel.setAnchorPoint(0.5,1);this.tipLabel.x=e.width/2;this.tipLabel.y=e.height-this._shareLabel.getContentSize().height-50;this.addChild(this.tipLabel);d=new cc.MenuItemImage(res.JiXuBtn_png,res.JiXuBtn_png,function(){cc.director.runScene(new GameScene);cc.director.resume()},this);d.attr({x:e.width/2,y:e.height/5+60,anchorX:0.5,anchorY:0.5});var f=new cc.MenuItemSprite(new cc.Sprite(res.MoreGame_png),new cc.Sprite(res.MoreGame_png),function(){window.location.href="http://t.cn/R5A0ttf"},this);f.attr({x:e.width/2,y:e.height/2-120,anchorX:0.5,anchorY:0.5});e=new cc.Menu(d,f);e.x=0;e.y=0;this.addChild(e)},showScore:function(d){cc.director.getVisibleSize();parseFloat(d/game_max_score).toFixed(2);var c="\u6211\u771f\u662f\u592a\u5389\u5bb3\uff0c\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u7adf\u7136\u5f97\u4e860\u5206\uff0c\u5168\u7403\u53ea\u67091\u4e2a\u4eba\u5f970\u5206\uff0c\u90a3\u4e2a\u4eba\u5c31\u662f\u6211\u5440\uff01";d>=game_max_score?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u51fb\u8d25\u4e86\u5168\u7403\u6240\u6709\u5bf9\u624b\uff0c\u7b49\u4f60\u6765\u6218\uff01":0<d&&150>=d?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u771f\u662f\u592a\u68d2\u4e86\uff0c\u518d\u7ec3\u7ec3\u5c31\u8fbe\u5230\u719f\u80fd\u751f\u5de7\uff01":150<d&&500>=d?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u771f\u662f\u592a\u68d2\u4e86\uff0c\u518d\u7ec3\u7ec3\u5c31\u662f\u7089\u706b\u7eaf\u9752\u5566\uff01":500<d&&750>=d?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u51fb\u8d25\u4e86\u5168\u7403"+(Math.floor(12*(d-500)/250)+80)+"%\u7684\u73a9\u5bb6\uff0c\u8fbe\u5230\u4e86\u7089\u706b\u7eaf\u9752\u7684\u5883\u754c\uff01":750<d&&1250>=d?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u51fb\u8d25\u4e86\u5168\u7403"+(Math.floor(7*(d-750)/500)+92)+"%\u7684\u73a9\u5bb6\uff0c\u8fbe\u5230\u4e86\u51fa\u795e\u5165\u5316\u7684\u5883\u754c!":1250<d&&2000>=d?c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u51fb\u8d25\u4e86\u5168\u740399%\u7684\u73a9\u5bb6\uff0c\u8fbe\u5230\u4e86\u72ec\u5b64\u6c42\u8d25\u7684\u5883\u754c\uff01":2000<d&&d<game_max_score&&(c=20-Math.ceil(17*(d-2000)/(game_max_score-2000)),c="\u6211\u5728\u516d\u89d2\u62fc\u62fc\u4e2d\u5f97\u4e86"+d+"\u5206\uff0c\u636e\u8bf4\u5168\u7403\u53ea\u6709 "+c+"\u4e2a\u4eba\u8fbe\u5230\u8fd9\u4e2a\u6c34\u5e73\uff01\u6709\u4f60\u5417\uff1f");d>=game_max_score&&(game_max_score=d);updateShare(d);Play68.setRankingScoreDesc(d);this.tipLabel.string=c},SetMaxScore:function(b){}});var GameInfoLayer=cc.LayerColor.extend({ctor:function(){this._super();this.init()},init:function(){this._super(cc.color(0,0,0,180));var e=cc.director.getVisibleSize();cc.p(e.width/2,e.height/2);var d,f;ChineseFlag?(d="\u70b9\u51fb\u4e0b\u9762\u65b9\u5757\u53ef\u8fdb\u884c\u65cb\u8f6c\uff0c\u53ef\u5c06\u65b9\u5757\u62d6\u5165\u4e0a\u65b9\u7a7a\u767d\u5904\uff0c\u5f53\u5468\u56f4\u8fde\u63a53\u4e2a\u540c\u8272\uff08\u540c\u70b9\u6570\uff09\u65f6\uff0c\u53ef\u4ee5\u8fdb\u884c\u6d88\u9664\u5408\u5e76\u3002",f="\u70b9\u51fb\u5f00\u59cb"):(d="Click on the following squares can rotate, can be square above into a blank space, when connecting three the same color, can be eliminated to merge.",f="Start");d=new cc.LabelTTF(d,"Arial",42,cc.size(600,450),cc.TEXT_ALIGNMENT_LEFT);d.setAnchorPoint(0.5,1);d.x=e.width/2;d.y=3*e.height/4;this.addChild(d);f=new cc.LabelTTF(f,"Arial",60);f.x=e.width/2;f.y=e.height/5;this.addChild(f);e=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:this.onTouchBegin,onTouchMoved:this.onTouchMoved,onTouchEnded:this.onTouchEnded});cc.eventManager.addListener(e,this)},onTouchBegin:function(e,d){var f=d.getCurrentTarget();cc.director.resume();f.parent.gameStart();f.removeFromParentAndCleanup();return !1},onTouchMoved:function(d,c){},onTouchEnded:function(d,c){}});var hexcase=0,b64pad="",chrsz=8;function hex_md5(b){return binl2hex(core_md5(str2binl(b),b.length*chrsz))}function b64_md5(b){return binl2b64(core_md5(str2binl(b),b.length*chrsz))}function str_md5(b){return binl2str(core_md5(str2binl(b),b.length*chrsz))}function hex_hmac_md5(d,c){return binl2hex(core_hmac_md5(d,c))}function b64_hmac_md5(d,c){return binl2b64(core_hmac_md5(d,c))}function str_hmac_md5(d,c){return binl2str(core_hmac_md5(d,c))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function core_md5(y,x){y[x>>5]|=128<<x%32;y[(x+64>>>9<<4)+14]=x;for(var w=1732584193,v=-271733879,u=-1732584194,t=271733878,s=0;s<y.length;s+=16){var r=w,p=v,o=u,j=t,w=md5_ff(w,v,u,t,y[s+0],7,-680876936),t=md5_ff(t,w,v,u,y[s+1],12,-389564586),u=md5_ff(u,t,w,v,y[s+2],17,606105819),v=md5_ff(v,u,t,w,y[s+3],22,-1044525330),w=md5_ff(w,v,u,t,y[s+4],7,-176418897),t=md5_ff(t,w,v,u,y[s+5],12,1200080426),u=md5_ff(u,t,w,v,y[s+6],17,-1473231341),v=md5_ff(v,u,t,w,y[s+7],22,-45705983),w=md5_ff(w,v,u,t,y[s+8],7,1770035416),t=md5_ff(t,w,v,u,y[s+9],12,-1958414417),u=md5_ff(u,t,w,v,y[s+10],17,-42063),v=md5_ff(v,u,t,w,y[s+11],22,-1990404162),w=md5_ff(w,v,u,t,y[s+12],7,1804603682),t=md5_ff(t,w,v,u,y[s+13],12,-40341101),u=md5_ff(u,t,w,v,y[s+14],17,-1502002290),v=md5_ff(v,u,t,w,y[s+15],22,1236535329),w=md5_gg(w,v,u,t,y[s+1],5,-165796510),t=md5_gg(t,w,v,u,y[s+6],9,-1069501632),u=md5_gg(u,t,w,v,y[s+11],14,643717713),v=md5_gg(v,u,t,w,y[s+0],20,-373897302),w=md5_gg(w,v,u,t,y[s+5],5,-701558691),t=md5_gg(t,w,v,u,y[s+10],9,38016083),u=md5_gg(u,t,w,v,y[s+15],14,-660478335),v=md5_gg(v,u,t,w,y[s+4],20,-405537848),w=md5_gg(w,v,u,t,y[s+9],5,568446438),t=md5_gg(t,w,v,u,y[s+14],9,-1019803690),u=md5_gg(u,t,w,v,y[s+3],14,-187363961),v=md5_gg(v,u,t,w,y[s+8],20,1163531501),w=md5_gg(w,v,u,t,y[s+13],5,-1444681467),t=md5_gg(t,w,v,u,y[s+2],9,-51403784),u=md5_gg(u,t,w,v,y[s+7],14,1735328473),v=md5_gg(v,u,t,w,y[s+12],20,-1926607734),w=md5_hh(w,v,u,t,y[s+5],4,-378558),t=md5_hh(t,w,v,u,y[s+8],11,-2022574463),u=md5_hh(u,t,w,v,y[s+11],16,1839030562),v=md5_hh(v,u,t,w,y[s+14],23,-35309556),w=md5_hh(w,v,u,t,y[s+1],4,-1530992060),t=md5_hh(t,w,v,u,y[s+4],11,1272893353),u=md5_hh(u,t,w,v,y[s+7],16,-155497632),v=md5_hh(v,u,t,w,y[s+10],23,-1094730640),w=md5_hh(w,v,u,t,y[s+13],4,681279174),t=md5_hh(t,w,v,u,y[s+0],11,-358537222),u=md5_hh(u,t,w,v,y[s+3],16,-722521979),v=md5_hh(v,u,t,w,y[s+6],23,76029189),w=md5_hh(w,v,u,t,y[s+9],4,-640364487),t=md5_hh(t,w,v,u,y[s+12],11,-421815835),u=md5_hh(u,t,w,v,y[s+15],16,530742520),v=md5_hh(v,u,t,w,y[s+2],23,-995338651),w=md5_ii(w,v,u,t,y[s+0],6,-198630844),t=md5_ii(t,w,v,u,y[s+7],10,1126891415),u=md5_ii(u,t,w,v,y[s+14],15,-1416354905),v=md5_ii(v,u,t,w,y[s+5],21,-57434055),w=md5_ii(w,v,u,t,y[s+12],6,1700485571),t=md5_ii(t,w,v,u,y[s+3],10,-1894986606),u=md5_ii(u,t,w,v,y[s+10],15,-1051523),v=md5_ii(v,u,t,w,y[s+1],21,-2054922799),w=md5_ii(w,v,u,t,y[s+8],6,1873313359),t=md5_ii(t,w,v,u,y[s+15],10,-30611744),u=md5_ii(u,t,w,v,y[s+6],15,-1560198380),v=md5_ii(v,u,t,w,y[s+13],21,1309151649),w=md5_ii(w,v,u,t,y[s+4],6,-145523070),t=md5_ii(t,w,v,u,y[s+11],10,-1120210379),u=md5_ii(u,t,w,v,y[s+2],15,718787259),v=md5_ii(v,u,t,w,y[s+9],21,-343485551),w=safe_add(w,r),v=safe_add(v,p),u=safe_add(u,o),t=safe_add(t,j)}return[w,v,u,t]}function md5_cmn(h,g,n,m,k,j){return safe_add(bit_rol(safe_add(safe_add(g,h),safe_add(m,j)),k),n)}function md5_ff(j,h,p,o,n,m,k){return md5_cmn(h&p|~h&o,j,h,n,m,k)}function md5_gg(j,h,p,o,n,m,k){return md5_cmn(h&o|p&~o,j,h,n,m,k)}function md5_hh(j,h,p,o,n,m,k){return md5_cmn(h^p^o,j,h,n,m,k)}function md5_ii(j,h,p,o,n,m,k){return md5_cmn(p^(h|~o),j,h,n,m,k)}function core_hmac_md5(h,g){var n=str2binl(h);16<n.length&&(n=core_md5(n,h.length*chrsz));for(var m=Array(16),k=Array(16),j=0;16>j;j++){m[j]=n[j]^909522486,k[j]=n[j]^1549556828}n=core_md5(m.concat(str2binl(g)),512+g.length*chrsz);return core_md5(k.concat(n),640)}function safe_add(e,d){var f=(e&65535)+(d&65535);return(e>>16)+(d>>16)+(f>>16)<<16|f&65535}function bit_rol(d,c){return d<<c|d>>>32-c}function str2binl(f){for(var e=[],h=(1<<chrsz)-1,g=0;g<f.length*chrsz;g+=chrsz){e[g>>5]|=(f.charCodeAt(g/chrsz)&h)<<g%32}return e}function binl2str(f){for(var e="",h=(1<<chrsz)-1,g=0;g<32*f.length;g+=chrsz){e+=String.fromCharCode(f[g>>5]>>>g%32&h)}return e}function binl2hex(f){for(var e=hexcase?"0123456789ABCDEF":"0123456789abcdef",h="",g=0;g<4*f.length;g++){h+=e.charAt(f[g>>2]>>g%4*8+4&15)+e.charAt(f[g>>2]>>g%4*8&15)}return h}function binl2b64(g){for(var f="",k=0;k<4*g.length;k+=3){for(var j=(g[k>>2]>>k%4*8&255)<<16|(g[k+1>>2]>>(k+1)%4*8&255)<<8|g[k+2>>2]>>(k+2)%4*8&255,h=0;4>h;h++){f=8*k+6*h>32*g.length?f+b64pad:f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(j>>6*(3-h)&63)}}return f}var PC_FLAG=!1,ChineseFlag=!0;cc.game.onStart=function(){!cc.sys.isNative&&document.getElementById("cocosLoading")&&document.body.removeChild(document.getElementById("cocosLoading"));cc.view.enableRetina(cc.sys.os===cc.sys.OS_IOS?!0:!1);cc.view.adjustViewPort(!0);cc.sys.os===cc.sys.OS_IOS||cc.sys.os===cc.sys.OS_ANDROID||cc.sys.os===cc.sys.OS_BLACKBERRY||cc.sys.os===cc.sys.OS_WP8||cc.sys.os===cc.sys.OS_BADA?cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_WIDTH):(PC_FLAG=!0,cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.SHOW_ALL));cc.sys.language==cc.sys.LANGUAGE_CHINESE&&(ChineseFlag=!0);document.getElementById("loadingImg")&&document.body.removeChild(document.getElementById("loadingImg"));cc.view.resizeWithBrowserSize(!0);cc._loaderImage="";cc.LoaderScene.preload(g_resources,function(){cc.director.runScene(new GameScene)},this)};cc.game.run();